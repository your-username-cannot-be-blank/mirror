[
    {
        "id": 12230,
        "name": null,
        "username": "ValdikSS",
        "avatar_template": "/user_avatar/ntc.party/valdikss/{size}/2_2.png",
        "created_at": "2023-03-03T10:38:13.192Z",
        "cooked": "<p>Iranian <a href=\"https://parsonline.net\">ParsOnline</a> ISP has a regexp filter for the domain generation algorithm used in Tor for ClientHello SNI field.<br>\n<code>www\\.[a-z]{4,25}\\.com</code></p>\n<p><a href=\"https://gitweb.torproject.org/tor.git/tree/src/lib/tls/tortls_openssl.c?h=maint-0.4.7&amp;id=21b3397f9b0803134bc458b83cd161de259887fd#n1082\" class=\"onebox\" target=\"_blank\" rel=\"noopener\">https://gitweb.torproject.org/tor.git/tree/src/lib/tls/tortls_openssl.c?h=maint-0.4.7&amp;id=21b3397f9b0803134bc458b83cd161de259887fd#n1082</a></p>\n<p>You can connect to the majority of Tor relays, but the connection would freeze if this type of SNI is used along with ClientHello size &lt;= 256 bytes.<br>\nChanging the domain name even slightly, like <code>.com</code> to <code>.org</code> allows to connect to Tor Relay.<br>\nThis filter seem to be applied only to known Relays IP addresses in Tor network.</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 3,
        "updated_at": "2023-03-03T10:38:13.192Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 180,
        "reads": 63,
        "readers_count": 62,
        "score": 912.6,
        "yours": false,
        "topic_id": 3922,
        "topic_slug": "tor-relay-tls-clienthello-sni-fingerprinting",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://gitweb.torproject.org/tor.git/tree/src/lib/tls/tortls_openssl.c?h=maint-0.4.7&id=21b3397f9b0803134bc458b83cd161de259887fd#n1082",
                "internal": false,
                "reflection": false,
                "title": "tortls_openssl.c\\tls\\lib\\src - tor - Tor's source code",
                "clicks": 27
            },
            {
                "url": "https://parsonline.net",
                "internal": false,
                "reflection": false,
                "clicks": 9
            }
        ],
        "read": true,
        "user_title": "AntiZapret staff",
        "title_is_group": false,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": true,
        "staff": true,
        "user_id": 1,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/tor-relay-tls-clienthello-sni-fingerprinting/3922/1",
        "can_translate": false
    },
    {
        "id": 12237,
        "name": "",
        "username": "tango",
        "avatar_template": "/letter_avatar_proxy/v4/letter/t/e36b37/{size}.png",
        "created_at": "2023-03-03T20:06:41.496Z",
        "cooked": "<p>I thought that the client SNI encoded some signification information for the Tor handshake, but I was mistaken. By my reading of the spec, there are no restrictions on the SNI, and so the name generation algorithm could be changed by a single client compatibly.</p>\n<p>What I was thinking of, relating to the name being significant, is actually in the server certificate. A commonName ending in <code>.net</code> indicates a v2 handshake; any other TLD is for a v3 handshake. For backward compatibility, some conventional implementation details of the v2 handshake were selected to be markers of v2 when v3 was introduced.</p>\n<p><a href=\"https://gitweb.torproject.org/torspec.git/tree/tor-spec.txt?id=4234d9325913a0c2ab54a86f2108b3fe99551035#n330\" class=\"onebox\" target=\"_blank\" rel=\"noopener\">https://gitweb.torproject.org/torspec.git/tree/tor-spec.txt?id=4234d9325913a0c2ab54a86f2108b3fe99551035#n330</a></p>\n<blockquote>\n<p>In “in-protocol” (a.k.a. “the v3 handshake”), the initiator sends no certificates, and the responder sends a single connection certificate.  The choice of ciphersuites must be as in a “renegotiation” handshake.  There are additionally a set of constraints on the connection certificate, which the initiator can use to learn that the in-protocol handshake is in use.  Specifically, at least one of these properties must be true of the certificate:</p>\n<ul>\n<li>The certificate is self-signed</li>\n<li>Some component other than “commonName” is set in the subject or issuer DN of the certificate.</li>\n<li>The commonName of the subject or issuer of the certificate ends with a suffix other than “.net”.</li>\n<li>The certificate’s public key modulus is longer than 1024 bits.</li>\n</ul>\n</blockquote>\n<p>More info: <a href=\"https://gitweb.torproject.org/torspec.git/tree/proposals/176-revising-handshake.txt?id=0b9fbb893c7cd395887a9e297febfa88cab068ab\">Proposal 176: Proposed version-3 link handshake for Tor</a>.</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 3,
        "updated_at": "2023-03-03T20:06:41.496Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 61,
        "readers_count": 60,
        "score": 27.2,
        "yours": false,
        "topic_id": 3922,
        "topic_slug": "tor-relay-tls-clienthello-sni-fingerprinting",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://gitweb.torproject.org/torspec.git/tree/tor-spec.txt?id=4234d9325913a0c2ab54a86f2108b3fe99551035#n330",
                "internal": false,
                "reflection": false,
                "title": "tor-spec.txt - torspec - Tor's protocol specifications",
                "clicks": 9
            },
            {
                "url": "https://gitweb.torproject.org/torspec.git/tree/proposals/176-revising-handshake.txt?id=0b9fbb893c7cd395887a9e297febfa88cab068ab",
                "internal": false,
                "reflection": false,
                "title": "176-revising-handshake.txt\\proposals - torspec - Tor's protocol specifications",
                "clicks": 3
            }
        ],
        "read": true,
        "user_title": "dnstt developer",
        "title_is_group": false,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 26,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/tor-relay-tls-clienthello-sni-fingerprinting/3922/2",
        "can_translate": false
    },
    {
        "id": 18695,
        "name": null,
        "username": "ValdikSS",
        "avatar_template": "/user_avatar/ntc.party/valdikss/{size}/2_2.png",
        "created_at": "2023-10-12T02:13:42.198Z",
        "cooked": "<p>5 posts were merged into an existing topic: <a href=\"/t/%D0%BE%D0%B1%D1%81%D1%83%D0%B6%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5-tor-arti-rust-%D0%B2%D0%B5%D1%80%D1%81%D0%B8%D1%8F/4912\">Обсуждение Tor Arti (Rust-версия)</a></p>",
        "post_number": 3,
        "post_type": 3,
        "posts_count": 3,
        "updated_at": "2023-10-12T02:13:42.198Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 16,
        "readers_count": 15,
        "score": 3.2,
        "yours": false,
        "topic_id": 3922,
        "topic_slug": "tor-relay-tls-clienthello-sni-fingerprinting",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://ntc.party/t/%D0%BE%D0%B1%D1%81%D1%83%D0%B6%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5-tor-arti-rust-%D0%B2%D0%B5%D1%80%D1%81%D0%B8%D1%8F/4912",
                "internal": true,
                "reflection": false,
                "title": "Обсуждение Tor Arti (Rust-версия)",
                "clicks": 0
            }
        ],
        "read": true,
        "user_title": "AntiZapret staff",
        "title_is_group": false,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": true,
        "staff": true,
        "user_id": 1,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "action_code": "split_topic",
        "post_url": "/t/tor-relay-tls-clienthello-sni-fingerprinting/3922/3",
        "can_translate": false
    }
]
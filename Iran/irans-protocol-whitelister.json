[
    {
        "id": 1646,
        "name": "",
        "username": "fortuna",
        "avatar_template": "/user_avatar/ntc.party/fortuna/{size}/150_2.png",
        "created_at": "2020-08-06T17:29:46.855Z",
        "cooked": "<p>The Geneva team has reported on a new protocol whitelister that has been deployed in Iran: <a href=\"https://geneva.cs.umd.edu/posts/iran-whitelister/\" rel=\"nofollow noopener\">https://geneva.cs.umd.edu/posts/iran-whitelister/</a></p>\n<p>Here are my observations:</p>\n<ul>\n<li>They observe traffic to ports 53, 80 and 443 and block connections that are not DNS, HTTP or HTTPS.</li>\n<li>They monitor the first two packets only</li>\n<li>They are not able to reassemble the TCP connection. Sending “G”, “ET”, “/” for HTTP fails when “GET /” succeeds.</li>\n<li>Blocking happens by blocking the second and subsequent packets from the client.\n<ul>\n<li>This aligns with pcaps I’ve seen for blocked Outline servers in Iran. The client is able to send some data, but the rest is blackholed and it looks like a client timeout from the server perspective.</li>\n</ul>\n</li>\n<li>Server packets are not affected</li>\n<li>DNS-over-TCP is blocked, but usually there’s no second packet, so there’s not much disruption there.</li>\n<li>The whitelister is not bidirectional. You need to be in Iran to trigger it</li>\n<li>Not all destination IPs are subject to the whitelister. It’s unclear what IP ranges are affected.</li>\n<li>Their Geneva system learned some circumvention strategies:\n<ul>\n<li>Send two empty FIN packets before the TCP handshake. You can’t implement this on mobile and it’s very fingerprintable.</li>\n<li>Send 9 ACKs during the TCP handshake. Also fingerprintable and not mobile-friendly.</li>\n<li>Send a HTTP GET fingerprint with corrupted checksum before each packet. Mobile apps could prepend traffic with a GET, but not tamper with the checksum.</li>\n</ul>\n</li>\n</ul>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 2,
        "updated_at": "2020-08-06T17:29:46.855Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 27,
        "reads": 30,
        "readers_count": 29,
        "score": 141.0,
        "yours": false,
        "topic_id": 609,
        "topic_slug": "irans-protocol-whitelister",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://geneva.cs.umd.edu/posts/iran-whitelister/",
                "internal": false,
                "reflection": false,
                "title": "censorship.ai | Iran: A New Model for Censorship",
                "clicks": 19
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 77,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/irans-protocol-whitelister/609/1",
        "can_translate": false
    },
    {
        "id": 1647,
        "name": "",
        "username": "fortuna",
        "avatar_template": "/user_avatar/ntc.party/fortuna/{size}/150_2.png",
        "created_at": "2020-08-06T17:31:40.387Z",
        "cooked": "<p>One question I have: can you establish a connection, wait some time, then use it freely?<br>\nDepending on how long you need to wait, a circumvention tool could leverage a pool of connections that are set up before they are needed.</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 2,
        "updated_at": "2020-08-06T17:31:40.387Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 28,
        "readers_count": 27,
        "score": 15.6,
        "yours": false,
        "topic_id": 609,
        "topic_slug": "irans-protocol-whitelister",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 77,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/irans-protocol-whitelister/609/2",
        "can_translate": false
    }
]
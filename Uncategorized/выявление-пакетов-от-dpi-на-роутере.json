[
    {
        "id": 6159,
        "name": null,
        "username": "Sector",
        "avatar_template": "/letter_avatar_proxy/v4/letter/s/ac91a4/{size}.png",
        "created_at": "2022-03-18T14:09:31.978Z",
        "cooked": "<p>Всем привет! Задача проста: выявлять и направлять через VPS заблокированные ресурсы на уровне домашнего роутера. Сейчас пытаюсь реализовать на базе микротика. На данный момент отлавливаю ответ от DPI следующим правилом:</p>\n<p>/ip firewall filter add action=add-src-to-address-list address-list=rkn address-list-timeout=1w chain=forward comment=<br>\n“RST to Address list” connection-state=established in-interface=pppoe-out1 packet-size=40 protocol=tcp <br>\nsrc-port=443,80 tcp-flags=rst</p>\n<p>Затем соединения с хостами, из сформировавшегося списка “подозрительных” ip-адресов направляю через VPN:</p>\n<p>/ip firewall mangle<br>\nadd action=mark-routing chain=prerouting dst-address-list=rkn new-routing-mark=rkn passthrough=yes</p>\n<p>Проблема в том, что правило фильтра слишком широкое, и в список попадает много лишних, легитимных соединений. В статье на хабре ValdikSS писал: “В случае с HTTPS-сайтами, DPI присылает TCP Reset-пакет, тоже с Identification = 1 и Flags = 0”, но в моём случае это не так почему-то, всё наоборот: DF-флаг на месте (1), identification = 0. Провайдер - ростелеком, Нижний Новгород.</p>\n<p>Подскажите, можно-ли как-то средствами микротика однозначно идентифицировать ответ от DPI (TCP-reset)?</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2022-03-18T14:10:58.862Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1996,
        "reads": 72,
        "readers_count": 71,
        "score": 9999.4,
        "yours": false,
        "topic_id": 1990,
        "topic_slug": "%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 948,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5/1990/1",
        "can_translate": false
    },
    {
        "id": 6269,
        "name": null,
        "username": "ValdikSS",
        "avatar_template": "/user_avatar/ntc.party/valdikss/{size}/2_2.png",
        "created_at": "2022-03-20T21:08:27.864Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"Sector\" data-post=\"1\" data-topic=\"1990\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/s/ac91a4/48.png\" class=\"avatar\"> Sector:</div>\n<blockquote>\n<p>В статье на хабре ValdikSS писал</p>\n</blockquote>\n</aside>\n<p>Эта информация чуть ли не пятилетней давности, с тех пор многие системы DPI изменились или были заменены.</p>\n<p>Почему из всех возможных методов обхода блокировок вы выбрали именно этот? Вас чем-то не устроили «классические» методы маршрутизации заблокированных адресов (которые тоже могут маршрутизировать много «лишнего»)?</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2022-03-20T21:08:27.864Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 1,
        "incoming_link_count": 21,
        "reads": 59,
        "readers_count": 58,
        "score": 116.8,
        "yours": false,
        "topic_id": 1990,
        "topic_slug": "%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "AntiZapret staff",
        "title_is_group": false,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": true,
        "staff": true,
        "user_id": 1,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5/1990/2",
        "can_translate": false
    },
    {
        "id": 6280,
        "name": null,
        "username": "Sector",
        "avatar_template": "/letter_avatar_proxy/v4/letter/s/ac91a4/{size}.png",
        "created_at": "2022-03-21T04:16:54.688Z",
        "cooked": "<p>Приветствую! Так вот как раз и не устроили тем, что маршрутизируют много «лишнего», ищу способ исправить этот момент</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2022-03-21T04:16:54.688Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 12,
        "reads": 56,
        "readers_count": 55,
        "score": 76.2,
        "yours": false,
        "topic_id": 1990,
        "topic_slug": "%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 948,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5/1990/3",
        "can_translate": false
    },
    {
        "id": 6284,
        "name": "Евгений",
        "username": "Eugen",
        "avatar_template": "/letter_avatar_proxy/v4/letter/e/ebca7d/{size}.png",
        "created_at": "2022-03-21T05:32:37.887Z",
        "cooked": "<p>Привет!<br>\nУ меня провайдер тоже ростелеком. В принципе с его DPI (не ТСПУ) в целом легко бороться.<br>\nНа микроте две команды:<br>\nпод https значение ttl=equal возможно придется подобрать индивидуально Wireshark в помощь.</p>\n<pre><code class=\"lang-auto\">1    block - http\n      chain=forward action=drop protocol=tcp in-interface=ether1 src-port=80 content=Location: http://warning.rt.ru/ log=no log-prefix=\"\" \n\n 2    block - https\n      chain=forward action=drop tcp-flags=rst protocol=tcp ttl=equal:118 in-interface=ether1 src-port=443 packet-size=40 log=no log-prefix=\"\"\n</code></pre>\n<p>Ну и в дополнении к этому <a href=\"https://habr.com/ru/post/549282/\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Настройка BGP для обхода блокировок, версия 3.1. И немного Q&amp;A / Хабр</a></p>\n<p>P.S.<br>\nРостелеком вроде не баловался подменой DNS, но все равно запросы лучше также в тунель отправлять</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2022-03-21T05:32:37.887Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 14,
        "reads": 55,
        "readers_count": 54,
        "score": 86.0,
        "yours": false,
        "topic_id": 1990,
        "topic_slug": "%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5",
        "display_username": "Евгений",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://habr.com/ru/post/549282/",
                "internal": false,
                "reflection": false,
                "title": "Настройка BGP для обхода блокировок, версия 3.1. И немного Q&A / Хабр",
                "clicks": 49
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 964,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5/1990/4",
        "can_translate": false
    },
    {
        "id": 6285,
        "name": null,
        "username": "Sector",
        "avatar_template": "/letter_avatar_proxy/v4/letter/s/ac91a4/{size}.png",
        "created_at": "2022-03-21T05:58:49.735Z",
        "cooked": "<p>Привет! Увы, это решение уже не работает должным образом, по крайней мере в Нижнем Новгороде <img src=\"https://ntc.party/images/emoji/twitter/frowning.png?v=12\" title=\":frowning:\" class=\"emoji\" alt=\":frowning:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2022-03-21T05:58:49.735Z",
        "reply_count": 0,
        "reply_to_post_number": 4,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 52,
        "readers_count": 51,
        "score": 25.4,
        "yours": false,
        "topic_id": 1990,
        "topic_slug": "%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "Eugen",
            "name": "Евгений",
            "avatar_template": "/letter_avatar_proxy/v4/letter/e/ebca7d/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 948,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5/1990/5",
        "can_translate": false
    },
    {
        "id": 6286,
        "name": "Евгений",
        "username": "Eugen",
        "avatar_template": "/letter_avatar_proxy/v4/letter/e/ebca7d/{size}.png",
        "created_at": "2022-03-21T06:15:50.747Z",
        "cooked": "<p>А DNS заворачиваете в туннель?</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2022-03-21T06:15:50.747Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 4,
        "reads": 53,
        "readers_count": 52,
        "score": 35.6,
        "yours": false,
        "topic_id": 1990,
        "topic_slug": "%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5",
        "display_username": "Евгений",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 964,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5/1990/6",
        "can_translate": false
    },
    {
        "id": 6343,
        "name": null,
        "username": "Sector",
        "avatar_template": "/letter_avatar_proxy/v4/letter/s/ac91a4/{size}.png",
        "created_at": "2022-03-22T08:48:30.804Z",
        "cooked": "<p>DNS через DoH Cloudflare</p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2022-03-22T08:48:30.804Z",
        "reply_count": 0,
        "reply_to_post_number": 6,
        "quote_count": 0,
        "incoming_link_count": 6,
        "reads": 55,
        "readers_count": 54,
        "score": 41.0,
        "yours": false,
        "topic_id": 1990,
        "topic_slug": "%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "Eugen",
            "name": "Евгений",
            "avatar_template": "/letter_avatar_proxy/v4/letter/e/ebca7d/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 948,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5/1990/7",
        "can_translate": false
    },
    {
        "id": 6349,
        "name": null,
        "username": "ValdikSS",
        "avatar_template": "/user_avatar/ntc.party/valdikss/{size}/2_2.png",
        "created_at": "2022-03-22T09:23:39.900Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"Sector\" data-post=\"3\" data-topic=\"1990\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/s/ac91a4/48.png\" class=\"avatar\"> Sector:</div>\n<blockquote>\n<p>маршрутизируют много «лишнего», ищу способ исправить этот момент</p>\n</blockquote>\n</aside>\n<aside class=\"quote quote-modified\" data-post=\"1\" data-topic=\"129\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/user_avatar/ntc.party/valdikss/48/2_2.png\" class=\"avatar\">\n    <a href=\"https://ntc.party/t/vpn/129\">Контейнер VPN АнтиЗапрета для установки на собственный сервер</a> <a class=\"badge-category__wrapper \" href=\"/c/antizapret-prostovpn-org/az-self-hosted/38\"><span data-category-id=\"38\" style=\"--category-badge-color: #0088CC; --category-badge-text-color: #FFFFFF; --parent-category-badge-color: #8C6238;\" data-parent-category-id=\"5\" data-drop-close=\"true\" class=\"badge-category --has-parent\" title=\"Вопросы и особенности работы контейнера VPN АнтиЗапрета на своих серверах\"><span class=\"badge-category__name\">АнтиЗапрет на собственном сервере (self-hosted)</span></span></a>\n  </div>\n  <blockquote>\n    <a name=\"antizapret-vpn-container-1\" class=\"anchor\" href=\"#antizapret-vpn-container-1\"></a>AntiZapret VPN Container\nВыложил готовый контейнер VPN АнтиЗапрета и все файлы для его сборки на \n<a href=\"https://bitbucket.org/anticensority/antizapret-vpn-container/src/\" class=\"onebox\" target=\"_blank\" rel=\"noopener\">https://bitbucket.org/anticensority/antizapret-vpn-container/src/</a> \nПоследнее обновление: <a href=\"https://ntc.party/t/vpn/129/61\">26.05.2020</a> \nДля правильной работы Twitter, Facebook и Instagram <a href=\"https://ntc.party/t/vpn/129/127\">требуются дополнительные действия</a>. \n\n<a name=\"vpn-10-2\" class=\"anchor\" href=\"#vpn-10-2\"></a>Создайте свой личный VPN АнтиЗапрета за 10 минут!\nЧто это? Это полный аналог сервиса для получения доступа к заблокированным сайтам в Российской Федерации <a href=\"https://antizapret.prostovpn.org/\">АнтиЗапрет VPN</a>, пригодный для установки на личный сервер…\n  </blockquote>\n</aside>\n",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2022-03-22T09:23:39.900Z",
        "reply_count": 0,
        "reply_to_post_number": 3,
        "quote_count": 1,
        "incoming_link_count": 28,
        "reads": 62,
        "readers_count": 61,
        "score": 152.4,
        "yours": false,
        "topic_id": 1990,
        "topic_slug": "%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://ntc.party/t/%D0%BA%D0%BE%D0%BD%D1%82%D0%B5%D0%B9%D0%BD%D0%B5%D1%80-vpn-%D0%B0%D0%BD%D1%82%D0%B8%D0%B7%D0%B0%D0%BF%D1%80%D0%B5%D1%82%D0%B0-%D0%B4%D0%BB%D1%8F-%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B8-%D0%BD%D0%B0-%D1%81%D0%BE%D0%B1%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D1%8B%D0%B9-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80/129",
                "internal": true,
                "reflection": false,
                "title": "Контейнер VPN АнтиЗапрета для установки на собственный сервер",
                "clicks": 0
            }
        ],
        "read": true,
        "user_title": "AntiZapret staff",
        "title_is_group": false,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": true,
        "staff": true,
        "user_id": 1,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5/1990/8",
        "can_translate": false
    },
    {
        "id": 7534,
        "name": "",
        "username": "Elevator",
        "avatar_template": "/letter_avatar_proxy/v4/letter/e/ee59a6/{size}.png",
        "created_at": "2022-05-16T08:03:07.364Z",
        "cooked": "<p>Поделюсь своим способом.<br>\nМой провайдер осуществляет блокировку интересным способом, отправляя FIN,ACK пакет после ClientHello. Видимо они думали что это усложнит жизнь тем кто захочет обойти блокировку DPI.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"выявление-пакетов-от-dpi-на-роутере/074978daeddb88ebbbfb823a593813fc7505a843.png\" data-download-href=\"https://ntc.party/uploads/default/074978daeddb88ebbbfb823a593813fc7505a843\" title=\"для статьи\"><img src=\"выявление-пакетов-от-dpi-на-роутере/074978daeddb88ebbbfb823a593813fc7505a843.png\" alt=\"для статьи\" data-base62-sha1=\"12sKQdRXwy3zjKLsBGAptJS6QBJ\" width=\"690\" height=\"245\" data-dominant-color=\"BEC2C3\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">для статьи</span><span class=\"informations\">1129×401 35.5 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Фейковый пакет FIN,ACK мало чем отличается от других кроме всегда одинакового TTL=57 что недостаточно для выявления блокировки.</p>\n<p>Но я нашел способ его выявлять практически со 100% гарантией.</p>\n<p><strong>Принцип работы</strong><br>\nМы создаем два правила. Первое помечает все соединения в которых мы нашли ClientHello пакет.<br>\nВторое правило ловит следующий пакет и проверяет его на FIN,ACK при условии что <strong>объем переданных пакетов в соединении не превышает 1000 байт</strong>.  Значение в 1000 байт я подбирал экспериментально. Если 2-ое правило срабатывает то добавляем ip сервера в список для обхода блокировок.</p>\n<p>Вероятность что в первых 1000 байт соединения, отсылая приветствие, мы получим пинок под зад стремится к нулю, следовательно нас блокируют.</p>\n<p><strong>Реализация</strong></p>\n<p>В IP-Firewall-Mangle создаем два правила:</p>\n<p>Первое правило:</p>\n<details>\n<summary>\nПосмотреть</summary>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"выявление-пакетов-от-dpi-на-роутере/e7b767f08652aadbc14fb7019a12c9ca5139932f.png\" data-download-href=\"https://ntc.party/uploads/default/e7b767f08652aadbc14fb7019a12c9ca5139932f\" title=\"rule1_1\"><img src=\"выявление-пакетов-от-dpi-на-роутере/e7b767f08652aadbc14fb7019a12c9ca5139932f.png\" alt=\"rule1_1\" data-base62-sha1=\"x3ReXlINQ6DpicnDuG4wJDbQ6f5\" width=\"436\" height=\"500\" data-dominant-color=\"E6E6E9\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">rule1_1</span><span class=\"informations\">603×690 16.1 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div><br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"выявление-пакетов-от-dpi-на-роутере/e27f004bf6dbdb94f1767f434d4af2c32b42fdcb.png\" data-download-href=\"https://ntc.party/uploads/default/e27f004bf6dbdb94f1767f434d4af2c32b42fdcb\" title=\"rule1_2\"><img src=\"выявление-пакетов-от-dpi-на-роутере/e27f004bf6dbdb94f1767f434d4af2c32b42fdcb.png\" alt=\"rule1_2\" data-base62-sha1=\"wjG0r6dbHgLHihCmzDo4F33TZiz\" width=\"438\" height=\"500\" data-dominant-color=\"E3E4E6\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">rule1_2</span><span class=\"informations\">607×692 17.5 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div><br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"выявление-пакетов-от-dpi-на-роутере/302236500a15f647ed852563742319dc9e5e287e.png\" data-download-href=\"https://ntc.party/uploads/default/302236500a15f647ed852563742319dc9e5e287e\" title=\"rule1_3\"><img src=\"выявление-пакетов-от-dpi-на-роутере/302236500a15f647ed852563742319dc9e5e287e.png\" alt=\"rule1_3\" data-base62-sha1=\"6ROdvcluafacxI3zZksAm8cCEMK\" width=\"436\" height=\"500\" data-dominant-color=\"E7E8EB\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">rule1_3</span><span class=\"informations\">605×693 11.1 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n</details>\n<p>Второе правило:</p>\n<details>\n<summary>\nПосмотреть</summary>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"выявление-пакетов-от-dpi-на-роутере/1cd48cdb37c8ea73dee20944492b88ed7af3d36d.png\" data-download-href=\"https://ntc.party/uploads/default/1cd48cdb37c8ea73dee20944492b88ed7af3d36d\" title=\"rule2_1\"><img src=\"выявление-пакетов-от-dpi-на-роутере/1cd48cdb37c8ea73dee20944492b88ed7af3d36d.png\" alt=\"rule2_1\" data-base62-sha1=\"472KRKAJe4Igbg83VENaoFXfrAN\" width=\"436\" height=\"500\" data-dominant-color=\"E6E6E9\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">rule2_1</span><span class=\"informations\">603×690 16.1 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div><br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"выявление-пакетов-от-dpi-на-роутере/a7952384f217147d6a29b426f444b7e900af4bc0.png\" data-download-href=\"https://ntc.party/uploads/default/a7952384f217147d6a29b426f444b7e900af4bc0\" title=\"rule2_2\"><img src=\"выявление-пакетов-от-dpi-на-роутере/a7952384f217147d6a29b426f444b7e900af4bc0.png\" alt=\"rule2_2\" data-base62-sha1=\"nUvgtXi1Bjkq5NPoRUTD3OPwq4M\" width=\"435\" height=\"500\" data-dominant-color=\"E4E4E7\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">rule2_2</span><span class=\"informations\">603×693 17.7 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div><br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"выявление-пакетов-от-dpi-на-роутере/7d8397bfed10083ff889d41879638fa788bd1d1d.png\" data-download-href=\"https://ntc.party/uploads/default/7d8397bfed10083ff889d41879638fa788bd1d1d\" title=\"rule2_3\"><img src=\"выявление-пакетов-от-dpi-на-роутере/7d8397bfed10083ff889d41879638fa788bd1d1d.png\" alt=\"rule2_3\" data-base62-sha1=\"hUlCrmfDvmsbJED9qa8t1jWYPG5\" width=\"436\" height=\"500\" data-dominant-color=\"E7E8EC\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">rule2_3</span><span class=\"informations\">603×691 11 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n</details>\n<p>Данный способ также хорошо подойдет если провайдер отсылает фейковый RST пакет, т.к мы отсекаем пакеты после 1000 байт и тем самым уменьшаем вероятность ложного срабатывания.</p>",
        "post_number": 9,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2022-05-16T17:18:30.506Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 87,
        "reads": 58,
        "readers_count": 57,
        "score": 446.6,
        "yours": false,
        "topic_id": 1990,
        "topic_slug": "%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 4,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://ntc.party/t/%D0%B2%D0%BA%D0%BB%D1%8E%D1%87%D0%B8%D0%BB%D0%B8-dpi-%D0%B4%D0%BB%D1%8F-%D1%85%D0%BE%D1%81%D1%82%D0%B8%D0%BD%D0%B3%D0%BE%D0%B2/3750/4",
                "internal": true,
                "reflection": true,
                "title": "Включили DPI для хостингов?",
                "clicks": 0
            },
            {
                "url": "https://ntc.party/t/%D0%B2%D0%BA%D0%BB%D1%8E%D1%87%D0%B8%D0%BB%D0%B8-dpi-%D0%B4%D0%BB%D1%8F-%D1%85%D0%BE%D1%81%D1%82%D0%B8%D0%BD%D0%B3%D0%BE%D0%B2/3750/5",
                "internal": true,
                "reflection": true,
                "title": "Включили DPI для хостингов?",
                "clicks": 0
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 581,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5/1990/9",
        "can_translate": false
    },
    {
        "id": 12361,
        "name": "",
        "username": "Elevator",
        "avatar_template": "/letter_avatar_proxy/v4/letter/e/ee59a6/{size}.png",
        "created_at": "2023-03-10T10:41:17.612Z",
        "cooked": "<p>Заметил у своего провайдера новый тип блокировки<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"выявление-пакетов-от-dpi-на-роутере/c8b9c95dd2fba5f500170c8f8604732f856415b3.png\" data-download-href=\"https://ntc.party/uploads/default/c8b9c95dd2fba5f500170c8f8604732f856415b3\" title=\"new_type_of_block\"><img src=\"выявление-пакетов-от-dpi-на-роутере/c8b9c95dd2fba5f500170c8f8604732f856415b3.png\" alt=\"new_type_of_block\" data-base62-sha1=\"sDHxtPykbuaD9EcQ4eyWM6Su7g7\" width=\"690\" height=\"108\" data-dominant-color=\"78747B\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">new_type_of_block</span><span class=\"informations\">1453×229 21.1 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Теперь после clienthello делается drop пакетов вместо FIN,ACK</p>\n<p>Добавил новое правило на роутер, теперь ищется пакет от клиента PSH,ACK после clienthello. Пока тестирую на ложные срабатывания</p>\n<p>Также придумал как обнаруживать блокировку по ip. Но скорее всего будет много ложных срабатываний. Тесты покажут.</p>\n<p>Все это наводит меня на мысли что нужно делать active probing на стороне клиента. Чтобы автоматически и достоверно определять факт блокировки</p>",
        "post_number": 10,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-10T10:46:01.719Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 5,
        "reads": 40,
        "readers_count": 39,
        "score": 38.0,
        "yours": false,
        "topic_id": 1990,
        "topic_slug": "%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 3,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 581,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5/1990/10",
        "can_translate": false
    },
    {
        "id": 12362,
        "name": null,
        "username": "Sector",
        "avatar_template": "/letter_avatar_proxy/v4/letter/s/ac91a4/{size}.png",
        "created_at": "2023-03-10T10:57:59.122Z",
        "cooked": "<p>В этом, собственно, и вопрос: как качественно сделать этот самый “Active Probing”? Желательно, средствами Микротика…</p>",
        "post_number": 11,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-10T10:57:59.122Z",
        "reply_count": 1,
        "reply_to_post_number": 10,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 37,
        "readers_count": 36,
        "score": 22.4,
        "yours": false,
        "topic_id": 1990,
        "topic_slug": "%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "Elevator",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/e/ee59a6/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 948,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5/1990/11",
        "can_translate": false
    },
    {
        "id": 12363,
        "name": "",
        "username": "Elevator",
        "avatar_template": "/letter_avatar_proxy/v4/letter/e/ee59a6/{size}.png",
        "created_at": "2023-03-10T11:09:08.202Z",
        "cooked": "<p>Средствами микротика никак. Насколько мне известно функционал routeros не позволяет отправлять свои пакеты.</p>",
        "post_number": 12,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-10T11:09:19.739Z",
        "reply_count": 0,
        "reply_to_post_number": 11,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 39,
        "readers_count": 38,
        "score": 17.8,
        "yours": false,
        "topic_id": 1990,
        "topic_slug": "%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "Sector",
            "name": null,
            "avatar_template": "/letter_avatar_proxy/v4/letter/s/ac91a4/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 581,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5/1990/12",
        "can_translate": false
    },
    {
        "id": 12367,
        "name": "",
        "username": "bolvan",
        "avatar_template": "/letter_avatar_proxy/v4/letter/b/8e8cbc/{size}.png",
        "created_at": "2023-03-10T16:47:21.199Z",
        "cooked": "<p>Лишь только дропанием каких-либо пакетов можно обойти только пассивный DPI, который не может блокировать пакеты по признаку соединения. Активный DPI после срабатывания блочит весь tcp сеанс.<br>\nСейчас провайдеров лишь только с пассивным DPI не так много осталось.</p>\n<p>На routeros есть scripting, возможно с ним что-то можно соорудить.<br>\nМожно запускать докер контейнеры с linux, но не могу сказать насколько они окажутся урезанными в возможностях</p>",
        "post_number": 13,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-10T16:50:14.344Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 39,
        "readers_count": 38,
        "score": 12.8,
        "yours": false,
        "topic_id": 1990,
        "topic_slug": "%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "Zapret anti-DPI software staff",
        "title_is_group": false,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": false,
        "staff": true,
        "user_id": 19,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5/1990/13",
        "can_translate": false
    },
    {
        "id": 12368,
        "name": "",
        "username": "Elevator",
        "avatar_template": "/letter_avatar_proxy/v4/letter/e/ee59a6/{size}.png",
        "created_at": "2023-03-10T17:12:47.203Z",
        "cooked": "<p>Речь не про дроп пакетов. Идея состоит в том чтобы роутер мог автоматически определять факт блокировки. Это позволит отказаться от многотысячных списков и ручного наполнения. Комфорт просто несоизмеримый. Заходишь на сайт - connection reset. Нажимаешь F5 и сайт открывается. А если приложение где тысячи доменов заблочены по маске? Пару раз посвайпал и все работает.</p>\n<p>Вот у меня и крутится в голове идея про active probing для клиента.</p>",
        "post_number": 14,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-10T17:12:47.203Z",
        "reply_count": 1,
        "reply_to_post_number": 13,
        "quote_count": 0,
        "incoming_link_count": 5,
        "reads": 42,
        "readers_count": 41,
        "score": 38.4,
        "yours": false,
        "topic_id": 1990,
        "topic_slug": "%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "bolvan",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/b/8e8cbc/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 581,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5/1990/14",
        "can_translate": false
    },
    {
        "id": 12389,
        "name": "",
        "username": "bolvan",
        "avatar_template": "/letter_avatar_proxy/v4/letter/b/8e8cbc/{size}.png",
        "created_at": "2023-03-11T06:55:35.822Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"Elevator\" data-post=\"14\" data-topic=\"1990\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/e/ee59a6/48.png\" class=\"avatar\"> Elevator:</div>\n<blockquote>\n<p>Вот у меня и крутится в голове идея про active probing для клиента.</p>\n</blockquote>\n</aside>\n<p>Выглядит не просто реализуемым.<br>\nОсобенно на таких ограниченных поделках как mikrotik.</p>\n<p>Нужно каким-то образом распознать факт обращения к IP, по факту вызвать некий обработчик<br>\nЛибо нужно распознать через пассивный анализ трафика факт сброса соединения и тоже вызвать некий обработчик.<br>\nЛибо повеситься на ресолв DNS и проверять каждый заресолвленный IP.<br>\nОбработчик может, например, добавить IP в ipset/nfset. Это не так сложно , сложнее первое.<br>\nСамо ядро просто так не может взять и запустить процесс по приходу определенных пакетов.<br>\nБудь такое возможно, и бурст таких пакетов запустил бы тысячи, если не миллионы процессов.<br>\nНапрашивается написание некого NFQUEUE обработчика, а чтобы сократить ему сложноту и снизить нагрузку, можно использовать описанный выше в теме подход с маркировкой соединения через connmark.<br>\nНо это все, разумеется, выходит за уютный счастливый мирок любителя микроты.<br>\nПреодоление сопротивления микротоделателей для доступа к linux явно не стоит того, проще снести это все и накатить openwrt. Или пробовать докер. Но что там с неймспейсами - это вопрос</p>\n<p>Еще потенциальная проблема может быть с отслеживанием аномальных ситуаций. Сброс может произойти по желанию самого сервера, если он, например, перегружен. Чтобы каждый такой чих не приводил к вечному занесению IP. А как сделать невечное ? В ipset это невозможно, там нет даты/времени добавления. Тереть каждый день ? Тогда придется каждый день заново нажимать F5.<br>\nМожно сделать отдельный set для успешных соединений. Если хоть раз прокатило - больше не проверять. Не проверять повторно и неуспешные.</p>",
        "post_number": 15,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-11T07:09:40.060Z",
        "reply_count": 0,
        "reply_to_post_number": 14,
        "quote_count": 1,
        "incoming_link_count": 30,
        "reads": 40,
        "readers_count": 39,
        "score": 158.0,
        "yours": false,
        "topic_id": 1990,
        "topic_slug": "%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "Zapret anti-DPI software staff",
        "title_is_group": false,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": false,
        "staff": true,
        "user_id": 19,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BE%D1%82-dpi-%D0%BD%D0%B0-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%B5/1990/15",
        "can_translate": false
    }
]
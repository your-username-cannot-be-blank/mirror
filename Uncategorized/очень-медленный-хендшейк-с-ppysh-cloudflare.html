
    <html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <style>
    th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      word-wrap: break-word;
      padding: 5px;
    }
    table {
      width: 100%;
      max-width: 100%;
      border: 1px solid black;
      border-collapse: collapse;
      table-layout: fixed;
      word-wrap: break-word
    }
    code {
      word-wrap: break-word;
    }
    pre {
        white-space: pre-wrap;
    }
    </style>
        <title>очень-медленный-хендшейк-с-ppysh-cloudflare</title>
      </head>
      <body>
        <table border="1" width="100%" cellpadding="5">
          <tr>
            <th style="width: 10%;">Ник</th>
            <th>Пост</th>
            <th style="width: 10%;">Дата</th>
          </tr>
    <tr><td>0ka(0ka)</td><td><p>Проблема плавающая, очень сложно поймать, пока что заметил только в браузере (курлом или wireshark пока не смог отловить, всегда быстро отвечает во время тестов)<br>
Проблема проявляется при использовании стокового айпи сайта от клаудфлейр (188.114.98/99.224), но если в hosts прописать другой айпи (“172.67.0.128 osu.ppy.sh”), то сайт начинает открываться быстро каждый раз. Аватарки пользователей (a.ppy.sh) я оставил на стоке и часто замечаю что сайт osu.ppy.sh уже прогрузился, а аватарки a.ppy.sh приходится ждать &gt;5 секунд (немного похоже на блокировку quic и fallback к tcp)</p></td><td>2023-11-22T23:55:00.714Z</td></tr><tr><td>0ka(0ka)</td><td><p>вот прямо сейчас поймал это: ава прогрузилась на 20%, браузер показывал анимацию открытия сайта еще около 5 сек, сделать дамп или открыть devtools не успел</p>
<pre><code class="lang-auto">https://a.ppy.sh/14282873?1666571579.jpeg
</code></pre>
<p><img src="очень-медленный-хендшейк-с-ppysh-cloudflare/2ee1d217b043948fff8620a2e48ee7f05b3c8a14.png" alt="image" data-base62-sha1="6GJMuMWgcI4ogNsCwg9KALNus1C" width="502" height="428"></p>
<p>upd: поймал похожее (ава на скрине мыльная, не до конца загрузилась) в devtools и wireshark<br>
<div class="lightbox-wrapper"><a class="lightbox" href="очень-медленный-хендшейк-с-ppysh-cloudflare/20c37612e045269fd3cb5ce7e198e9ae76a9a349.png" data-download-href="https://ntc.party/uploads/default/20c37612e045269fd3cb5ce7e198e9ae76a9a349" title="image"><img src="очень-медленный-хендшейк-с-ppysh-cloudflare/20c37612e045269fd3cb5ce7e198e9ae76a9a349_2_690x211.png" alt="image" data-base62-sha1="4FQ3gXpfO5luzsEa9ZycoU8SfOx" width="690" height="211" srcset="очень-медленный-хендшейк-с-ppysh-cloudflare/20c37612e045269fd3cb5ce7e198e9ae76a9a349_2_690x211.png, очень-медленный-хендшейк-с-ppysh-cloudflare/20c37612e045269fd3cb5ce7e198e9ae76a9a349_2_1035x316.png 1.5x, очень-медленный-хендшейк-с-ppysh-cloudflare/20c37612e045269fd3cb5ce7e198e9ae76a9a349.png 2x" data-dominant-color="3C463D"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">1205×370 67.4 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
<div class="lightbox-wrapper"><a class="lightbox" href="очень-медленный-хендшейк-с-ppysh-cloudflare/37f28ed903873b4de55879071e452fa14a63e0c9.png" data-download-href="https://ntc.party/uploads/default/37f28ed903873b4de55879071e452fa14a63e0c9" title="image"><img src="очень-медленный-хендшейк-с-ppysh-cloudflare/37f28ed903873b4de55879071e452fa14a63e0c9.png" alt="image" data-base62-sha1="7YVWdtJKjjkADo2z4siWXo5Cq25" width="689" height="336" data-dominant-color="D0E3F0"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">1223×597 14.1 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
после обновления страницы браузер переходит на http2 и ошибок уже нет, картинка прогружается нормально</p></td><td>2023-11-23T00:05:50.497Z</td></tr><tr><td>0ka(0ka)</td><td><p>решено: админ сайта выключил QUIC cloudflare</p></td><td>2023-12-27T12:10:20.669Z</td></tr>
    </table>
      </body>
    </html>

    <html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <style>
    th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      word-wrap: break-word;
      padding: 5px;
    }
    table {
      width: 100%;
      max-width: 100%;
      border: 1px solid black;
      border-collapse: collapse;
      table-layout: fixed;
      word-wrap: break-word
    }
    code {
      word-wrap: break-word;
    }
    pre {
        white-space: pre-wrap;
    }
    </style>
        <title>нестабильность-при-работе-xray-vless-reality-через-домен-и-tls-известная-проблема-есть-решение</title>
      </head>
      <body>
        <table border="1" width="100%" cellpadding="5">
          <tr>
            <th style="width: 10%;">Ник</th>
            <th>Пост</th>
            <th style="width: 10%;">Дата</th>
          </tr>
    <tr><td>bpGusar</td><td><p>Привет! Кто-нибудь сталкивался с нестабильностью работы VPN через xray vless reality при подключении домена и сертификата?<br>
Проблема такая:</p>
<p>Через IP-адрес сервера могут одновременно подключаться 5–10 человек, и у всех все работает отлично — Discord, игры, музыка, YouTube, все шикарно.<br>
Но как только подключаю домен, добавляю сертификат и начинаю пользоваться уже через домен, стабильность пропадает. В играх появляются потери пакетов и/или пинг взлетает до небес. Видео на YouTube останавливаются и возобновляются (то же самое с Shorts), Discord может лагать из-за высокого пинга. Такое поведение наблюдается как при использовании конфига vless, так и при подписке.</p>
<p>При этом, если на сервере подключен домен и сертификат, но использовать конфигурацию через IP-адрес, все работает отлично.</p>
<p>В чем может быть причина? Может ли это быть из-за бесплатного субдомена или чего-то еще?<br>
Домен взял на DuckDNS, сертификат создавал через терминал командой из XUI.</p></td><td>2025-01-13T10:46:35.565Z</td></tr><tr><td>0ka(0ka)</td><td><p>ваши конфигурации непонятны, используйте родные термины или хотя бы скрины настроек сделайте. и проверьте всё еще раз т.к. может просто сеть у хостера лагает</p></td><td>2025-01-13T10:54:39.942Z</td></tr><tr><td>bpGusar</td><td><p>что конкретно непонятно?</p></td><td>2025-01-13T10:55:44.004Z</td></tr><tr><td>0ka(0ka)</td><td><p>всё непонятно…</p></td><td>2025-01-13T10:56:30.079Z</td></tr><tr><td>bpGusar</td><td><p>вам непонятна тема проблемы? терминология в тексте? вы не сталкивались с такой проблемой и непонимаете о чем речь?<br>
я не понимаю того что вам непонятно. конкретнее пожалуйста )</p></td><td>2025-01-13T10:58:31.682Z</td></tr><tr><td>0ka(0ka)</td><td><p>мне и остальным всё будет понятно если вы дадите информацию в понимаемом виде, то что вы тут написали почти невозможно расшифровать, не флудите и прочитайте уже мой первый ответ и сделайте ХОТЯ БЫ скриншоты настроек и напишите какой конфиг работает плохо а какой хорошо. и без скриншотов пожалуйста больше не отвечайте мне, я не ванга и не поддерживаю других кто придёт и будет гадать на песке (т.к. в вашем посте нет ничего конкретного)</p></td><td>2025-01-13T11:00:08.443Z</td></tr><tr><td>bpGusar</td><td><p>есть сервер в загранице<br>
у сервера есть ip<br>
на сервер установлен 3x-ui<br>
в 3x-ui есть куча профилей впн с flow xtls-rprx-vision для человеков</p>
<p>когда человек дает другому человеку конфиг вида<br>
vless://f7176189-c261-495b-bcf4-cb05766d02a0@<strong>IP:PORT</strong>?type=tcp&amp;security=reality&amp;pbk=oI-LbfzW8z492m7A9qe-yYIXyUt_2M5IVCC8U1EpPhk&amp;fp=chrome&amp;<a href="http://sni=yahoo.com" rel="noopener nofollow ugc">sni=yahoo.com</a>&amp;sid=c52eda6bb69529&amp;spx=%2F&amp;flow=xtls-rprx-vision#test<br>
все прекрастно. дискорд говорит, игра играет, ютуб трубит, человек счастлив</p>
<p>но когда человек дает другому человеку конфиг вида<br>
vless://f7176189-c261-495b-bcf4-cb05766d02a0@<strong><a href="http://DOMAIN.COM" rel="noopener nofollow ugc">DOMAIN.COM</a>:PORT</strong>?type=tcp&amp;security=reality&amp;pbk=oI-LbfzW8z492m7A9qe-yYIXyUt_2M5IVCC8U1EpPhk&amp;fp=chrome&amp;<a href="http://sni=yahoo.com" rel="noopener nofollow ugc">sni=yahoo.com</a>&amp;sid=c52eda6bb69529&amp;spx=%2F&amp;flow=xtls-rprx-vision#test<br>
все ужастно. дискорд заикается, игра не играется, пинг высокий к сожалению, ютуб не трубит как раньше, человек очень несчастлив</p>
<p>когда человек не счастлив к ip сервера привязан домен который взяли из duckdns, а так же сертификат</p>
<p>скриншоты каких именно настроек вы хотите увидеть?</p></td><td>2025-01-13T11:13:21.666Z</td></tr><tr><td>0ka(0ka)</td><td><p>время резолва домена можете проверить сами через <code>nslookup domain.com</code>, на duckdns уже несколько раз замечал что домен резолвится не с 1 раза и с большой задержкой, это повлияет на скорость загрузки сайтов, но дискорду и играм на это пофиг, игры и дс могут лагать из-за лагучего инета или хостера, поэтому оставьте в клиенте оба конфига и проверьте еще раз и в одно и то же время, т.е. надо запустить 1 конфиг, зайти в игру/дс и проверить, затем через пару минут <strong>закрыть</strong> игру/дс, запустить 2 конфиг и проверить так же.<br>
т.к. у вас <a href="http://yahoo.com">yahoo.com</a> reality то единственное изменение в конфигах это адрес назначения, ваш tls сертификат нигде не используется</p></td><td>2025-01-13T11:20:08.148Z</td></tr><tr><td>anonymous195(anonymous195)</td><td><p>все это было проверено.<br>
хостер в порядке. пинг и скорость не меняется не важно ip это или домен, если что и меняется то это скорость и то не критично, в рамках разумного, на пользователя не влияет.<br>
интернет в порядке.<br>
дебажил проблему уже трижды, не то что в разные часы/дни, в разные месяцы. проблема с этими “отвалами” наблюдается только при подключении домена (все разы duckdns использовался).<br>
происходит это так. подклчюается к впн без проблем, ip скрыт, все ок, но как только начинаешь использовать, например, ютуб, видео начинается и потом через какие то секунды останаваливается, перематаешь на 10сек продолжает играть.<br>
в играх как будто теряется соединение с сервером. играешь норм, пинг условные 30, потерь нету, и рандомно и пинг 2к и потери пакетов в потолок.</p>
<p>наверное, стоит попробовать другой суб домен, либо подкинуть личный, но я хотел узнать мб это какая то распростаненная проблема прежде чем покупать свой домен</p></td><td>2025-01-13T11:29:54.461Z</td></tr><tr><td>0ka(0ka)</td><td><p>это bpgusar или уже другой? единственная проблема которую я вижу - duckdns часто лагает, но в играх это не должно вызывать проблем, ну может игра такая, хз, проверьте через <a href="https://www.noip.com/">no-ip</a></p></td><td>2025-01-13T11:35:37.990Z</td></tr><tr><td>Xunlei</td><td><p>Единственное отличие строк — это добавление задержки разрешения имени домена. Большинство ПО не умеет локально кэшировать разрешенные домены, и полагается на системный резолвер. Системный резолвер будет спамить запросами, если TTL A записи равен 0 или нескольким секундам. NS сервер будет блокировать IP резолвера по достижению Query Rate Limit. Получится что последующие резолвы дадут ошибку подключения до тех пор пока окно блокировки QPS не пройдёт.</p></td><td>2025-01-13T11:40:40.949Z</td></tr><tr><td>bpGusar</td><td><p>bpgusar. включил какой то анонимный мод.</p>
<p>ну вот хз. лаги в играх прям сильно дают о себе знать.<br>
попробую другой домен</p></td><td>2025-01-13T11:40:55.127Z</td></tr><tr><td>bpGusar</td><td><aside class="quote no-group" data-username="Xunlei" data-post="11" data-topic="14548">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/x/8e7dd6/48.png" class="avatar"> Xunlei:</div>
<blockquote>
<p>добавление задержки разрешения имени домена</p>
</blockquote>
</aside>
<p>имеется ввиду в отличии от кейса когда простой ip используется? про эту задержку речь?<br>
такое поведение как то можно исправить?</p></td><td>2025-01-13T11:43:34.141Z</td></tr><tr><td>Xunlei</td><td><p><a href="https://ntc.party/t/%D0%B8%D0%BC%D0%B5%D0%B5%D1%82-%D0%BB%D0%B8-%D1%81%D0%BC%D1%8B%D1%81%D0%BB-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D1%8C-dnscrypt/14469/6">Тут</a> писал про это. Надо либо клиентам ставить кэширующий stub резолвер, либо патченый клиент vless, где вы добавите локальный кэш доменых имён. Если IP статичный, можно потенциальной проблемой смены IP раз в N лет пренебречь и раздавать конфиги с IP.</p>
<aside class="quote no-group" data-username="bpGusar" data-post="12" data-topic="14548">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/bpgusar/48/6169_2.png" class="avatar"> bpGusar:</div>
<blockquote>
<p>лаги в играх прям сильно дают о себе знать</p>
</blockquote>
</aside>
<p>Это что за игры такие, где vless может работать. Для игр лучше использовать IP тунель.</p></td><td>2025-01-13T11:44:03.181Z</td></tr><tr><td>0ka(0ka)</td><td><aside class="quote no-group" data-username="Xunlei" data-post="14" data-topic="14548">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/x/8e7dd6/48.png" class="avatar"> Xunlei:</div>
<blockquote>
<p>Это что за игры такие, где vless может работать</p>
</blockquote>
</aside>
<p>да любые наверное, там же даже есть fullcone nat</p></td><td>2025-01-13T11:51:54.735Z</td></tr><tr><td>0ka(0ka)</td><td><aside class="quote no-group" data-username="Xunlei" data-post="14" data-topic="14548">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/x/8e7dd6/48.png" class="avatar"> Xunlei:</div>
<blockquote>
<p>Надо либо клиентам ставить кэширующий stub резолвер, либо патченый клиент vless, где вы добавите локальный кэш доменых имён</p>
</blockquote>
</aside>
<p>либо вместо всего этого просто купить домен и привязать к cloudflare где rate limit нету, ну или достигнуть его очень трудно</p></td><td>2025-01-13T11:54:06.701Z</td></tr><tr><td>bpGusar</td><td><aside class="quote no-group" data-username="Xunlei" data-post="14" data-topic="14548">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/x/8e7dd6/48.png" class="avatar"> Xunlei:</div>
<blockquote>
<p>Это что за игры такие, где vless может работать</p>
</blockquote>
</aside>
<p>dota 2, cod wz/bo6, poe2 например пробовали. не совсем понимаю как всё это работает но пинг заметно меняется из под впн, что говорит о том, что игра через впн работает</p>
<aside class="quote no-group" data-username="Xunlei" data-post="14" data-topic="14548">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/x/8e7dd6/48.png" class="avatar"> Xunlei:</div>
<blockquote>
<p>Для игр лучше использовать IP тунель.</p>
</blockquote>
</aside>
<p>типа на клиенте (прим. комп) настроить так, что бы  трафик игры шел напрямую, не через впн?<br>
если про это речь то это практически невозможно, ввиду того, что я то себе могу настроить, а вот заводчанин “скажет что ты мне тут городишь”</p></td><td>2025-01-13T11:54:38.012Z</td></tr><tr><td>Xunlei</td><td><p>А как же congestion control? По TCP будут периодические телепортации.</p></td><td>2025-01-13T11:54:40.281Z</td></tr><tr><td>Xunlei</td><td><aside class="quote no-group" data-username="bpGusar" data-post="17" data-topic="14548">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/bpgusar/48/6169_2.png" class="avatar"> bpGusar:</div>
<blockquote>
<p>типа на клиенте (прим. комп) настроить так, что бы трафик игры шел напрямую, не через впн?</p>
</blockquote>
</aside>
<p>Это называется split tunneling, не знаю как это делается в клиентах vless.<br>
Я имел ввиду, что к IP пакету клиента просто добавляются заголовки, шифруется и передается как есть на сервер IP тунеля.</p></td><td>2025-01-13T11:57:44.947Z</td></tr><tr><td>0ka(0ka)</td><td><aside class="quote no-group" data-username="Xunlei" data-post="18" data-topic="14548">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/x/8e7dd6/48.png" class="avatar"> Xunlei:</div>
<blockquote>
<p>По TCP будут периодические телепортации</p>
</blockquote>
</aside>
<p>на стабильном инете почти не беспокоят</p></td><td>2025-01-13T11:57:47.122Z</td></tr><tr><td>0ka(0ka)</td><td><p>del</p></td><td>2025-01-13T11:59:26.705Z</td></tr><tr><td>bpGusar</td><td><aside class="quote no-group" data-username="0ka" data-post="16" data-topic="14548">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/0/d78d45/48.png" class="avatar"> 0ka:</div>
<blockquote>
<p>купить домен и привязать к cloudflare</p>
</blockquote>
</aside>
<p>есть шанс что задержки вырастут при таком конфиге?</p></td><td>2025-01-13T12:05:26.620Z</td></tr><tr><td>0ka(0ka)</td><td><p>какие задержки? задержка резолва только уменьшится т.к. сервера cloudflare по всему миру. в играх пинг не изменится</p></td><td>2025-01-13T12:06:12.043Z</td></tr><tr><td>Xunlei</td><td><p>Если TTL записи будет большим, то системный резолвер будет долго хранить разрешенный IP в кэше.</p></td><td>2025-01-13T12:07:16.974Z</td></tr><tr><td>bpGusar</td><td><p>да, имел ввиду любые задержки.<br>
понял. попробую покурить эту тему</p></td><td>2025-01-13T12:08:28.087Z</td></tr><tr><td>DBT081</td><td><p>Слышал что duckdns довольно медленный. Попробуйте использовать другой провайдер домена</p></td><td>2025-01-13T22:51:05.150Z</td></tr><tr><td>bpGusar</td><td><p>сделал вчера через no-ip<br>
пользуюсь сам и дал человекам на тест<br>
пока молчат. с duckdns вонь начиналась с нулевой</p></td><td>2025-01-14T09:48:05.864Z</td></tr>
    </table>
      </body>
    </html>
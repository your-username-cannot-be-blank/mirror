[
    {
        "id": 78992,
        "name": "Ivanixa333",
        "username": "ivanixa333",
        "avatar_template": "/user_avatar/ntc.party/ivanixa333/{size}/2766_2.png",
        "created_at": "2025-01-13T10:02:29.736Z",
        "cooked": "<p>доброе утро у меня такая проблема я добавил сайты с айпишниками в файл host через командную строку роутера но когда я включаю opkg dns-override он перестает работать сайты добавленные host перестают открываться можно ли в entware как то добавит host файл или заставит работать системный host роутера</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 7,
        "updated_at": "2025-01-13T10:02:29.736Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 54,
        "reads": 78,
        "readers_count": 77,
        "score": 265.6,
        "yours": false,
        "topic_id": 14547,
        "topic_slug": "entware-hosts-keenetic",
        "display_username": "Ivanixa333",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 2248,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/entware-hosts-keenetic/14547/1",
        "can_translate": false
    },
    {
        "id": 78993,
        "name": "",
        "username": "bolvan",
        "avatar_template": "/letter_avatar_proxy/v4/letter/b/8e8cbc/{size}.png",
        "created_at": "2025-01-13T10:05:50.387Z",
        "cooked": "<p>entware  специально патчится и собирается для /opt<br>\nпроги из entware будут смотреть в /opt/etc/hosts, а не /etc/hosts<br>\nпроги, не собранные для entware, будут смотреть /etc/hosts</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 7,
        "updated_at": "2025-01-13T10:06:36.353Z",
        "reply_count": 2,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 78,
        "readers_count": 77,
        "score": 25.6,
        "yours": false,
        "topic_id": 14547,
        "topic_slug": "entware-hosts-keenetic",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "Zapret anti-DPI software staff",
        "title_is_group": false,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": false,
        "staff": true,
        "user_id": 19,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/entware-hosts-keenetic/14547/2",
        "can_translate": false
    },
    {
        "id": 79005,
        "name": "Ivanixa333",
        "username": "ivanixa333",
        "avatar_template": "/user_avatar/ntc.party/ivanixa333/{size}/2766_2.png",
        "created_at": "2025-01-13T11:34:56.955Z",
        "cooked": "<p>Благодарю Спасибо. Что подсказали. Всё работает</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 7,
        "updated_at": "2025-01-13T11:34:56.955Z",
        "reply_count": 0,
        "reply_to_post_number": 2,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 72,
        "readers_count": 71,
        "score": 14.4,
        "yours": false,
        "topic_id": 14547,
        "topic_slug": "entware-hosts-keenetic",
        "display_username": "Ivanixa333",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "bolvan",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/b/8e8cbc/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 2248,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/entware-hosts-keenetic/14547/3",
        "can_translate": false
    },
    {
        "id": 79040,
        "name": "Alexander Gavrilov",
        "username": "dartraiden",
        "avatar_template": "/user_avatar/ntc.party/dartraiden/{size}/15299_2.png",
        "created_at": "2025-01-13T15:35:14.881Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"bolvan\" data-post=\"2\" data-topic=\"14547\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/b/8e8cbc/48.png\" class=\"avatar\"> bolvan:</div>\n<blockquote>\n<p>проги, не собранные для entware, будут смотреть /etc/hosts</p>\n</blockquote>\n</aside>\n<p>Если точнее, это делает системный DNS-резолвер,  а проги уже обращаются к нему.<br>\nА вот в какой файл будет смотреть системный резолвер, зависит от того, кто этот резолвер.</p>\n<p>Топикстартер отключил системный резолвер командой <code>opkg dns-override</code>. После этого системный dns-proxy освобождает 53 порт, чтобы туда мог встать AdguardHome или dnsmasq (или ещё какой резолвер) из Entware. А эти DNS-резолверы из Entware, в свою очередь, смотрят в энтварский <code>/opt/etc/hosts</code>.</p>\n<p>Таким образом, если бы топикстартер не отключал системный резолвер, то даже проги из Entware учитывали бы записи в <code>/etc/hosts</code>. Это легко проверить: достаточно создать запись в <code>/etc/hosts</code> командой <code>ip host my.comp 192.168.1.33</code>, а затем установить в Entware wget и дёрнуть этот домен</p>\n<pre><code class=\"lang-auto\">~ # wget my.comp\n--2025-01-13 18:45:20--  http://my.comp/\nResolving my.comp... 192.168.1.33\n</code></pre>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 7,
        "updated_at": "2025-01-13T16:14:58.314Z",
        "reply_count": 1,
        "reply_to_post_number": 2,
        "quote_count": 1,
        "incoming_link_count": 1,
        "reads": 64,
        "readers_count": 63,
        "score": 17.8,
        "yours": false,
        "topic_id": 14547,
        "topic_slug": "entware-hosts-keenetic",
        "display_username": "Alexander Gavrilov",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 5,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": false,
        "staff": true,
        "user_id": 1450,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/entware-hosts-keenetic/14547/4",
        "can_translate": false
    },
    {
        "id": 79051,
        "name": "",
        "username": "bolvan",
        "avatar_template": "/letter_avatar_proxy/v4/letter/b/8e8cbc/{size}.png",
        "created_at": "2025-01-13T15:59:22.683Z",
        "cooked": "<p>Клиентская часть системного ресолвера находится в libc.<br>\nУ entware glibc патчен на /opt. Все, что линковано на патченый glibc, будет искать в /opt/etc/hosts при вызове getaddrinfo<br>\nНо если в /opt/etc/resolv.conf  локалхост стоит, и там dnsmasq родной от прошивки, то он посмотрит /etc/hosts  и вернет результат оттуда</p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 7,
        "updated_at": "2025-01-13T16:01:25.032Z",
        "reply_count": 0,
        "reply_to_post_number": 4,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 44,
        "readers_count": 43,
        "score": 8.8,
        "yours": false,
        "topic_id": 14547,
        "topic_slug": "entware-hosts-keenetic",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "Zapret anti-DPI software staff",
        "title_is_group": false,
        "reply_to_user": {
            "username": "dartraiden",
            "name": "Alexander Gavrilov",
            "avatar_template": "/user_avatar/ntc.party/dartraiden/{size}/15299_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": false,
        "staff": true,
        "user_id": 19,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/entware-hosts-keenetic/14547/5",
        "can_translate": false
    },
    {
        "id": 79060,
        "name": "Alexander Gavrilov",
        "username": "dartraiden",
        "avatar_template": "/user_avatar/ntc.party/dartraiden/{size}/15299_2.png",
        "created_at": "2025-01-13T16:12:55.782Z",
        "cooked": "<p>/opt/bin/wget слинкован с /opt/lib/libc.so.6</p>\n<pre><code class=\"lang-auto\"># ldd /opt/bin/wget\n        linux-vdso.so.1 (0x77404000)\n        libpcre2-8.so.0 =&gt; /opt/lib/libpcre2-8.so.0 (0x77329000)\n        libssl.so.3 =&gt; /opt/lib/libssl.so.3 (0x77286000)\n        libcrypto.so.3 =&gt; /opt/lib/libcrypto.so.3 (0x76f19000)\n        libdl.so.2 =&gt; /opt/lib/libdl.so.2 (0x76f05000)\n        libz.so.1 =&gt; /opt/lib/libz.so.1 (0x76ee0000)\n        libgcc_s.so.1 =&gt; /opt/lib/libgcc_s.so.1 (0x76ebc000)\n        libc.so.6 =&gt; /opt/lib/libc.so.6 (0x76d29000)\n        libpthread.so.0 =&gt; /opt/lib/libpthread.so.0 (0x76cfb000)\n        libatomic.so.1 =&gt; /opt/lib/libatomic.so.1 (0x76ce6000)\n        /opt/lib/ld.so.1 (0x773d2000)\n</code></pre>\n<p>Запись в /opt/etc/hosts есть</p>\n<pre><code class=\"lang-auto\"># cat /opt/etc/hosts\n192.168.1.66 my.site\n</code></pre>\n<p>Но домен не резолвится</p>\n<pre><code class=\"lang-auto\"># /opt/bin/wget my.site\n--2025-01-13 19:03:30--  http://my.site/\nwget: unable to resolve host address ‘my.site’\n</code></pre>\n<p>/opt/etc/resolv.conf вообще отсутствует</p>\n<p>То есть, всё равно используется родной прошивочный резолвер, а самостоятельно wget в /opt/etc/hosts не заглядывет.</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 7,
        "updated_at": "2025-01-13T16:17:41.033Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 46,
        "readers_count": 45,
        "score": 14.2,
        "yours": false,
        "topic_id": 14547,
        "topic_slug": "entware-hosts-keenetic",
        "display_username": "Alexander Gavrilov",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": false,
        "staff": true,
        "user_id": 1450,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/entware-hosts-keenetic/14547/6",
        "can_translate": false
    },
    {
        "id": 79067,
        "name": "",
        "username": "bolvan",
        "avatar_template": "/letter_avatar_proxy/v4/letter/b/8e8cbc/{size}.png",
        "created_at": "2025-01-13T16:27:48.846Z",
        "cooked": "<p>Посмотрел исходники.<br>\nДействительно, ошибаюсь. В libc там запатчены passwd,group и некоторые другие.<br>\nresolv.conf и hosts запатчены только в dnsmasq, но не в libc.<br>\nтаким образом проги будут использовать стандартные /etc/resolv.conf и /etc/hosts<br>\nНо если используется dnsmasq от entware, то он будет смотреть еще в /opt и возвращать ответы оттуда.</p>\n<pre><code class=\"lang-auto\">-#define HOSTSFILE \"/etc/hosts\"\n-#define ETHERSFILE \"/etc/ethers\"\n+#define HOSTSFILE \"/opt/etc/hosts\"\n+#define ETHERSFILE \"/opt/etc/ethers\"\n-#      define RESOLVFILE \"/etc/resolv.conf\"\n+#      define RESOLVFILE \"/opt/etc/resolv.conf\"\n</code></pre>\n<p>Вся эта котовасья идет из расчета , что root может быть readonly, а /etc/resolv.conf может быть линком на динамически генерируемый файл в /tmp.<br>\nТо, что наверняка нужно модифицировать, уносится из /etc в /opt</p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 7,
        "updated_at": "2025-01-13T16:31:11.355Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 44,
        "readers_count": 43,
        "score": 8.8,
        "yours": false,
        "topic_id": 14547,
        "topic_slug": "entware-hosts-keenetic",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "Zapret anti-DPI software staff",
        "title_is_group": false,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": false,
        "staff": true,
        "user_id": 19,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/entware-hosts-keenetic/14547/7",
        "can_translate": false
    }
]
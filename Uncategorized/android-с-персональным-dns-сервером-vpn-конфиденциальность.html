
    <html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <style>
    th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      word-wrap: break-word;
      padding: 5px;
    }
    table {
      width: 100%;
      max-width: 100%;
      border: 1px solid black;
      border-collapse: collapse;
      table-layout: fixed;
      word-wrap: break-word
    }
    code {
      word-wrap: break-word;
    }
    pre {
        white-space: pre-wrap;
    }
    </style>
        <title>android-с-персональным-dns-сервером-vpn-конфиденциальность</title>
      </head>
      <body>
        <table border="1" width="100%" cellpadding="5">
          <tr>
            <th style="width: 10%;">Ник</th>
            <th>Пост</th>
            <th style="width: 10%;">Дата</th>
          </tr>
    <tr><td>Krusty-the-Clown(Krusty The Clown)</td><td><p>Подскажите, если на Android включен персональный DNS и VPN (WireGuard с настроенным приложением (браузер EDGE)). Персональный DNS поддерживает DOT. Будет ли провайдер видеть историю моего просмотра? Сможет ли просмотреть мои DNS запросы (они ведь идут отдельно)?</p></td><td>2024-09-26T04:30:07.172Z</td></tr><tr><td>zzr</td><td><p>да будет видеть потому что <a href="https://ru.wikipedia.org/wiki/Server_Name_Indication" rel="noopener nofollow ugc">https://ru.wikipedia.org/wiki/Server_Name_Indication</a>  в чём проблема днсы тудаже в тунель засовывать</p>
<p>туда же <a href="https://www.linux.org.ru/forum/talks/16558739" rel="noopener nofollow ugc">https://www.linux.org.ru/forum/talks/16558739</a></p></td><td>2024-09-26T05:51:31.557Z</td></tr><tr><td>Krusty-the-Clown(Krusty The Clown)</td><td><aside class="quote no-group" data-username="zzr" data-post="2" data-topic="10751">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/zzr/48/14949_2.png" class="avatar"> zzr:</div>
<blockquote>
<p>да будет видеть потому что <a href="https://ru.wikipedia.org/wiki/Server_Name_Indication" rel="noopener nofollow ugc">https://ru.wikipedia.org/wiki/Server_Name_Indication </a></p>
</blockquote>
</aside>
<p>Я предполагал, что если само соединение проходит через VPN то провайдер ничего не должен видеть</p>
<aside class="quote no-group" data-username="zzr" data-post="2" data-topic="10751">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/zzr/48/14949_2.png" class="avatar"> zzr:</div>
<blockquote>
<p>в чём проблема днсы тудаже в тунель засовывать</p>
</blockquote>
</aside>
<p>у меня VPN настроен на выборочную маршрутизацию приложений. Что бы все отправить в туннель нужно использовать VPN для всего, чего не очень-то хотелось</p></td><td>2024-09-26T06:04:39.970Z</td></tr><tr><td>zzr</td><td><p>ясно ну тут как говорится <a href="https://www.youtube.com/watch?v=z5BO5tgbL8s" rel="noopener nofollow ugc">https://www.youtube.com/watch?v=z5BO5tgbL8s</a> <img src="https://ntc.party/images/emoji/twitter/sweat_smile.png?v=12" title=":sweat_smile:" class="emoji" alt=":sweat_smile:" loading="lazy" width="20" height="20"></p></td><td>2024-09-26T06:30:37.950Z</td></tr><tr><td>Krusty-the-Clown(Krusty The Clown)</td><td><aside class="quote no-group" data-username="zzr" data-post="4" data-topic="10751">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/zzr/48/14949_2.png" class="avatar"> zzr:</div>
<blockquote>
<p>ясно ну тут как говорится</p>
</blockquote>
</aside>
<p>Так всё же провайдер сможет смотреть историю моих просмотров?</p></td><td>2024-09-26T06:51:12.031Z</td></tr><tr><td>zzr</td><td><p>я ХЗ, пердаклгаю вам провести эксперемемнт - находясь в одной сети (вой-фай например) на смаратафоне всё включаете как вам надо (впн не впн дох-недох) ставить адрес шлюза например свой комп на ём открываеште ваершакр и смотрите что там идёт в открытую а что нет, в идеяле ваершакр должон видеть тока что идут пакеты завёрнутые в протокол который у вас роль впна выполняет</p></td><td>2024-09-26T06:59:53.405Z</td></tr><tr><td>Krusty-the-Clown(Krusty The Clown)</td><td><p>Спасибо, что отвечаете. Я понимаю, что это можно как-то посмотреть. Но моих знаний не хватает для этого. Если я и получу некий результат этого теста, то не факт, что смогу его правильно интерпретировать. Возможно, кто-то ещё сможет мне помочь с ответом. Суть в понимании процесса: запрос DNS через TLS с последующим просмотром интернет страницы через установленное соединение VPN.</p></td><td>2024-09-26T07:14:27.683Z</td></tr><tr><td>souvao</td><td><p>В таком случае провайдер не будет видеть, куда вы ходите.<br>
Если днс идёт в обход впна, то будет видно запросы к днс серверу на 853 порт, провайдер будет знать о самом факте днс запросов, но не будет видеть их содержимое из за tls.<br>
Трафик внутри туннеля wireguard провайдер увидеть не может.</p></td><td>2024-09-26T07:38:39.157Z</td></tr><tr><td>Krusty-the-Clown(Krusty The Clown)</td><td><aside class="quote no-group" data-username="souvao" data-post="8" data-topic="10751">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/s/4491bb/48.png" class="avatar"> souvao:</div>
<blockquote>
<p>будет видно запросы к днс серверу на 853 порт, провайдер будет знать о самом факте днс запросов, но не будет видеть их содержимое из за tls</p>
</blockquote>
</aside>
<p>Спасибо.</p></td><td>2024-09-26T07:48:14.781Z</td></tr><tr><td>zzr</td><td><p>окей а как тогда dpi детектят куда вы идёте даже при использовании шифрованых днсов? если до 17-18 года примерно, кокда были пассивные dpi было достаточно прост днсы не от провайдера использовать то теперь если вы прост поставите в насройках браузера или общесистемный шифрованый днс и попробуйте открыть какой нето <em>запрещёный</em> сайт то ничего не получится ето вы как обиясните? а про ТЛС я уже скидывал ссылку там написано что Server Name Indication передаётся открытым текстом, только если вы не используете ECH но чтобы его использовать нужна понтдержка с обоих сторон какна клиенте так и на сервере к которому оборощаетесь</p></td><td>2024-09-26T09:00:18.957Z</td></tr><tr><td>zzr</td><td><p>есть эксперимент гораздо проще - на компе отрубаете все впны захоите в браузер включаете DOH или щто там открываете ваершакр в браузере пытаетеь перейти на любой сайт в ваершаке в поиске вбиваете какой там фильтр <code>ssl.handshake.extensions_server_name</code> и удивляетесь как ето несмотря на шифрованые днс ТЛС и прочие абривиатуры оно видит куда вы пошли<br>
<div class="lightbox-wrapper"><a class="lightbox" href="android-с-персональным-dns-сервером-vpn-конфиденциальность/f7252650790ccf0309d0c4ef1a95f19631d449a3.jpeg" data-download-href="https://ntc.party/uploads/default/f7252650790ccf0309d0c4ef1a95f19631d449a3" title="Screenshot 2024-09-26 121734"><img src="android-с-персональным-dns-сервером-vpn-конфиденциальность/f7252650790ccf0309d0c4ef1a95f19631d449a3_2_690x208.jpeg" alt="Screenshot 2024-09-26 121734" data-base62-sha1="zglwJBh9cbKWofejHE2bkCes1Vh" width="690" height="208" srcset="android-с-персональным-dns-сервером-vpn-конфиденциальность/f7252650790ccf0309d0c4ef1a95f19631d449a3_2_690x208.jpeg, android-с-персональным-dns-сервером-vpn-конфиденциальность/f7252650790ccf0309d0c4ef1a95f19631d449a3_2_1035x312.jpeg 1.5x, android-с-персональным-dns-сервером-vpn-конфиденциальность/f7252650790ccf0309d0c4ef1a95f19631d449a3_2_1380x416.jpeg 2x" data-dominant-color="E0DEEA"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Screenshot 2024-09-26 121734</span><span class="informations">1697×512 195 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p></td><td>2024-09-26T09:20:52.909Z</td></tr><tr><td>Krusty-the-Clown(Krusty The Clown)</td><td><aside class="quote no-group" data-username="zzr" data-post="10" data-topic="10751">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/zzr/48/14949_2.png" class="avatar"> zzr:</div>
<blockquote>
<p>окей а как тогда dpi детектят куда вы идёте даже при использовании шифрованых днсов?</p>
</blockquote>
</aside>
<p>Из того, что я понял, браузер получив ответ от DNS пытается установить соединение. Для этого отправляет информацию, часть которой идёт без шифрования. Именно в этот момент провайдер может анализировать куда пошёл запрос. Это моё мнение, как дилетанта</p></td><td>2024-09-26T09:53:14.448Z</td></tr><tr><td>souvao</td><td><p>Речь шла о DoT. Обычный трафик идёт через wireguard. Провайдер видит DoT запросы, шифрованные tls.<br>
Вместо обычного трафика видит трафик wireguard. Client hello тут не при чём.</p></td><td>2024-09-26T10:18:53.334Z</td></tr><tr><td>zzr</td><td><p><a href="https://cf-assets.www.cloudflare.com/slt3lc6tev37/2Dya9l0Am8pUE5Ii0u58az/e3b45ffbbcd8282322239715cf3c4379/image4-11.png" rel="noopener nofollow ugc">if you say so</a><br>
<a href="https://blog.cloudflare.com/encrypted-client-hello/" rel="noopener nofollow ugc">https://blog.cloudflare.com/encrypted-client-hello/</a></p></td><td>2024-09-26T10:44:55.883Z</td></tr><tr><td>souvao</td><td><p>Я в курсе про ECH. Дальше что?</p></td><td>2024-09-26T11:10:24.513Z</td></tr><tr><td>Doqsa</td><td><p>если у тебя включен персональный DNS с поддержкой DoT и одновременно работающий впн, то провайдер не сможет увидеть твою историю просмотров или DNS-запросы. впн шифрует весь трафик, включая DNS-запросы</p></td><td>2024-09-26T11:39:57.378Z</td></tr><tr><td>zzr</td><td><p><a href="https://security.stackexchange.com/questions/200201/how-does-dns-over-tls-prevent-your-isp-from-seeing-the-websites-you-visit" rel="noopener nofollow ugc">https://security.stackexchange.com/questions/200201/how-does-dns-over-tls-prevent-your-isp-from-seeing-the-websites-you-visit</a></p></td><td>2024-09-26T13:17:25.093Z</td></tr><tr><td>Krusty-the-Clown(Krusty The Clown)</td><td><blockquote>
<p>As DNS over TLS is encrypted, your ISP can’t see the domains you query for but they don’t have to. TLS uses <strong>Server Name Indication</strong> , a <strong>TLS extension</strong> which appears on the outside of <strong>HTTP host header</strong> . SNI field contains the domain name of the server you want to talk to. Once you visit that site, your ISP can see that unless you use a VPN.</p>
</blockquote>
<p>Это по вашей ссылке. Получается, что <a class="mention" href="/u/souvao">@souvao</a> был прав?</p></td><td>2024-09-26T17:17:01.238Z</td></tr><tr><td>Krusty-the-Clown(Krusty The Clown)</td><td><aside class="quote no-group" data-username="Doqsa" data-post="16" data-topic="10751" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/d/6a8cbe/48.png" class="avatar"> Doqsa:</div>
<blockquote>
<p>если у тебя включен персональный DNS с поддержкой DoT и одновременно работающий впн, то провайдер не сможет увидеть твою историю просмотров или DNS-запросы. впн шифрует весь трафик, включая DNS-запросы</p>
</blockquote>
</aside>
<p>не совсем так. В Android установка персонального DNS имеет приоритет перед VPN</p></td><td>2024-09-26T17:19:32.612Z</td></tr><tr><td>haste</td><td><p>Вам может казаться, что бы включили VPN и зашифровали DNS. А как оно там происходит на самом деле - неизвестно, гарантий нет. Прошивка телефона и несколько приложений с кучей настроек и прочих вариабельных факторов дают обширные возможности  пользователю - накосячить, а разработчику - не предусмотреть особенностей конкретной комбинации.</p>
<p>Имхо вариантов два:</p>
<ul>
<li>разбираться в деталях, в т.ч. проверяться этим самым Wireshark’ом, и пр.; или кого-то замотивировать, доверенного и квалифицированного, дать ему ваш девайс…</li>
<li>поставить Tor Browser, который не даст вам произвести утечку, но не на все сайты вас с ним пустят, да и подключится пожет не удасться.</li>
</ul></td><td>2024-09-26T21:00:28.628Z</td></tr>
    </table>
      </body>
    </html>

    <html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <style>
    th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      word-wrap: break-word;
      padding: 5px;
    }
    table {
      width: 100%;
      max-width: 100%;
      border: 1px solid black;
      border-collapse: collapse;
      table-layout: fixed;
      word-wrap: break-word
    }
    code {
      word-wrap: break-word;
    }
    pre {
        white-space: pre-wrap;
    }
    </style>
        <title>внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle</title>
      </head>
      <body>
        <table border="1" width="100%" cellpadding="5">
          <tr>
            <th style="width: 10%;">Ник</th>
            <th>Пост</th>
            <th style="width: 10%;">Дата</th>
          </tr>
    <tr><td>ValdikSS</td><td><p>27.02.2022 наблюдается блокировка IP-адреса <code>199.36.158.100</code> сервиса Google Firebase, который используется на доменах forms.gle, posts.gle и <a href="http://firebaseapp.com">firebaseapp.com</a> от Google.<br>
Блокировка осуществляется системой ТСПУ DPI, на провайдерах, где эта система установлена. TCP-соединение закрывается пакетом TCP RSTACK в ответ на SYN, ICMP-ответ (ping) не получается.</p>
<p>Сервис ping-admin <a href="https://ping-admin.ru/free_test/result/164595672348v2d6faj8ggtmx239l8l.html">показывает</a> доступность сервиса в целом. ОБИТ, Ростелеком, МТС и Tele2 (все с ТСПУ) не устанавливают соединение до этого IP-адреса, причём с соседними адресами <code>199.36.158.99</code>, <code>199.36.158.101</code> и <code>199.36.158.102</code> проблем не наблюдается.</p>
<p>В Реестре данный адрес не значится. Потенциальные заблокированные домены, ссылающиеся на этот адрес, также не найдены.</p>
<blockquote>
<p># traceroute 199.36.158.100 --tcp<br>
traceroute to 199.36.158.100 (199.36.158.100), 30 hops max, 60 byte packets<br>
1  _gateway (192.168.69.1)  0.431 ms  0.388 ms  0.583 ms<br>
2  185-171-192-41<span>.obit.</span>ru (185.171.192.41)  1.378 ms  1.774 ms  2.161 ms<br>
3  172.29.192.206 (172.29.192.206)  1.748 ms  1.949 ms  2.132 ms<br>
4  172.29.192.121 (172.29.192.121)  2.720 ms  2.965 ms  3.103 ms<br>
5  172.29.194.77 (172.29.194.77)  2.692 ms  2.945 ms  2.938 ms<br>
6  172.29.194.102 (172.29.194.102)  2.930 ms  1.633 ms  1.762 ms<br>
7  172.29.255.217 (172.29.255.217)  1.079 ms  1.867 ms  1.282 ms<br>
8  172.29.194.121 (172.29.194.121)  1.694 ms  1.888 ms  1.880 ms<br>
9  172.29.194.37 (172.29.194.37)  1.872 ms  1.864 ms  2.061 ms<br>
<strong>10  censor-02<span>.obit.</span>ru (85.114.3.53)  2.053 ms  2.046 ms  2.039 ms</strong><br>
<strong>11  vi-xx-1874<span>.brc1.spb.obit.</span>ru (85.114.3.56)  2.440 ms  2.637 ms  2.835 ms</strong><br>
12  ae1-144.rt.<span>ov.spb.ru.retn.</span>net (87.245.250.65)  2.828 ms  1.884 ms  1.867 ms<br>
13  * * *<br>
14  * * *<br>
15  * * *<br>
16  ae0-3.rt.<span>irx.fkt.de.retn.</span>net (87.245.232.181)  33.290 ms *  33.267 ms<br>
17  gw-fastly<span>.retn.</span>net (87.245.236.129)  32.644 ms  32.447 ms  32.603 ms<br>
18  199.36.158.100 (199.36.158.100)  33.621 ms  30.754 ms  38.735 ms</p>
</blockquote>
<p>Traceroute соседнего адреса:</p>
<blockquote>
<p># traceroute 199.36.158.102 --tcp<br>
traceroute to 199.36.158.102 (199.36.158.102), 30 hops max, 60 byte packets<br>
1  _gateway (192.168.69.1)  0.466 ms  0.450 ms  0.625 ms<br>
2  185-171-192-41<span>.obit.</span>ru (185.171.192.41)  1.438 ms  1.838 ms  2.241 ms<br>
3  172.29.194.72 (172.29.194.72)  1.823 ms  2.020 ms  2.221 ms<br>
4  172.29.192.121 (172.29.192.121)  2.467 ms  2.563 ms  2.760 ms<br>
5  172.29.194.77 (172.29.194.77)  2.447 ms  2.441 ms  2.435 ms<br>
6  172.29.194.102 (172.29.194.102)  2.428 ms  1.063 ms  0.954 ms<br>
7  172.29.255.217 (172.29.255.217)  1.353 ms  2.251 ms  1.136 ms<br>
8  172.29.194.121 (172.29.194.121)  1.515 ms  1.508 ms  1.500 ms<br>
9  172.29.194.37 (172.29.194.37)  2.931 ms  2.923 ms  3.115 ms<br>
10  ae1-144.rt<span>.ov.spb.ru.retn.</span>net (87.245.250.65)  2.501 ms  2.494 ms  2.488 ms<br>
11  * * *<br>
12  gw-fastly<span>.retn.</span>net (87.245.236.129)  31.493 ms  31.068 ms  31.060 ms<br>
13  199.36.158.102 (199.36.158.102)  38.291 ms  38.266 ms  38.859 ms</p>
</blockquote></td><td>2022-02-27T11:01:31.875Z</td></tr><tr><td>bfov0jzd</td><td><p>mars-stub.web.app</p></td><td>2022-03-01T15:07:22.372Z</td></tr><tr><td>ValdikSS</td><td><pre><code class="lang-auto">$ host mars-stub.web.app
mars-stub.web.app has address 199.36.158.100
mars-stub.web.app has IPv6 address 2620:0:890::100
</code></pre></td><td>2022-03-01T15:07:34.233Z</td></tr><tr><td>nitesco</td><td><p>199.36.158.100 разблокировали?</p></td><td>2022-03-02T07:01:03.557Z</td></tr><tr><td>ValdikSS</td><td><p>Да.</p></td><td>2022-03-02T07:01:32.162Z</td></tr><tr><td>oLejikOnMyEvent(OLejik On My Event)</td><td><p>все еще не пашет, причем уже давно</p></td><td>2022-04-26T11:16:15.236Z</td></tr><tr><td>diwenx</td><td><p>It looks like the IP is still being blocked, same mechanism as the tor entry IP.</p></td><td>2022-04-26T19:39:35.104Z</td></tr><tr><td>ValdikSS</td><td><p>Убедился еще раз — <code>199.36.158.100</code> с моих провайдеров доступен.<br>
forms.gle, posts.gle, <a href="http://firebaseapp.com">firebaseapp.com</a> открываются.</p></td><td>2022-05-22T09:41:36.673Z</td></tr><tr><td>UzverNumber47(Uzver Number47)</td><td><p>В последнее время ни у кого не было проблем с доступом к firebase из МегаФон и МТС? Именно мобильных сетей. С VPN все нормально начинает работать.<br>
Firebase клиент пишет “Failed to fetch document because the client is offline”. И это все, что у меня есть.</p></td><td>2023-10-13T09:09:28.493Z</td></tr><tr><td>rubkv(rubkv)</td><td><p>Подтверждаю. Тоже есть периодические проблемы с доступом к Firebase через Мегафон и Ростелеком (Теле2). Начались примерно 3-4 дня назад. Database location: nam5 (не знаю имеет ли это значение).</p>
<p>Не знаю куда копать…</p></td><td>2023-10-15T00:29:35.316Z</td></tr><tr><td>UzverNumber47(Uzver Number47)</td><td><p>У меня все началось в ночь 7-8.10.2023. С каждым днем у большего числа людей начинает глючить. Домашние, мобильные сети, уже независимо от провайдера. Но еще есть у кого нормально работает. Видимо постепенно вводят свои блокировки <img src="https://ntc.party/images/emoji/twitter/rage.png?v=12" title=":rage:" class="emoji" alt=":rage:" loading="lazy" width="20" height="20"></p></td><td>2023-10-15T09:50:38.894Z</td></tr><tr><td>ValdikSS</td><td><p>Все предыдущие домены, которые были недоступны год назад, работают.</p></td><td>2023-10-15T16:08:36.534Z</td></tr><tr><td>rubkv(rubkv)</td><td><p>Аналогично, всё так. С каждым днём всё большее количество пользователей жалуются на ошибку о недоступности БД Firebase. Подскажите, какая у вас локация серверов в Firebase, nam5 или другая?</p>
<p>Пока не понимаю как отловить заблокированные IP-адреса, чтобы сообщить здесь. У тех пользователей, у которых проблема с доступностью Firebase если включить VPN - всё работает отлично.</p></td><td>2023-10-15T16:43:00.364Z</td></tr><tr><td>amen</td><td><p>Такая же проблема, началась 3 дня назад.<br>
Firestore сервер используем eur3.<br>
Есть подозрение, что проблема именно с авторизацией в Firebase, а не с самой базой данных.</p>
<p>Если кто найдет решение этой проблемы, было бы здорово.</p>
<p>С VPN тоже все работает.</p></td><td>2023-10-15T17:35:47.216Z</td></tr><tr><td>rubkv(rubkv)</td><td><p>Коллеги, есть у кого-нибудь возможность попробовать отловить какие IP-адреса все-таки попали под блокировку? У нас авторизации нет, но проблема с запуском приложений из-за недоступности Firebase - есть.</p>
<p>Я попробую сегодня собрать дамп через <a href="https://play.google.com/store/apps/details?id=com.emanuelef.remote_capture" rel="noopener nofollow ugc">PCAPdroid</a>, может тоже кто-нибудь попробует отловить заблокированные адреса? Едва ли такая частичная блокировка серверов Firebase носит преднамеренный характер?</p></td><td>2023-10-15T18:26:58.268Z</td></tr><tr><td>ValdikSS</td><td><p>Firebase изначально работал по протоколу XMPP, но сейчас он объявлен deprecated и используется HTTP API.<br>
Возможно, в вашем ПО используется XMPP-версия, а проблемы вызваны <a href="https://ntc.party/t/%D0%BE%D0%B1%D1%81%D1%83%D0%B6%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B0-jabberxmpp-%D0%B2-%D1%80%D0%BE%D1%81%D1%81%D0%B8%D0%B8/5984/" class="inline-onebox">Обсуждение: Блокировка Jabber/XMPP в России</a>?</p></td><td>2023-10-15T21:16:04.236Z</td></tr><tr><td>UzverNumber47(Uzver Number47)</td><td><p>Database location: eur3</p></td><td>2023-10-16T07:26:35.825Z</td></tr><tr><td>evilandfox(Rinat)</td><td><p>У нас тоже проблема, у многих пользователей (зависит походу от интернет провайдера) не работают запросы к firestore, причем только во flutter-библиотеке. Firebase Admin SDK и Firebase web SDK ок.<br>
Предполагаю тогда что <a href="https://pub.dev/packages/cloud_firestore" class="inline-onebox" rel="noopener nofollow ugc">cloud_firestore | Flutter Package</a> работет на XMPP и из за этого возникают проблемы. Пока непонятно как это решать.</p></td><td>2023-10-16T07:44:06.190Z</td></tr><tr><td>usnevst</td><td><p><a href="https://firebase.google.com/docs/cloud-messaging/xmpp-server-ref" rel="noopener nofollow ugc">Firebase Cloud Messaging XMPP protocol</a><br>
<a href="https://firebase.google.com/docs/cloud-messaging/auth-server" rel="noopener nofollow ugc">Authorize send requests</a></p>
<pre><code class="lang-auto">// Production
fcm-xmpp.googleapis.com:5235

// Testing
fcm-xmpp.googleapis.com:5236
</code></pre>
<blockquote>
<p>You must initiate a Transport Layer Security (TLS) connection. Note that FCM doesn’t currently support the STARTTLS extension.</p>
</blockquote>
<aside class="quote no-group" data-username="evilandfox" data-post="19" data-topic="1739">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/evilandfox/48/3796_2.png" class="avatar"> evilandfox:</div>
<blockquote>
<p>не работают запросы к firestore, причем только во flutter-библиотеке. Firebase Admin SDK и Firebase web SDK ок.</p>
</blockquote>
</aside>
<aside class="onebox githubissue" data-onebox-src="https://github.com/firebase/flutterfire/issues/9965#issuecomment-1321882357">
  <header class="source">

      <a href="https://github.com/firebase/flutterfire/issues/9965#issuecomment-1321882357" target="_blank" rel="noopener nofollow ugc">github.com/firebase/flutterfire</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Issue" data-github-private-repo="false">
	  <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/firebase/flutterfire/issues/9965#issuecomment-1321882357" target="_blank" rel="noopener nofollow ugc">🐛 [cloud_firestore] Incomplete TLS Handshake error</a>
    </h4>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2022-11-19" data-time="14:31:01" data-timezone="UTC">02:31PM - 19 Nov 22 UTC</span>
      </div>

        <div class="date">
          closed <span class="discourse-local-date" data-format="ll" data-date="2022-11-21" data-time="11:07:07" data-timezone="UTC">11:07AM - 21 Nov 22 UTC</span>
        </div>

      <div class="user">
        <a href="https://github.com/rivella50" target="_blank" rel="noopener nofollow ugc">
          <img alt="rivella50" src="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/a11fed5538a964057eaa9216372dc626d26563f7.png" class="onebox-avatar-inline" width="20" height="20" data-dominant-color="EAD3BC">
          rivella50
        </a>
      </div>
    </div>

    <div class="labels">
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">
          type: bug
        </span>
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">
          resolution: invalid
        </span>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">## Bug report

**Describe the bug**
In rare cases i get a TLS handshake excep<span class="show-more-container"><a href="" rel="noopener" class="show-more">…</a></span><span class="excerpt hidden">tion in my mobile app which doesn't fulfill the current request.
Here some details i encountered:

- the errors happen on emulators and physical devices
- they happen when performing CRUD requests against Firestore
- no Crashlytics entry is automatically created when such an error happens

### Steps to reproduce

Not reproducible

### Expected behavior

These kinds of errors should not happen and if so they should not abort the current request.
Also i would like to know why/when these kind of errors can happen and how i can handle them.

---

## Additional context

This is the error i get:
```
[tcp] tcp_input [C39.1:3] flags=[R] seq=1852302311, ack=0, win=0 state=ESTABLISHED rcv_nxt=1852302311, snd_una=1889288412
Connection 39: received failure notification
Connection 39: received ECONNRESET with incomplete TLS handshake - generating errSSLClosedNoNotify
Connection 39: failed to connect 3:-9816, reason -1
Connection 39: encountered error(3:-9816)
Task &lt;D5EDE561-3569-4EC8-8108-93A1650CAF06&gt;.&lt;1&gt; HTTP load failed, 0/0 bytes (error code: -1200 [3:-9816])
[tcp] tcp_input [C39.1:3] flags=[R] seq=1852302311, ack=0, win=0 state=CLOSED rcv_nxt=1852302311, snd_una=1889288412
Task &lt;D5EDE561-3569-4EC8-8108-93A1650CAF06&gt;.&lt;1&gt; finished with error [-1200] Error Domain=NSURLErrorDomain Code=-1200 
  "Es ist ein SSL-Fehler aufgetreten. Eine sichere Verbindung zum Server kann nicht hergestellt werden." 
  UserInfo={NSErrorFailingURLStringKey=https://www.googleapis.com/identitytoolkit/v3/relyingparty/verifyPassword?key=myKey, NSLocalizedRecoverySuggestion=Soll die Verbindung zum Server trotzdem hergestellt werden?, _kCFStreamErrorDomainKey=3, _NSURLErrorFailingURLSessionTaskErrorKey=LocalDataTask &lt;D5EDE561-3569-4EC8-8108-93A1650CAF06&gt;.&lt;1&gt;, _NSURLErrorRelatedURLSessionTaskErrorKey=(
    "LocalDataTask &lt;D5EDE561-3569-4EC8-8108-93A1650CAF06&gt;.&lt;1&gt;"
), NSLocalizedDescription=Es ist ein SSL-Fehler aufgetreten. Eine sichere Verbindung zum Server kann nicht hergestellt werden., NSErrorFailingURLKey=https://www.googleapis.com/identitytoolkit/v3/relyingparty/verifyPassword?key=myKey, NSUnderlyingError=0x281761fe0 {Error Domain=kCFErrorDomainCFNetwork Code=-1200 "(null)" UserInfo={_kCFStreamPropertySSLClientCertificateState=0, _kCFNetworkCFStreamSSLErrorOriginalValue=-9816, _kCFStreamErrorDomainKey=3, _kCFStreamErrorCodeKey=-9816, _NSURLErrorNWPathKey=satisfied (Path is satisfied), viable, interface: en0, ipv4, ipv6, dns}}, _kCFStreamErrorCodeKey=-9816}
[tcp] tcp_input [C39.1:3] flags=[R] seq=1852302311, ack=0, win=0 state=CLOSED rcv_nxt=1852302311, snd_una=1889288412
```

---

### Flutter doctor

Run `flutter doctor` and paste the output below:

&lt;details&gt;&lt;summary&gt;Click To Expand&lt;/summary&gt;

```
Doctor summary (to see all details, run flutter doctor -v):
[✓] Flutter (Channel stable, 3.3.5, on macOS 12.6.1 21G217 darwin-arm, locale en-CH)
[✓] Android toolchain - develop for Android devices (Android SDK version 33.0.0-rc1)
[✓] Xcode - develop for iOS and macOS (Xcode 13.4.1)
[✓] Chrome - develop for the web
[✓] Android Studio (version 2021.1)
[✓] IntelliJ IDEA Ultimate Edition (version 2022.2.3)
[✓] VS Code (version 1.73.0)
[✓] Connected device (4 available)
[✓] HTTP Host Availability

• No issues found!
```

&lt;/details&gt;

---

### Flutter dependencies

Run `flutter pub deps -- --style=compact` and paste the output below:

&lt;details&gt;&lt;summary&gt;Click To Expand&lt;/summary&gt;

```
Dart SDK 2.18.2
Flutter SDK 3.3.5
mrcleaner 1.0.16+20

dependencies:
- badges 2.0.2 [flutter]
- beamer 1.5.3 [flutter flutter_web_plugins]
- camera 0.9.7+1 [camera_platform_interface camera_web flutter flutter_plugin_android_lifecycle quiver]
- cloud_firestore 4.0.4 [cloud_firestore_platform_interface cloud_firestore_web collection firebase_core firebase_core_platform_interface flutter meta]
- cloud_functions 4.0.3 [cloud_functions_platform_interface cloud_functions_web firebase_core firebase_core_platform_interface flutter]
- country_code_picker 2.0.2 [flutter modal_bottom_sheet collection universal_platform]
- cross_file 0.3.3+2 [js meta]
- email_validator 2.0.1
- file_picker 5.2.2 [flutter flutter_web_plugins flutter_plugin_android_lifecycle plugin_platform_interface ffi path win32]
- firebase_analytics 10.0.4 [firebase_analytics_platform_interface firebase_analytics_web firebase_core firebase_core_platform_interface flutter]
- firebase_app_check 0.1.1+3 [firebase_app_check_platform_interface firebase_app_check_web firebase_core firebase_core_platform_interface flutter]
- firebase_auth 4.1.1 [firebase_auth_platform_interface firebase_auth_web firebase_core firebase_core_platform_interface flutter meta]
- firebase_core 2.1.1 [firebase_core_platform_interface firebase_core_web flutter meta]
- firebase_crashlytics 3.0.4 [firebase_core firebase_core_platform_interface firebase_crashlytics_platform_interface flutter stack_trace]
- firebase_messaging 14.0.4 [firebase_core firebase_core_platform_interface firebase_messaging_platform_interface firebase_messaging_web flutter meta]
- firebase_storage 11.0.4 [firebase_core firebase_core_platform_interface firebase_storage_platform_interface firebase_storage_web flutter]
- flutter 0.0.0 [characters collection material_color_utilities meta vector_math sky_engine]
- flutter_cache_manager 3.3.0 [clock collection file flutter http path path_provider pedantic rxdart sqflite uuid]
- flutter_image_compress 1.1.3 [flutter]
- flutter_localizations 0.0.0 [flutter intl characters clock collection material_color_utilities meta path vector_math]
- flutter_native_splash 2.2.2 [args flutter flutter_web_plugins image js lint meta path universal_io xml yaml]
- flutter_phone_direct_caller 2.1.1 [flutter]
- flutter_riverpod 2.1.1 [collection flutter meta riverpod state_notifier]
- flutter_sfsymbols 2.0.0 [flutter]
- flutter_spinkit 5.1.0 [flutter]
- get_it 7.2.0 [async collection]
- google_maps_flutter 2.1.8 [flutter flutter_plugin_android_lifecycle google_maps_flutter_platform_interface]
- grouped_list 5.1.1 [flutter]
- http 0.13.5 [async http_parser meta path]
- image 3.2.0 [archive meta xml]
- internet_connection_checker 0.0.1+4
- intl 0.17.0 [clock path]
- jiffy 5.0.0 [intl]
- package_info_plus 1.4.3+1 [flutter package_info_plus_platform_interface package_info_plus_linux package_info_plus_macos package_info_plus_windows package_info_plus_web]
- pdfx 2.3.0 [flutter flutter_web_plugins plugin_platform_interface js device_info_plus uuid meta extension synchronized universal_platform photo_view vector_math]
- photo_view 0.14.0 [flutter]
- share_plus 6.0.1 [cross_file meta mime flutter flutter_web_plugins share_plus_platform_interface file url_launcher ffi win32]
- shared_preferences 2.0.15 [flutter shared_preferences_android shared_preferences_ios shared_preferences_linux shared_preferences_macos shared_preferences_platform_interface shared_preferences_web shared_preferences_windows]
- sumup 0.5.0 [flutter]
- uni_links 0.5.1 [flutter uni_links_platform_interface uni_links_web]
- url_launcher 6.1.6 [flutter url_launcher_android url_launcher_ios url_launcher_linux url_launcher_macos url_launcher_platform_interface url_launcher_web url_launcher_windows]
- uuid 3.0.6 [crypto]

dev dependencies:
- flutter_test 0.0.0 [flutter test_api path fake_async clock stack_trace vector_math async boolean_selector characters collection matcher material_color_utilities meta source_span stream_channel string_scanner term_glyph]
- mocktail 0.3.0 [collection matcher test]
- very_good_analysis 2.4.0

transitive dependencies:
- _fe_analyzer_shared 40.0.0 [meta]
- _flutterfire_internals 1.0.7 [cloud_firestore_platform_interface cloud_firestore_web collection firebase_core firebase_core_platform_interface flutter meta]
- analyzer 4.1.0 [_fe_analyzer_shared collection convert crypto glob meta package_config path pub_semver source_span watcher yaml]
- archive 3.3.0 [crypto path]
- args 2.3.1
- async 2.9.0 [collection meta]
- boolean_selector 2.1.0 [source_span string_scanner]
- camera_platform_interface 2.2.0 [cross_file flutter plugin_platform_interface stream_transform]
- camera_web 0.2.1+6 [camera_platform_interface flutter flutter_web_plugins stream_transform]
- characters 1.2.1
- clock 1.1.1
- cloud_firestore_platform_interface 5.8.4 [_flutterfire_internals collection firebase_core flutter meta plugin_platform_interface]
- cloud_firestore_web 3.0.4 [_flutterfire_internals cloud_firestore_platform_interface collection firebase_core firebase_core_web flutter flutter_web_plugins js]
- cloud_functions_platform_interface 5.1.22 [firebase_core flutter meta plugin_platform_interface]
- cloud_functions_web 4.3.11 [cloud_functions_platform_interface firebase_core firebase_core_web flutter flutter_web_plugins js]
- collection 1.16.0
- convert 3.0.2 [typed_data]
- coverage 1.3.2 [args logging package_config path source_maps stack_trace vm_service]
- crypto 3.0.2 [typed_data]
- device_info_plus 4.1.3 [flutter device_info_plus_platform_interface device_info_plus_macos device_info_plus_linux device_info_plus_web device_info_plus_windows]
- device_info_plus_linux 3.0.0 [device_info_plus_platform_interface file flutter meta]
- device_info_plus_macos 3.0.0 [device_info_plus_platform_interface flutter]
- device_info_plus_platform_interface 3.0.0 [flutter meta plugin_platform_interface]
- device_info_plus_web 3.0.0 [device_info_plus_platform_interface flutter_web_plugins flutter]
- device_info_plus_windows 4.1.0 [device_info_plus_platform_interface ffi flutter win32]
- extension 0.5.0
- fake_async 1.3.1 [clock collection]
- ffi 2.0.1
- file 6.1.2 [meta path]
- firebase_analytics_platform_interface 3.3.12 [_flutterfire_internals firebase_core flutter meta plugin_platform_interface]
- firebase_analytics_web 0.5.1+3 [_flutterfire_internals firebase_analytics_platform_interface firebase_core firebase_core_web flutter flutter_web_plugins js]
- firebase_app_check_platform_interface 0.0.5+6 [_flutterfire_internals firebase_core flutter meta plugin_platform_interface]
- firebase_app_check_web 0.0.7+6 [_flutterfire_internals firebase_app_check_platform_interface firebase_core firebase_core_web flutter flutter_web_plugins js]
- firebase_auth_platform_interface 6.11.1 [_flutterfire_internals collection firebase_core flutter meta plugin_platform_interface]
- firebase_auth_web 5.1.1 [firebase_auth_platform_interface firebase_core firebase_core_web flutter flutter_web_plugins http_parser intl js meta]
- firebase_core_platform_interface 4.5.2 [collection flutter flutter_test meta plugin_platform_interface]
- firebase_core_web 2.0.1 [firebase_core_platform_interface flutter flutter_web_plugins js meta]
- firebase_crashlytics_platform_interface 3.3.5 [_flutterfire_internals collection firebase_core flutter meta plugin_platform_interface]
- firebase_messaging_platform_interface 4.2.5 [_flutterfire_internals firebase_core flutter meta plugin_platform_interface]
- firebase_messaging_web 3.2.5 [_flutterfire_internals firebase_core firebase_core_web firebase_messaging_platform_interface flutter flutter_web_plugins js meta]
- firebase_storage_platform_interface 4.1.22 [collection firebase_core flutter meta plugin_platform_interface]
- firebase_storage_web 3.3.14 [_flutterfire_internals async firebase_core firebase_core_web firebase_storage_platform_interface flutter flutter_web_plugins http js meta]
- flutter_plugin_android_lifecycle 2.0.6 [flutter]
- flutter_web_plugins 0.0.0 [flutter js characters collection material_color_utilities meta vector_math]
- frontend_server_client 2.1.3 [async path]
- glob 2.0.2 [async collection file path string_scanner]
- google_maps_flutter_platform_interface 2.2.0 [collection flutter plugin_platform_interface stream_transform]
- http_multi_server 3.2.0 [async]
- http_parser 4.0.1 [collection source_span string_scanner typed_data]
- io 1.0.3 [meta path string_scanner]
- js 0.6.4
- lint 1.8.2
- logging 1.0.2
- matcher 0.12.12 [stack_trace]
- material_color_utilities 0.1.5
- meta 1.8.0
- mime 1.0.2
- modal_bottom_sheet 2.1.0 [flutter]
- node_preamble 2.0.1
- package_config 2.0.2 [path]
- package_info_plus_linux 1.0.5 [package_info_plus_platform_interface flutter path]
- package_info_plus_macos 1.3.0 [flutter]
- package_info_plus_platform_interface 1.0.2 [flutter meta plugin_platform_interface]
- package_info_plus_web 1.0.5 [flutter flutter_web_plugins http meta package_info_plus_platform_interface]
- package_info_plus_windows 2.1.0 [package_info_plus_platform_interface ffi flutter win32]
- path 1.8.2
- path_provider 2.0.10 [flutter path_provider_android path_provider_ios path_provider_linux path_provider_macos path_provider_platform_interface path_provider_windows]
- path_provider_android 2.0.14 [flutter path_provider_platform_interface]
- path_provider_ios 2.0.9 [flutter path_provider_platform_interface]
- path_provider_linux 2.1.7 [ffi flutter path path_provider_platform_interface xdg_directories]
- path_provider_macos 2.0.6 [flutter path_provider_platform_interface]
- path_provider_platform_interface 2.0.4 [flutter platform plugin_platform_interface]
- path_provider_windows 2.1.3 [ffi flutter path path_provider_platform_interface win32]
- pedantic 1.11.1
- petitparser 5.0.0 [meta]
- platform 3.1.0
- plugin_platform_interface 2.1.3 [meta]
- pool 1.5.0 [async stack_trace]
- process 4.2.4 [file path platform]
- pub_semver 2.1.1 [collection meta]
- quiver 3.1.0 [matcher]
- riverpod 2.1.1 [collection meta stack_trace state_notifier]
- rxdart 0.27.4
- share_plus_platform_interface 3.1.2 [cross_file flutter meta mime plugin_platform_interface]
- shared_preferences_android 2.0.14 [flutter shared_preferences_platform_interface]
- shared_preferences_ios 2.1.1 [flutter shared_preferences_platform_interface]
- shared_preferences_linux 2.1.1 [file flutter path path_provider_linux path_provider_platform_interface shared_preferences_platform_interface]
- shared_preferences_macos 2.0.4 [flutter shared_preferences_platform_interface]
- shared_preferences_platform_interface 2.1.0 [flutter plugin_platform_interface]
- shared_preferences_web 2.0.4 [flutter flutter_web_plugins shared_preferences_platform_interface]
- shared_preferences_windows 2.1.1 [file flutter path path_provider_platform_interface path_provider_windows shared_preferences_platform_interface]
- shelf 1.3.0 [async collection http_parser path stack_trace stream_channel]
- shelf_packages_handler 3.0.0 [path shelf shelf_static]
- shelf_static 1.1.0 [convert http_parser mime path shelf]
- shelf_web_socket 1.0.1 [shelf stream_channel web_socket_channel]
- sky_engine 0.0.99
- source_map_stack_trace 2.1.0 [path stack_trace source_maps]
- source_maps 0.10.10 [source_span]
- source_span 1.9.0 [collection path term_glyph]
- sqflite 2.0.2+1 [flutter sqflite_common path]
- sqflite_common 2.2.1+1 [synchronized path meta]
- stack_trace 1.10.0 [path]
- state_notifier 0.7.2+1 [meta]
- stream_channel 2.1.0 [async]
- stream_transform 2.0.0
- string_scanner 1.1.1 [source_span]
- synchronized 3.0.0+2
- term_glyph 1.2.1
- test 1.21.4 [analyzer async boolean_selector collection coverage http_multi_server io js node_preamble package_config path pool shelf shelf_packages_handler shelf_static shelf_web_socket source_span stack_trace stream_channel typed_data web_socket_channel webkit_inspection_protocol yaml test_api test_core]
- test_api 0.4.12 [async boolean_selector collection meta source_span stack_trace stream_channel string_scanner term_glyph matcher]
- test_core 0.4.16 [analyzer async args boolean_selector collection coverage frontend_server_client glob io meta package_config path pool source_map_stack_trace source_maps source_span stack_trace stream_channel vm_service yaml matcher test_api]
- typed_data 1.3.1 [collection]
- uni_links_platform_interface 1.0.0 [flutter plugin_platform_interface]
- uni_links_web 0.1.0 [flutter flutter_web_plugins uni_links_platform_interface]
- universal_io 2.0.4 [collection crypto meta typed_data]
- universal_platform 1.0.0+1
- url_launcher_android 6.0.19 [flutter url_launcher_platform_interface]
- url_launcher_ios 6.0.17 [flutter url_launcher_platform_interface]
- url_launcher_linux 3.0.1 [flutter url_launcher_platform_interface]
- url_launcher_macos 3.0.1 [flutter url_launcher_platform_interface]
- url_launcher_platform_interface 2.1.1 [flutter plugin_platform_interface]
- url_launcher_web 2.0.13 [flutter flutter_web_plugins url_launcher_platform_interface]
- url_launcher_windows 3.0.1 [flutter url_launcher_platform_interface]
- vector_math 2.1.2
- vm_service 8.3.0
- watcher 1.0.1 [async path]
- web_socket_channel 2.2.0 [async crypto stream_channel]
- webkit_inspection_protocol 1.1.0 [logging]
- win32 3.0.1 [ffi]
- xdg_directories 0.2.0+1 [meta path process]
- xml 6.1.0 [collection meta petitparser]
- yaml 3.1.1 [collection source_span string_scanner]
```

&lt;/details&gt;

---</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<blockquote>
<p>it is just a wrapper around native Firebase SDKs</p>
</blockquote></td><td>2023-10-16T07:50:35.528Z</td></tr><tr><td>amen</td><td><p>В Android Cloud Firestore такая же проблема, flutter не используется, да и FCM не используем.<br>
Пока работает только через VPN.</p></td><td>2023-10-16T09:30:06.034Z</td></tr><tr><td>rubkv(rubkv)</td><td><aside class="quote no-group" data-username="amen" data-post="21" data-topic="1739">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/a/ee7513/48.png" class="avatar"> amen:</div>
<blockquote>
<p>flutter не используется, да и FCM не используем.</p>
</blockquote>
</aside>
<p>Аналогично. Flutter и не FCM не используем в этом проекте, но доступа у пользователей без VPN - нет. Значит вряд ли ошибка в блокировке XMPP?</p>
<p>Экспериментальным путем выяснили, что проблема с доступом к Cloud Firestore, доступ к Firebase Remote Config, например, есть у всех пользователей.</p></td><td>2023-10-16T09:54:18.510Z</td></tr><tr><td>usnevst</td><td><p>У <code>firebaseremoteconfig.googleapis.com</code> туча адресов, у <code>firestore.googleapis.com</code> один. Они иногда пересекаются.</p>
<details>
<summary>
Адреса firestore.googleapis.com для разных geoip клиентов</summary>
<p>142.250.179.234<br>
142.250.181.170<br>
142.250.182.138<br>
142.250.184.138<br>
142.250.184.170<br>
142.250.193.170<br>
142.250.201.74<br>
142.250.218.234<br>
142.250.65.170<br>
142.250.65.234<br>
142.250.68.42<br>
142.250.74.138<br>
142.250.74.74<br>
142.250.80.42<br>
142.251.221.138<br>
142.251.221.74<br>
142.251.36.202<br>
142.251.40.138<br>
142.251.40.234<br>
142.251.41.10<br>
142.251.47.202<br>
172.217.0.170<br>
172.217.169.106<br>
172.217.2.138<br>
172.217.215.95<br>
172.217.23.202<br>
216.58.215.234<br>
34.64.4.10<br>
74.125.130.95</p>
</details></td><td>2023-10-16T10:08:59.985Z</td></tr><tr><td>rubkv(rubkv)</td><td><p>Если я правильно смотрю дамп, то нет ответа на Client Hello как минимум от двух IP-адресов.</p>
<p>25	2.264054	192.168.1.118	216.58.209.202	TLSv1	234	Client Hello<br>
32	2.527785	192.168.1.118	216.58.209.202	TCP	234	[TCP Retransmission] 39206 → 443 [PSH, ACK] Seq=1 Ack=1 Win=87616 Len=168 TSval=4294938752 TSecr=1926719265</p>
<p>61	3.566939	192.168.1.118	216.58.211.226	TLSv1	583	Client Hello<br>
71	4.101006	192.168.1.118	216.58.211.226	TCP	583	[TCP Retransmission] 58744 → 443 [PSH, ACK] Seq=1 Ack=1 Win=87616 Len=517 TSval=4294939224 TSecr=2701383711</p>
<p>По некоторым IP-адресам есть ответ Server Hello:<br>
37	2.710146	192.168.1.118	216.58.209.170	TLSv1.2	247	Client Hello<br>
40	2.758502	216.58.209.170	192.168.1.118	TLSv1.2	1466	Server Hello</p>
<p>Но не уверен, что правильно смотрю.</p></td><td>2023-10-16T11:10:38.727Z</td></tr><tr><td>usnevst</td><td><p>Чем заканчиваются TCP streams c этими Retransmission?</p>
<p>PCAPdroid использует <a href="https://github.com/emanuele-f/zdtun" rel="noopener nofollow ugc">zdtun</a>, реализуя логику tun2socket. Пишет пакеты клиента на VPN интерфейсе, транслируя дату в сетевые сокеты. ACK’ает пакеты клиента при удачной записи в сокет, связь с ответом сервера косвенная. Дампы, при блокировке, могут сильно отличаться от снятых на внешнем интерфейсе или далее в сети. Retransmission может совсем не быть в дампах PCAPdroid, при реальной блокировке. Получается, надо смотреть все streams.</p>
<p>РКН ранее <a href="https://usher2.club/articles/google-ban/" rel="noopener nofollow ugc">уже блокировал Google</a>. Было масштабней, не нужно было искать иголку в стогу сена. Но можно использовать тот опыт для сбора всех адресов используемых гуглом для apis. Только не понятно, каких apis, блокируют ли проблемные адреса на всех ТСПУ, что именно по адресам блокируют.</p></td><td>2023-10-16T18:05:20.957Z</td></tr><tr><td>evilandfox(Rinat)</td><td><p>что делать то, ребят?</p></td><td>2023-10-17T05:09:47.431Z</td></tr><tr><td>usnevst</td><td><p>Мобильные платформы существуют в мире единорогов и розовых пони, там никогда не бывает сетевых сбоев. “client is offline” (unavailable) возвращает также когда проблемы с бэкендом, но апи доступно и отвечает. Идеальная цель для РКН, могут кошмарить и отмараживаться.</p></td><td>2023-10-17T12:18:19.716Z</td></tr><tr><td>ValdikSS</td><td><aside class="quote" data-post="16" data-topic="1739">
  <div class="title">
    <div class="quote-controls"></div>
    <img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/rubkv/48/3790_2.png" class="avatar">
    <a href="https://ntc.party/t/%D0%B2%D0%BD%D0%B5%D1%80%D0%B5%D0%B5%D1%81%D1%82%D1%80%D0%BE%D0%B2%D0%B0%D1%8F-%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B0-google-firebase-firebaseappcom-formsgle-postsgle/1739/16">Внереестровая блокировка Google Firebase (firebaseapp.com, forms.gle, posts.gle)</a> <a class="badge-category__wrapper " href="/c/internet-censorship-all-around-the-world/russia/12"><span data-category-id="12" style="--category-badge-color: #BF1E2E; --category-badge-text-color: #FFFFFF; --parent-category-badge-color: #0088CC;" data-parent-category-id="10" data-drop-close="true" class="badge-category --has-parent" title="Информация и обсуждение блокировок ресурсов в Российской Федерации"><span class="badge-category__name">Russia</span></span></a>
  </div>
  <blockquote>
    Коллеги, есть у кого-нибудь возможность попробовать отловить какие IP-адреса все-таки попали под блокировку? У нас авторизации нет, но проблема с запуском приложений из-за недоступности Firebase - есть. 
Я попробую сегодня собрать дамп через <a href="https://play.google.com/store/apps/details?id=com.emanuelef.remote_capture" rel="noopener nofollow ugc">PCAPdroid</a>, может тоже кто-нибудь попробует отловить заблокированные адреса? Едва ли такая частичная блокировка серверов Firebase носит преднамеренный характер?
  </blockquote>
</aside>
</td><td>2023-10-17T12:26:24.469Z</td></tr><tr><td>ValdikSS</td><td><p>Удалось выяснить, к какому домену идут эти запросы?</p></td><td>2023-10-17T20:58:00.474Z</td></tr><tr><td>murka(Danil Shaymurzin)</td><td><pre><code class="lang-auto">googleapis.com
firestore.googleapis.com
oauth2.googleapis.com
play.googleapis.com

dns.google
</code></pre></td><td>2023-10-18T07:10:25.246Z</td></tr><tr><td>ValdikSS</td><td><p>Всё TLS на порт 443?<br>
Доступно отовсюду, проблем не наблюдаю.</p></td><td>2023-10-18T09:05:52.273Z</td></tr><tr><td>UzverNumber47(Uzver Number47)</td><td><p>У меня проблема решилась перенаправлением трафика через прокси-сервер, который находится в СПб. Squid с дефолтными настройками и вот такой кусочек кода в андроид приложении.</p>
<pre><code class="lang-auto">System.setProperty("https.proxyHost", "x.x.x.x");
System.setProperty("https.proxyPort", "1234");
System.setProperty("com.google.api.client.should_use_proxy", "true");
</code></pre>
<p>Может кому-то поможет.<br>
Firebase ios SDK вроде тоже так умеет, но я бы сам не отказался если бы кто-то показал как сделать подобное на ios.</p></td><td>2023-10-18T14:39:34.896Z</td></tr><tr><td>usnevst</td><td><aside class="quote no-group" data-username="UzverNumber47" data-post="32" data-topic="1739">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/uzvernumber47/48/3787_2.png" class="avatar"> UzverNumber47:</div>
<blockquote>
<p>через прокси-сервер, который находится в СПб</p>
</blockquote>
</aside>
<p>Там есть другие внереестровые блокировки?</p></td><td>2023-10-19T09:56:01.244Z</td></tr><tr><td>UzverNumber47(Uzver Number47)</td><td><p>Я не знаю, с тех пор как подключил этот сервер пользователи больше не жаловались. В будущем если и на нем появятся блокировки - поставлю VPN прямо на сервер. Как-то так придумал.</p></td><td>2023-10-19T10:15:57.108Z</td></tr><tr><td>usnevst</td><td><p>Проверка на внереестровые блокировки</p>
<pre><code class="lang-auto">curl https://play.google.com/
</code></pre></td><td>2023-10-19T10:26:54.939Z</td></tr><tr><td>UzverNumber47(Uzver Number47)</td><td><p>Именно в таком виде ничего не выводит. С опцией -v много текста и в конце Connection …  left intact.</p></td><td>2023-10-19T10:34:09.211Z</td></tr><tr><td>usnevst</td><td><aside class="quote no-group" data-username="UzverNumber47" data-post="36" data-topic="1739">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/uzvernumber47/48/3787_2.png" class="avatar"> UzverNumber47:</div>
<blockquote>
<p>Именно в таком виде ничего не выводит.</p>
</blockquote>
</aside>
<p>Нет ошибок.<br>
Блокировок нет.</p></td><td>2023-10-19T10:41:22.593Z</td></tr><tr><td>UzverNumber47(Uzver Number47)</td><td><p>Тогда, думаю, можно рекомендовать этот подход. Сервер брал самый дешевый на <a href="http://selectel.ru" rel="noopener nofollow ugc">selectel.ru</a><br>
Почему сurl на <a href="http://play.google.com" rel="noopener nofollow ugc">play.google.com</a>? Все запросы в моем приложении шли на .googleapis.com правда это уже с включенным прокси в приложении.</p></td><td>2023-10-19T11:10:53.882Z</td></tr><tr><td>usnevst</td><td><p>Потому что <code>.googleapis.com</code> пока непонятно где и что блокируют, а <code>https://play.google.com</code> стабильно везде где есть внереестровые блокировки, и сайт близок к теме.</p>
<aside class="quote no-group" data-username="UzverNumber47" data-post="38" data-topic="1739">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/uzvernumber47/48/3787_2.png" class="avatar"> UzverNumber47:</div>
<blockquote>
<p>Все запросы в моем приложении шли на .googleapis.com</p>
</blockquote>
</aside>
<p>Есть полный список доменов которое приложение запрашивает при нулевом старте (без кеша, даты)?</p></td><td>2023-10-19T11:20:56.567Z</td></tr><tr><td>UzverNumber47(Uzver Number47)</td><td><pre><code class="lang-auto">firebaselogging-pa.googleapis.com
firebasestorage.googleapis.com
firestore.googleapis.com
firebaseinappmessaging.googleapis.com
firebaseremoteconfig.googleapis.com
</code></pre></td><td>2023-10-20T07:34:29.846Z</td></tr><tr><td>Andrew(Андрей)</td><td><p>Как у вас успехи? Приложение с базой firebase работает только через впн или ноунем провайдеров. Стоит ли ожидать разрешения проблемы со стороны Firebase Support. Написал им, но пока тишина.</p></td><td>2023-10-20T09:23:51.513Z</td></tr><tr><td>Andrew(Андрей)</td><td><p>У нас присвоен регион eur3 - мультирегион в восточной Европе. Сейчас нельзя изменить регион, его можно менять только при создании нового проекта в файрбейс. Может стоит попробовать создать новый проект, присвоить другой регион (Азию, Восток) и перенести на него базу? Спасибо. PS не программист.</p></td><td>2023-10-20T09:28:21.894Z</td></tr><tr><td>UzverNumber47(Uzver Number47)</td><td><p>Кстати, у пользователей, у которых отваливалась firestore database, вполне себе нормально в браузере открывался <a href="http://firestore.googleapis.com" rel="noopener nofollow ugc">firestore.googleapis.com</a> И еще, когда я сразу пытался поднять nginx чтобы проксировать все в него приходили CONNECT запросы по каждому адресу выше. Может это важно.</p></td><td>2023-10-20T11:06:28.182Z</td></tr><tr><td>usnevst</td><td><p>У iOS пользователей приложения были те же проблемы?</p></td><td>2023-10-20T11:47:41.851Z</td></tr><tr><td>Deniska(Denis)</td><td><p>Попробовал создать проекты в разных регионах и все также. Не помогает</p></td><td>2023-10-20T11:50:42.589Z</td></tr><tr><td>UzverNumber47(Uzver Number47)</td><td><p>Да, они и остались. Прямо сейчас пытаюсь что-то похожее, как я сделал на Android, провернуть и на ios, но ничего не выходит. Задать “глобальный прокси” для ios приложения не выходит. Можно только перед отправкой самого запроса. Если кто поможет, буду признателен</p></td><td>2023-10-20T12:13:09.475Z</td></tr><tr><td>usnevst</td><td><p>Без сетевого дампа от клиента проблему не понять, imho.</p>
<p>firebase-ios-sdk и firebase-android-sdk используют разные стеки для TLS, у iOS С++ либы, у Android java. При этом через браузер работает (только неизвестно какой ip адрес получали для firestore). Если это не блок на стороне самих apis (не сетевой или TLS), возможно есть попытка цензора отсечь не api трафик и случился false positive. Вариантов у цензора масса, даже с данными из дампа воспроизвести блокировку из другой точки будет сложно. Это сетевой ад.</p></td><td>2023-10-20T15:12:41.316Z</td></tr><tr><td>UzverNumber47(Uzver Number47)</td><td><p>У меня есть пара пользователей у которых стабильно воспроизводится. Если есть способ снять дамп максимально просто, так чтобы бабуля разобралась, то возможно я смогу этот дамп добыть.</p></td><td>2023-10-20T15:59:44.233Z</td></tr><tr><td>Vladimir(Vladimir)</td><td><p>Всем привет. Через прокси тоже заработало.<br>
Вот настройки для реализации на iOS:</p>
<p>Firebase осуществляет сетевой слой посредством gRPC.<br>
Необходимо найти класс C++ “grpc_connection”<br>
(лежит в папке FirebaseFirestore)<br>
Найти Метод - CreateChannel (у меня на строке 300)<br>
В параметрах к ChannelArguments добавить две строки</p>
<p>args.SetString(GRPC_ARG_HTTP_PROXY, “<a href="http://proxyHost" rel="noopener nofollow ugc">http://proxyHost</a>:proxyPort”);  (url и порт одной строкой (порт через двоеточие))<br>
args.SetInt(GRPC_ARG_ENABLE_HTTP_PROXY, 1);</p>
<p>Непосредственно процедуру формирования данных для сетевого соединения с учетом настроек прокси можно отследить (проверить) в классе http_proxy (лежит в папке gRPC-Core) это строка 132 - absl::optional<a>std::string</a> HttpProxyMapper::MapName<br>
Если прокси url указан некорректно, то Firebase в консоле напишет что-то вроде - cannot parse value of ‘http_proxy’ итп</p>
<p>Важно! При обновлении зависимостей Firestore проекта, эти правки перетрутся.</p>
<p>Надеюсь помог</p></td><td>2023-10-20T17:07:22.767Z</td></tr><tr><td>UzverNumber47(Uzver Number47)</td><td><p>Есть вариант чуть проще.</p>
<pre><code class="lang-auto">setenv("grpc_proxy", "http://x.x.x.x:yyyy", 1);
</code></pre>
<p>Вот это в любом месте своего кода и не будет перетираться.</p>
<p>Спасибо  <a href="https://ntc.party/u/usnevst">usnevst</a>!</p></td><td>2023-10-20T17:33:25.262Z</td></tr><tr><td>Vladimir(Vladimir)</td><td><p>Ого, круто! А я ковырял гугловский SDK, тоже полезно )))</p></td><td>2023-10-20T17:45:42.410Z</td></tr><tr><td>ValdikSS</td><td><p>Вместо того, чтобы использовать обходные решения, гораздо продуктивнее было бы захватить трафик, как описано, например, здесь, выявить причину проблемы и проанализировать её, чтобы не гадать.</p>
<aside class="quote" data-post="16" data-topic="1739">
  <div class="title">
    <div class="quote-controls"></div>
    <img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/rubkv/48/3790_2.png" class="avatar">
    <a href="https://ntc.party/t/%D0%B2%D0%BD%D0%B5%D1%80%D0%B5%D0%B5%D1%81%D1%82%D1%80%D0%BE%D0%B2%D0%B0%D1%8F-%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B0-google-firebase-firebaseappcom-formsgle-postsgle/1739/16">Внереестровая блокировка Google Firebase (firebaseapp.com, forms.gle, posts.gle)</a> <a class="badge-category__wrapper " href="/c/internet-censorship-all-around-the-world/russia/12"><span data-category-id="12" style="--category-badge-color: #BF1E2E; --category-badge-text-color: #FFFFFF; --parent-category-badge-color: #0088CC;" data-parent-category-id="10" data-drop-close="true" class="badge-category --has-parent" title="Информация и обсуждение блокировок ресурсов в Российской Федерации"><span class="badge-category__name">Russia</span></span></a>
  </div>
  <blockquote>
    Коллеги, есть у кого-нибудь возможность попробовать отловить какие IP-адреса все-таки попали под блокировку? У нас авторизации нет, но проблема с запуском приложений из-за недоступности Firebase - есть. 
Я попробую сегодня собрать дамп через <a href="https://play.google.com/store/apps/details?id=com.emanuelef.remote_capture" rel="noopener nofollow ugc">PCAPdroid</a>, может тоже кто-нибудь попробует отловить заблокированные адреса? Едва ли такая частичная блокировка серверов Firebase носит преднамеренный характер?
  </blockquote>
</aside>
</td><td>2023-10-22T16:59:47.168Z</td></tr><tr><td>usnevst</td><td><p>Есть примеры, когда проблема исчезала при переключении на wi-fi проводного провайдера?</p></td><td>2023-10-22T20:11:18.857Z</td></tr><tr><td>Andrew(Андрей)</td><td><p>Да, есть, провайдер к-телеком</p></td><td>2023-10-23T04:10:57.230Z</td></tr><tr><td>UzverNumber47(Uzver Number47)</td><td><p>Есть, причем множество. И есть примеры когда в сести wi-fi проводного провайдера те же проблемы.</p></td><td>2023-10-23T07:08:20.365Z</td></tr><tr><td>usnevst</td><td><aside class="quote no-group" data-username="UzverNumber47" data-post="56" data-topic="1739">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/uzvernumber47/48/3787_2.png" class="avatar"> UzverNumber47:</div>
<blockquote>
<p>проводного провайдера те же проблемы</p>
</blockquote>
</aside>
<p>Клиенты использовали нестандартные dns настройки? Провайдеры известны?</p></td><td>2023-10-23T08:49:37.852Z</td></tr><tr><td>Andrew(Андрей)</td><td><p>Переписываюсь с ТП Файрбейс,<br>
Скриншот <a href="https://disk.yandex.ru/d/XFoh5KfCfQP1qA" class="inline-onebox" rel="noopener nofollow ugc">Ой!</a><br>
Предлагаю вам также написать в ТП, более подробно изложить проблему (не программист), возможно у вас получится донести все нюансы данной проблемы, возможно предложить им решение.</p>
<p><a href="https://firebase.google.com/support/troubleshooter/contact" class="onebox" target="_blank" rel="noopener nofollow ugc">https://firebase.google.com/support/troubleshooter/contact</a></p></td><td>2023-10-23T09:13:18.004Z</td></tr><tr><td>ValdikSS</td><td><p>Чтобы сообщить о проблеме, нужно сначала понять, где она происходит: блокируется ли какой-то конкретный домен, IP-адрес, порт. Без этой информации ни провайдер, ни поддержка Google вам никак не поможет.</p>
<p>Чтобы собрать эту информацию, достаточно <a href="https://ntc.party/t/%D0%B2%D0%BD%D0%B5%D1%80%D0%B5%D0%B5%D1%81%D1%82%D1%80%D0%BE%D0%B2%D0%B0%D1%8F-%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B0-google-firebase-firebaseappcom-formsgle-postsgle/1739/16">захватить</a> трафик и проанализировать его, либо выложить дамп сюда.</p>
<p>Все IP-адреса домена <code>firestore.googleapis.com</code>, которые мне удалось найти, открываются со всех точек в России, которые у меня имеются.</p></td><td>2023-10-23T20:16:29.029Z</td></tr><tr><td>Deniska(Denis)</td><td><p>Я не разбираюсь особо в этом. Но вот попытался перехватить трафик, у меня пакеты идут туда когда пытаюсь обратиться к firestore базе данных. А в ответ никаких.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/820373bd5dbd3316c2fb3cdd7ba3a695bcb2a1d0.jpeg" data-download-href="https://ntc.party/uploads/default/820373bd5dbd3316c2fb3cdd7ba3a695bcb2a1d0" title="traffic"><img src="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/820373bd5dbd3316c2fb3cdd7ba3a695bcb2a1d0_2_689x268.jpeg" alt="traffic" data-base62-sha1="iy9sYaCcG4Q3IfqY4z6F1ZMi5pu" width="689" height="268" srcset="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/820373bd5dbd3316c2fb3cdd7ba3a695bcb2a1d0_2_689x268.jpeg, внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/820373bd5dbd3316c2fb3cdd7ba3a695bcb2a1d0_2_1033x402.jpeg 1.5x, внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/820373bd5dbd3316c2fb3cdd7ba3a695bcb2a1d0_2_1378x536.jpeg 2x" data-dominant-color="EFF0F4"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">traffic</span><span class="informations">2412×940 173 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
Хотя пинг к <a href="http://lu-in-f95.1e100.net" rel="noopener nofollow ugc">lu-in-f95.1e100.net</a> проходит</p></td><td>2023-10-24T13:02:47.609Z</td></tr><tr><td>UzverNumber47(Uzver Number47)</td><td><p>У меня есть 1 пользователь, у которого сваливается по таймауту <a href="http://play.google.com" rel="noopener nofollow ugc">http://play.google.com</a> Мегафон и NetByNet даже VPN не помогает. Какую информацию мы можем от него получить? Мой метод с прокси у него не работает. Т.е. даже запросы, которые проксируются через мой сервер в СПб у него не проходят.</p></td><td>2023-10-24T13:25:49.208Z</td></tr><tr><td>ValdikSS</td><td><p>Захватите трафик с помощью Wireshark, в pcap-файл. На вашем скриншоте недостаточно информации.</p>
<ol>
<li>Установите <a href="https://www.wireshark.org/download.html">WireShark</a></li>
<li>Выберите в нём сетевой интерфейс и укажите в строке filter: <code>port 53 or port 443</code></li>
<li>Запустите захват</li>
<li>Откройте сервис/запустите программу, которая не работает</li>
<li>Проверьте, есть ли какие-то адреса, на которые не удаётся подключение (много красных строк TCP SYN либо много повторений ClientHello).</li>
<li>Остановите захват кнопкой с красным квадратом, сохраните в pcap-файл.</li>
</ol>
<p>Выложите дамп (pcap-файл) сюда или отправьте личным сообщением.</p>
<aside class="quote no-group" data-username="UzverNumber47" data-post="61" data-topic="1739">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/uzvernumber47/48/3787_2.png" class="avatar"> UzverNumber47:</div>
<blockquote>
<p>У меня есть 1 пользователь, у которого сваливается по таймауту <a href="http://play.google.com">http://play.google.com</a></p>
</blockquote>
</aside>
<p>Он заблокирован с марта 2022: <a href="https://ntc.party/t/%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B0-newsgooglecom-%D0%B8-%D0%BD%D0%B5%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%BD%D0%BE%D1%81%D1%82%D1%8C-playgooglecom/2071" class="inline-onebox">Блокировка news.google.com и недоступность play.google.com</a></p></td><td>2023-10-24T14:16:18.882Z</td></tr><tr><td>ValdikSS</td><td><p>Я нашел причину — Android-приложение meduza в режиме обхода блокировок обращается к Firebase (<code>firestore.googleapis.com</code>) при запуске.<br>
Блокируют сочетание TLS ciphersuites + server_name + supported_groups средствами ТСПУ. Как я понимаю, оно стандартное, из Firebase SDK.</p>
<p><a class="attachment" href="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/aaFeFherBhMuIJDHPAeUYKcl15m.pcap">meduza-firebase.pcap</a> (11.6 KB)</p></td><td>2023-10-26T19:32:37.848Z</td></tr><tr><td>nail(Nail)</td><td><p>Столкнулся с той же проблемой. Заметил, что на некоторых операторах начали зависать обращения к firestore документам и отваливаться транзакции. Меняешь сеть или используешь vpn - проблема уходит.  Налицо блокировки. Начал копать и разбираться. Приложение на Flutter. Работает нативно на android и ios, и есть web версия.</p>
<p>Любопытно, что на операторе, на котором нативные flutter (AOT) версии блокируются, web версия работает! Первое предположение было, что может как-то хитро разные IP используются, для натива и web, отсюда и разное поведение (с блокировкой и без) Забегая вперед - нет, IP адреса одинаковые. [64.233.165.95] Ну и это же логично, их же выдает DNS по UDP, а там user-agent’a нет.</p>
<p>Первое что потребовалось, это исключить влияние Flutter. Сделал тестовый проект на Android. Чистое Android приложение на kotlin с последними версиями библиотек - симптомы те же.<br>
В логах немного разные ошибки в зависимости от провайдера, видимо зависит от того как провайдеры рубят коннекшен, или не рубят его. все не сохранилось, вот одна из них такая:<br>
<code>Caused by: io.grpc.StatusException: UNAVAILABLE: Channel shutdownNow invoked</code></p>
<p>Когда сеть без блокировок firestore работает по gRPC и создание документа выглядит так:</p>
<pre><code class="lang-auto">POST https://firestore.googleapis.com/google.firestore.v1.Firestore/Write HTTP/2.0
user-agent: grpc-java-okhttp/1.52.1
...
POST https://firestore.googleapis.com/google.firestore.v1.Firestore/Commit HTTP/2.0
user-agent: grpc-java-okhttp/1.52.1
...
</code></pre>
<p>Начал снимать TCP DUMP на разных провайдерах и анализировать их.</p>
<ul>
<li>не блочится на мобильном tele2</li>
<li>блочится на домашнем wifi - оператор <a href="http://ufanet.ru" rel="noopener nofollow ugc">ufanet.ru</a></li>
</ul>
<p>в том числе запечатлел нюанс, что web версия на “плохом”  операторе работает и не блочится</p>
<p><a class="attachment" href="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/7bWu4TAHz4dF9BT3Tjn68PT91pb.pcap">tele2_not_blocked.pcap</a> (9,8 КБ)<br>
<a class="attachment" href="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/pzuu9saMf3XxajE83uHlg8IpHH1.pcap">wifi_blocked.pcap</a> (1,2 КБ)<br>
<a class="attachment" href="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/up546CZyWpiYnWmFMObIK42C5Qc.pcap">web_wifi_not_blocked_long.pcap</a> (13,4 КБ)</p>
<p>Обнаружил, что при handshake после “Client Hello” сервер не отвечает “Server Hello”. Handshake просто прерывается.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/939655ea4c93beb9edecdb0a12d84e2630c7d20c.png" data-download-href="https://ntc.party/uploads/default/939655ea4c93beb9edecdb0a12d84e2630c7d20c" title="Screenshot 2023-10-29 at 01.53.55"><img src="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/939655ea4c93beb9edecdb0a12d84e2630c7d20c_2_690x190.png" alt="Screenshot 2023-10-29 at 01.53.55" data-base62-sha1="l3Chp2nH0XZlodZFDijiBRceLmc" width="690" height="190" srcset="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/939655ea4c93beb9edecdb0a12d84e2630c7d20c_2_690x190.png, внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/939655ea4c93beb9edecdb0a12d84e2630c7d20c_2_1035x285.png 1.5x, внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/939655ea4c93beb9edecdb0a12d84e2630c7d20c_2_1380x380.png 2x" data-dominant-color="B09FAE"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Screenshot 2023-10-29 at 01.53.55</span><span class="informations">1616×446 115 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Далее начал искать по ключевым словам “Client Hello” и наткнулся на этот сайт и это обсуждение.<br>
Надеюсь мои наблюдения будут полезны.</p>
<p>У меня два вопроса:</p>
<ol>
<li>Как ValdikSS узнал что блокировка была нацелена на программу от meduza?</li>
<li>такая блокировка не является точечной, кто отвечает за то, чтобы уведомить РКН о необходимости пересмотреть правило блокировки, и будет ли это сделано в обозримом будущем? Или нам нужно костылять прокси обходы на клиентах?</li>
</ol></td><td>2023-10-28T23:08:09.536Z</td></tr><tr><td>nail(Nail)</td><td><p>Дополню, сейчас речь об од wifi сети оператора ufanet, который блочит работу с firestore.<br>
Но как было замечено, блочатся только наивные приложения android и ios (Flutter).<br>
То же самое приложение запущенное в браузере, web версия (Fluter) - не блочится.<br>
Девайс тот же самый, приложение нативное и web работает с одним и тем же firestore,  сеть одна и та же.<br>
пакет Client Hello для handshake собираются немного по разному:<br>
<div class="lightbox-wrapper"><a class="lightbox" href="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/66d6ff9feeeafe78c905bd5b269931ea1eacfa35.png" data-download-href="https://ntc.party/uploads/default/66d6ff9feeeafe78c905bd5b269931ea1eacfa35" title="Screenshot 2023-10-29 at 02.16.19"><img src="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/66d6ff9feeeafe78c905bd5b269931ea1eacfa35_2_690x375.png" alt="Screenshot 2023-10-29 at 02.16.19" data-base62-sha1="eFLkIKayKVNupxyXdukKuW3CpiR" width="690" height="375" srcset="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/66d6ff9feeeafe78c905bd5b269931ea1eacfa35_2_690x375.png, внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/66d6ff9feeeafe78c905bd5b269931ea1eacfa35_2_1035x562.png 1.5x, внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/66d6ff9feeeafe78c905bd5b269931ea1eacfa35_2_1380x750.png 2x" data-dominant-color="EAEAEA"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Screenshot 2023-10-29 at 02.16.19</span><span class="informations">2264×1232 392 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>сравнить весь кусок <a href="https://www.diffchecker.com/AWFL8Ym6/" class="inline-onebox" rel="noopener nofollow ugc">wifi_hello_native_and_web - Diffchecker</a></p></td><td>2023-10-28T23:27:21.268Z</td></tr><tr><td>usnevst</td><td><aside class="quote no-group" data-username="nail" data-post="64" data-topic="1739">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/n/8797f3/48.png" class="avatar"> nail:</div>
<blockquote>
<p>Обнаружил, что при handshake после “Client Hello” сервер не отвечает “Server Hello”. Handshake просто прерывается.</p>
</blockquote>
</aside>
<p>У вас в дампе подтверждение для “Client Hello” приходит через 0.3 мс. Подтверждал явно не сервер.</p>
<p>Можете показать дампы для iOS?</p></td><td>2023-10-29T08:39:51.471Z</td></tr><tr><td>nail(Nail)</td><td><p>Так, я сейчас уехал из дома на квартиру, поэтому сеть другая.<br>
Но <a href="http://dom.ru" rel="noopener nofollow ugc">dom.ru</a> тоже блочит.<br>
mac подключен проводом к роутеру. share internet через wifi.<br>
ios подключен к маку по wifi на созданный hotspot<br>
на маке запущен wireshark<br>
ip срезолвился другой 209.85.233.95<br>
<div class="lightbox-wrapper"><a class="lightbox" href="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/98630fb00a7ccefa37ded9a84517e690c63479d7.png" data-download-href="https://ntc.party/uploads/default/98630fb00a7ccefa37ded9a84517e690c63479d7" title="Screenshot 2023-10-29 at 16.36.22"><img src="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/98630fb00a7ccefa37ded9a84517e690c63479d7_2_690x44.png" alt="Screenshot 2023-10-29 at 16.36.22" data-base62-sha1="lK4Oqpk6plbMKqDOsLSbuwmTDn1" width="690" height="44" srcset="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/98630fb00a7ccefa37ded9a84517e690c63479d7_2_690x44.png, внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/98630fb00a7ccefa37ded9a84517e690c63479d7_2_1035x66.png 1.5x, внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/98630fb00a7ccefa37ded9a84517e690c63479d7.png 2x" data-dominant-color="C0D4E3"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Screenshot 2023-10-29 at 16.36.22</span><span class="informations">1191×76 21.2 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/f39b5e08982b4f686c98144f0b855ab51a9fe615.png" data-download-href="https://ntc.party/uploads/default/f39b5e08982b4f686c98144f0b855ab51a9fe615" title="Screenshot 2023-10-29 at 16.37.39"><img src="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/f39b5e08982b4f686c98144f0b855ab51a9fe615_2_690x372.png" alt="Screenshot 2023-10-29 at 16.37.39" data-base62-sha1="yL2TGVulRlwxnLXMwpjpYAojvMh" width="690" height="372" srcset="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/f39b5e08982b4f686c98144f0b855ab51a9fe615_2_690x372.png, внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/f39b5e08982b4f686c98144f0b855ab51a9fe615_2_1035x558.png 1.5x, внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/f39b5e08982b4f686c98144f0b855ab51a9fe615_2_1380x744.png 2x" data-dominant-color="565A63"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Screenshot 2023-10-29 at 16.37.39</span><span class="informations">1417×765 255 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>дамп <a class="attachment" href="внереестровая-блокировка-google-firebase-firebaseappcom-formsgle-postsgle/gSiixKHvUbnMmrf2mtMx7ly3Vzs.pcapng">domru_widi_blocked_ios_through_mac.pcapng</a> (15,5 КБ)</p></td><td>2023-10-29T13:44:30.286Z</td></tr><tr><td>usnevst</td><td><p>Интересно <code>TLS_CHACHA20_POLY1305_SHA256</code> идет первым, хотя в коде grpc++ он третий. В сборке отдельно от SDK, он таки третий.</p>
<p>Причина в железе, run-time условие:</p>
<pre><code class="lang-auto">  // Order the bulk ciphers. First the preferred AEAD ciphers. We prefer
  // CHACHA20 unless there is hardware support for fast and constant-time
  // AES_GCM. Of the two CHACHA20 variants, the new one is preferred over the
  // old one.
</code></pre></td><td>2023-10-29T13:59:27.758Z</td></tr><tr><td>nail(Nail)</td><td><p>железка была iPhone xs, iOS 16.7.1</p></td><td>2023-10-29T15:58:42.755Z</td></tr><tr><td>usnevst</td><td><p>В сети пишут, что начиная с 5 iPhone используемые процессоры имеют поддержку AES инструкций.<br>
Но в BoringSSL по факту игнорируют эту поддержку. Можно при сборке отдельно включить, но тогда приложение может упасть на древних гаджетах, если поддерживаются.<br>
То есть нет ситуации, что где-то есть пользователи у которых отсутствуют блокировки по причине железа, у всех будет едино. Но вот есть ситуация, когда  невозможно воспроизвести блокировку вне блокируемой платформы, даже если можно собрать тот же код. Тот, да не тот.</p></td><td>2023-10-29T18:51:51.151Z</td></tr><tr><td>nail(Nail)</td><td><p>Возможно я не до конца понял Вас, но вот мои наблюдения насчет устройств:<br>
На всех наблюдаемых устройствах (и android и iOS) блокировка на “плохих” операторах присутствует, если запускать нативную версию приложения. Как Flutter так и обычные.  А вот если запустить веб версию (Fluttre) приложения блокировки нет.<br>
Если есть подозрения, что поведение может отличаться в зависимости от устройств, обоснуйте причины и я проведу серию тестов на устройствах, до которых могу дотянуться.<br>
Если говорить про Apple оборудование, вот такие устройства есть рядом.</p>
<blockquote>
<p>iphone xs<br>
iphone 12<br>
iphone 13 pro max<br>
iphone 14<br>
ipad pro (не M)<br>
ipad air 4<br>
Можно попробовать приложение еще на маке запустить</p>
</blockquote>
<p>Android оборудование тоже есть разнообразное.</p></td><td>2023-10-29T20:39:31.526Z</td></tr><tr><td>evilandfox(Rinat)</td><td><p>А если на уровне приложения задать прокси, то повляет ли это на модерацию приложения в Apple/Google? Не будет проблем с тем, что трафик проксируется?</p></td><td>2023-11-01T11:56:42.373Z</td></tr><tr><td>Vladimir(Vladimir)</td><td><p>У нас всё норм на обеих платформах прошло.</p></td><td>2023-11-01T13:50:20.897Z</td></tr><tr><td>UzverNumber47(Uzver Number47)</td><td><p>У меня на обеих платформах все норм. Крутится уже 2 недели, 4 апдейта</p></td><td>2023-11-01T15:42:56.705Z</td></tr><tr><td>evilandfox(Rinat)</td><td><p>Можете пожалуйста привести пример кода для обеих платформ?..</p></td><td>2023-11-02T10:37:32.218Z</td></tr><tr><td>evilandfox(Rinat)</td><td><p>А вообще возможно кто то на флаттер это реализовал, можете скинуть?</p></td><td>2023-11-02T10:39:49.660Z</td></tr><tr><td>Vladimir(Vladimir)</td><td><p>Там выше, на 15 дней назад необходимо ленту отмотать. Есть примеры кода</p></td><td>2023-11-02T15:58:42.262Z</td></tr><tr><td>Elevator</td><td><p>Медуза добавила новый способ обхода блокировок <a href="https://meduza.io/feature/2023/11/07/vazhneyshee-ob-yavlenie-my-pridumali-esche-odin-hitryy-sposob-pomogayuschiy-chitat-meduzu-v-rossii-bez-vpn-my-nazyvaem-ego-volshebnym" class="inline-onebox" rel="noopener nofollow ugc">Важнейшее объявление: мы придумали еще один хитрый способ, помогающий читать «Медузу» в России без VPN. Мы называем его волшебным! — Meduza</a></p>
<p>Они используют для своих ссылок домен <a href="http://storage.googleapis.com" rel="noopener nofollow ugc">storage.googleapis.com</a><br>
Ждем ответа от РКН</p></td><td>2023-11-07T20:49:58.500Z</td></tr><tr><td>UzverNumber47(Uzver Number47)</td><td><p>Товарищи, никто в последние 3 дня не сталкивался с проблемами доступа к firebase? Очень похоже, что опять началось. И обход со squid сервером перестал работать. Пока есть 2 пользователя Питер - Билайн, Екатерингбург - Теле2. VPN помогает.</p></td><td>2024-01-14T08:10:13.990Z</td></tr>
    </table>
      </body>
    </html>
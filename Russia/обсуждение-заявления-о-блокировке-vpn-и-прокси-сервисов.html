
    <html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <style>
    th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      word-wrap: break-word;
      padding: 5px;
    }
    table {
      width: 100%;
      max-width: 100%;
      border: 1px solid black;
      border-collapse: collapse;
      table-layout: fixed;
      word-wrap: break-word
    }
    code {
      word-wrap: break-word;
    }
    pre {
        white-space: pre-wrap;
    }
    </style>
        <title>обсуждение-заявления-о-блокировке-vpn-и-прокси-сервисов</title>
      </head>
      <body>
        <table border="1" width="100%" cellpadding="5">
          <tr>
            <th style="width: 10%;">Ник</th>
            <th>Пост</th>
            <th style="width: 10%;">Дата</th>
          </tr>
    <tr><td>VasilyGrigoriev378(Василий Григорьев)</td><td><p>Боюсь что скоро к Антизапрету доберутся их ручонки, вместе с инструментом Goodbye DPI который они могут сделать не работоспособными</p></td><td>2021-06-17T19:17:46.281Z</td></tr><tr><td>blablabla</td><td><p>Пора опять ставить WireGuard на VPS где-нибудь поближе к Англии?</p></td><td>2021-06-17T19:53:04.358Z</td></tr><tr><td>zhenyolka</td><td><p>Временное решение. Не за горами поиск по сигнатурам и active probing</p></td><td>2021-06-18T12:45:41.056Z</td></tr><tr><td>VasilyGrigoriev378(Василий Григорьев)</td><td><p>Как решить проблемы с  пропажей кнопки VPN в Opera.<br>
Открываем C:\Users*ВАШ_ПРОФИЛЬ*\AppData\Roaming\Opera Software\Opera Stable<br>
Находим файл Secure Preferences<br>
Открываем его в AkelPad или NotePad++<br>
Находим строку “vpn”:{“blacklisted_locations”:[“cn”,“ru”],“last_established_location”:“RU”}}<br>
Заменяем на “vpn”:{“blacklisted_locations”:[“cn”],“last_established_location”:“CN”}}<br>
В данном случае всё делается по аналогии – первый, это Россия , а второй Китай . Следовательно, первый удаляем, и параметр указываем от китайского.<br>
Делаем файл Secure Preferences доступным только для чтения.</p></td><td>2021-06-18T19:09:27.944Z</td></tr><tr><td>Petrovich</td><td><details>
<summary>
Список доменов</summary>
<p><a href="http://api.hotdata.net" rel="noopener nofollow ugc">api.hotdata.net</a><br>
<a href="http://api.gf-install.com" rel="noopener nofollow ugc">api.gf-install.com</a><br>
<a href="http://api.gf-config.com" rel="noopener nofollow ugc">api.gf-config.com</a><br>
<a href="http://api.succentric.com" rel="noopener nofollow ugc">api.succentric.com</a><br>
<a href="http://api.netitude.net" rel="noopener nofollow ugc">api.netitude.net</a><br>
<a href="http://api.gf-mobile.com" rel="noopener nofollow ugc">api.gf-mobile.com</a><br>
<a href="http://api.netapult.net" rel="noopener nofollow ugc">api.netapult.net</a><br>
<a href="http://api.bondwidth.org" rel="noopener nofollow ugc">api.bondwidth.org</a><br>
<a href="http://api.gf-app.com" rel="noopener nofollow ugc">api.gf-app.com</a><br>
<a href="http://api.gf-profile.com" rel="noopener nofollow ugc">api.gf-profile.com</a><br>
<a href="http://api.notscrewed.com" rel="noopener nofollow ugc">api.notscrewed.com</a><br>
<a href="http://api.inunison.net" rel="noopener nofollow ugc">api.inunison.net</a><br>
<a href="http://api.nthelead.com" rel="noopener nofollow ugc">api.nthelead.com</a><br>
<a href="http://api.trajectore.com" rel="noopener nofollow ugc">api.trajectore.com</a><br>
<a href="http://api.4titude.net" rel="noopener nofollow ugc">api.4titude.net</a></p>
</details></td><td>2021-07-04T05:54:21.471Z</td></tr><tr><td>VasilyGrigoriev378(Василий Григорьев)</td><td><p>Ну и как хак работает или нет? Ну VyprVPN сервис такой себе сервис тех. поддержка и обслуживание клиентов могло быть лучше.</p></td><td>2021-07-04T13:20:28.240Z</td></tr><tr><td>lossenstein(lossenstein)</td><td><p>У меня VyprVPN работает все это время, и Wireguard и OpenVPN. Ростелеком, все дела, вот сейчас из-под него пишу. Ничего не менял.</p></td><td>2021-07-05T14:44:38.936Z</td></tr><tr><td>lossenstein(lossenstein)</td><td><p>)) pong на двух разных провайдерах.</p></td><td>2021-07-08T14:20:49.155Z</td></tr><tr><td>0ka(0ka)</td><td><p>Мобильный мегафон - ERR_TIMED_OUT, goodbyeDPI помогает</p></td><td>2021-07-08T15:45:57.340Z</td></tr><tr><td>hookz(Talya)</td><td><p>26 августа знакомый из Саратова жаловался на интернет соединение через Wireguard на Эстонию (не публичные vpn), провайдер ДомРу. На проводе было тоже самое, видимо тестили что-то.<div class="lightbox-wrapper"><a class="lightbox" href="обсуждение-заявления-о-блокировке-vpn-и-прокси-сервисов/846b0575e645cfdbceb3db636db854810c2740ee.jpeg" data-download-href="https://ntc.party/uploads/default/846b0575e645cfdbceb3db636db854810c2740ee" title="IMG_20210904_154747_473"><img src="обсуждение-заявления-о-блокировке-vpn-и-прокси-сервисов/846b0575e645cfdbceb3db636db854810c2740ee_2_281x500.jpeg" alt="IMG_20210904_154747_473" data-base62-sha1="iTqjJjWDUj5nUmmbYqLZ9IcB9F4" width="281" height="500" srcset="обсуждение-заявления-о-блокировке-vpn-и-прокси-сервисов/846b0575e645cfdbceb3db636db854810c2740ee_2_281x500.jpeg, обсуждение-заявления-о-блокировке-vpn-и-прокси-сервисов/846b0575e645cfdbceb3db636db854810c2740ee_2_421x750.jpeg 1.5x, обсуждение-заявления-о-блокировке-vpn-и-прокси-сервисов/846b0575e645cfdbceb3db636db854810c2740ee_2_562x1000.jpeg 2x" data-dominant-color="202436"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">IMG_20210904_154747_473</span><span class="informations">720×1280 47.4 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p></td><td>2021-09-04T12:48:47.205Z</td></tr><tr><td>neur0tx</td><td><p>На выходных переставал работать WireGuard. Примерно в середине дня по МСК заработал.<br>
Проверял на NordVPN, Mullvad и self-hosted.<br>
Провайдер - домашний мтс.</p>
<p>У NordVPN, кстати, отваливался только WireGuard. Всё остальное работало.</p></td><td>2021-09-06T19:32:55.232Z</td></tr><tr><td>ValdikSS</td><td><p>A post was merged into an existing topic: <a href="/t/rkn-will-try-to-block-the-following-vpn-services/1022/74">RKN will try to block the following VPN services</a></p></td><td>2021-09-07T08:27:43.464Z</td></tr><tr><td>tango</td><td><p>el3xyz started a thread on the WireGuard mailing list with a patch for per-packet payload obfuscation in WireGuard and is asking for comments.</p>
<p><a href="https://lists.zx2c4.com/pipermail/wireguard/2021-September/007142.html" class="onebox" target="_blank" rel="noopener">https://lists.zx2c4.com/pipermail/wireguard/2021-September/007142.html</a></p>
<blockquote>
<p>To make detection more difficult two things are being done</p>
<ul>
<li>handshake initiation, response and cookie messages are padded with random sized garbage</li>
<li>Up to 192 bytes of each message is encrypted with obfuscation key derived from peer public key (different keys are used in different directions).</li>
</ul>
</blockquote>
<p>I posted <a href="https://github.com/net4people/bbs/issues/88#issuecomment-930471399">commands for setting it up</a> that worked for me.</p>
<p>On both peers:</p>
<pre><code class="lang-plaintext">$ sudo apt install build-essential linux-headers-amd64
$ cd
$ git clone https://github.com/el3xyz/wireguard-linux-compat
$ cd wireguard-linux-compat/src
$ make DEV=wireguard_obf
$ sudo make install
$ cd
$ git clone https://github.com/el3xyz/wireguard-tools
$ cd wireguard-tools/src
$ make DEV=wireguard_obf
$ cd
$ (umask 077; ~/wireguard-tools/src/wg genkey &gt; privatekey)
$ ~/wireguard-tools/src/wg pubkey &lt; privatekey &gt; publickey
</code></pre>
<p>One one peer:</p>
<pre><code class="lang-plaintext">peera$ sudo ip link add dev wgobf0 type wireguard_obf
peera$ sudo ip address add dev wgobf0 192.168.2.1 peer 192.168.2.2
peera$ sudo ~/wireguard-tools/src/wg set wgobf0 \
           listen-port 51820 \
           private-key privatekey \
           peer [peerb-publickey] \
           allowed-ips 0.0.0.0/0 \
           endpoint [peerb-ip]:51820
peera$ sudo ip link set up dev wgobf0
</code></pre>
<p>On the other peer:</p>
<pre><code class="lang-plaintext">peerb$ sudo ip link add dev wgobf0 type wireguard_obf
peerb$ sudo ip address add dev wgobf0 192.168.2.2 peer 192.168.2.1
peerb$ sudo ~/wireguard-tools/src/wg set wgobf0 \
           listen-port 51820 \
           private-key privatekey \
           peer [peera-publickey] \
           allowed-ips 0.0.0.0/0 \
           endpoint [peera-ip]:51820
peerb$ sudo ip link set up dev wgobf0
</code></pre></td><td>2021-09-29T19:34:04.779Z</td></tr><tr><td>bolvan</td><td><p>Nice to hear somebody works in this direction too. It did something similar about 2 years ago.<br>
Instead of patching vpn code i created simple xor ip packet obfuscator with 2 versions : linux kernel mod and NFQUEUE handler.<br>
The main problem is that its linux only (and android with NFQUEUE), lacks easiness and does not support all supported by wireguard platforms</p>
<p>From my view it would be the best for wireguard developers to implement optional obfuscation in the mainline code, including non-linux implementations.<br>
Otherwise to make it easy for anyone someone must fork all the wireguard code and create/maintain separate version</p></td><td>2021-09-30T07:00:21.672Z</td></tr><tr><td>el3xyz(el3xyz)</td><td><p>Hey bolvan,</p>
<p>I talked to Jason and he is not going to add obfuscation to mainline WG and has every right to do so. His point is that this will just tighten the restrictions imposed by local regulators, while each new obfuscation method will make protocol incompatible.</p>
<p>My understanding is Russia currently implementing 2nd generation of blocks which is based on DPI and DNS spoofing, while China adopts 3rd generation which is based on DPI/DNS spoofing combined with statistical models and active probing. The latter can detect and block even obfuscated WG traffic, however encapsulating obfuscated WG packets to QUIC and use round robin selection for endpoints may work even in this case.</p>
<p>Cheers</p></td><td>2021-09-30T08:43:54.270Z</td></tr><tr><td>bolvan</td><td><p>As far as I understand wireguard is protected against replay attacks and also does not reply to malformed packets or packets encrypted with the wrong key. That’s why it may be protected from active probing. But not statistical methods. Am I right ?</p>
<p>Anyway, I think its good to have proper instrumentation for every blocks generation<br>
It might take a while for the regulator to impose next block generation model<br>
Tools such as udp2raw already exist and people will use them anyway or use another simplier solution if it appears. So it will not stop the regulator from escalating its blocking. Even not sure it will delay.<br>
We talk about a fast vpn that supports obfuscation natively without any thirdparty usermode tools.<br>
I think the key factor here is easiness. Most people are lazy nowadays and absenсe of easy solution can significantly reduce the number of users.</p></td><td>2021-09-30T10:00:19.083Z</td></tr><tr><td>tango</td><td><aside class="quote no-group" data-username="bolvan" data-post="18" data-topic="1107">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/b/8e8cbc/48.png" class="avatar"> bolvan:</div>
<blockquote>
<p>i created simple xor ip packet obfuscator with 2 versions : linux kernel mod and NFQUEUE handler.</p>
</blockquote>
</aside>
<p>Do you have source code for these? A kernel mod or NFQUEUE is what <a href="https://lists.zx2c4.com/pipermail/wireguard/2021-September/007155.html">Jason suggested</a> in the thread. I have not done something like that before; it would be good to have a reference example.</p>
<aside class="quote no-group" data-username="el3xyz" data-post="19" data-topic="1107">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/e/c5a1d2/48.png" class="avatar"> el3xyz:</div>
<blockquote>
<p>encapsulating obfuscated WG packets to QUIC</p>
</blockquote>
</aside>
<p>Something to be aware of is <a href="https://datatracker.ietf.org/wg/masque/about/">MASQUE</a>, an IETF project to specify proxy protocols over HTTP (including HTTP/3; i.e. QUIC). There’s a <a href="https://datatracker.ietf.org/doc/draft-ietf-masque-connect-udp/">draft-ietf-masque-connect-udp</a> for a CONNECT-UDP HTTP method. I don’t know if there are any implementations.</p>
<p>Of course, it may not be necessary to actually construct a QUIC tunnel; modifying the WireGuard packets to resemble QUIC will probably work as well.</p></td><td>2021-09-30T17:00:11.260Z</td></tr><tr><td>ValdikSS</td><td><aside class="onebox githubrepo" data-onebox-src="https://github.com/bol-van/ipobfs">
  <header class="source">

      <a href="https://github.com/bol-van/ipobfs" target="_blank" rel="noopener">github.com</a>
  </header>

  <article class="onebox-body">
    <div class="github-row" data-github-private-repo="false">
  <img width="690" height="344" src="обсуждение-заявления-о-блокировке-vpn-и-прокси-сервисов/7171c9b4391ad9270ea816def4f4543ef87fd092_2_690x344.png" class="thumbnail" data-dominant-color="F1F4F1">

  <h3><a href="https://github.com/bol-van/ipobfs" target="_blank" rel="noopener">GitHub - bol-van/ipobfs: IP obfuscation NFQUEUE/kmod filter</a></h3>

    <p><span class="github-repo-description">IP obfuscation NFQUEUE/kmod filter</span></p>
</div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>
</td><td>2021-09-30T17:08:50.299Z</td></tr><tr><td>el3xyz(el3xyz)</td><td><aside class="quote no-group" data-username="bolvan" data-post="20" data-topic="1107">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/b/8e8cbc/48.png" class="avatar"> bolvan:</div>
<blockquote>
<p>That’s why it may be protected from active probing. But not statistical methods. Am I right ?</p>
</blockquote>
</aside>
<p>Exactly. Also it’s protected against RST attack used by GFW of China, just because it’s UDP based. With statistical methods one may try to classify traffic as web browsing (idle periods intermixed with high bandwidth usage) and start blocking it if other properties match (UDP, high entropy of the packet, you name it)</p>
<aside class="quote no-group" data-username="bolvan" data-post="20" data-topic="1107">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/b/8e8cbc/48.png" class="avatar"> bolvan:</div>
<blockquote>
<p>I think the key factor here is easiness</p>
</blockquote>
</aside>
<p>Yep, I understand that doing this in kernel will reduce number of users in several orders of magnitude given the necessity to build/install from sources. Still it was fun and I decided to share results.</p>
<aside class="quote no-group" data-username="tango" data-post="21" data-topic="1107">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/t/e36b37/48.png" class="avatar"> tango:</div>
<blockquote>
<p>Something to be aware of is <a href="https://datatracker.ietf.org/wg/masque/about/" rel="noopener nofollow ugc">MASQUE</a>, an IETF project to specify proxy protocols over HTTP (including HTTP/3; i.e. QUIC). There’s a <a href="https://datatracker.ietf.org/doc/draft-ietf-masque-connect-udp/" rel="noopener nofollow ugc">draft-ietf-masque-connect-udp</a> for a CONNECT-UDP HTTP method. I don’t know if there are any implementations.</p>
</blockquote>
</aside>
<p>I’m thinking about something like udp2raw, still in kernel. I don’t want to stick to NFQUEUE/netfilter by now, given that I have plans for Windows driver as well</p></td><td>2021-09-30T17:53:25.952Z</td></tr><tr><td>tango</td><td><p>Thanks for the link to ipobfs. Reading the source code helped me understand how it works.</p>
<p>According to <a href="https://stackoverflow.com/q/31368816" class="inline-onebox">c - Sending queued packets with NFQUEUE? - Stack Overflow</a>, it’s possible to do fancy traffic shaping operations (delay packets, split packets, send chaff packets, encapsulate packets into another protocol) in a somewhat roundabout way: the userspace program responds <code>NF_DROP</code> to every packet, queues the packets internally, and injects packets into the outgoing network interface when appropriate. In that sense, NFQUEUE can be thought of as an inconvenient and platform-specific alternative to receiving packets from the kernel over a UDP socket or Unix domain socket.</p></td><td>2021-10-01T17:53:10.154Z</td></tr><tr><td>anonymous94(anonymous94)</td><td><p>Блокировка TunnelBear: заметки на полях</p>
<p>Cайт блокируют с мая 2018, сервис c конца 2021. И «окончательно» заблокировали в начале 2022.</p>
<p>Блокируемые протоколы (или просто трафик на порту) для адресов сервиса: OpenVPN-UDP (443, 7011), OpenVPN-TCP (443), IKEv2 (500, 4500), WG-Bear(51820), GhostBear(old-obfs4 на 6418).</p>
<p>IKEv2 и WG-Bear <a href="https://archive.is/UoUWR" rel="noopener nofollow ugc">поддерживаются</a> только в Windows и iOS версиях. WG-Bear появился впервые для Windows версии 4.5.0 в апреле 2022 (для iOS нет данных по датам). WG-Bear не совместим с WireGuard (паттерны оригинального WG не блокируются).</p>
<p>В январе 2023 «окончательно» перекрыли все точки доступа к API.</p></td><td>2023-02-07T18:57:56.647Z</td></tr><tr><td>anonymous100(anonymous100)</td><td><p>Шаблоны блокировок сервисов стремительно упростились. Сначала из условия пропали порты, а затем и содержимое пакетов. Причины и цели неизвестны, но старые блокировки, пока, не трогают. Есть предположение, что для адресов добываемых с гаджетов сломался классификатор, но сами адреса поступают/подключаются.</p>
<hr>
<p>Изменения для портов и содержимого могут быть не связаны. Но блокировка адреса не баг, а фича. Проверка идет с лагом после сбора адресов. Сервис съехал, но адрес из логов идет в дело. Пользователи сами на себя “стучат”: предустановленные госперские, вк, счетчики и прочие яндексы.</p></td><td>2023-02-17T17:34:55.566Z</td></tr>
    </table>
      </body>
    </html>
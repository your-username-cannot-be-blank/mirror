
    <html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <style>
    th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      word-wrap: break-word;
      padding: 5px;
    }
    table {
      width: 100%;
      max-width: 100%;
      border: 1px solid black;
      border-collapse: collapse;
      table-layout: fixed;
      word-wrap: break-word
    }
    code {
      word-wrap: break-word;
    }
    pre {
        white-space: pre-wrap;
    }
    </style>
        <title>результаты-тестирования-разных-dpi-роскомнадзором</title>
      </head>
      <body>
        <table border="1" width="100%" cellpadding="5">
          <tr>
            <th style="width: 10%;">Ник</th>
            <th>Пост</th>
            <th style="width: 10%;">Дата</th>
          </tr>
    <tr><td>ValdikSS</td><td><p>В конце 2017-начале 2018 года Роскомнадзор провёл тестирование 12 комплексов DPI для провайдеров, с целью проверки эффективности блокировок, правильной работы комплексов с реестром, выявления и документирования пропусков заблокированных сайтов.</p>
<p><a href="http://www.rkn.gov.ru/communication/p922/" class="onebox" target="_blank" rel="noopener">http://www.rkn.gov.ru/communication/p922/</a></p>
<p>В документах содержатся типовые схемы подключения DPI в сеть, информация о разных моделях, режимах работы и пропускной способности.<br>
Кое-где можно встретить более глубокие технические подробности.</p>
<p>На всякий случай, прикладываю результаты тестирования всех DPI, если их вдруг удалят с сайта. Перегнал все TIFF’ы в PDF.</p>
<p><a class="attachment" href="результаты-тестирования-разных-dpi-роскомнадзором/aqTBodmjzdcW7QkUBHmF5vvKRuS.pdf">01_equila.pdf</a> (2.0 MB)<br>
<a class="attachment" href="результаты-тестирования-разных-dpi-роскомнадзором/w5IOlWjMs0iGlSmzOJnJnlVTQ8E.pdf">02_cyberfilter.pdf</a> (1.5 MB)<br>
<a class="attachment" href="результаты-тестирования-разных-dpi-роскомнадзором/rv493V66QhTLdBWQXamkRsmuE1W.pdf">03_barier.pdf</a> (646.3 KB), <a class="attachment" href="результаты-тестирования-разных-dpi-роскомнадзором/w09kzIHcpebib9hXKAVh325mXK7.pdf">03_berier_trebovaniya.pdf</a> (2.3 MB)<br>
<a class="attachment" href="результаты-тестирования-разных-dpi-роскомнадзором/uJcj5wHj3y3nmksyyZSNDQGPKug.pdf">04_admfilter.pdf</a> (1.7 MB)<br>
<a class="attachment" href="результаты-тестирования-разных-dpi-роскомнадзором/vu4aek8R46GSp30moh3ihqm7d2A.pdf">05_zapretservice.pdf</a> (1.3 MB)<br>
<a class="attachment" href="результаты-тестирования-разных-dpi-роскомнадзором/trDGvfjXRDq1onFnlYkDZwLMjk.pdf">06_ideco_selecta_isp.pdf</a> (1.4 MB)<br>
<a class="attachment" href="результаты-тестирования-разных-dpi-роскомнадзором/nuAPN3ttwNzZzcVeeOFtAfZDv8Q.pdf">07_carbon_reductor_dpi.pdf</a> (1.0 MB)<br>
<a class="attachment" href="результаты-тестирования-разных-dpi-роскомнадзором/oP1iQrulJPNTJhZgmzDb7RXXnG3.pdf">08_skydns_zapret_isp.pdf</a> (1.5 MB)<br>
<a class="attachment" href="результаты-тестирования-разных-dpi-роскомнадзором/2VLCBZMyLsxtokQlSgZF36nggpQ.pdf">09_tiksen_blokirovka.pdf</a> (2.1 MB)<br>
<a class="attachment" href="результаты-тестирования-разных-dpi-роскомнадзором/3CCGcV8LhnmyjAzn66HLo8V97WT.pdf">10_skat.pdf</a> (1.2 MB)<br>
<a class="attachment" href="результаты-тестирования-разных-dpi-роскомнадзором/uzLKjZzIwtHNT8DKfkGqespcTk2.pdf">11_ecofilter.pdf</a> (1.3 MB)<br>
<a class="attachment" href="результаты-тестирования-разных-dpi-роскомнадзором/w5RGRdzHtHyf9NGCmu8LKck5TMd.pdf">12_ubic.pdf</a> (1.5 MB)</p></td><td>2019-09-27T13:54:40.030Z</td></tr><tr><td>ValdikSS</td><td><p>Мои небольшие заметки о разных DPI.<br>
Используемая терминология:</p>
<p>in-path = установка DPI в разрыв = активный DPI = man-in-the-middle<br>
on-path = установка DPI с зеркалированием оптическим сплиттером или программно = пассивный DPI = man-on-the-side</p>
<h4><a name="p-268-equila-1" class="anchor" href="#p-268-equila-1"></a>СПАК “Equila”</h4>
<p>От компании <a href="http://www.napalabs.ru/">napalabs</a></p>
<ul>
<li>Поставляется в виде программно-аппаратного комплекса</li>
<li>До 80 Gbit/s (на сайте написано про 80, в документе — до 160).</li>
<li>Поддерживает режимы подключения: in-path, двусторонний on-path («пассивный» DPI, в который зеркалируется и входящий, и исходящий трафик оптическим сплиттером или программно), односторонний on-path (зеркалируется только исходящий клиентский трафик)</li>
<li>Помимо блокировок может осуществлять QoS, кеширование, родительский контроль и внедрение рекламы</li>
</ul>
<h4><a name="p-268-cyberfilter-2" class="anchor" href="#p-268-cyberfilter-2"></a>CyberFilter</h4>
<p>Компания <a href="https://cyberfilter.ru/">CyberFilter</a></p>
<ul>
<li>Поставляется в виде ISO-образа для установки на обычные серверы</li>
<li>Перенаправляет трафик на себя через BGP или DNS RPZ</li>
<li>3 разных варианта подключения: облачный, прокси у провайдера, программно-аппаратный комплекс</li>
<li>25+ Gbit/s (в случае программно-аппаратного комплекса. Видимо, имеется в виду общая пропускная способность провайдера, а не возможности обработки ПАК.)</li>
</ul>
<p>Есть <a href="http://wiki.cyberfilter.ru/">Wiki</a>. Из <a href="http://wiki.cyberfilter.ru/doku.php?id=faq">FAQ</a>:</p>
<blockquote>
<h3>Как происходит фильтрация ?</h3>
<ol>
<li>
<p>Запросы пользователя перенаправляются на фильтрующий сервер. Перенаправление может осуществляться через маршрутизацию (основной способ) или через DNS RPZ (дополнительный способ).</p>
</li>
<li>
<p>Фильтрующий сервер проверяет наличие запрашиваемого ресурса в реестрах запрещенных сайтов и либо пропускает запрос, либо выводит сообщение, что ресурс заблокирован.</p>
</li>
</ol>
<h3>Как обрабатываются протоколы отличные от HTTP/HTTPS ?</h3>
<ul>
<li>
<p>если перенаправление произошло через маршрутизацию и ресурс НЕ блокируется по IP, то запрос пропускается (с использованием NAT)</p>
</li>
<li>
<p>если перенаправление произошло через DNS RPZ, то запрос блокируется</p>
</li>
</ul>
<h3>Как обрабатывается HTTPS ?</h3>
<ul>
<li>
<p>запросы к сайтам, которые размещены на тех же IP, что и ресурсы из реестра - пропускаются</p>
</li>
<li>
<p>запросы к сайтам из реестра блокируются без вывода сообщения (вывод сообщения может быть настроен дополнительно, но браузер пользователя будет «ругаться» на сертификат)</p>
</li>
<li>
<p>запросы по HTTPS к <a href="http://youtube.com">youtube.com</a> пропускаются</p>
</li>
</ul>
</blockquote>
<h4><a name="p-268-h-3" class="anchor" href="#p-268-h-3"></a>Барьер</h4>
<p>От компании <a href="https://nvg.ru/press/news-and-press-releases/envizhn-grup-predstavila-sistemu-filtratsii-internet-trafika-barer/?sphrase_id=2200">NVision</a></p>
<ul>
<li>Поддерживается установка in-path и on-path.</li>
<li>Внедрён у МТС Москва (по информации из документа)</li>
</ul>
<p>По этому DPI почти нет информации в интернете.</p>
<h4><a name="p-268-adm-filter-4" class="anchor" href="#p-268-adm-filter-4"></a>ADM Filter</h4>
<p>От компании <a href="https://www.adm-systems.com/">АМД СИСТЕМЫ</a><br>
<a class="attachment" href="результаты-тестирования-разных-dpi-роскомнадзором/itutpnvpPvY4kHMueRqjxNOov3p.pdf">ADM_Filter_2.1.9.25_2.2.13.pdf</a> (831.7 KB)</p>
<ul>
<li>Поставляется в виде программно-аппаратного комплекса</li>
<li>До 80 ГБит/с</li>
<li>Устанавливается только in-path</li>
<li>Также реализует родительский контроль и QoS</li>
<li>Поддержка HTTP/2 и QUIC</li>
</ul>
<blockquote>
<p>Фильтрация WEB-ресурсов выполняется путем поиска соответствия в списке Роскомнадзора по IP-адресу, доменному имени и полному указателю страницы.<br>
Список Роскомнадзора выгружается раз в час через XML-интерфейс.<br>
Блокировка по доменному имени выполняется в случае, если в XML-списке отсутствует полный указатель страницы. Блокировка по IP-адресу выполняется, если в XML-списке отсутствует и полный указатель страницы, и доменное имя ресурса.<br>
Проверка выполняется для фрагментированных IP-пакетов и сегментированных блоков данных на уровне TCP.</p>
</blockquote>
<h4><a name="p-268-zapretservice-5" class="anchor" href="#p-268-zapretservice-5"></a>ZapretService</h4>
<p>«Игрушечный» комплекс от компании <a href="http://www.zapretservice.ru/">ZapretService</a>.<br>
<strong>Доступна пробная версия, ISO-файл свободно скачивается с веб-сайта производителя!</strong><br>
<a class="attachment" href="результаты-тестирования-разных-dpi-роскомнадзором/41me1boAipzXX2HEVENEIoeoyoi.pdf">zapretservice_readme.pdf</a> (969.0 KB)</p>
<ul>
<li>Поставляется в виде ISO-образа для установки на обычные серверы</li>
<li>До 400 Мбит/с</li>
<li>In-path и on-path-подключение</li>
</ul>
<h4><a name="p-268-ideco-selecta-6" class="anchor" href="#p-268-ideco-selecta-6"></a>Ideco SELECTA</h4>
<p>DPI компании <a href="https://ideco.ru/">Ideco</a>.<br>
<a class="attachment" href="результаты-тестирования-разных-dpi-роскомнадзором/5RsUtr7wo3Nj1m80dHfCYAOfIdP.pdf">IdecoSelecta_Admin_Guide.pdf</a> (2.9 MB)<br>
<a class="attachment" href="результаты-тестирования-разных-dpi-роскомнадзором/s44hGnlSQg8obDUD7X5HTfOP8qh.pdf">SELECTA-140219-1954-6402.pdf</a> (2.9 MB)</p>
<ul>
<li>Поставляется в виде ISO-образа для установки на обычные серверы</li>
<li>До 40 Гбит/с</li>
<li>4 варианта установки: in-path, BGP, WCCP (GRE), режим роутера</li>
</ul>
<h4><a name="p-268-carbon-reductor-dpi-x-7" class="anchor" href="#p-268-carbon-reductor-dpi-x-7"></a>Carbon Reductor DPI X</h4>
<p>DPI компании <a href="https://www.carbonsoft.ru/">Carbon Soft</a><br>
<strong>Доступна пробная версия, ISO-файл и Flash-образ свободно скачивается с веб-сайта производителя!</strong><br>
<strong>Доступна <a href="http://docs.carbonsoft.ru/pages/viewpage.action?pageId=113115207">подробная документация от производителя</a></strong>.</p>
<ul>
<li>Поставляется в виде ISO-образа для установки на обычные серверы</li>
<li>Предназначен для обработки ~10 Гбит/с</li>
<li>Устанавливается только on-path</li>
<li>Осуществляет блокировку записей, заблокированных по IP-адресам и диапазонам, через BGP/OSPF, blackhole.</li>
<li><strong><a href="http://docs.carbonsoft.ru/display/REDUCTOR9/HTTP">Блокирует доменную зону целиком</a></strong> (если в реестр внесён домен второго уровня, то любой поддомен этого домена будет блокироваться)</li>
<li>Имеет интересный модуль <a href="http://docs.carbonsoft.ru/pages/viewpage.action?pageId=113737730#%D0%9C%D0%BE%D0%B4%D1%83%D0%BB%D1%8C%D0%B8%D0%BD%D1%82%D0%B5%D0%B3%D1%80%D0%B0%D1%86%D0%B8%D0%B8%D1%81DNS-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B0%D0%BC%D0%B8-%D0%98%D0%B7%D0%B1%D0%B5%D0%B6%D0%B0%D0%BD%D0%B8%D0%B5%D1%87%D0%B0%D1%81%D1%82%D0%B8%D1%87%D0%BD%D1%8B%D1%85%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BE%D0%BA%D0%BF%D0%BE%D0%BF%D1%83%D0%BB%D1%8F%D1%80%D0%BD%D1%8B%D1%85%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%BE%D0%B2">«Избежание частичных блокировок популярных ресурсов»</a>, исключающий из DNS-ответов заблокированные IP-адреса, если ответ содержит несколько адресов (заблокированных и незаблокированных в одном ответе).</li>
<li>Умеет <a href="http://docs.carbonsoft.ru/pages/viewpage.action?pageId=113115218#%D0%9D%D0%BE%D0%B2%D0%BE%D0%B5%D0%B2CarbonReductorDPIX-%D0%9D%D0%BE%D0%B2%D1%8B%D0%B5%D0%B2%D0%BE%D0%B7%D0%BC%D0%BE%D0%B6%D0%BD%D0%BE%D1%81%D1%82%D0%B8DPI">выявлять неизвестные протоколы</a> и <strong>отправляет информацию о них разработчику</strong></li>
</ul>
<p><em>Это сообщение всё ещё дописывается</em></p></td><td>2019-09-27T15:26:49.810Z</td></tr><tr><td>tango</td><td><aside class="quote no-group" data-username="ValdikSS" data-post="2" data-topic="126">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/valdikss/48/2_2.png" class="avatar"> ValdikSS:</div>
<blockquote>
<h4>Carbon Reductor DPI X</h4>
<p>DPI компании <a href="https://www.carbonsoft.ru/">Carbon Soft</a><br>
<strong>Доступна пробная версия, ISO-файл и Flash-образ свободно скачивается с веб-сайта производителя!</strong></p>
</blockquote>
</aside>
<p>Translation: “A trial version is available, an ISO file and a Flash image can be downloaded freely from the manufacturer’s website!”</p>
<p>This is a great find! About 40 GB of .iso and .img files (some of them duplicates) are available under the download directory:</p>
<ul>
<li><a href="https://download5.carbonsoft.ru/Carbon_install/" class="inline-onebox">Index of /Carbon_install</a> (<a href="https://web.archive.org/web/20190930164026/https://download5.carbonsoft.ru/Carbon_install/">Wayback archive</a>)</li>
</ul>
<p>Assuming this software runs on a standard PC or server, it could make a good subject for study. Perhaps you could install it (on an isolated network) and test how it handles various types of traffic. I would be interested in testing ValdikSS’s final bullet point:</p>
<ul>
<li>Умеет <a href="http://docs.carbonsoft.ru/pages/viewpage.action?pageId=113115218#%D0%9D%D0%BE%D0%B2%D0%BE%D0%B5%D0%B2CarbonReductorDPIX-%D0%9D%D0%BE%D0%B2%D1%8B%D0%B5%D0%B2%D0%BE%D0%B7%D0%BC%D0%BE%D0%B6%D0%BD%D0%BE%D1%81%D1%82%D0%B8DPI">выявлять неизвестные протоколы</a> и <strong>отправляет информацию о них разработчику</strong></li>
<li><em>It is able to <a href="http://docs.carbonsoft.ru/pages/viewpage.action?pageId=113115218#%D0%9D%D0%BE%D0%B2%D0%BE%D0%B5%D0%B2CarbonReductorDPIX-%D0%9D%D0%BE%D0%B2%D1%8B%D0%B5%D0%B2%D0%BE%D0%B7%D0%BC%D0%BE%D0%B6%D0%BD%D0%BE%D1%81%D1%82%D0%B8DPI">detect unknown protocols</a> and <strong>sends information about them to the developer</strong></em></li>
</ul>
<p>These are the sha256sums I got for the files available for download:</p>
<pre><code class="lang-auto">122953c1331b0907eb1c3188fe0d9ec359d28cfdd693718d33bc0b20b9d1f4ca  Carbon_Billing_x64.img
0c1f9505c5481e64f13f5c5507c9a48e6136cce7b2029f8b1c22fc2f91cc9e35  Carbon_Billing_x64.img.md5
122953c1331b0907eb1c3188fe0d9ec359d28cfdd693718d33bc0b20b9d1f4ca  Carbon_Billing_x64.iso
0c1f9505c5481e64f13f5c5507c9a48e6136cce7b2029f8b1c22fc2f91cc9e35  Carbon_Billing_x64.iso.md5
122953c1331b0907eb1c3188fe0d9ec359d28cfdd693718d33bc0b20b9d1f4ca  Carbon_Billing_x64.iso.upload
953eb4a76b14208c41fc376e58a1ba2cd7512e0a76a4934a701e41a0f8b1c6b9  Carbon_install_51393029.iso.md5
14c063d94d1430bf25b9c4668110f183f409e703d4f14690d9b9b3c08f38e43a  Carbon_install.iso
14c063d94d1430bf25b9c4668110f183f409e703d4f14690d9b9b3c08f38e43a  Carbon_Install.iso
13370ebeba065cced80904aa73133a9cd3b5b00edba01ef416f03f5690376228  Carbon_install.iso.md5
13370ebeba065cced80904aa73133a9cd3b5b00edba01ef416f03f5690376228  Carbon_Install.iso.md5
d67ef01894aaecd5ce6dfee1f63ef03ca3b6ddd343ff97d87e7158f5f8c98101  CarbonPlatform_devel_1.iso
970ad34a567b7d027528b3e163cfb1c435299fea01e7bebe373599273bab2ffc  Carbon_Reductor_integra_x64.iso.new
34b5f9e271ec7e873ca9bc81384fed95c04261d753b7ebf849e5e7aa9347ed55  Carbon_Reductor_integra_x64.iso.upload
bc5c5fb383cdbd2e86edaa031a48068acca5e604e927c77a7da1a9983bc35f7f  Carbon_Reductor_weirded_x64.iso
bc5c5fb383cdbd2e86edaa031a48068acca5e604e927c77a7da1a9983bc35f7f  Carbon_Reductor_weirded_x64.iso.upload
a42d7809f5eea053935f7f246d4c7cab6eca74c07543d6a571f3cc3ea7fe58df  Carbon_Reductor_x64.img
a62d347e6554bebc8be693b214cf1cdc460ec25a338c71c9370096c6fb9e3b3c  Carbon_Reductor_x64.img.md5
a42d7809f5eea053935f7f246d4c7cab6eca74c07543d6a571f3cc3ea7fe58df  Carbon_Reductor_x64.iso
a62d347e6554bebc8be693b214cf1cdc460ec25a338c71c9370096c6fb9e3b3c  Carbon_Reductor_x64.iso.md5
a42d7809f5eea053935f7f246d4c7cab6eca74c07543d6a571f3cc3ea7fe58df  Carbon_Reductor_x64.iso.upload
78982e954d4d00fc217063e0e229ff359aa87f78b219ad9a405def01f81da3d6  index.html
</code></pre></td><td>2019-10-03T02:33:53.766Z</td></tr><tr><td>ValdikSS</td><td><p>Actually I tested it several (2-3?) years ago a bit, in a VM. I remember running <a href="https://github.com/ValdikSS/blockcheck">blockcheck</a> on it, maybe goodbyedpi too.<br>
The software didn’t have functionality to detect unknown traffic at that time.</p>
<p>I believe they’ve added it when Telegram started to use MTProto proxies, because the wiki says:</p>
<blockquote>
<p><strong>“Euristic DPI” option</strong></p>
<p>With this option you can improve filtering quality of complex protocols, like the encrypted messengers’ traffic.<br>
With the aid of proactive analysis, Carbon Reductor DPI X is able to block only what’s needed, which would improve your customers’ Internet quality, decreasing the number of blocks due to indecent resources.<br>
<em>We’re discussing the details of this option with Roscomnadzor right now.</em></p>
</blockquote>
<p>Roscomnadzor was blocking my unencrypted HTTP proxy servers since November to the end of July, once in every 4-14 days. They’ve silently added IP addresses of the proxy servers to the registry, insisted that my IP addresses are used in Telegram infrastructure and refused to provide any details or proofs. I was running an experiment to understand what’s going on, how do they detect proxy servers and what triggers the detection.<br>
At that time, I had two hypotheses: either they get dump of all IP addresses and ports the customers visit (netflow), and then recheck every IP-port combination as HTTP proxy without authentication, or they get some kind of exported data from DPI manufacturer or from DPI itself (Telegram, if used with HTTP proxy, has a very distinct fingerprint: it just uses HTTP Post request with the pattern of <code>POST http://1.2.3.4:80/api</code>, at least the desktop version at that time).<br>
I tend to believe the latter during my experiment, and now I’m sure it was either Carbon Reductor or EcoDPI (Roscomnadzor’s “recommended DPI system”) data.</p></td><td>2019-10-03T03:42:50.899Z</td></tr>
    </table>
      </body>
    </html>
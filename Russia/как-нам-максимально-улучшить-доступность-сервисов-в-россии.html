
    <html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <style>
    th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      word-wrap: break-word;
      padding: 5px;
    }
    table {
      width: 100%;
      max-width: 100%;
      border: 1px solid black;
      border-collapse: collapse;
      table-layout: fixed;
      word-wrap: break-word
    }
    code {
      word-wrap: break-word;
    }
    pre {
        white-space: pre-wrap;
    }
    </style>
        <title>как-нам-максимально-улучшить-доступность-сервисов-в-россии</title>
      </head>
      <body>
        <table border="1" width="100%" cellpadding="5">
          <tr>
            <th style="width: 10%;">Ник</th>
            <th>Пост</th>
            <th style="width: 10%;">Дата</th>
          </tr>
    <tr><td>ValdikSS</td><td><p>English speakers, don’t forget about “translate” button (globe icon) at the bottom of every post.</p>
<p>Итак, элита, чтобы хоть как-то оставить интернет в России в работоспособном состоянии, не натыкаясь каждую минуту на неработающий домен, заблокированный IP-адрес или другие признаки Роскомнадзора, у меня назрели следующие мысли:</p>
<h3><a name="p-7249-h-1-dns-ip-1" class="anchor" href="#p-7249-h-1-dns-ip-1"></a>1. DNS-резолвер, получающий все возможные геораспределённые IP-адреса из других регионов</h3>
<p>Суть в следующем: резолвер, установленный локально или на удалённом сервере, делает рекурсивные запросы с разными адресами EDNS Client Subnet, а также через разные публичные резолверы в разных регионах, чтобы отдать клиенту максимально широкий набор потенциально доступных адресов.</p>
<p>Дополнительно резолвер может исключить заблокированные адреса из ответа (находящиеся в Реестре).</p>
<p>Такой резолвер позволит зайти на ресурс за заблокированным IP-адресом, не применяя туннелирование трафика без необходимости.</p>
<h3><a name="p-7249-h-2-dns-ip-2" class="anchor" href="#p-7249-h-2-dns-ip-2"></a>2. DNS-резолвер, переписывающий IP-адреса облачных сервисов, позволяющих обращаться по разным адресам</h3>
<p>Вариация пункта 1 для сайтов за Cloudflare и Amazon CloudFront. Эти сервисы спроектированы так, что позволяют подключаться к практически любому IP-адресу: DNS-резолвер может заменять IP-адреса из диапазона этих сервисов на статические, заведомо доступные и не заблокированные.</p>
<p>Диапазоны адресов доступны публично: для <a href="https://www.cloudflare.com/ips/">Cloudflare</a> и <a href="https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/LocationsOfEdgeServers.html">Cloudfront</a>.</p>
<p>Возможно, часть менее известных CDN-сервисов тоже позволяют такое обращение.</p>
<h3><a name="p-7249-h-3-happier-eyeballs-with-mouth-open-3" class="anchor" href="#p-7249-h-3-happier-eyeballs-with-mouth-open-3"></a>3. Happier eyeballs with mouth open</h3>
<p>Расширение алгоритма <a href="https://en.wikipedia.org/wiki/Happy_Eyeballs">Happy Eyeballs</a>, позволяющего программам подключаться сразу к IPv6 и IPv4-адресам, если IPv6 недоступен, чтобы уменьшить задержку перед открытием сайта.</p>
<p>Улучшение алгоритма заключается в установке сразу нескольких соединений в рамках одного протокола, не только к разным IPv4/IPv6, но и к одному адресу несколько раз: иногда один и тот же адрес может быть то доступен, то недоступен, из-за использования нескольких вышестоящих каналов провайдером. В некоторых случаях, выбором канала можно неявно управлять, например, если он осуществлятся в зависимости от номера исходящего порта.</p>
<p>Реализовать улучшение можно в прокси-серверах, например, в комбайне v2ray/v2fly.</p>
<hr>
<p>Наверняка что-то забыл, дополню пост, если вспомню. Слушаю вашу критику и встречные предложения.</p></td><td>2022-04-24T23:14:20.979Z</td></tr><tr><td>bolvan</td><td><p>Теоретически это возможно, но как любое “хакерское” и одновременно “простое” решение требует от “умных парней” постоянно обслуживать этот агрегат.<br>
Ибо постоянно ситуация меняется. Сейчас все активнее идет блокировка внереестровая, автоматизировать полностью не получится.<br>
Потребуется какой-то центральный сервер, откуда будут скачиваться правила для этой системы.<br>
К тому же от блокировок вообще это не панацея, поскольку везде DPI. Только от каких-то конкретных частных случаев, которых не так и много.<br>
Может разве что в составе goodbye dpi.  Все зависит от целевой аудитории. Если надо, чтобы “нажал и заработало”, то нужно какое-то интегрированное решение</p>
<p>Еще какая проблема может быть. Если начать давать неоптимизированные IP от ютуба, то скорость может упасть очень сильно, а следовательно и качество. Ведь не просто так используется оптимизация по geo. И не только ютуба это касается</p></td><td>2022-04-25T06:15:43.452Z</td></tr><tr><td>ValdikSS</td><td><aside class="quote no-group" data-username="bolvan" data-post="2" data-topic="2323">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/b/8e8cbc/48.png" class="avatar"> bolvan:</div>
<blockquote>
<p>Может разве что в составе goodbye dpi. Все зависит от целевой аудитории. Если надо, чтобы “нажал и заработало”, то нужно какое-то интегрированное решение</p>
</blockquote>
</aside>
<p>Предполагается некий комплекс. Не обязательно в составе GoodbyeDPI; то, что описано выше, вообще скорее для выборочных VPN.</p>
<aside class="quote no-group" data-username="bolvan" data-post="2" data-topic="2323">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/b/8e8cbc/48.png" class="avatar"> bolvan:</div>
<blockquote>
<p>Если начать давать неоптимизированные IP от ютуба, то скорость может упасть очень сильно, а следовательно и качество.</p>
</blockquote>
</aside>
<p>Считаю, что это всё равно лучше, чем маршрутизировать трафик через VPN.</p></td><td>2022-04-26T21:00:45.810Z</td></tr><tr><td>ValdikSS</td><td><p>Вынес на всеобщее обозрение.</p></td><td>2022-04-26T21:00:57.389Z</td></tr><tr><td>bolvan</td><td><aside class="quote no-group" data-username="ValdikSS" data-post="3" data-topic="2323">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/valdikss/48/2_2.png" class="avatar"> ValdikSS:</div>
<blockquote>
<p>Считаю, что это всё равно лучше, чем маршрутизировать трафик через VPN.</p>
</blockquote>
</aside>
<p>Это лучше, когда нет иной альтернативы<br>
А по нормальному надо сначала проверять какие IP из оптимизированных доступны, и если такие есть - выдавать их. И только если их нет, выдавать другие. И то, желательно их как-то упорядочить хотя бы по geoip, чтобы не давать для юзеров из RU американские IP<br>
Причем на разных провайдерах ситуация может быть разной<br>
Вот о чем и хотел сказать. Что если начать раскручивать идею, не все так просто получается</p></td><td>2022-04-27T06:18:14.464Z</td></tr><tr><td>Elevator</td><td><p>К перечисленным выше пунктам добавлю вариант с DPI. На хабре уже была статья как сделать “домашний” DPI на базе nginx. На мой взгляд сильно упростит обход блокировок, а также позволит создать базу заблокированных ip и доменов по sni. Конечно это не решает вопрос с прокси/vpn, но жить без автоматизации с каждым годом будет все тяжелее.</p></td><td>2022-04-27T08:53:25.235Z</td></tr><tr><td>ValdikSS</td><td><p>Вы имеете в виду некий автоматический метод определения доступности сайтов? Как вы это видите?</p></td><td>2022-04-27T13:50:46.777Z</td></tr><tr><td>Elevator</td><td><p>Да.<br>
Примерно так:<br>
1)Пользователь заходит на сайт<br>
2)Если соединение сбрасывается через tcp reset, timeout (настраиваемое значение) или происходит подмена сертификата то проверяем в фоне curl’ом через vpn.<br>
3)Если через vpn сайт открывается то уведомляем пользователя что сайт доступен через vpn и предлагаем добавить домен/ip в исключения. На этом этапе также можно собирать статистику по заблокированным доменам/ip.<br>
Теоретически можно написать сколько угодно сложную логику проверки.</p>
<p>Единственная проблема это нагрузка на систему пользователя. Т.к придеться проверять все соединения.</p>
<p>Статья на хабре <a href="https://habr.com/ru/post/548110/" rel="noopener nofollow ugc">Домашний DPI</a></p></td><td>2022-04-27T14:07:41.178Z</td></tr>
    </table>
      </body>
    </html>
[
    {
        "id": 4320,
        "name": "",
        "username": "critical_error",
        "avatar_template": "/letter_avatar_proxy/v4/letter/c/898d66/{size}.png",
        "created_at": "2021-10-20T18:49:24.351Z",
        "cooked": "<p>I rechecked my packet captures. I set aside my notices about blocking inside Teredo tunnels (I’m not sure I interpreted these network flows right) and updated the information. Below is my draft, beware of my English!<br>\n<strong>Ugly shaping, false FINs, and annoying RSTs. Notes on World Wide Web filtering in Uzbekistan</strong><br>\nMy observations on how local authorities censor the World Wide Web are very limited. From time to time I have to start a network sniffer to investigate some seemingly absurd network problems. Later these appear to be our new Internet restrictions according to an ‘Uzbekistan’ page of the annual ‘<em>Freedom on the Net</em>’ report by <em>Freedom House</em>. I can summarize what I stumble upon as follows.<br>\n<strong>1. Shaping the traffic for Internet censorship</strong> First noted around 2018 as a Facebook problem, traffic shaping is trending as a filtering technology here. Some connections, which where interrupted or routed to nowhere previously, are now rate limited to turn useless.<br>\nBandwidth limiting is aggressive. It starts from the very first packets. Curl’ing a blocked resource with an -m  option often ends just immediately, as no TCP connection could be established at all. Segments are being lost in both directions. A TCP flow diagram, if any, looks really horrible. Twitter, Viber, Skype, and mobile devices’ power supply units are among the affected.<br>\n<strong>2. Blocking TLS connections by injection of TCP segments with the FIN flag set in reply to the ‘<em>Client Hello</em>’ messages</strong> It’s still a popular filtering technique, entirely SNI-based. TLS 1.0, 1.2 SNI-less connections to banned resources are not interrupted and do work as needed.<br>\nFIN segments inserted have right syn and ask values, but are still distinguishable by their weird timing (they come too fast to originate from a server abroad), ‘random’ IP IDs, and non-empty data (proudly reporting some ‘<em>Middlebox v 1.0</em>’ usage as a plain text string).<br>\nDropping these SYNs with nftables causes them to be reinserted several times with one second delay, followed by the final RST segment. The later comes with right syn and ask values and no data, albeit again it has a ‘random’ IP ID and follows the same single second temporal pattern.<br>\nNo data from the remote server appear in between these injected segments. That points to the next level of filtering equipment installed in-path.<br>\nSome times ago I also noticed forceful setting of FIN flags in what looked like genuine remote server replies to the ‘<em>Client Hello</em>’ messages. No in-path blocking equipment was seen in such cases. I don’t know, whether such blocking method is being employed now.<br>\n<strong>3. RSTing TCP connections</strong> It’s used, probably, for non-TLS TCP connections our state censors want to interrupt. Injected segments again have proper syn and ask values and no data. They come too fast to originate from a remote server and possess ‘random’ IP IDs.<br>\nAs of what is being blocked in Uzbekistan one could look at country’s <em>OONI</em> (<em>OONI</em> forever!) profile. To put the things into context I’d recommend the already mentioned collection of ‘<em>Freedom on the Net</em>’ reports on Uzbekistan (by <em>The Freedom House</em>).</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 2,
        "updated_at": "2021-10-20T18:54:17.995Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 16,
        "reads": 19,
        "readers_count": 18,
        "score": 83.8,
        "yours": false,
        "topic_id": 1406,
        "topic_slug": "can-we-have-an-uzbekistan-group-inside-internet-censorship-around-the-world-category",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 518,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/can-we-have-an-uzbekistan-group-inside-internet-censorship-around-the-world-category/1406/1",
        "can_translate": false
    },
    {
        "id": 4323,
        "name": null,
        "username": "ValdikSS",
        "avatar_template": "/user_avatar/ntc.party/valdikss/{size}/2_2.png",
        "created_at": "2021-10-20T19:15:30.308Z",
        "cooked": "<p>Done</p><aside class=\"onebox category-onebox\" style=\"box-shadow: -5px 0px #0088CC;\">\n  <article class=\"onebox-body category-onebox-body\">\n    <h3>\n      <a class=\"badge-wrapper bullet\" href=\"/c/internet-censorship-all-around-the-world/uzbekistan/35\">\n          <span class=\"badge-category-bg\" style=\"background-color: #0088CC\"></span>\n        <span class=\"clear-badge\"><span>Uzbekistan</span></span>\n      </a>\n    </h3>\n  </article>\n  <div class=\"clearfix\"></div>\n</aside>\n",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 2,
        "updated_at": "2021-10-20T19:15:30.308Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 18,
        "readers_count": 17,
        "score": 8.6,
        "yours": false,
        "topic_id": 1406,
        "topic_slug": "can-we-have-an-uzbekistan-group-inside-internet-censorship-around-the-world-category",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "AntiZapret staff",
        "title_is_group": false,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": true,
        "staff": true,
        "user_id": 1,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/can-we-have-an-uzbekistan-group-inside-internet-censorship-around-the-world-category/1406/2",
        "can_translate": false
    }
]
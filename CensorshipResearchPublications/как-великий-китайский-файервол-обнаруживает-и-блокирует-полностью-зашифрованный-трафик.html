
    <html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <style>
    th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      word-wrap: break-word;
      padding: 5px;
    }
    table {
      width: 100%;
      max-width: 100%;
      border: 1px solid black;
      border-collapse: collapse;
      table-layout: fixed;
      word-wrap: break-word
    }
    code {
      word-wrap: break-word;
    }
    pre {
        white-space: pre-wrap;
    }
    </style>
        <title>как-великий-китайский-файервол-обнаруживает-и-блокирует-полностью-зашифрованный-трафик</title>
      </head>
      <body>
        <table border="1" width="100%" cellpadding="5">
          <tr>
            <th style="width: 10%;">Ник</th>
            <th>Пост</th>
            <th style="width: 10%;">Дата</th>
          </tr>
    <tr><td>runetchecker</td><td><p>Сжатый перевод свежего исследования Great Firewall Report<br>
Источник перевода: <a href="https://roskomsvoboda.org/post/chinese-firewall/" rel="noopener nofollow ugc">https://roskomsvoboda.org/post/chinese-firewall/</a></p>
<p>Одним из основых механизмов в обходе цензуры являются полностью зашифрованные протоколы, которые шифруют каждый байт полезной нагрузки в стремлении «выглядеть как ничто» (look like nothing). Например, полностью зашифрованные (рандомизированные) протоколы – такие как <a href="https://www.v2fly.org/en_US/developer/protocols/vmess.html" rel="noopener nofollow ugc">VMess</a>, <a href="https://shadowsocks.org/guide/aead.html" rel="noopener nofollow ugc">Shadowsocks</a> и <a href="https://gitlab.com/yawning/obfs4/blob/master/doc/obfs4-spec.txt" rel="noopener nofollow ugc">Obfs4</a> – разработаны таким образом, что каждый байт в соединении функционально неотличим от случайного. Идея этих протоколов «выглядеть как ничто» заключается в том, что цензорам должно быть сложно снять отпечатки пальцев и, следовательно, дорого блокировать их. Однако в начале ноября 2021 года Великий Китайский Файервол (Great Firewall of China, GFW) развернул <strong>новую технологию цензуры, которая пассивно обнаруживает и впоследствии блокирует полностью зашифрованный трафик в режиме реального времени</strong>. Новая цензурная способность GFW затрагивает большой набор популярных протоколов обхода цензуры, включая, помимо прочего, Shadowsocks, VMess и Obfs4. Хотя Китай уже давно ведёт активную проверку таких протоколов, это первое сообщение о полностью «пассивном» обнаружении, что заставляет сообщество противников цензуры задаться вопросом, как такое обнаружение стало возможным. Эти материалы стали известны после публикации <a href="https://gfw.report/publications/usenixsecurity23/en/" rel="noopener nofollow ugc">Great Firewall Report</a>, авторы которого проделали огромную работу для раскрытия механизмов работы китайской цензуры.</p>
<h2>
<a name="h-1" class="anchor" href="#h-1"></a>Бэкграунд</h2>
<p>В атаках активного зондирования цензор посылает хорошо подготовленные полезные нагрузки на подозреваемый сервер и измеряет его реакцию. <strong>Если сервер отвечает на эти запросы идентифицируемым образом (например, позволяет цензору использовать его в качестве прокси), цензор может его заблокировать.</strong> Ещё в августе 2011 года было замечено, что GFW посылает кажущиеся случайными нагрузки на иностранные SSH-серверы, которые <a href="https://www.nsc.liu.se/~nixon/sshprobes.html" rel="noopener nofollow ugc">принимают SSH-логины из Китая</a>. В 2012 году GFW сначала искал уникальный шифр TLS для идентификации трафика Tor; затем он отправлял активные зонды на подозрительные серверы для подтверждения <a href="https://www.usenix.org/system/files/conference/foci12/foci12-final2.pdf" rel="noopener nofollow ugc">своей догадки</a>. В 2015 году Энсафи и др. <a href="http://conferences2.sigcomm.org/imc/2015/papers/p445.pdf" rel="noopener nofollow ugc">провели подробный анализ активных зондирующих атак GFW на различные протоколы</a>. С мая 2019 года Китай развернул систему цензуры для обнаружения и блокировки серверов Shadowsocks в два этапа: сначала она использует длину и энтропию полезной нагрузки первого пакета в каждом соединении для пассивной идентификации возможного трафика Shadowsocks, а затем отправляет различные зонды, на разных этапах, на подозреваемые серверы для подтверждения своих догадок. Таким образом, это первый случай, когда цензура могла массово блокировать полностью зашифрованные прокси в режиме реального времени, полностью основываясь на пассивном анализе трафика.</p>
<p>Для выводов, представленных в Докладе <a href="https://gfw.report/publications/usenixsecurity23/en/" rel="noopener nofollow ugc">Great Firewall Report</a> (далее – Доклад) была проведена серия экспериментов, чтобы понять, как GFW обнаруживает и блокирует полностью зашифрованные соединения. <strong>Исследователи создавали и отправляли различные тестовые зонды между хостами в Китае и за его пределами, позволяя им быть замеченными GFW. Они наблюдали за реакцией GFW, перехватывая и сравнивая трафик на каждой стороне</strong>. Для проведения экспериментов использовалось три VPS в Китае и три sink-сервера в США. В тот же период также использовали один VPS в AlibabaCloud Beijing (AS37963) для повторения всех экспериментов. Такое протоколирование позволило им выявить любые отброшенные или манипулированные пакеты, а также активные зонды.</p>
<p>Исследователи не заметили никаких различий в поведении цензуры между собственными точками наблюдения в Китае или любой затронутой внешней точкой наблюдения. 16 февраля 2023 года они повторили эксперименты и подтвердили, что все правила обнаружения остаются в силе. На этот раз мы использовали один VPS в TencentCloud BJ и один стоковый сервер в DigitalOcean SFO. Подробнее о методологии можно прочитать в <a href="https://gfw.report/publications/usenixsecurity23/data/paper/paper.pdf" rel="noopener nofollow ugc">Докладе</a>.</p>
<h2>
<a name="h-2" class="anchor" href="#h-2"></a>Стратегии блокирования</h2>
<p>Исследователи выяснили, какой стратегии блокирования придерживается GFW при анализе трафика. В результате 10%-го сканирования Интернета было обнаружено 109 489 IP-адресов, которые учёные пометили как заблокированные. Как показывает оценка вероятности блокировки, распределение количества успешных случайных соединений с данными, которые мы можем сделать с каждым IP-адресом, прежде чем он будет заблокирован, соответствует геометрическому распределению. Этот результат позволяет предположить, что блокировка каждого соединения происходит независимо, с вероятностью 26,3 %</p>
<p>Почему используется вероятностная блокировка. <strong>Исследователи предполагают, что цензор использует вероятностную блокировку, возможно, по двум причинам: во-первых, это позволяет цензору проверять только одну четвертую часть соединений, сокращая вычислительные ресурсы. Во-вторых, это помогает цензору уменьшить побочный ущерб, наносимый соединениям без обхода.</strong> Хотя это сокращение также происходит за счёт снижения истинно положительных результатов, остаточная цензура может компенсировать это: как только соединение определяется как заблокированное, последующие соединения также блокируются в течение нескольких минут после этого, что затрудняет успешное подключение пользователей прокси после обнаружения. Это также может подтвердить предыдущие утверждения о том, что цензоры уделяют больше внимания снижению числа ложных срабатываний, чем <a href="https://www.eecs.berkeley.edu/~sa499/papers/oakland2016.pdf" rel="noopener nofollow ugc">достижению высокого числа истинных срабатываний</a>.</p>
<p><strong>Таким образом, вместо того чтобы напрямую определять, что такое полностью зашифрованный трафик, цензор применяет топорную, но эффективную интуицию для исключения трафика, который вряд ли является полностью зашифрованным трафиком, а затем он блокирует оставшийся неисключённый трафик.</strong> Эти эвристики основаны на «отпечатках пальцев» распространенных протоколов, доле установленных битов, количестве, доле и положении печатаемых символов ASCII. Сканирование Интернета показывает, какой трафик и какие IP-адреса проверяет GFW. Алгоритм обнаружения GFW моделируется на живом трафике университетского сетевого экрана, чтобы оценить его полноту и количество ложных срабатываний.</p>
<h2>
<a name="h-3" class="anchor" href="#h-3"></a>Выводы</h2>
<p>В Докладе исследователи раскрыли и изучили новейшую китайскую систему цензуры, которая динамически блокирует полностью зашифрованный трафик в режиме реального времени. Эта новая мощная форма цензуры частично или полностью затронула многие основные инструменты обхода, включая Shadowsocks, Outline, VMess, Obfs4, Lantern, Phiphon и Conjure. В итоге понимание этой новой системы цензуры позволило исследователям вывести несколько стратегий обхода. Они представляют две контрмеры, которые помогают пользователям в Китае и разработчикам антицензурных решений: Customizable Payload Prefixes и Altering Popcount. Подробнее о них вы можете прочитать в полной версии <a href="https://gfw.report/publications/usenixsecurity23/en/" rel="noopener nofollow ugc">Доклада</a>.</p>
<p>Оригинал от Great Firewall Report -  <a href="https://gfw.report/publications/usenixsecurity23/en/" class="inline-onebox" rel="noopener nofollow ugc">How the Great Firewall of China Detects and Blocks Fully Encrypted Traffic</a></p></td><td>2023-05-02T14:48:23.630Z</td></tr><tr><td>anon94384997</td><td><p>Полностью зашифрованный трафик довольно неоднозначная формулировка. Есть трафик, который выглядит как “мусор” (случайные данные), а есть трафик, который имеет заголовки TLS (маскируется под стандартный HTTPS) и уже внутри него прячется VPN. Но похоже, что затронуло всех.</p></td><td>2023-05-02T17:20:10.379Z</td></tr><tr><td>tango</td><td><p>The “fully encrypted” label is a relatively recent one, proposed by <a href="https://www.petsymposium.org/foci/2023/foci-2023-0004.php">" Security Notions for Fully Encrypted Protocols"</a>. Some people have adopted it as an alternative to “looks-like-nothing” protocols or “fully randomized” protocols. It includes protocols that try to present a uniformly random byte stream, even if they fail at indistinguishability according to the definitions in the Fenske and Johnson paper. So it include things like Shadowsocks, VMess, obfs4; but not TLS, WireGuard, etc.</p></td><td>2023-06-11T04:20:52.253Z</td></tr>
    </table>
      </body>
    </html>
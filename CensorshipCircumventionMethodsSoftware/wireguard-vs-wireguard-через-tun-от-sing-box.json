[
    {
        "id": 19508,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2023-11-01T08:28:57.284Z",
        "cooked": "<p>Запускаю wireguard на сервере и подключаюсь с клиента в обычной стандартной конфигурации и в итоге скорость интернета через туннель печальная, но если создать на сервере правило маршрутизации wg в tun от sing-box (freedom outbound), то скорость интернета через туннель на клиенте возрастает почти до максимальной.<br>\nЯ так понимаю при таком конфиге сам сервер начинает устанавливать tcp соединения, а не просто гнать трафик по маршруту, и скорость возрастает из-за tcp congestion control (bbr). Так вот есть ли какие-то более дешевые способы сделать похожее через wireguard? Нагрузка на цп сильно возрастает из-за singbox, может есть какой-то похожий софт?</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 8,
        "updated_at": "2024-09-17T12:07:04.329Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 857,
        "reads": 106,
        "readers_count": 105,
        "score": 4306.2,
        "yours": false,
        "topic_id": 6160,
        "topic_slug": "wireguard-vs-wireguard-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-tun-%D0%BE%D1%82-sing-box",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/wireguard-vs-wireguard-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-tun-%D0%BE%D1%82-sing-box/6160/1",
        "can_translate": false
    },
    {
        "id": 19519,
        "name": "andy",
        "username": "spirt",
        "avatar_template": "/user_avatar/ntc.party/spirt/{size}/3874_2.png",
        "created_at": "2023-11-01T09:48:55.017Z",
        "cooked": "<p>Попробуйте в конфигах wg добавить MTU = 1492.  и вообще потестить на уменьшение mtu.</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 8,
        "updated_at": "2023-11-01T10:02:39.009Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 105,
        "readers_count": 104,
        "score": 21.0,
        "yours": false,
        "topic_id": 6160,
        "topic_slug": "wireguard-vs-wireguard-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-tun-%D0%BE%D1%82-sing-box",
        "display_username": "andy",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 2764,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/wireguard-vs-wireguard-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-tun-%D0%BE%D1%82-sing-box/6160/2",
        "can_translate": false
    },
    {
        "id": 19521,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2023-11-01T10:11:35.382Z",
        "cooked": "<p>1492 это выход за рамки, если на интернет интерфейсе (или роутере) стоит mtu 1500, то максимальный mtu внутри ipv4 wg не может быть выше 1440 (который у меня и стоит, уменьшение только снижает скорость как и положено)</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 8,
        "updated_at": "2023-11-01T10:16:24.746Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 103,
        "readers_count": 102,
        "score": 35.6,
        "yours": false,
        "topic_id": 6160,
        "topic_slug": "wireguard-vs-wireguard-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-tun-%D0%BE%D1%82-sing-box",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/wireguard-vs-wireguard-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-tun-%D0%BE%D1%82-sing-box/6160/3",
        "can_translate": false
    },
    {
        "id": 19524,
        "name": "andy",
        "username": "spirt",
        "avatar_template": "/user_avatar/ntc.party/spirt/{size}/3874_2.png",
        "created_at": "2023-11-01T10:33:07.927Z",
        "cooked": "<p>у меня “чистый” wg вообще не требует манипуляций с mtu. а вот его обертки в разные штуки постоянно ругаются на оверсайсз. при этом скорость падает раза в 2-3.  уменьшение mtu в этих случаях повышает скорость, как и положено ) ваш случай просто мне показался очень похожем на проблемы с mtu )</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 8,
        "updated_at": "2023-11-01T10:36:29.313Z",
        "reply_count": 1,
        "reply_to_post_number": 3,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 102,
        "readers_count": 101,
        "score": 35.4,
        "yours": false,
        "topic_id": 6160,
        "topic_slug": "wireguard-vs-wireguard-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-tun-%D0%BE%D1%82-sing-box",
        "display_username": "andy",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "reply_to_user": {
            "username": "0ka",
            "name": "0ka",
            "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 2764,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/wireguard-vs-wireguard-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-tun-%D0%BE%D1%82-sing-box/6160/4",
        "can_translate": false
    },
    {
        "id": 19526,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2023-11-01T10:37:39.122Z",
        "cooked": "<p>по дефолту в wg mtu 1420 который и не требует манипуляций на большинстве сетей</p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 8,
        "updated_at": "2023-11-01T10:37:39.122Z",
        "reply_count": 0,
        "reply_to_post_number": 4,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 94,
        "readers_count": 93,
        "score": 23.8,
        "yours": false,
        "topic_id": 6160,
        "topic_slug": "wireguard-vs-wireguard-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-tun-%D0%BE%D1%82-sing-box",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "spirt",
            "name": "andy",
            "avatar_template": "/user_avatar/ntc.party/spirt/{size}/3874_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/wireguard-vs-wireguard-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-tun-%D0%BE%D1%82-sing-box/6160/5",
        "can_translate": false
    },
    {
        "id": 19673,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2023-11-04T12:44:33.563Z",
        "cooked": "<p>ничего другого похожего не нашел и решил оставить sing-box, но часто появляется плавающий баг: новые соединения перестают устанавливаться (curl зависает на trying…), в логах системы и sing-box при этом ничего необычного. попробую поставить сокс сервер и tun2socks вместо одного sing-box</p>\n<p>upd: <a href=\"https://github.com/heiher/hev-socks5-tunnel\">hev-socks5-tunnel</a> и <a href=\"https://github.com/heiher/hev-socks5-server\">hev-socks5-server</a> вместе не дают нужного эффекта, как будто системный tcp или его настройки не используются. <a href=\"https://github.com/heiher/hev-socks5-tunnel\">hev-socks5-tunnel</a> и sing-box с socks в итоге пинг на wg клиентах становится 2x, системный tcp используется но скорость все равно ужасна. Походу придётся смириться или поверх wg пускать уже какой-то другой протокол (hysteria? от wg отказываться не хочу, уж очень удобен)</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 8,
        "updated_at": "2023-11-05T14:58:41.868Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 8,
        "reads": 84,
        "readers_count": 83,
        "score": 56.8,
        "yours": false,
        "topic_id": 6160,
        "topic_slug": "wireguard-vs-wireguard-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-tun-%D0%BE%D1%82-sing-box",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://github.com/heiher/hev-socks5-tunnel",
                "internal": false,
                "reflection": false,
                "title": "GitHub - heiher/hev-socks5-tunnel: A high-performance tun2socks for Linux/Android/FreeBSD/macOS/iOS (IPv4/IPv6/TCP/UDP)",
                "clicks": 6
            },
            {
                "url": "https://github.com/heiher/hev-socks5-server",
                "internal": false,
                "reflection": false,
                "title": "GitHub - heiher/hev-socks5-server: A simple, lightweight socks5 server for Unix (Linux/BSD/macOS)",
                "clicks": 4
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/wireguard-vs-wireguard-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-tun-%D0%BE%D1%82-sing-box/6160/6",
        "can_translate": false
    },
    {
        "id": 19803,
        "name": null,
        "username": "ValdikSS",
        "avatar_template": "/user_avatar/ntc.party/valdikss/{size}/2_2.png",
        "created_at": "2023-11-08T23:24:19.774Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"0ka\" data-post=\"1\" data-topic=\"6160\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/0/d78d45/48.png\" class=\"avatar\"> 0ka:</div>\n<blockquote>\n<p>может есть какой-то похожий софт</p>\n</blockquote>\n</aside>\n<p>tpws zapret’а, по идее, может работать в таком режиме. Он использует splice для проксирования сокетов, должно создавать минимум нагрузки на CPU.</p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 8,
        "updated_at": "2023-11-08T23:24:19.774Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 1,
        "incoming_link_count": 3,
        "reads": 77,
        "readers_count": 76,
        "score": 30.4,
        "yours": false,
        "topic_id": 6160,
        "topic_slug": "wireguard-vs-wireguard-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-tun-%D0%BE%D1%82-sing-box",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "AntiZapret staff",
        "title_is_group": false,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": true,
        "staff": true,
        "user_id": 1,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/wireguard-vs-wireguard-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-tun-%D0%BE%D1%82-sing-box/6160/7",
        "can_translate": false
    },
    {
        "id": 21317,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2023-12-29T14:00:29.858Z",
        "cooked": "<p>попробовал tpws, tcptp-booster, xray. Использовал iptables redirect, и еще сделал небольшой бенч <code>time curl https://1.1.1.1/cdn-cgi/trace</code>, который грубо говоря выдает время загрузки сайта</p>\n<p>прямое подключение: бенч выдает 330ms real</p>\n<p>tpws: маленькое потребление цп. Иногда в dmesg вижу сообщения о syn flood, решением будет запуск нескольких tpws и load balance через iptables -m statistic. На моей системе есть неопределенный баг с 100% потреблением цп если использовать iptables tproxy. бенч выдает 430ms real</p>\n<p>tcptp-booster: маленькое потребление цп (<a href=\"https://github.com/bol-van/zapret/issues/168#issuecomment-1868881690\">спорно</a>), бенч выдает 530ms real.</p>\n<p>xray: большое потребление цп, по умолчанию нет защиты от петли (при обычном tcp подключении к порту прокси начинает потреблять 100% цп), бенч выдает 330ms</p>\n<p>sing-box с tun отбросил из-за неопределенного бага, из-за которого иногда не устанавливались новые соединения (curl рандомно зависал)</p>\n<p>решил остановиться на xray для постоянного использования</p>\n<p><small>для гугл поиска: udp vpn tcp bbr boost</small></p>",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 8,
        "updated_at": "2023-12-29T14:06:30.709Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 12,
        "reads": 67,
        "readers_count": 66,
        "score": 73.4,
        "yours": false,
        "topic_id": 6160,
        "topic_slug": "wireguard-vs-wireguard-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-tun-%D0%BE%D1%82-sing-box",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://github.com/bol-van/zapret/issues/168#issuecomment-1868881690",
                "internal": false,
                "reflection": false,
                "title": "tpws request_sock_TCP: Possible SYN flooding on port 65530 · Issue #168 · bol-van/zapret · GitHub",
                "clicks": 2
            },
            {
                "url": "https://ntc.party/t/%D0%BE%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F-tcp-%D0%B4%D0%BB%D1%8F-%D1%81%D0%B5%D1%82%D0%B5%D0%B9-%D1%81-%D0%B2%D1%8B%D1%81%D0%BE%D0%BA%D0%BE%D0%B9-%D0%B7%D0%B0%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D0%BE%D0%B9-%D0%BF%D0%BE%D1%82%D0%B5%D1%80%D1%8F%D0%BC%D0%B8-jitter/6692/8",
                "internal": true,
                "reflection": true,
                "title": "Оптимизация TCP для сетей с высокой задержкой, потерями, jitter?",
                "clicks": 4
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/wireguard-vs-wireguard-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-tun-%D0%BE%D1%82-sing-box/6160/8",
        "can_translate": false
    }
]
[
    {
        "id": 55037,
        "name": "Ivan",
        "username": "Fanarill",
        "avatar_template": "/letter_avatar_proxy/v4/letter/f/6a8cbe/{size}.png",
        "created_at": "2024-10-15T09:23:21.409Z",
        "cooked": "<p>Всех приветствую.</p>\n<p>Сразу скажу цель всего моего деяния: хочу подключаться к VPS по VPN, а далее трафик который идет к VPS пусть по второму VPN (сервера Cloudflare, конфиг к которому сгенерен через wgcf). У меня было несколько фундаментально разных попыток сделать это.</p>\n<p>Попытка 1:<br>\nУ меня есть VPS, у нее есть три интерефейса: wg0, wg1, eth0.</p>\n<p>К VPS я подключаюсь через wg0, а wg1 - это WireGuard подключаемый к серверам Cloudflare.</p>\n<p>То есть я хочу сделать цепочку вида:</p>\n<p>Local PC (connects with wg0) → VPS → (connects with wg1) → Cloudflare → Destination.</p>\n<p>Мой VPS выступает как будто в роли proxy, но хочу я это сделать через VPNы. Единственная проблема - я могу настроить, только Local PC и VPS.</p>\n<p>Когда включаю оба интерфейса wg1 и wg0, то wg0 может совершать хендшейки, но перенаправлять трафик между ними я не осилил. Я каким-то образом видимо должен nat правильно настроить?..</p>\n<p>Для настройки интерфейсов, использую я iptables и wg-quick, иногда ip. Если не использовать wg1 и использовать настройку рода iptables -t nat -A POSTROUTING -j MASQUERADE -o eth0, то цепочка становится рабочей и выглядит так:</p>\n<p>Local PC (connects with wg0) → VPS (connects with eth0) → Destination.</p>\n<p>Возможно ли сделать, то что я хочу (перенаправить трафик далее на второй vpn)? Ну и повторяю проблему - нет доступа к настройкам сервера cloudflare.</p>\n<p>Попытка 2:<br>\nВместо того, чтобы поддерживать 2 интерфейса с VPN - я объединил их в один. То есть взял конфиг с wg1 (который к cloudflare подключается), и напихал туда своих пиров, и пирам раскидал публичный ключ этого интерфейса, который легко восстанавливается из приватного.</p>\n<p>Тогда конфиг для сервера выглядит следующим образом:</p>\n<pre><code class=\"lang-auto\">\n[Interface]\nPrivateKey = &lt;key&gt;\nAddress = 172.16.0.2/32\nAddress = 2606:4700:110:8f92:848e:9ae:5e1f:db28/128\nListenPort = 33333\nDNS = 1.1.1.1\nMTU = 1280\n#Table = 123\n\n#PostUp = sysctl -w net.ipv4.ip_forward=1\n#PostUp = ip rule add iif wg1 table 123 priority 456\n#PostDown = ip rule del iif wg1 table 123 priority 456\n#PostUp = sysctl -w net.ipv6.conf.all.forwarding=1\n#PostUp = ip -6 rule add iif wg1 table 123 priority 456\n#PostDown = ip -6 rule del iif wg1 table 123 priority 456\n\n[Peer]\nPublicKey = &lt;key&gt;\nAllowedIPs = 0.0.0.0/0, ::/0\nEndpoint = engage.cloudflareclient.com:&lt;port&gt;\n\n[Peer]\nPublicKey = &lt;key&gt;\nAllowedIPs = 172.16.0.3/32\nEndpoint = &lt;ip&gt;:&lt;port&gt;\n</code></pre>\n<p>Конфиг для клиента остался тем же (только публичный ключ у пира поменялся):</p>\n<pre><code class=\"lang-auto\">[Interface]\nAddress = 172.16.0.3/24\nListenPort = 33333\nPrivateKey = &lt;key&gt;\n\n[Peer]\nPublicKey = &lt;key&gt;\nAllowedIPs = 0.0.0.0/0, ::/0\nEndpoint = &lt;ip&gt;:33333\n</code></pre>\n<p>Теперь даже хендшейков не происходит. Пытался делать в аналогии с <a href=\"https://www.procustodibus.com/blog/2022/06/multi-hop-wireguard/\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Multi-Hop WireGuard | Pro Custodibus</a>, но моя проблема естественно, что я не могу настроить что-то на серверах cloudflare. То есть сервер cloudflare для меня черный ящик…<br>\nНекоторые настройки закоментированы, потому что, что с ними что без не работает, хотя поведение разное…</p>\n<p>====================================</p>\n<p>Я не пробовал жестко дебагать, потому что не умею в это, с сетями слаб, если кто-то что может посоветовать буду рад. Про дебагать я имею ввиду следующее: возможно мне хотелось бы уметь полностью отследить пришел ли пакет, прошел ли он через routing table, перешел ли в другой интерфейс, в корректном состоянии он или нет и т.д.</p>\n<p>Ну и в целом вопрос можно ли реализовать то, что я хочу? Может я вообще фигню пытаюсь сделать…</p>\n<p>Короче нужна ваша помощь. Сам уже не справлюсь, силы на исходе)</p>\n<p>Заранее спасибо!</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 13,
        "updated_at": "2024-10-15T09:33:51.834Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 233,
        "reads": 64,
        "readers_count": 63,
        "score": 1167.8,
        "yours": false,
        "topic_id": 11859,
        "topic_slug": "%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables",
        "display_username": "Ivan",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://www.procustodibus.com/blog/2022/06/multi-hop-wireguard/",
                "internal": false,
                "reflection": false,
                "title": "Multi-Hop WireGuard | Pro Custodibus",
                "clicks": 2
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 6258,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables/11859/1",
        "can_translate": false
    },
    {
        "id": 55377,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-10-16T04:06:45.563Z",
        "cooked": "<p>в секцию interface в wgcf.conf добавь table=100. запускай оба конфига через wg-quick, затем</p>\n<pre><code class=\"lang-auto\">sysctl -w net.ipv4.ip_forward=1\niptables -t nat -A POSTROUTING -j MASQUERADE\nip rule add from wg0_subnet/24 table 100\n</code></pre>\n<p>wg0_subnet нужно заменить на своё</p>\n<p>или вместо всего этого просто пробрось порт</p>\n<p>если не вышло то пиши дс или тг</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 13,
        "updated_at": "2024-10-16T04:10:01.275Z",
        "reply_count": 2,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 44,
        "readers_count": 43,
        "score": 18.8,
        "yours": false,
        "topic_id": 11859,
        "topic_slug": "%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables/11859/2",
        "can_translate": false
    },
    {
        "id": 55671,
        "name": "Ivan",
        "username": "Fanarill",
        "avatar_template": "/letter_avatar_proxy/v4/letter/f/6a8cbe/{size}.png",
        "created_at": "2024-10-16T18:18:16.816Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"0ka\" data-post=\"2\" data-topic=\"11859\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/0/d78d45/48.png\" class=\"avatar\"> 0ka:</div>\n<blockquote>\n<p><code>iptables -t nat -A POSTROUTING -j MASQUERADE</code></p>\n</blockquote>\n</aside>\n<p>Я уже слишком долго долблюсь с этим, поэтому я уже хронологию событий не помню, но насколько помню мне эта настройка наконец разрешила делать и хендшейки для wg0 и заставить работать инет для wg1 одновременно. И мне оказывается маскарадинг надо было на все интерфейсы навесить, чтобы добиться того же результата.</p>\n<p>Теперь у меня встала проблема, что если в wg1 прописать AllowedIPs = 0.0.0.0/0, то видимо происходит проблема рода: представим что надо отправить ack к хендшейку, но этот пакет отправляется не ко мне, а обратно на VPN из-за того что туда весь трафик идет.<br>\nВ итоге у меня выходит, что то в роде симплексного канала связи, лол)</p>\n<p>В итоге я весь день провозился с тем, чтобы понять что нужно поставить в AllowedIPs. То есть я как будто бы должен разрешить все КРОМЕ адресов моих локальных компьютеров и адресов wg0.</p>\n<p>Так и сделал, зашел на данный замечательный сайт <a href=\"https://www.procustodibus.com/blog/2021/03/wireguard-allowedips-calculator/\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">WireGuard AllowedIPs Calculator | Pro Custodibus</a>, и разрешил все айпишники кроме моего (под моим имею ввиду не VPS), и адреса wg0. Сеть намертво умирает. Никуда не могу подключиться. Пытался только wg0 заблокировать, или только свой - тоже нет результата.</p>\n<p>Попробовал, вбить айпишники сервера <a href=\"http://ifconfig.co\" rel=\"noopener nofollow ugc\">ifconfig.co</a> и о магия когда я туда захожу через локальный пк, я действительно захожу через cloudflare.</p>\n<p>Я в каком-то смысле могу реализовать таким образом что-то рода split tunneling, явно избирая какие айпишники пойдут через cloudflare а какие нет. Для интереса я через cloudflare все айпи гугла забил</p>\n<p><code>AllowedIPs = 8.8.4.0/24, 8.8.8.0/24, 8.34.208.0/20,  8.35.192.0/20, 23.236.48.0/20, 23.251.128.0/19, 34.0.0.0/15,  34.2.0.0/16, 34.3.0.0/23, 34.3.3.0/24, 34.3.4.0/24, 34.3.8.0/21,  34.3.16.0/20, 34.3.32.0/19, 34.3.64.0/18, 34.4.0.0/14, 34.8.0.0/13,  34.16.0.0/12, 34.32.0.0/11, 34.64.0.0/10, 34.128.0.0/10, 35.184.0.0/13,  35.192.0.0/14, 35.196.0.0/15, 35.198.0.0/16, 35.199.0.0/17,  35.199.128.0/18, 35.200.0.0/13, 35.208.0.0/12, 35.224.0.0/12,  35.240.0.0/13, 57.140.192.0/18, 64.15.112.0/20, 64.233.160.0/19,  66.22.228.0/23, 66.102.0.0/20, 66.249.64.0/19, 70.32.128.0/19,  72.14.192.0/18, 74.125.0.0/16, 104.154.0.0/15, 104.196.0.0/14,  104.237.160.0/19, 107.167.160.0/19, 107.178.192.0/18, 108.59.80.0/20,  108.170.192.0/18, 108.177.0.0/17, 130.211.0.0/16, 136.22.160.0/20,  136.22.176.0/21, 136.22.184.0/23, 136.22.186.0/24, 136.124.0.0/15,  142.250.0.0/15, 146.148.0.0/17, 152.65.208.0/22, 152.65.214.0/23,  152.65.218.0/23, 152.65.222.0/23, 152.65.224.0/19, 162.120.128.0/17,  162.216.148.0/22, 162.222.176.0/21, 172.110.32.0/21, 172.217.0.0/16,  172.253.0.0/16, 173.194.0.0/16, 173.255.112.0/20, 192.158.28.0/22,  192.178.0.0/15, 193.186.4.0/24, 199.36.154.0/23, 199.36.156.0/24,  199.192.112.0/22, 199.223.232.0/21, 207.223.160.0/20, 208.65.152.0/22,  208.68.108.0/22, 208.81.188.0/22, 208.117.224.0/19, 209.85.128.0/17,  216.58.192.0/19, 216.73.80.0/20, 216.239.32.0/19</code></p>\n<p>Хз кому это пригодится, но не суть.</p>\n<p>Я все же не умею абсолютно весь трафик перенаправлять. Поковырялся с wireshark’ом и смотрел на разницу между рабочей и нерабочей версией. В итоге пришлось банить айпишники cloudflare еще, потому что в рабочей версии запрос идет на eth0, а в нерабочей на wg1. Тоже не помогло.</p>\n<aside class=\"quote no-group\" data-username=\"0ka\" data-post=\"2\" data-topic=\"11859\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/0/d78d45/48.png\" class=\"avatar\"> 0ka:</div>\n<blockquote>\n<p><code>ip rule add from wg0_subnet/24 table 100</code></p>\n</blockquote>\n</aside>\n<p>Эту опцию не использовал, потому что не супер понимаю, что она делает. Еще не добрался до этого, но пока что хоть какой-то прогресс.</p>\n<aside class=\"quote no-group\" data-username=\"0ka\" data-post=\"2\" data-topic=\"11859\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/0/d78d45/48.png\" class=\"avatar\"> 0ka:</div>\n<blockquote>\n<p>если не вышло то пиши дс или тг</p>\n</blockquote>\n</aside>\n<p>А контакты где можно найти?)</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 13,
        "updated_at": "2024-10-16T18:18:16.816Z",
        "reply_count": 2,
        "reply_to_post_number": 2,
        "quote_count": 1,
        "incoming_link_count": 1,
        "reads": 34,
        "readers_count": 33,
        "score": 21.8,
        "yours": false,
        "topic_id": 11859,
        "topic_slug": "%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables",
        "display_username": "Ivan",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "http://ifconfig.co",
                "internal": false,
                "reflection": false,
                "title": "What is my IP address? — ifconfig.co",
                "clicks": 0
            },
            {
                "url": "https://www.procustodibus.com/blog/2021/03/wireguard-allowedips-calculator/",
                "internal": false,
                "reflection": false,
                "title": "WireGuard AllowedIPs Calculator | Pro Custodibus",
                "clicks": 0
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 6258,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables/11859/3",
        "can_translate": false
    },
    {
        "id": 55672,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-10-16T18:20:08.605Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"Fanarill\" data-post=\"3\" data-topic=\"11859\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/f/6a8cbe/48.png\" class=\"avatar\"> Fanarill:</div>\n<blockquote>\n<p>контакты где можно найти</p>\n</blockquote>\n</aside>\n<p>в лс свой пиши</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 13,
        "updated_at": "2024-10-16T18:20:08.605Z",
        "reply_count": 1,
        "reply_to_post_number": 3,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 30,
        "readers_count": 29,
        "score": 11.0,
        "yours": false,
        "topic_id": 11859,
        "topic_slug": "%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables/11859/4",
        "can_translate": false
    },
    {
        "id": 55674,
        "name": "Ivan",
        "username": "Fanarill",
        "avatar_template": "/letter_avatar_proxy/v4/letter/f/6a8cbe/{size}.png",
        "created_at": "2024-10-16T18:24:40.825Z",
        "cooked": "<p>в дсе ник как и на форуме Fanarill</p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 13,
        "updated_at": "2024-10-16T18:24:40.825Z",
        "reply_count": 0,
        "reply_to_post_number": 4,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 29,
        "readers_count": 28,
        "score": 5.8,
        "yours": false,
        "topic_id": 11859,
        "topic_slug": "%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables",
        "display_username": "Ivan",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "0ka",
            "name": "0ka",
            "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 6258,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables/11859/5",
        "can_translate": false
    },
    {
        "id": 55679,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-10-16T18:37:38.244Z",
        "cooked": "<p>жду приема</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 13,
        "updated_at": "2024-10-16T18:37:38.244Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 23,
        "readers_count": 22,
        "score": 9.6,
        "yours": false,
        "topic_id": 11859,
        "topic_slug": "%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables/11859/6",
        "can_translate": false
    },
    {
        "id": 55696,
        "name": "",
        "username": "praniguroiqua",
        "avatar_template": "/letter_avatar_proxy/v4/letter/p/ecb155/{size}.png",
        "created_at": "2024-10-16T19:11:18.462Z",
        "cooked": "<p>Текста много, читал не очень внимательно, но что могу сказать:</p>\n<ol>\n<li>Нужно проверить, что хост готов форвардить пакеты</li>\n</ol>\n<pre><code class=\"lang-auto\">cat /proc/sys/net/ipv4/ip_forward\n</code></pre>\n<ol start=\"2\">\n<li>Нужно проверить, что хост <em>точно</em> готов форвардить пакеты</li>\n</ol>\n<pre><code class=\"lang-auto\">sudo nft list ruleset\nsudo iptables -L\n</code></pre>\n<p>И посмотреть, чтобы FORWARD либо по умолчанию, либо по специальному правилу для wg0 принимало<br>\n3. Это впн, значит надо чтобы адрес переписывался по дороге, об этом позаботится</p>\n<pre><code class=\"lang-auto\">iptables -t nat -A POSTROUTING -j MASQUERADE -o wg1\n</code></pre>\n<p>что, как я понял, уже делается<br>\n4. И последнее, но самое главное, надо чтобы все пакеты отсылались в какой нужно интерфейс.<br>\nЕсли используется wg или wg-quick, то он сам пытается угадать, куда что посылать, но, например, systemd-networkd этого не делает, и надо прописывать отдельно<br>\nНо даже с wg*, на двух интерфейсах он может не угадать, что куда надо:</p>\n<ul>\n<li>default в wg1</li>\n<li>wg0_subnet/24 в wg0</li>\n<li>И, о чём я выше не увидел упоминания, домашнюю сеть и эндпоинт варпа в eth0</li>\n</ul>\n<p>Чтобы посмотреть подробнее присылай</p>\n<pre><code class=\"lang-auto\">ip route\n</code></pre>\n<aside class=\"quote no-group\" data-username=\"0ka\" data-post=\"2\" data-topic=\"11859\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/0/d78d45/48.png\" class=\"avatar\"> 0ka:</div>\n<blockquote>\n<pre><code class=\"lang-auto\">ip rule add from wg0_subnet/24 table 100\n</code></pre>\n</blockquote>\n</aside>\n<p>Это необязательно. Тут довольно простой роутинг, можно обойтись без правил.</p>\n<aside class=\"quote no-group\" data-username=\"Fanarill\" data-post=\"3\" data-topic=\"11859\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/f/6a8cbe/48.png\" class=\"avatar\"> Fanarill:</div>\n<blockquote>\n<p>То есть я как будто бы должен разрешить все КРОМЕ адресов моих локальных компьютеров и адресов wg0.</p>\n</blockquote>\n</aside>\n<p>Это не обязательно. Более точные адреса (например <code>8.8.4.0/24</code>)  и так будут с более высоким приоритетом, чем общий 0.0.0.0/0</p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 13,
        "updated_at": "2024-10-16T19:21:37.597Z",
        "reply_count": 3,
        "reply_to_post_number": null,
        "quote_count": 2,
        "incoming_link_count": 2,
        "reads": 24,
        "readers_count": 23,
        "score": 29.8,
        "yours": false,
        "topic_id": 11859,
        "topic_slug": "%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 7367,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables/11859/7",
        "can_translate": false
    },
    {
        "id": 55712,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-10-16T19:41:54.829Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"praniguroiqua\" data-post=\"7\" data-topic=\"11859\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/p/ecb155/48.png\" class=\"avatar\"> praniguroiqua:</div>\n<blockquote>\n<p>Тут довольно простой роутинг, можно обойтись без правил.</p>\n</blockquote>\n</aside>\n<p>а как? мы уже сделали как я писал</p>",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 13,
        "updated_at": "2024-10-16T19:41:54.829Z",
        "reply_count": 1,
        "reply_to_post_number": 7,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 23,
        "readers_count": 22,
        "score": 9.6,
        "yours": false,
        "topic_id": 11859,
        "topic_slug": "%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables/11859/8",
        "can_translate": false
    },
    {
        "id": 55726,
        "name": "",
        "username": "praniguroiqua",
        "avatar_template": "/letter_avatar_proxy/v4/letter/p/ecb155/{size}.png",
        "created_at": "2024-10-16T20:15:10.905Z",
        "cooked": "<p>Да я там в середине описал</p>\n<aside class=\"quote no-group\" data-username=\"praniguroiqua\" data-post=\"7\" data-topic=\"11859\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/p/ecb155/48.png\" class=\"avatar\"> praniguroiqua:</div>\n<blockquote>\n<ul>\n<li>default в wg1</li>\n<li>wg0_subnet/24 в wg0</li>\n<li>И, о чём я выше не увидел упоминания, домашнюю сеть и эндпоинт варпа в eth0</li>\n</ul>\n</blockquote>\n</aside>\n<p>Как видно, чтобы определить, куда посылать пакет, хватает только адреса назначения, а с этим справится и обычный ip route.</p>\n<p>Это, естественно, подразумевая, что мы не против, чтобы вся vps в интернет ходила через wg1.</p>\n<p>Если нужно только из wg0 в wg1, то да, либо ip rule, либо через iptables руководить пакетами.<br>\nХотя мне в таком случае нравится запихнуть это всё хозяйство в network namespace, и там по первому сценарию (без третьего пункта, это остаётся в главном неймспейсе). Мне кажется это проще пониманием объять, чем комплексные правила роутинга/фаервола; заодно и killswitch бесплатный.</p>",
        "post_number": 9,
        "post_type": 1,
        "posts_count": 13,
        "updated_at": "2024-10-16T20:16:11.398Z",
        "reply_count": 1,
        "reply_to_post_number": 8,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 22,
        "readers_count": 21,
        "score": 9.4,
        "yours": false,
        "topic_id": 11859,
        "topic_slug": "%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "0ka",
            "name": "0ka",
            "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 7367,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables/11859/9",
        "can_translate": false
    },
    {
        "id": 55733,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-10-16T20:23:17.089Z",
        "cooked": "<p>если вы хотите default route на wg1 в основной таблице то без ip rule не обойтись, default route на wg1 как минимум убьёт ssh на vps</p>",
        "post_number": 10,
        "post_type": 1,
        "posts_count": 13,
        "updated_at": "2024-10-16T20:23:31.453Z",
        "reply_count": 1,
        "reply_to_post_number": 9,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 19,
        "readers_count": 18,
        "score": 8.8,
        "yours": false,
        "topic_id": 11859,
        "topic_slug": "%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "praniguroiqua",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/p/ecb155/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables/11859/10",
        "can_translate": false
    },
    {
        "id": 55738,
        "name": "",
        "username": "praniguroiqua",
        "avatar_template": "/letter_avatar_proxy/v4/letter/p/ecb155/{size}.png",
        "created_at": "2024-10-16T20:31:55.105Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"0ka\" data-post=\"10\" data-topic=\"11859\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/0/d78d45/48.png\" class=\"avatar\"> 0ka:</div>\n<blockquote>\n<p>default route на wg1 как минимум убьёт ssh на vps</p>\n</blockquote>\n</aside>\n<aside class=\"quote no-group quote-modified\" data-username=\"praniguroiqua\" data-post=\"7\" data-topic=\"11859\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/p/ecb155/48.png\" class=\"avatar\"> praniguroiqua:</div>\n<blockquote>\n<p>домашнюю сеть &lt;…&gt; в eth0</p>\n</blockquote>\n</aside>\n<p>должен об этом позаботиться.<br>\nЕщё можно к ssh через wg0 подключаться. кроме всяких резервных-каналов-связи, вроде ssh over tor.<br>\nЕсли уж совсем пожар и wg0 отлетел совсем, то хостерский vnc есть.</p>",
        "post_number": 11,
        "post_type": 1,
        "posts_count": 13,
        "updated_at": "2024-10-16T20:31:55.105Z",
        "reply_count": 1,
        "reply_to_post_number": 10,
        "quote_count": 2,
        "incoming_link_count": 2,
        "reads": 20,
        "readers_count": 19,
        "score": 19.0,
        "yours": false,
        "topic_id": 11859,
        "topic_slug": "%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 7367,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables/11859/11",
        "can_translate": false
    },
    {
        "id": 55743,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-10-16T20:43:07.751Z",
        "cooked": "<p>ничего не понял</p>",
        "post_number": 12,
        "post_type": 1,
        "posts_count": 13,
        "updated_at": "2024-10-16T20:43:07.751Z",
        "reply_count": 1,
        "reply_to_post_number": 11,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 22,
        "readers_count": 21,
        "score": 9.4,
        "yours": false,
        "topic_id": 11859,
        "topic_slug": "%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "praniguroiqua",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/p/ecb155/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables/11859/12",
        "can_translate": false
    },
    {
        "id": 55746,
        "name": "",
        "username": "praniguroiqua",
        "avatar_template": "/letter_avatar_proxy/v4/letter/p/ecb155/{size}.png",
        "created_at": "2024-10-16T20:49:53.710Z",
        "cooked": "<p>Когда мы подключаемся к впс по ссш, мы, предположительно, делаем это со своего пк из домашней сети. То есть роутинг там аналогичный ваергарду, который создаёт wg0:<br>\nдомашняя сеть → впс<br>\nСоответственно, роутинг для такого маршрута у нас уже уже должен быть (иначе wg0 не будет работать) и впс знает, что пакеты с ответами (для ссш сессии или исходящего трафика домашнего ваергарда), предназначеные в домашнюю сеть, нужно отправлять в интерфейс eth0.</p>",
        "post_number": 13,
        "post_type": 1,
        "posts_count": 13,
        "updated_at": "2024-10-16T20:54:43.125Z",
        "reply_count": 0,
        "reply_to_post_number": 12,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 22,
        "readers_count": 21,
        "score": 9.4,
        "yours": false,
        "topic_id": 11859,
        "topic_slug": "%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "0ka",
            "name": "0ka",
            "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 7367,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%BD%D0%B0%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C-%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA-%D1%81-%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE-wireguard-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0-%D0%BD%D0%B0-%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9-%D0%BD%D0%B0-linux-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-iptables/11859/13",
        "can_translate": false
    }
]
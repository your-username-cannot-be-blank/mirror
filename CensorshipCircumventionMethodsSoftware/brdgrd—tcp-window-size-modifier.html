
    <html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <style>
    th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      word-wrap: break-word;
      padding: 5px;
    }
    table {
      width: 100%;
      max-width: 100%;
      border: 1px solid black;
      border-collapse: collapse;
      table-layout: fixed;
      word-wrap: break-word
    }
    code {
      word-wrap: break-word;
    }
    pre {
        white-space: pre-wrap;
    }
    </style>
        <title>brdgrd—tcp-window-size-modifier</title>
      </head>
      <body>
        <table border="1" width="100%" cellpadding="5">
          <tr>
            <th style="width: 10%;">Ник</th>
            <th>Пост</th>
            <th style="width: 10%;">Дата</th>
          </tr>
    <tr><td>ValdikSS</td><td><aside class="onebox githubrepo" data-onebox-src="https://github.com/NullHypothesis/brdgrd">
  <header class="source">

      <a href="https://github.com/NullHypothesis/brdgrd" target="_blank" rel="noopener">github.com</a>
  </header>

  <article class="onebox-body">
    <div class="github-row" data-github-private-repo="false">
  <img width="690" height="344" src="brdgrd—tcp-window-size-modifier/c84abdf0667a85e308033f156cf2c65e98813181_2_690x344.png" class="thumbnail" data-dominant-color="F0F1F1">

  <h3><a href="https://github.com/NullHypothesis/brdgrd" target="_blank" rel="noopener">GitHub - NullHypothesis/brdgrd: Protects Tor bridges from being scanned (and as a...</a></h3>

    <p><span class="github-repo-description">Protects Tor bridges from being scanned (and as a result blocked) by GFW probes.</span></p>
</div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>Brdgrd is short for “bridge guard”: A small tool that is meant to protect Tor bridges from being <a href="https://gist.github.com/da3c7a9af01d74cd7de7">scanned</a> (and as a result <a href="http://www.cs.kau.se/philwint/static/gfc/">blocked</a>) by the Great Firewall of China.</p>
<p>Brdgrd runs in user space and makes use of the libnetfilter_queue mechanism (and hence only runs on Linux) to move packets from kernel into user space. Only TCP SYN/ACK segments are passed into user space because brdgrd is only interested in TCP handshakes and not in established connections. Hence, there are virtually no performance implications.</p>
<p>Brdgrd intercepts the SYN/ACK segment that a Tor bridge sends to its client. It then rewrites the TCP window size announced in this segment. The window size is rewritten to a smaller, randomly chosen value. That way, the client “fragments” its cipher list inside the TLS client hello. The GFW will not recognize the cipher list and as a result will not scan the bridge.</p></td><td>2019-09-22T21:39:35.106Z</td></tr><tr><td>cypherpunks(cypherpunks:writecodes)</td><td><blockquote>
<p><strong>Update 2013-11-17</strong> : brdgrd no longer seems to be effective as the GFC appears to be doing TCP stream reassembly now.</p>
</blockquote></td><td>2019-12-14T15:21:09.338Z</td></tr>
    </table>
      </body>
    </html>
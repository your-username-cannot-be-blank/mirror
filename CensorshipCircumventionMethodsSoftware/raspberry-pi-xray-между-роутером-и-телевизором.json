[
    {
        "id": 30370,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-05T20:22:18.020Z",
        "cooked": "<p>Есть VPS с настроенным vless reality.<br>\nВ доме стоит <strong>роутер</strong>, на который openwrt встанет со скрипом, и уж точно без поддержки проксирования через vless.<br>\nЕсть <strong>телевизор Samsung</strong>, на котором хочется смотреть youtube.<br>\nИ есть лежащая без дела <strong>Raspberry Pi</strong> ранних ревизий, к которой есть парочка совместимых <strong>wifi usb адаптеров</strong>.</p>\n<p>Напрашивается такая схема:<br>\nРоутер --(ethernet)-- Raspberry Pi --(usb wifi)-- Телевизор</p>\n<p>Попробовал накатить последнюю Raspbian, подключил к роутеру кабелем (wifi пока не трогал), установил xray-core в режиме клиента для vless, в inbound listen прописал 0.0.0.0:1080. То есть xray-core создаёт прокси-сервер на порту 1080, всё что к нему подключается — заворачивается в vless. Потестировал с компа через FoxyProxy — работает на удивление неплохо, 4K поток тянет без проблем, особо не греется даже.</p>\n<p>Но дальше я не понимаю, как настроить связку с телевизором. Подключил usb wifi адаптер к малине. <em>Не прошло и года, как</em> поднял точку доступа на wlan0 через NetworkManager, прописал</p>\n<pre><code class=\"lang-auto\">sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\n</code></pre>\n<p>и нормально, устройства подключаются к малине по wifi и получают доступ в интернет. Но у меня вообще никак не получается завернуть трафик в прокси, вот совсем. Гуглом ничего подходящего не нашёл, chatgpt говорит что-то про redsocks и/или разные правила в iptables — в лучшем случае эти предложения ничего не делают, а в худшем ломают подключение.</p>\n<p>Может, кто-то посоветует, как лучше сделать? Может, кто-то уже делал подобное? Ещё видел, что для малины есть openwrt - не будет ли проще использовать этот вариант? (Никогда не пользовался openwrt и не знаю, позволит ли она реализовать задуманное.)</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-19T20:01:31.305Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 4242,
        "reads": 241,
        "readers_count": 240,
        "score": 21213.2,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 4,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://ntc.party/t/%D0%BF%D0%BE%D0%BC%D0%BE%D0%B3%D0%B8%D1%82%D0%B5-%D0%BE%D0%B6%D0%B8%D0%B2%D0%B8%D1%82%D1%8C-%D1%8E%D1%82%D1%83%D0%B1-%D0%BD%D0%B0-%D1%82%D0%B2-%D1%81%D0%B0%D0%BC%D1%81%D1%83%D0%BD%D0%B3/10798/8",
                "internal": true,
                "reflection": true,
                "title": "Помогите оживить ютуб на тв Самсунг",
                "clicks": 3
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/1",
        "can_translate": false
    },
    {
        "id": 30380,
        "name": "",
        "username": "gfqwdgecewgcdw",
        "avatar_template": "/user_avatar/ntc.party/gfqwdgecewgcdw/{size}/4431_2.png",
        "created_at": "2024-08-05T20:56:44.371Z",
        "cooked": "<p><a href=\"https://kubuntu.ru/nat-iptables\" class=\"onebox\" target=\"_blank\" rel=\"noopener nofollow ugc\">https://kubuntu.ru/nat-iptables</a></p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-05T20:56:44.371Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 10,
        "reads": 221,
        "readers_count": 220,
        "score": 99.2,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://kubuntu.ru/nat-iptables",
                "internal": false,
                "reflection": false,
                "title": "NAT и iptables (Как раздать интернет через вторую сетевую карту) | Kubuntu.ru",
                "clicks": 116
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3234,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/2",
        "can_translate": false
    },
    {
        "id": 30390,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-05T21:10:53.681Z",
        "cooked": "<p>Возможно туплю, поправьте если так. Но по ссылке вроде говорится о том, что у меня уже работает, а именно раздача интернета на другие устройства, которые подключаются к wi-fi точке доступа (ну, в моём случае к ней). <code>POSTROUTING </code> в iptables прописан, <code>net.ipv4.ip_forward = 1</code> тоже включил. Интернет раздаётся, всё окей.</p>\n<p>Только я не могу понять, как мне вот этот раздаваемый интернет завернуть в socks5 на порту 1080. Есть ощущение, что вот так напрямую это нельзя сделать, но я не понимаю, как можно и куда смотреть. Пробовал поменять на http и прописать системный прокси для http и https через raspi-config. После этого curl с малины начинает работать через vless, но подключенные устройства по-прежнему работают в обход прокси. Не понимаю, как этот момент настроить.</p>\n<p>Возможно, мой подход вообще ошибочный, и мне не нужно создавать никакой прокси-сервер, а нужно заворачивать трафик в vless как-то иначе. Но я пока не понимаю, как это сделать.</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-05T21:17:38.247Z",
        "reply_count": 1,
        "reply_to_post_number": 2,
        "quote_count": 0,
        "incoming_link_count": 12,
        "reads": 214,
        "readers_count": 213,
        "score": 107.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 4,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "gfqwdgecewgcdw",
            "name": "",
            "avatar_template": "/user_avatar/ntc.party/gfqwdgecewgcdw/{size}/4431_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/3",
        "can_translate": false
    },
    {
        "id": 30396,
        "name": null,
        "username": "Texsis",
        "avatar_template": "/letter_avatar_proxy/v4/letter/t/ecc23a/{size}.png",
        "created_at": "2024-08-05T21:19:48.777Z",
        "cooked": "<p>Может лучше поднять вместо x-ray поставить sing-box. Он может поднимать интерфейс, а не как прокси работать. И уже между ними пересылку делать.</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-05T21:19:48.777Z",
        "reply_count": 1,
        "reply_to_post_number": 3,
        "quote_count": 0,
        "incoming_link_count": 9,
        "reads": 199,
        "readers_count": 198,
        "score": 89.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 2860,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/4",
        "can_translate": false
    },
    {
        "id": 30398,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-05T21:21:26.418Z",
        "cooked": "<p>Об этом не думал, спасибо, завтра будет время почитаю об этом подробнее. Но думаю вы правы, что мой подход с xray-core и прокси изначально дурацкий <img src=\"https://ntc.party/images/emoji/twitter/grinning.png?v=12\" title=\":grinning:\" class=\"emoji\" alt=\":grinning:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-05T21:21:26.418Z",
        "reply_count": 1,
        "reply_to_post_number": 4,
        "quote_count": 0,
        "incoming_link_count": 22,
        "reads": 192,
        "readers_count": 191,
        "score": 153.4,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "Texsis",
            "name": null,
            "avatar_template": "/letter_avatar_proxy/v4/letter/t/ecc23a/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/5",
        "can_translate": false
    },
    {
        "id": 30402,
        "name": null,
        "username": "Dhohbr",
        "avatar_template": "/letter_avatar_proxy/v4/letter/d/8797f3/{size}.png",
        "created_at": "2024-08-05T22:09:33.319Z",
        "cooked": "<p>Наверно проще использовать какой-нибудь VPN.<br>\nЕсли прям xray нужен, можно через tun2socks завернуть его в tun интерфейс, и с ним уже настраивать маршрутизацию.</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-05T22:09:33.319Z",
        "reply_count": 0,
        "reply_to_post_number": 5,
        "quote_count": 0,
        "incoming_link_count": 62,
        "reads": 184,
        "readers_count": 183,
        "score": 346.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 209,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/6",
        "can_translate": false
    },
    {
        "id": 30422,
        "name": null,
        "username": "souvao",
        "avatar_template": "/letter_avatar_proxy/v4/letter/s/4491bb/{size}.png",
        "created_at": "2024-08-06T03:55:07.053Z",
        "cooked": "<p>Тебе нужно маркировать весь трафик и заворачивать его часть с помощью tproxy на inbound dokodemo-door в xray.<br>\nПочитать про это можно здесь, на русском <a href=\"https://xtls.github.io/Xray-docs-next/ru/document/level-2/tproxy_ipv4_and_ipv6.html\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Прозрачное проксирование TProxy (ipv4 и ipv6) | Project X</a> и здесь, на китайском <a href=\"https://guide.v2fly.org/app/tproxy.html#%E5%BC%80%E6%9C%BA%E8%87%AA%E5%8A%A8%E8%BF%90%E8%A1%8C%E9%80%8F%E6%98%8E%E4%BB%A3%E7%90%86%E8%A7%84%E5%88%99\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">透明代理(TPROXY) | 新 V2Ray 白话文指南</a></p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-06T03:57:43.577Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 60,
        "reads": 179,
        "readers_count": 178,
        "score": 335.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://xtls.github.io/Xray-docs-next/ru/document/level-2/tproxy_ipv4_and_ipv6.html",
                "internal": false,
                "reflection": false,
                "title": "Прозрачное проксирование TProxy (ipv4 и ipv6) | Project X",
                "clicks": 85
            },
            {
                "url": "https://guide.v2fly.org/app/tproxy.html#%E5%BC%80%E6%9C%BA%E8%87%AA%E5%8A%A8%E8%BF%90%E8%A1%8C%E9%80%8F%E6%98%8E%E4%BB%A3%E7%90%86%E8%A7%84%E5%88%99",
                "internal": false,
                "reflection": false,
                "title": "透明代理(TPROXY) | 新 V2Ray 白话文指南",
                "clicks": 16
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4231,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/7",
        "can_translate": false
    },
    {
        "id": 30463,
        "name": "",
        "username": "MasterYoba",
        "avatar_template": "/user_avatar/ntc.party/masteryoba/{size}/6182_2.png",
        "created_at": "2024-08-06T07:22:48.230Z",
        "cooked": "<p>Честно говоря, ваша схема подключения довольно странная. Я решительно не понимаю, зачем тут usb wifi адаптер, и зачем подключать телевизор именно <strong>физически</strong> <strong>через</strong> Raspberry? Все ведь решается простыми сетевыми настройками на уровне L3.<br>\nЯ бы сделал так: Raspberry подключен к роутер по ethernet, телевизор тоже подключен к роутеру любым способом (ethernet/wifi). Далее пошагово:</p>\n<ol>\n<li>Сносите с Raspberry xray-core и ставите sing-box. Это гораздо более производительный клиент/сервер, и обладает очень богатым функционалом. И что немаловажно, имеет качественную документацию на английском языке (<a href=\"https://sing-box.sagernet.org/manual/proxy/client/\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Client - sing-box</a>).</li>\n<li>Настраиваете конфиг sing-box. В интернете полно примеров, можно гуглить sing-box example config, если настраивали xray-core думаю разберётесь. В Inbounds создаёте инбаунд типа tun, обязательно с опцией <strong>“auto_route”: true</strong>. В outbounds ваш конфиг vless reality по сути такой же, как в xray. В Route создаёте правила, что именно вы хотите завернуть в туннель, например для телевизора рекомендую завернуть только “domain_suffix” = “.googlevideo.com”. Этого будет достаточно, чтобы вылечить ютуб. Но можно завернуть и весь трафик, только будьте осторожны с российскими стриминговыми сервисами, если пользуетесь ими! И обязательно опцию <strong>“auto_detect_interface”: true</strong>, без неё работать не будет у вас!</li>\n<li>В настройках телевизора вы ставите шлюз по умолчанию = ip адрес Raspberry.<br>\nИтог: трафик с телевизора роутится на Raspberry, попадает на tun интерфейс, далее либо заворачивается sing-boxом в vless туннель и идёт на роутер и далее в интернет, либо просто сразу на роутер и в интернет напрямую, в зависимости от правил в разделе Routes.</li>\n</ol>\n<p>У меня в целом похожая схема дома реализована, только вместо Raspberry классическая x86 платформа, и заворачиваю я туда трафик с избранных устройств не через шлюз по умолчанию, а отдельным маршрутом на маршрутизаторе. А в sing-box я использую список всех заблоченных РКН доменов, то есть проксирую только “запрещенку”. Если интересно, могу потом рассказать подробнее.</p>",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-06T07:22:48.230Z",
        "reply_count": 3,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 62,
        "reads": 169,
        "readers_count": 168,
        "score": 358.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://sing-box.sagernet.org/manual/proxy/client/",
                "internal": false,
                "reflection": false,
                "title": "Client - sing-box",
                "clicks": 92
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4361,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/8",
        "can_translate": false
    },
    {
        "id": 30469,
        "name": "Elena",
        "username": "cimon357",
        "avatar_template": "/user_avatar/ntc.party/cimon357/{size}/3804_2.png",
        "created_at": "2024-08-06T07:35:29.840Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"MasterYoba\" data-post=\"8\" data-topic=\"8804\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/user_avatar/ntc.party/masteryoba/48/6182_2.png\" class=\"avatar\"> MasterYoba:</div>\n<blockquote>\n<p>Если интересно, могу потом рассказать подробнее.</p>\n</blockquote>\n</aside>\n<p>Интересно, может быть, сделаете отдельную подробную статью?</p>",
        "post_number": 9,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-06T07:35:29.840Z",
        "reply_count": 1,
        "reply_to_post_number": 8,
        "quote_count": 1,
        "incoming_link_count": 8,
        "reads": 156,
        "readers_count": 155,
        "score": 76.2,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "Elena",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 2729,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/9",
        "can_translate": false
    },
    {
        "id": 30476,
        "name": "",
        "username": "MasterYoba",
        "avatar_template": "/user_avatar/ntc.party/masteryoba/{size}/6182_2.png",
        "created_at": "2024-08-06T08:22:02.577Z",
        "cooked": "<p>Думал об этом уже, только пока не знаю, на какой ресурс лучше выкладывать. Сюда или на какой-то пока рабочий в рф ресурс, вроде гитхаба.</p>",
        "post_number": 10,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-06T08:22:02.577Z",
        "reply_count": 0,
        "reply_to_post_number": 9,
        "quote_count": 0,
        "incoming_link_count": 17,
        "reads": 159,
        "readers_count": 158,
        "score": 116.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "cimon357",
            "name": "Elena",
            "avatar_template": "/user_avatar/ntc.party/cimon357/{size}/3804_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4361,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/10",
        "can_translate": false
    },
    {
        "id": 30485,
        "name": null,
        "username": "ValdikSS",
        "avatar_template": "/user_avatar/ntc.party/valdikss/{size}/2_2.png",
        "created_at": "2024-08-06T09:09:30.178Z",
        "cooked": "<p><strong>На телевизоре есть поддержка прокси</strong> ⇒ настроить HTTP-прокси-сервер на компьютере/Raspberry (xray input), настроить прокси на телевизоре.</p>\n<p><strong>На телевизоре нет поддержки прокси, хочется обойтись только отдельными программами</strong> ⇒</p>\n<ol>\n<li>настроить беспротокольный прокси-порт (в v2ray называется dokodemo-door) на компьютере/Raspberry на портах 80 и 443, в нём настроить sniffing трафика (определение домена/IP-адреса из содержимого запроса, а не из метаданных подключения)</li>\n<li>настроить DNS-сервер на компьютере/raspberry с отдачей IP-адреса компьютера/raspberry для доменов, которые необходимо проксировать (возможно, DNS можно поднять и средствами xray/v2ray, но не уверен)</li>\n<li>указать IP-адрес компьютера/rasbperry в качестве DNS-сервера на телевизоре</li>\n</ol>\n<p>// <a href=\"https://ntc.party/t/%D0%BE%D0%B1%D1%85%D0%BE%D0%B4-%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B8-youtube-%D0%B4%D0%BB%D1%8F-%D0%BB%D1%8E%D0%B1%D1%8B%D1%85-smart-tv-%D1%81-goodbyedpi-v2ray-maradns/9415\" class=\"inline-onebox\">Обход блокировки YouTube для любых Smart TV с GoodbyeDPI + V2ray + MaraDNS</a></p>\n<p><strong>На телевизоре нет поддержки прокси и VPN</strong> ⇒ настраивать компьютер/raspberry как шлюз, как пишет <a class=\"mention\" href=\"/u/masteryoba\">@MasterYoba</a>. Можно сделать на компьютере в виртуальной машине с Linux, отдельное устройство не обязательно.</p>\n<p><strong>На телевизоре нет поддержки прокси, есть поддержка VPN (любого протокола)</strong> ⇒</p>\n<ol>\n<li>настроить VPN-сервер для этого протокола на компьютере/raspberry</li>\n<li>настроить перенаправление трафика на беспротокольный прокси-порт (dokodemo-door) v2ray/xray с VPN-интерфейса</li>\n<li>настроить телевизор на VPN-подключение к компьютеру/raspberry</li>\n</ol>\n<p>Преимущество перед настройкой шлюзом (способ выше) только в удобстве настройки/соединения/разъединения VPN-подключения.</p>",
        "post_number": 11,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-16T23:57:05.592Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 415,
        "reads": 161,
        "readers_count": 160,
        "score": 2102.0,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://ntc.party/t/%D0%BE%D0%B1%D1%85%D0%BE%D0%B4-%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B8-youtube-%D0%B4%D0%BB%D1%8F-%D0%BB%D1%8E%D0%B1%D1%8B%D1%85-smart-tv-%D1%81-goodbyedpi-v2ray-maradns/9415",
                "internal": true,
                "reflection": false,
                "title": "Обход блокировки YouTube для любых Smart TV с GoodbyeDPI + V2ray + MaraDNS",
                "clicks": 72
            }
        ],
        "read": true,
        "user_title": "AntiZapret staff",
        "title_is_group": false,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": true,
        "staff": true,
        "user_id": 1,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/11",
        "can_translate": false
    },
    {
        "id": 30486,
        "name": null,
        "username": "ValdikSS",
        "avatar_template": "/user_avatar/ntc.party/valdikss/{size}/2_2.png",
        "created_at": "2024-08-06T09:17:56.751Z",
        "cooked": "<p>См. описание реализации VPN-подхода: <a href=\"https://github.com/ValdikSS/hoogmoon-testing/blob/master/TECH.md#user-traffic-redirection\" class=\"inline-onebox\">hoogmoon-testing/TECH.md at master · ValdikSS/hoogmoon-testing · GitHub</a><br>\nФайлы: <a href=\"https://github.com/ValdikSS/hoogmoon-testing/tree/master/build/files/etc/v2ray\" class=\"inline-onebox\">hoogmoon-testing/build/files/etc/v2ray at master · ValdikSS/hoogmoon-testing · GitHub</a> — там много всего дополнительного, но как пример подобной настройки, надеюсь, будет полезно.</p>",
        "post_number": 12,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-06T09:17:56.751Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 4,
        "reads": 150,
        "readers_count": 149,
        "score": 49.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://github.com/ValdikSS/hoogmoon-testing/blob/master/TECH.md#user-traffic-redirection",
                "internal": false,
                "reflection": false,
                "title": "hoogmoon-testing/TECH.md at master · ValdikSS/hoogmoon-testing · GitHub",
                "clicks": 49
            },
            {
                "url": "https://github.com/ValdikSS/hoogmoon-testing/tree/master/build/files/etc/v2ray",
                "internal": false,
                "reflection": false,
                "title": "hoogmoon-testing/build/files/etc/v2ray at master · ValdikSS/hoogmoon-testing · GitHub",
                "clicks": 22
            }
        ],
        "read": true,
        "user_title": "AntiZapret staff",
        "title_is_group": false,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": true,
        "staff": true,
        "user_id": 1,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/12",
        "can_translate": false
    },
    {
        "id": 30491,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-06T10:05:27.733Z",
        "cooked": "<p>Приветствую <a class=\"mention\" href=\"/u/valdikss\">@ValdikSS</a> и <a class=\"mention\" href=\"/u/masteryoba\">@MasterYoba</a> , благодарю за подробные ответы!</p>\n<p>На всякий случай уточню, что телевизор не поддерживает VPN и вот это всё. Настройки ограничены вот этим списком (картинка из интернета, но у меня так же).<br>\n<img src=\"raspberry-pi-xray-между-роутером-и-телевизором/56c6f7d0a60e3b7172dec0877450a38e72ee53ee.jpeg\" alt=\"samsung-ip-settings\" data-base62-sha1=\"cnFlFrBoSqqSaYHs978nC8Ae58q\" width=\"400\" height=\"267\"></p>\n<p>Если я правильно понял идею, нужно просто подключить Raspberry Pi кабелем к роутеру и не городить из него точку доступа, а использовать малину как шлюз в настройках телевизора. Это дельная мысль, она не пришла мне в голову потому что я нуб и всегда всё усложняю <img src=\"https://ntc.party/images/emoji/twitter/grinning.png?v=12\" title=\":grinning:\" class=\"emoji\" alt=\":grinning:\" loading=\"lazy\" width=\"20\" height=\"20\"> Вечером попробую настроить sing-box под это дело.</p>",
        "post_number": 13,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-06T10:05:27.733Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 12,
        "reads": 153,
        "readers_count": 152,
        "score": 90.6,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/13",
        "can_translate": false
    },
    {
        "id": 30667,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-06T20:34:00.700Z",
        "cooked": "<p>Окей, вот я на свежей raspbian os прописал <code>net.ipv4.ip_forward=1</code>, телевизор нормально использует малину в качестве шлюза и ходит в интернет. Больше ничего не делал.</p>\n<p>sing-box поставил, правда не без приключений. Raspberry Pi 1B это armv6, а в репозитории sagernet видимо только для v7. Долго думал, почему процесс вылетает со <code>status=4/ILL</code> сразу после запуска, но в итоге собрал из исходников, всё запускается.</p>\n<p>Сейчас проблема в том, что сразу после <code>sudo systemctl start sing-box</code> я теряю связь с малиной по SSH, и как шлюз она тоже отваливается на подключенных устройствах. Пробовал добавлять direct маршруты в routes для локальных IP или для 22 порта, но то ли я неправильно добавляю, то ли дело не в маршрутах. При log level=“debug” в логе только это (в systemd тоже ничего интересного):</p>\n<pre><code class=\"lang-auto\">+0300 2024-08-06 22:45:09 INFO router: updated default interface eth0, index 2\n+0300 2024-08-06 22:45:09 INFO inbound/tun[tun-in]: started at tun0\n+0300 2024-08-06 22:45:09 INFO sing-box started (0.100s)\n</code></pre>\n<p>Вопросы:</p>\n<ol>\n<li>Всё ли верно в конфиге из того, что заполнено помимо routes?</li>\n<li>Что прописывать в routes для базового тестирования? Я имею в виду, пусть он вообще всё, кроме локальных маршрутов, заворачивает в туннель, для наглядности. Если заработает, то пропишу для отдельных доменов.</li>\n<li>Что-то ещё нужно делать, помимо конфигурации sing-box?</li>\n</ol>\n<pre><code class=\"lang-auto\">{\n\t\"log\": {\n\t\t\"disabled\": false,\n\t\t\"level\": \"warn\",\n\t\t\"output\": \"/tmp/sing-box.log\",\n\t\t\"timestamp\": true\n\t},\n\t\"dns\": {\n\t\t\"servers\": [\n\t\t\t{\n\t\t\t\t\"tag\": \"google\",\n\t\t\t\t\"address\": \"tls://8.8.8.8\"\n\t\t\t},\n\t\t\t{\n\t\t\t\"tag\": \"block\",\n\t\t\t\"address\": \"rcode://success\"\n\t\t\t}\n\t\t],\n\t\t\"final\": \"google\",\n\t\t\"strategy\": \"ipv4_only\"\n\t},\n\t\"inbounds\": [\n\t\t{\n\t\t\t\"type\": \"tun\",\n\t\t\t\"tag\": \"tun-in\",\n\t\t\t\"interface_name\": \"tun0\",\n\t\t\t\"stack\": \"system\",\n\t\t\t\"inet4_address\": \"172.19.16.1/30\",\n\t\t\t\"auto_route\": true,\n\t\t\t\"strict_route\": true,\n\t\t\t\"sniff\": true\n\t\t}\n\t],\n\t\"outbounds\": [\n\t\t{\n\t\t\t\"type\": \"vless\",\n\t\t\t\"tag\": \"vless-out\",\n\t\t\t\"server\": \"IP_ADDR\",\n\t\t\t\"server_port\": 443,\n\t\t\t\"uuid\": \"UUID\",\n\t\t\t\"flow\": \"xtls-rprx-vision\",\n\t\t\t\"network\": \"tcp\",\n\t\t\t\"tls\": {\n\t\t\t\t\"enabled\": true,\n\t\t\t\t\"server_name\": \"DOMAIN_NAME\",\n\t\t\t\t\"alpn\": [\"h2\"],\n\t\t\t\t\"utls\": {\n\t\t\t\t\t\"enabled\": true,\n\t\t\t\t\t\"fingerprint\": \"chrome\"\n\t\t\t\t},\n\t\t\t\t\"reality\": {\n\t\t\t\t\t\"enabled\": true,\n\t\t\t\t\t\"public_key\": \"PUBLIC_KEY\",\n\t\t\t\t\t\"short_id\": \"SHORT_ID\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"packet_encoding\": \"xudp\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"direct\",\n\t\t\t\"tag\": \"direct\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"block\",\n\t\t\t\"tag\": \"block\"\n\t\t},\n\t\t\t{\n\t\t\t\"type\": \"dns\",\n\t\t\t\"tag\": \"dns-out\"\n\t\t}\n\t],\n\t\"route\": {\n\t\t\"rules\": [\n\t\t\t{\n\t\t\t\t\"protocol\": \"dns\",\n\t\t\t\t\"outbound\": \"dns-out\"\n\t\t\t}\n\t\t],\n\t\"auto_detect_interface\": true\n\t}\n}\n</code></pre>",
        "post_number": 14,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-06T20:42:30.165Z",
        "reply_count": 3,
        "reply_to_post_number": 8,
        "quote_count": 0,
        "incoming_link_count": 67,
        "reads": 146,
        "readers_count": 145,
        "score": 379.2,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "MasterYoba",
            "name": "",
            "avatar_template": "/user_avatar/ntc.party/masteryoba/{size}/6182_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/14",
        "can_translate": false
    },
    {
        "id": 30679,
        "name": null,
        "username": "Texsis",
        "avatar_template": "/letter_avatar_proxy/v4/letter/t/ecc23a/{size}.png",
        "created_at": "2024-08-06T22:00:09.623Z",
        "cooked": "<p>Я брал конфиг из этой статьи и все взлетело <a href=\"https://itdog.info/podnimaem-na-openwrt-klient-proksi-vless-shadowsocks-shadowsocks2022-nastrojka-sing-box-i-tun2socks/#sing-box\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Поднимаем на OpenWrt клиент прокси VLESS, Shadowsocks, Shadowsocks2022. Настройка sing-box и tun2socks | ITDog.info</a></p>",
        "post_number": 15,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-06T22:00:09.623Z",
        "reply_count": 0,
        "reply_to_post_number": 14,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 121,
        "readers_count": 120,
        "score": 39.2,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://itdog.info/podnimaem-na-openwrt-klient-proksi-vless-shadowsocks-shadowsocks2022-nastrojka-sing-box-i-tun2socks/#sing-box",
                "internal": false,
                "reflection": false,
                "title": "Поднимаем на OpenWrt клиент прокси VLESS, Shadowsocks, Shadowsocks2022. Настройка sing-box и tun2socks | ITDog.info",
                "clicks": 115
            }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 2860,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/15",
        "can_translate": false
    },
    {
        "id": 30681,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-08-06T22:05:27.561Z",
        "cooked": "<p>Отключите авто роутинг в конфиге и работайте с отдельной таблицей маршрутов (rt_tables), добавьте в неё вручную default route dev singbox_tun, и затем ip rule add from tv_ip/32 table second_route_table</p>\n<p>Пример команд после запуска singbox<br>\nip route add default tun0 table 100<br>\nip rule add from 192.168.1.100/32 table 100</p>",
        "post_number": 16,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-06T22:07:44.556Z",
        "reply_count": 1,
        "reply_to_post_number": 14,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 121,
        "readers_count": 120,
        "score": 44.2,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/16",
        "can_translate": false
    },
    {
        "id": 30686,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-06T22:28:45.416Z",
        "cooked": "<p>Можно попробовать, но в свете последних тестов не уверен, что в этом есть смысл, вроде бы можно настроить и через sing-box. Слегка измененный минималистичный конфиг по ссылкам от <a class=\"mention\" href=\"/u/texsis\">@Texsis</a> действительно работает, хотя и своеобразно. Некоторые сайты показывают удалённый IP, а некоторые домашний.</p>\n<pre><code class=\"lang-auto\">{\n  \"log\": {\n    \"disabled\": false,\n    \"level\": \"debug\",\n    \"output\": \"/tmp/sing-box.log\",\n    \"timestamp\": true\n  },\n  \"inbounds\": [\n    {\n      \"type\": \"tun\",\n      \"interface_name\": \"tun0\",\n      \"domain_strategy\": \"ipv4_only\",\n      \"inet4_address\": \"172.16.250.1/30\",\n      \"auto_route\": true,\n      \"strict_route\": false,\n      \"sniff\": true\n    }\n  ],\n  \"outbounds\": [\n    {\n      \"type\": \"vless\",\n      \"tag\": \"vless-out\",\n      \"server\": \"IP_ADDR\",\n      \"server_port\": 443,\n      \"uuid\": \"UUID\",\n      \"flow\": \"xtls-rprx-vision\",\n      \"network\": \"tcp\",\n      \"tls\": {\n        \"enabled\": true,\n        \"server_name\": \"DOMAIN\",\n        \"alpn\": [\n          \"h2\"\n        ],\n        \"utls\": {\n          \"enabled\": true,\n          \"fingerprint\": \"chrome\"\n        },\n        \"reality\": {\n          \"enabled\": true,\n          \"public_key\": \"PUBLIC_KEY\",\n          \"short_id\": \"SHORT_ID\"\n        }\n      },\n      \"packet_encoding\": \"xudp\"\n    }\n  ],\n  \"route\": {\n    \"auto_detect_interface\": true\n  }\n}\n</code></pre>\n<p>Опытным путём выяснил, что всё падает, если задать <code>\"strict_route\": true</code>. Буду разбираться дальше.</p>",
        "post_number": 17,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-06T22:28:45.416Z",
        "reply_count": 1,
        "reply_to_post_number": 16,
        "quote_count": 0,
        "incoming_link_count": 15,
        "reads": 121,
        "readers_count": 120,
        "score": 104.2,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "0ka",
            "name": "0ka",
            "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/17",
        "can_translate": false
    },
    {
        "id": 30687,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-08-06T22:31:12.818Z",
        "cooked": "<p>Перезагрузите тв, возможно в кеше остался старый маршрут для некоторых айпи адресов</p>",
        "post_number": 18,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-06T22:31:12.818Z",
        "reply_count": 1,
        "reply_to_post_number": 17,
        "quote_count": 0,
        "incoming_link_count": 8,
        "reads": 111,
        "readers_count": 110,
        "score": 67.2,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/18",
        "can_translate": false
    },
    {
        "id": 30688,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-06T22:35:16.438Z",
        "cooked": "<p>Попробую, вероятно вы правы, иногда обновление страницы меняет отображаемый айпишник, хоть и не всегда.</p>\n<p>По поводу strict_route не особо понимаю, насколько нужна эта опция. В справке вижу вот это:<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"raspberry-pi-xray-между-роутером-и-телевизором/c322c3fd7981caf262617bbade764fc8273adaef.jpeg\" data-download-href=\"https://ntc.party/uploads/default/c322c3fd7981caf262617bbade764fc8273adaef\" title=\"2024-08-07 01_30_45-Tun - sing-box — Mozilla Firefox\"><img src=\"raspberry-pi-xray-между-роутером-и-телевизором/c322c3fd7981caf262617bbade764fc8273adaef_2_690x461.jpeg\" alt=\"2024-08-07 01_30_45-Tun - sing-box — Mozilla Firefox\" data-base62-sha1=\"rQfAGlRZI8Y5sT9PHqXv0kOgVuD\" width=\"690\" height=\"461\" srcset=\"raspberry-pi-xray-между-роутером-и-телевизором/c322c3fd7981caf262617bbade764fc8273adaef_2_690x461.jpeg, raspberry-pi-xray-между-роутером-и-телевизором/c322c3fd7981caf262617bbade764fc8273adaef.jpeg 1.5x, raspberry-pi-xray-между-роутером-и-телевизором/c322c3fd7981caf262617bbade764fc8273adaef.jpeg 2x\" data-dominant-color=\"F5F5F6\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">2024-08-07 01_30_45-Tun - sing-box — Mozilla Firefox</span><span class=\"informations\">739×494 50.3 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Всё равно не понимаю <img src=\"https://ntc.party/images/emoji/twitter/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"> Это описание того, что оно делает, или описание того, что я должен сделать, чтобы оно работало? И насколько вообще нужно включать эту опцию? Под Windows для всех клиентов обычно советуют включать, но здесь не знаю. <code>auto_route</code> у меня таки включен.</p>",
        "post_number": 19,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-06T22:38:41.892Z",
        "reply_count": 1,
        "reply_to_post_number": 18,
        "quote_count": 0,
        "incoming_link_count": 26,
        "reads": 120,
        "readers_count": 119,
        "score": 159.0,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "0ka",
            "name": "0ka",
            "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/19",
        "can_translate": false
    },
    {
        "id": 30711,
        "name": "",
        "username": "MasterYoba",
        "avatar_template": "/user_avatar/ntc.party/masteryoba/{size}/6182_2.png",
        "created_at": "2024-08-07T05:07:20.490Z",
        "cooked": "<p>Сейчас у вас всё идёт по умолчанию в первый по списку outbound - vless-out. Добавьте в rules такое правило, чтобы направить локальный трафик мимо прокси:</p>\n<pre><code class=\"lang-auto\">            {\n                \"ip_is_private\": true,\n                \"outbound\": \"direct\"\n            }\n</code></pre>\n<p>auto_route отключать не обязательно, на машине с одним интерфейсом, вроде той же малины, с ним будет прекрасно работать. Его отключают обычно, когда настраивают sing-box на роутере, чтобы не мешать работе маршрутизации на нём.</p>",
        "post_number": 20,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-07T05:07:20.490Z",
        "reply_count": 0,
        "reply_to_post_number": 14,
        "quote_count": 0,
        "incoming_link_count": 11,
        "reads": 123,
        "readers_count": 122,
        "score": 79.6,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4361,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/20",
        "can_translate": false
    },
    {
        "id": 30725,
        "name": "",
        "username": "MasterYoba",
        "avatar_template": "/user_avatar/ntc.party/masteryoba/{size}/6182_2.png",
        "created_at": "2024-08-07T08:04:25.909Z",
        "cooked": "<p>Вы правильно сделали, что отключили “strict_route”, про нее мало информации в документации, в моём понимании она нужна в тех случаях, когда sing-box используется в качестве клиента на конечных устройствах типа Android для предотвращения утечек IP. Когда sing-box выступает в роли шлюза для других хостов, её нужно отключать, иначе ничего работать не будет.</p>",
        "post_number": 21,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-07T08:04:25.909Z",
        "reply_count": 2,
        "reply_to_post_number": 19,
        "quote_count": 0,
        "incoming_link_count": 5,
        "reads": 114,
        "readers_count": 113,
        "score": 57.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4361,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/21",
        "can_translate": false
    },
    {
        "id": 30909,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-07T19:25:05.339Z",
        "cooked": "<p>Окей, спасибо <img src=\"https://ntc.party/images/emoji/twitter/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"> <code>ip_is_private</code> установил да. Ещё почитаю подробнее справку по sing-box на тему маршрутов и DNS, всё руки не доходили, видимо пора.</p>",
        "post_number": 22,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-07T19:25:15.166Z",
        "reply_count": 0,
        "reply_to_post_number": 21,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 106,
        "readers_count": 105,
        "score": 36.0,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "MasterYoba",
            "name": "",
            "avatar_template": "/user_avatar/ntc.party/masteryoba/{size}/6182_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/22",
        "can_translate": false
    },
    {
        "id": 31230,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-08T15:14:09.832Z",
        "cooked": "<p>It works! <img src=\"https://ntc.party/images/emoji/twitter/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>Если кому интересно, на доисторической Raspberry Pi 1B все это работает далеко от идеала, но работает. Железо в ней очень слабое, и если в режиме прокси в sing-box все выглядит пристойно, то более тяжелый tun просаживает скорость по speedtest до 6,5 - 8 Mbps, и даже банальный веб-серфинг становится довольно тормозным. Но потом вспомнил, что можно активировать разгон через <code>sudo raspi-config</code>. В режиме Turbo тормоза уходят, а speedtest выдает уже 12,5 Mbps. Youtube в статистике для сисадминов почему-то показывает чуть более высокую скорость и работает хорошо вплоть до 1440p@60fps (но 4K уже нет). Температура не поднимается выше 55 градусов (без радиатора).</p>\n<p>В /etc/sysctl.conf прописал:</p>\n<pre><code class=\"lang-auto\">net.ipv6.conf.all.disable_ipv6 = 1\nnet.ipv6.conf.default.disable_ipv6 = 1\nnet.ipv4.ip_forward = 1\n</code></pre>\n<p>Конфиг для sing-box в итоге такой (домены для обхода блокировок взял из файла russia-youtube.txt в архиве с GoodbyeDPI). Логи отключил, чтобы лишний раз не дергать карту памяти.</p>\n<pre><code class=\"lang-auto\">{\n\t\"log\": {\n\t\t\"disabled\": true,\n\t\t\"level\": \"warn\",\n\t\t\"output\": \"/tmp/sing-box.log\",\n\t\t\"timestamp\": true\n\t},\n\t\"dns\": {\n\t\t\"servers\": [\n\t\t\t{\n\t\t\t\t\"tag\": \"google\",\n\t\t\t\t\"address\": \"https://8.8.8.8/dns-query\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"tag\": \"local\",\n\t\t\t\t\"address\": \"192.168.1.1\",\n\t\t\t\t\"detour\": \"direct\"\n\t\t\t},\n\t\t\t{\n\t\t\t\"tag\": \"block\",\n\t\t\t\"address\": \"rcode://success\"\n\t\t\t}\n\t\t],\n\t\t\"strategy\": \"ipv4_only\"\n\t},\n\t\"inbounds\": [\n\t\t{\n\t\t\t\"type\": \"tun\",\n\t\t\t\"interface_name\": \"tun0\",\n\t\t\t\"domain_strategy\": \"ipv4_only\",\n\t\t\t\"inet4_address\": \"172.16.250.1/30\",\n\t\t\t\"mtu\": 9000,\n\t\t\t\"auto_route\": true,\n\t\t\t\"strict_route\": false,\n\t\t\t\"sniff\": true,\n\t\t\t\"sniff_override_destination\": true\n\t\t}\n\t],\n\t\"outbounds\": [\n\t\t{\n\t\t\t\"type\": \"vless\",\n\t\t\t\"tag\": \"vless-out\",\n\t\t\t\"server\": \"IP_ADDRESS\",\n\t\t\t\"server_port\": 443,\n\t\t\t\"uuid\": \"UUID\",\n\t\t\t\"flow\": \"xtls-rprx-vision\",\n\t\t\t\"network\": \"tcp\",\n\t\t\t\"tls\": {\n\t\t\t\t\"enabled\": true,\n\t\t\t\t\"server_name\": \"DOMAIN\",\n\t\t\t\t\"alpn\": [\"h2\"],\n\t\t\t\t\"utls\": {\n\t\t\t\t\t\"enabled\": true,\n\t\t\t\t\t\"fingerprint\": \"chrome\"\n\t\t\t\t},\n\t\t\t\t\"reality\": {\n\t\t\t\t\t\"enabled\": true,\n\t\t\t\t\t\"public_key\": \"PUBLIC_KEY\",\n\t\t\t\t\t\"short_id\": \"SHORT_ID\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"packet_encoding\": \"xudp\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"direct\",\n\t\t\t\"tag\": \"direct\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"block\",\n\t\t\t\"tag\": \"block\"\n\t\t},\n\t\t\t{\n\t\t\t\"type\": \"dns\",\n\t\t\t\"tag\": \"dns-out\"\n\t\t}\n\t],\n\t\"route\": {\n\t\t\"rules\": [\n\t\t\t{\n\t\t\t\t\"protocol\": \"dns\",\n\t\t\t\t\"outbound\": \"dns-out\"\n\t\t\t},\n\t\t\t{\n                \"ip_is_private\": true,\n                \"outbound\": \"direct\"\n            },\n\t\t\t{\n                \"domain_suffix\": \".youtube.com\",\n                \"outbound\": \"vless-out\"\n            },\n\t\t\t{\n                \"domain_suffix\": \".youtu.be\",\n                \"outbound\": \"vless-out\"\n            },\n\t\t\t{\n                \"domain_suffix\": \".ytimg.com\",\n                \"outbound\": \"vless-out\"\n            },\n\t\t\t{\n                \"domain_suffix\": \".googlevideo.com\",\n                \"outbound\": \"vless-out\"\n            }\n\t\t],\n\t\"final\": \"direct\",\n\t\"auto_detect_interface\": true\n\t}\n}\n</code></pre>\n<p>Обращу внимание на директиву <code>\"final\": \"direct\"</code> в секции route, без нее весь трафик пойдет на удаленный сервер, а нам это не нужно. Еще я пытался вынести домены в отдельный файл, чтобы не вводить для каждого новую секцию в конфиге (хотя вот сейчас дошло, что секцию можно оставить одну, а суффиксы вписать массивом, но все равно хотелось бы вынести их из конфига в отдельный файл). И я даже успешно создал srs файл через</p>\n<pre><code class=\"lang-auto\">sing-box rule-set compile [--output &lt;file-name&gt;.srs] &lt;file-name&gt;.json\n</code></pre>\n<p>Но пока так и не понял, как этот srs файл подключить в конфиг. Пытался через rule_set, но видимо неправильно, потому что sing-box наотрез отказывается запускаться, и в логах почему-то пусто (хотя были включены). Если кто-то знает, пожалуйста подскажите.</p>",
        "post_number": 23,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-08T15:45:31.140Z",
        "reply_count": 3,
        "reply_to_post_number": 21,
        "quote_count": 0,
        "incoming_link_count": 34,
        "reads": 110,
        "readers_count": 109,
        "score": 206.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 4,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "MasterYoba",
            "name": "",
            "avatar_template": "/user_avatar/ntc.party/masteryoba/{size}/6182_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/23",
        "can_translate": false
    },
    {
        "id": 31251,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-08-08T15:52:24.526Z",
        "cooked": "<p>для большей производительности добавь в tun</p>\n<pre><code class=\"lang-auto\">\"gso\": true\n</code></pre>\n<p>или можно перейти на iptables redirect, сделать его нетрудно:</p>\n<pre><code class=\"lang-auto\">{\n  \"type\": \"redirect\",\n  \"tag\": \"redirect-in\",\n  \"listen\": \"0.0.0.0\",\n  \"listen_port\": 100\n}\n</code></pre>\n<pre><code class=\"lang-auto\">iptables -t nat -A PREROUTING -s tv_ip/32 -p tcp -j REDIRECT --to-port 100\n</code></pre>",
        "post_number": 24,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-08T16:10:26.229Z",
        "reply_count": 2,
        "reply_to_post_number": 23,
        "quote_count": 0,
        "incoming_link_count": 4,
        "reads": 97,
        "readers_count": 96,
        "score": 49.4,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/24",
        "can_translate": false
    },
    {
        "id": 31256,
        "name": "",
        "username": "MasterYoba",
        "avatar_template": "/user_avatar/ntc.party/masteryoba/{size}/6182_2.png",
        "created_at": "2024-08-08T16:01:34.552Z",
        "cooked": "<p>Правильно будет вот так:<br>\nСодержимое youtube.json файла с правилами:</p>\n<pre><code class=\"lang-auto\">{\n    \"version\": 1,\n    \"rules\": [\n        {\n            \"domain_suffix\": [\n                \".googlevideo.com\",\n                \".youtube.com\",\n                \".ggpht.com\",\n                \".ytimg.com\",\n                \".googleapis.com\",\n                \".youtu.be\"\n            ]\n        }\n    ]\n}\n</code></pre>\n<p>Подключение его в правилах конфига:</p>\n<pre><code class=\"lang-auto\">    \"route\": {\n        \"auto_detect_interface\": true,\n        \"final\": \"direct\",\n        \"rules\": [\n            {\n                \"protocol\": \"dns\",\n                \"outbound\": \"dns-out\"\n            },\n            {\n                \"ip_is_private\": true,\n                \"outbound\": \"direct\"\n            },\n            {\n                \"rule_set\": \"youtube\",\n                \"outbound\": \"vless-out\"\n            }\n        ],\n        \"rule_set\": [\n            {\n                \"tag\": \"youtube\",\n                \"type\": \"local\",\n                \"format\": \"source\",\n                \"path\": \"/etc/sing-box/rule-set/youtube.json\"\n            }\n        ]\n</code></pre>\n<p>Если сконвертили в .srs через <code>sing-box rule-set compile</code>, то тогда <code>\"format\": \"binary\"</code><br>\nПравда .srs скорее нужно для оптимизации огромных наборов правил, вроде списков antizapret с миллионом строк, как у этого товарища - <a href=\"https://github.com/savely-krasovsky/antizapret-sing-box\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">GitHub - savely-krasovsky/antizapret-sing-box: Пример конфига</a></p>",
        "post_number": 25,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-08T16:01:34.552Z",
        "reply_count": 1,
        "reply_to_post_number": 23,
        "quote_count": 0,
        "incoming_link_count": 8,
        "reads": 101,
        "readers_count": 100,
        "score": 65.2,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://github.com/savely-krasovsky/antizapret-sing-box",
                "internal": false,
                "reflection": false,
                "title": "GitHub - savely-krasovsky/antizapret-sing-box: Пример конфига",
                "clicks": 15
            }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4361,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/25",
        "can_translate": false
    },
    {
        "id": 31260,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-08T16:04:32.201Z",
        "cooked": "<p><a class=\"mention\" href=\"/u/masteryoba\">@MasterYoba</a> а, значит я просто одно лишнее правило добавлял. Попробую как вы сказали, спасибо.</p>\n<aside class=\"quote no-group\" data-username=\"0ka\" data-post=\"24\" data-topic=\"8804\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/0/d78d45/48.png\" class=\"avatar\"> 0ka:</div>\n<blockquote>\n<p><code>\"gso\": true</code></p>\n</blockquote>\n</aside>\n<p>Это кстати пробовал, но заметных изменений не дало. Возможно, потому что <code>ethtool -k eth0</code> выдаёт <code>generic-segmentation-offload: off [requested on]</code>, принудительно включить не удалось.</p>\n<aside class=\"quote no-group\" data-username=\"0ka\" data-post=\"24\" data-topic=\"8804\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/0/d78d45/48.png\" class=\"avatar\"> 0ka:</div>\n<blockquote>\n<p>или можно перейти на iptables redirect</p>\n</blockquote>\n</aside>\n<p>Вообще любопытно. Если правильно понял, inbound типа redirect слушает на 100 порту, на который мы переводим запросы с ТВ. Спасибо, попробую так сделать.</p>",
        "post_number": 26,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-08T16:24:37.099Z",
        "reply_count": 0,
        "reply_to_post_number": 24,
        "quote_count": 1,
        "incoming_link_count": 8,
        "reads": 89,
        "readers_count": 88,
        "score": 57.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 3,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://ntc.party/t/%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-vpn-%D0%B4%D0%BB%D1%8F-%D0%B2%D1%81%D0%B5%D0%B9-%D0%B4%D0%BE%D0%BC%D0%B0%D1%88%D0%BD%D0%B5%D0%B9-%D1%81%D0%B5%D1%82%D0%B8/9125/3",
                "internal": true,
                "reflection": true,
                "title": "Настройка VPN для всей домашней сети",
                "clicks": 3
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/26",
        "can_translate": false
    },
    {
        "id": 31281,
        "name": "Shelby",
        "username": "lawsonshelby",
        "avatar_template": "/letter_avatar_proxy/v4/letter/l/59ef9b/{size}.png",
        "created_at": "2024-08-08T17:20:51.646Z",
        "cooked": "<p>Здравствуйте! А подскажите может есть успешные кейсы с Docker контейнером?</p>\n<p>У меня есть хост докера, у него есть macvlan я этому контейнеру прописываю статический айпишник в локальной сети:<br>\nversi</p>\n<pre><code class=\"lang-auto\">on: \"3.8\"\nservices:\n  sing-box:\n    image: ghcr.io/sagernet/sing-box\n    container_name: sing-box\n    restart: always\n    volumes:\n      - $PWD/:/etc/sing-box/\n    command: -D /var/lib/sing-box -C /etc/sing-box/ run\n    networks:\n      macnet8:\n        ipv4_address: 192.168.50.6\n    cap_add:\n      - NET_ADMIN\n    devices:\n      - /dev/net/tun\nnetworks:\n  macnet8:\n    external: true\n</code></pre>\n<p>Конфиг уже использую практически полностью такой же как финальный у <a href=\"https://ntc.party/u/xofamim548\">xofamim548</a></p>\n<p>Вроде всё запускается, в логах чисто:</p>\n<pre><code class=\"lang-auto\">+0000 2024-08-08 17:03:01 INFO router: updated default interface eth0, index 406\n+0000 2024-08-08 17:03:01 INFO inbound/tun[0]: started at tun0\n+0000 2024-08-08 17:03:01 INFO sing-box started (0.00s)\n</code></pre>\n<p>Но когда у себя указываю в качестве дефолт гейтвея этот контейнер, то у меня всё умирает, никакого интернета нет. Что-то уже не знаю куда копать)) Собираюсь доставать физическую распбери уже))</p>",
        "post_number": 27,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-08T17:20:51.646Z",
        "reply_count": 2,
        "reply_to_post_number": 8,
        "quote_count": 0,
        "incoming_link_count": 4,
        "reads": 93,
        "readers_count": 92,
        "score": 48.6,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "Shelby",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "MasterYoba",
            "name": "",
            "avatar_template": "/user_avatar/ntc.party/masteryoba/{size}/6182_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4514,
        "hidden": false,
        "trust_level": 0,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/27",
        "can_translate": false
    },
    {
        "id": 31288,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-08-08T17:37:02.292Z",
        "cooked": "<p>попробуйте</p>\n<pre><code class=\"lang-auto\">sysctl -w net.ipv4.conf.default.rp_filter=0\nsysctl -w net.ipv4.conf.all.rp_filter=0\nsysctl -w net.ipv4.ip_forward=1\n</code></pre>",
        "post_number": 28,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-08T17:37:02.292Z",
        "reply_count": 1,
        "reply_to_post_number": 27,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 84,
        "readers_count": 83,
        "score": 26.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "lawsonshelby",
            "name": "Shelby",
            "avatar_template": "/letter_avatar_proxy/v4/letter/l/59ef9b/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/28",
        "can_translate": false
    },
    {
        "id": 31300,
        "name": "Shelby",
        "username": "lawsonshelby",
        "avatar_template": "/letter_avatar_proxy/v4/letter/l/59ef9b/{size}.png",
        "created_at": "2024-08-08T18:07:21.917Z",
        "cooked": "<p>Поменял, запустил контейнер в привилегированном режиме, но картина та же. В логах пустота…</p>",
        "post_number": 29,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-08T18:07:21.917Z",
        "reply_count": 0,
        "reply_to_post_number": 28,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 83,
        "readers_count": 82,
        "score": 26.6,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "Shelby",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "0ka",
            "name": "0ka",
            "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4514,
        "hidden": false,
        "trust_level": 0,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/29",
        "can_translate": false
    },
    {
        "id": 31304,
        "name": "",
        "username": "MasterYoba",
        "avatar_template": "/user_avatar/ntc.party/masteryoba/{size}/6182_2.png",
        "created_at": "2024-08-08T18:10:35.402Z",
        "cooked": "<p>У меня такого опыта именно с docker macvlan не было, если команды <a class=\"mention\" href=\"/u/0ka\">@0ka</a> не помогут, я бы попробовал посмотреть через <code>tcpdump -v</code>, что происходит с трафиком внутри контейнера, что он не попадает в петлю и не дропается например. Как вариант, попробовать добавить в контейнер второй интерфейс с маршрутом default, чтобы трафик от устройств заходил в один интерфейс (который будет их шлюзом), а выходил в интернет через другой.</p>",
        "post_number": 30,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-08T18:10:35.402Z",
        "reply_count": 0,
        "reply_to_post_number": 27,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 84,
        "readers_count": 83,
        "score": 31.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "lawsonshelby",
            "name": "Shelby",
            "avatar_template": "/letter_avatar_proxy/v4/letter/l/59ef9b/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4361,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/30",
        "can_translate": false
    },
    {
        "id": 31306,
        "name": "Shelby",
        "username": "lawsonshelby",
        "avatar_template": "/letter_avatar_proxy/v4/letter/l/59ef9b/{size}.png",
        "created_at": "2024-08-08T18:41:41.427Z",
        "cooked": "<p>Бросил докер, убил на него уже часов 5, достал распберри 4, но не могу даже простой роутинг что-то настроить, или туплю или там ещё что-то нужно сделать кроме как включить:<br>\nnet.ipv4.ip_forward = 1</p>\n<p>Чтобы просто без впн через него трафик хотя бы начал ходить?</p>",
        "post_number": 31,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-08T18:41:41.427Z",
        "reply_count": 1,
        "reply_to_post_number": 23,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 82,
        "readers_count": 81,
        "score": 26.4,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "Shelby",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4514,
        "hidden": false,
        "trust_level": 0,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/31",
        "can_translate": false
    },
    {
        "id": 31323,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-08T19:37:49.700Z",
        "cooked": "<p>После этого выполнить (если ещё не)<br>\n<code>sudo sysctl -p</code><br>\nи возможно<br>\n<code>sudo systemctl restart NetworkManager</code>.</p>\n<p>По идее больше ничего. После этого указываете малину как шлюз, в качестве DNS роутер или 8.8.8.8. У меня работает так.</p>",
        "post_number": 32,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-08T19:38:32.107Z",
        "reply_count": 1,
        "reply_to_post_number": 31,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 82,
        "readers_count": 81,
        "score": 26.4,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "lawsonshelby",
            "name": "Shelby",
            "avatar_template": "/letter_avatar_proxy/v4/letter/l/59ef9b/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/32",
        "can_translate": false
    },
    {
        "id": 31327,
        "name": "Shelby",
        "username": "lawsonshelby",
        "avatar_template": "/letter_avatar_proxy/v4/letter/l/59ef9b/{size}.png",
        "created_at": "2024-08-08T20:01:04.273Z",
        "cooked": "<p>Странно но дело было в DNS. Но теперь ютуб просто какими-то скачками работает))) как буто супер ускоренный</p>",
        "post_number": 33,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-08T20:01:04.273Z",
        "reply_count": 1,
        "reply_to_post_number": 32,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 77,
        "readers_count": 76,
        "score": 20.4,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "Shelby",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4514,
        "hidden": false,
        "trust_level": 0,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/33",
        "can_translate": false
    },
    {
        "id": 31329,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-08T20:07:34.583Z",
        "cooked": "<p>Скачками это в смысле немного потормозит и резко раздупляется?) На youtube включите статистику для сисадминов, посмотрите что там с буферизацией происходит. И на малине посмотрите что происходит в htop. По идее в качестве шлюза она вообще без проблем должна работать.</p>",
        "post_number": 34,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-08T20:07:34.583Z",
        "reply_count": 1,
        "reply_to_post_number": 33,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 80,
        "readers_count": 79,
        "score": 21.0,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "lawsonshelby",
            "name": "Shelby",
            "avatar_template": "/letter_avatar_proxy/v4/letter/l/59ef9b/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/34",
        "can_translate": false
    },
    {
        "id": 31339,
        "name": "Shelby",
        "username": "lawsonshelby",
        "avatar_template": "/letter_avatar_proxy/v4/letter/l/59ef9b/{size}.png",
        "created_at": "2024-08-08T20:35:52.752Z",
        "cooked": "<p>На телевизоре нормально показывает в 4к, на компе что-то стало с буферизацией как будто сразу на несколько секунд вперед прыгает, но я ещё изучу! Спасибо всем за помощь! Кстати, в докере тоже заработало, когда DNS прописал. Но блин когда я просто пинговать пробовал по адресу, а не по имени никакого пинга не проходило. На компе от браузера зависит, в хроме большой дроп кадров, в сафари нет звука, при этом на телеке нормально и изображение и звук<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"raspberry-pi-xray-между-роутером-и-телевизором/8ae1806c755b30bb6d86249f5b533c08ee6fceff.png\" data-download-href=\"https://ntc.party/uploads/default/8ae1806c755b30bb6d86249f5b533c08ee6fceff\" title=\"screen\"><img src=\"raspberry-pi-xray-между-роутером-и-телевизором/8ae1806c755b30bb6d86249f5b533c08ee6fceff_2_690x216.png\" alt=\"screen\" data-base62-sha1=\"jOB1BU1t6kmy4CtiHyhb34Rcm87\" width=\"690\" height=\"216\" srcset=\"raspberry-pi-xray-между-роутером-и-телевизором/8ae1806c755b30bb6d86249f5b533c08ee6fceff_2_690x216.png, raspberry-pi-xray-между-роутером-и-телевизором/8ae1806c755b30bb6d86249f5b533c08ee6fceff.png 1.5x, raspberry-pi-xray-между-роутером-и-телевизором/8ae1806c755b30bb6d86249f5b533c08ee6fceff.png 2x\" data-dominant-color=\"353936\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">screen</span><span class=\"informations\">982×308 63.9 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
        "post_number": 35,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-08T20:35:52.752Z",
        "reply_count": 1,
        "reply_to_post_number": 34,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 82,
        "readers_count": 81,
        "score": 26.4,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "Shelby",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4514,
        "hidden": false,
        "trust_level": 0,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/35",
        "can_translate": false
    },
    {
        "id": 31343,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-08T20:57:08.936Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"0ka\" data-post=\"24\" data-topic=\"8804\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/0/d78d45/48.png\" class=\"avatar\"> 0ka:</div>\n<blockquote>\n<p>или можно перейти на iptables redirect, сделать его нетрудно:</p>\n<pre><code class=\"lang-auto\">{\n  \"type\": \"redirect\",\n  \"tag\": \"redirect-in\",\n  \"listen\": \"0.0.0.0\",\n  \"listen_port\": 100\n}\n</code></pre>\n<p><code>iptables -t nat -A PREROUTING -s tv_ip/32 -p tcp -j REDIRECT --to-port 100</code></p>\n</blockquote>\n</aside>\n<p>Бегло потестировал с ПК - работает! Нагрузка значительно меньше, чем в режиме tun, видео в 4k летают. Прямо вау.</p>",
        "post_number": 36,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-08T20:57:08.936Z",
        "reply_count": 2,
        "reply_to_post_number": 24,
        "quote_count": 1,
        "incoming_link_count": 6,
        "reads": 87,
        "readers_count": 86,
        "score": 57.4,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/36",
        "can_translate": false
    },
    {
        "id": 31344,
        "name": "Shelby",
        "username": "lawsonshelby",
        "avatar_template": "/letter_avatar_proxy/v4/letter/l/59ef9b/{size}.png",
        "created_at": "2024-08-08T20:58:09.124Z",
        "cooked": "<p>Чот какой-то был глюк уже на замученном компе походу с ютубом. Сейчас перезагрузился и через докер нормально показывает 4к!</p>",
        "post_number": 37,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-08T20:58:09.124Z",
        "reply_count": 0,
        "reply_to_post_number": 35,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 79,
        "readers_count": 78,
        "score": 15.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "Shelby",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "lawsonshelby",
            "name": "Shelby",
            "avatar_template": "/letter_avatar_proxy/v4/letter/l/59ef9b/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4514,
        "hidden": false,
        "trust_level": 0,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/37",
        "can_translate": false
    },
    {
        "id": 31345,
        "name": "Shelby",
        "username": "lawsonshelby",
        "avatar_template": "/letter_avatar_proxy/v4/letter/l/59ef9b/{size}.png",
        "created_at": "2024-08-08T20:59:55.333Z",
        "cooked": "<p>Эх… сколько нам открытий чудных) Здорово! Надо будет тоже попробовать</p>",
        "post_number": 38,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-08T20:59:55.333Z",
        "reply_count": 0,
        "reply_to_post_number": 36,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 80,
        "readers_count": 79,
        "score": 21.0,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "Shelby",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4514,
        "hidden": false,
        "trust_level": 0,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/38",
        "can_translate": false
    },
    {
        "id": 31357,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-08-08T22:07:00.073Z",
        "cooked": "<p>Я выше оставил в команде только tcp, и если вы убрали tun, то udp трафик (quic) будет идти напрямую. Но можно заблокировать udp (reject) на 443 порту чтобы не работал quic, тогда будет еще меньше нагрузка на железо</p>",
        "post_number": 39,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-08T22:07:39.831Z",
        "reply_count": 1,
        "reply_to_post_number": 36,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 81,
        "readers_count": 80,
        "score": 21.2,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/39",
        "can_translate": false
    },
    {
        "id": 31456,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-09T09:54:34.142Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"MasterYoba\" data-post=\"25\" data-topic=\"8804\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/user_avatar/ntc.party/masteryoba/48/6182_2.png\" class=\"avatar\"> MasterYoba:</div>\n<blockquote>\n<p>Правильно будет вот так:</p>\n</blockquote>\n</aside>\n<p>Все работает, большое спасибо!</p>",
        "post_number": 40,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-09T09:54:34.142Z",
        "reply_count": 0,
        "reply_to_post_number": 25,
        "quote_count": 1,
        "incoming_link_count": 1,
        "reads": 84,
        "readers_count": 83,
        "score": 21.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/40",
        "can_translate": false
    },
    {
        "id": 31457,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-09T10:00:54.553Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"0ka\" data-post=\"39\" data-topic=\"8804\" data-full=\"true\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/0/d78d45/48.png\" class=\"avatar\"> 0ka:</div>\n<blockquote>\n<p>Я выше оставил в команде только tcp, и если вы убрали tun, то udp трафик (quic) будет идти напрямую. Но можно заблокировать udp (reject) на 443 порту чтобы не работал quic, тогда будет еще меньше нагрузка на железо</p>\n</blockquote>\n</aside>\n<p>Если честно, не до конца понимаю, что происходит и почему так.</p>\n<p>Создал inbound redirect в sing-box, прописал вот это для ip адресов ПК и телевизора:</p>\n<pre><code class=\"lang-auto\">iptables -t nat -A PREROUTING -s tv_ip/32 -p tcp -j REDIRECT --to-port 100\n</code></pre>\n<p>С ПК все работает замечательно, а вот с телевизора начинаются проблемы. Если так и оставить, то youtube на ТВ упирается в 11 - 12 Mbps. Если я правильно понимаю, телевизор пытается работать через quic напрямую, потому что если в sing-box сделать вот так:</p>\n<pre><code class=\"lang-auto\">{\n \"protocol\": \"quic\",\n \"outbound\": \"block\"\n}\n</code></pre>\n<p>то youtube на ТВ перестаёт работать совсем.</p>\n<p>Попробовал прописать как вы сказали:</p>\n<pre><code class=\"lang-auto\">iptables -A INPUT -s 192.168.1.36/32 -p udp --dport 443 -j REJECT\n</code></pre>\n<p>Но и в этом случае youtube на ТВ просто не работает.</p>",
        "post_number": 41,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-09T10:01:22.147Z",
        "reply_count": 1,
        "reply_to_post_number": 39,
        "quote_count": 1,
        "incoming_link_count": 17,
        "reads": 85,
        "readers_count": 84,
        "score": 107.0,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/41",
        "can_translate": false
    },
    {
        "id": 31459,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-08-09T10:04:49.859Z",
        "cooked": "<p>вы tun оставили или убрали после добавления redirect?<br>\nу себя quic блокировал так</p>\n<pre><code class=\"lang-auto\">iptables -A FORWARD -p udp --dport 443 -j REJECT\n</code></pre>",
        "post_number": 42,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-09T10:05:44.598Z",
        "reply_count": 1,
        "reply_to_post_number": 41,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 77,
        "readers_count": 76,
        "score": 30.4,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/42",
        "can_translate": false
    },
    {
        "id": 31503,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-09T12:13:11.394Z",
        "cooked": "<p>tun убрал, оставил только это (привожу секции inbounds и route, параметры dns и outbounds не менял):</p>\n<pre><code class=\"lang-auto\">\"inbounds\": [\n\t\t{\n\t\t\t\"type\": \"redirect\",\n\t\t\t\"tag\": \"redirect-in\",\n\t\t\t\"listen\": \"0.0.0.0\",\n\t\t\t\"listen_port\": 100\n\t\t}\n\t],\n...\n\"route\": {\n\t\t\"rules\": [\n\t\t\t{\n\t\t\t\t\"protocol\": \"dns\",\n\t\t\t\t\"outbound\": \"dns-out\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"ip_is_private\": true,\n\t\t\t\t\"outbound\": \"direct\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"rule_set\": \"youtube\",\n\t\t\t\t\"outbound\": \"vless-out\"\n\t\t\t}\n        ],\n\t\"rule_set\": [\n\t\t{\n\t\t\t\"tag\": \"youtube\",\n\t\t\t\"type\": \"local\",\n\t\t\t\"format\": \"source\",\n\t\t\t\"path\": \"/etc/sing-box/rule-set/youtube.json\"\n\t\t}\n\t],\n\t\"final\": \"direct\"\n\t}\n</code></pre>\n<p>В iptables сейчас два правила:</p>\n<pre><code class=\"lang-auto\">Chain PREROUTING (policy ACCEPT)\ntarget     prot opt source               destination\nREDIRECT   tcp  --  192.168.1.36         anywhere             redir ports 100\n\n-A FORWARD -p udp -m udp --dport 443 -j REJECT --reject-with icmp-port-unreachable\n</code></pre>\n<p>Почему-то после этого приложение youtube просто зависает с серым экраном при открытии. НО если поставить final: “vless-out”, то youtube снова начинает работать <img src=\"https://ntc.party/images/emoji/twitter/frowning_with_open_mouth.png?v=12\" title=\":frowning_with_open_mouth:\" class=\"emoji\" alt=\":frowning_with_open_mouth:\" loading=\"lazy\" width=\"20\" height=\"20\"> Это странно, потому что для tun набор правил route был точно такой же, только убрал <code>auto_detect_interface</code>. Посмотрел<br>\n<code>sudo tcpdump -n -i any udp and src 192.168.1.36</code><br>\nникаких UDP кроме бродкаста на :15600 там нет. Насколько я понимаю, tcpdump показывает трафик ещё до фильтров iptables.</p>\n<p>Но если честно, я вообще не понимаю, что происходит. Прописал такой же редирект в iptables для ПК, вписал шлюз в настройки подключения, UDP на малине режектятся для всех устройств по вашему правилу, в route прописал final vless-out. В итоге получаю какую-то шизу:</p>\n<ul>\n<li><a href=\"http://speedtest.net\" rel=\"noopener nofollow ugc\">speedtest.net</a> на TV, sing-box и редиректы отключены: хорошая скорость, даже выше чем на ПК</li>\n<li><a href=\"http://speedtest.net\" rel=\"noopener nofollow ugc\">speedtest.net</a> на TV, sing-box и редиректы включены: 12,5 Mbps в обе стороны</li>\n<li><a href=\"http://speedtest.net\" rel=\"noopener nofollow ugc\">speedtest.net</a> на ПК, <strong>в обоих случаях</strong> хорошая скорость.</li>\n</ul>\n<p>Айпишники во всех случаях speedtest показывает как должно быть, да и по малине в htop сразу видна нагрузка. Ерунда какая-то.</p>\n<p>Попробую как-нибудь позже посмотреть на свежую голову, может я чего-то упускаю.</p>",
        "post_number": 43,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-09T12:15:36.264Z",
        "reply_count": 1,
        "reply_to_post_number": 42,
        "quote_count": 0,
        "incoming_link_count": 10,
        "reads": 81,
        "readers_count": 80,
        "score": 71.2,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "http://speedtest.net",
                "internal": false,
                "reflection": false,
                "title": "Speedtest by Ookla - The Global Broadband Speed Test",
                "clicks": 0
            }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "0ka",
            "name": "0ka",
            "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/43",
        "can_translate": false
    },
    {
        "id": 31511,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-08-09T12:33:40.779Z",
        "cooked": "<p>пробуй этот конф (добавил sniff, domain_strategy)</p>\n<pre><code class=\"lang-auto\">{\n    \"dns\": {\n        \"servers\": [\n            {\n                \"address\": \"udp://1.1.1.1\"\n            }\n        ],\n        \"strategy\": \"ipv4_only\"\n    },\n    \"inbounds\": [\n        {\n            \"domain_strategy\": \"ipv4_only\",\n            \"listen\": \"0.0.0.0\",\n            \"listen_port\": 100,\n            \"sniff\": true,\n            \"tag\": \"redirect-in\",\n            \"type\": \"redirect\"\n        },\n        {\n            \"auto_route\": true,\n            \"domain_strategy\": \"ipv4_only\",\n            \"gso\": true,\n            \"inet4_address\": \"198.18.0.1/30\",\n            \"interface_name\": \"singtun\",\n            \"mtu\": 1500,\n            \"sniff\": true,\n            \"tag\": \"tun-in\",\n            \"type\": \"tun\"\n        },\n        {\n            \"listen\": \"0.0.0.0\",\n            \"listen_port\": 53,\n            \"sniff\": true,\n            \"tag\": \"dns-cache\",\n            \"type\": \"direct\"\n        }\n    ],\n    \"log\": {\n        \"level\": \"info\"\n    },\n    \"outbounds\": [\n        {\n\t\t\t#vless\n        },\n        {\n            \"tag\": \"dns-out\",\n            \"type\": \"dns\"\n        },\n        {\n            \"tag\": \"direct\",\n            \"type\": \"direct\"\n        },\n        {\n            \"tag\": \"block\",\n            \"type\": \"block\"\n        }\n    ],\n    \"route\": {\n        \"auto_detect_interface\": true,\n        \"final\": \"direct\",\n        \"rule_set\": [\n            {\n                \"format\": \"source\",\n                \"path\": \"/etc/sing-box/rule-set/youtube.json\",\n                \"tag\": \"youtube\",\n                \"type\": \"local\"\n            }\n        ],\n        \"rules\": [\n            {\n                \"outbound\": \"dns-out\",\n                \"protocol\": \"dns\"\n            },\n            {\n                \"outbound\": \"vless-out\",\n                \"rule_set\": \"youtube\"\n            }\n        ]\n    }\n}\n</code></pre>\n<pre><code class=\"lang-auto\">iptables -A FORWARD -p udp --dport 443 -j REJECT\niptables -t nat -A PREROUTING -s tv_ip/32 -p tcp -j REDIRECT --to-port 100\n</code></pre>\n<p>редирект вроде бы не может в udp поэтому tun остаётся на всякий случай для udp трафика.<br>\nустройства перезагрузить после запуска сервиса и применения правил, или если винда, то можно выполнить</p>\n<pre><code class=\"lang-auto\">netsh interface ip delete destinationcache\n</code></pre>",
        "post_number": 44,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-09T12:40:56.440Z",
        "reply_count": 2,
        "reply_to_post_number": 43,
        "quote_count": 0,
        "incoming_link_count": 13,
        "reads": 78,
        "readers_count": 77,
        "score": 90.6,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/44",
        "can_translate": false
    },
    {
        "id": 31514,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-09T12:40:38.894Z",
        "cooked": "<p>Окей, большое спасибо, попробую на выходных. Про перезагрузки кстати, тоже думал, что может какой-то мусор остаётся, и малину перезагружал и телевизор от питания отключал, но нет. Попробую этот конфиг, посмотрим что получится.</p>",
        "post_number": 45,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-09T12:40:38.894Z",
        "reply_count": 0,
        "reply_to_post_number": 44,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 70,
        "readers_count": 69,
        "score": 19.0,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "0ka",
            "name": "0ka",
            "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/45",
        "can_translate": false
    },
    {
        "id": 32522,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-12T12:14:47.413Z",
        "cooked": "<p>Чтобы лишний раз не отнимать чужое время, уточню сразу: в принципе я добился того, что мне нужно, и текущая ситуация (с учётом нулевых затрат) меня вполне устраивает. Тем не менее, рассказываю, что в итоге получилось (спойлер: получилось странное) с ноткой некоторого недоумения.</p>\n<p>В iptables следующее:</p>\n<pre><code class=\"lang-auto\">sudo iptables -t nat -A PREROUTING -s 192.168.1.36/32 -p tcp -j REDIRECT --to-port 100\nsudo iptables -A FORWARD -p udp --dport 443 -j DROP\n</code></pre>\n<p>(Разницы между DROP и REJECT не увидел, да и дело по-моему совсем не в QUIC, я не вижу udp запросов с телевизора на 443 порт ни в логах, ни в tcpdump. Также прописал редиректы для ПК и смартфона, но об этом потом.)</p>\n<p>Ваш конфиг тоже не заработал, но вы подбросили мне идею: я действительно забыл про <code>sniff</code> в инбаунде redirect. Если добавить <code>sniff</code> и <code>sniff_override_destination</code>, то что-то слегка меняется, по крайней мере приложение начинает открываться, но по-прежнему как будто бы идет через РФ. К тому моменту я уже почитал тему о маркировке российских IP гуглом и от греха подальше решил перейти к обычной гео фильтрации, которой уже сто лет пользуюсь во всех клиентах. Ссылки на srs украл из hiddify:</p>\n<pre><code class=\"lang-auto\">\t\"route\": {\n\t\t\"rules\": [\n\t\t\t{\n\t\t\t\t\"protocol\": \"dns\",\n\t\t\t\t\"outbound\": \"dns-out\"\n\t\t\t},\n\t\t\t{\n                \"ip_is_private\": true,\n                \"outbound\": \"direct\"\n            },\n\t\t\t{\n                \"rule_set\": [\n\t\t\t\t\t\"geoip-ru\",\n\t\t\t\t\t\"geosite-ru\"\n\t\t\t\t],\n                \"outbound\": \"direct\"\n            }\n        ],\n\t\"rule_set\": [\n\t\t{\n\t\t\t\"type\": \"remote\",\n\t\t\t\"tag\": \"geoip-ru\",\n\t\t\t\"format\": \"binary\",\n\t\t\t\"url\": \"https://raw.githubusercontent.com/Chocolate4U/Iran-sing-box-rules/rule-set/geoip-ru.srs\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"remote\",\n\t\t\t\"tag\": \"geosite-ru\",\n\t\t\t\"format\": \"binary\",\n\t\t\t\"url\": \"https://raw.githubusercontent.com/Chocolate4U/Iran-sing-box-rules/rule-set/geosite-category-ru.srs\"\n\t\t}\n\t],\n\t\"final\": \"vless-out\",\n\t\"auto_detect_interface\": true\n\t}\n</code></pre>\n<p>Но и это ничего не изменило.</p>\n<p>А потом я вспомнил, что во всех клиентах на ПК у меня всегда был прописан DoH без условий, да и в Firefox по вашему совету тоже. <strong>И наконец-то получил рабочий конфиг:</strong></p>\n<pre><code class=\"lang-auto\">{\n\t\"log\": {\n\t\t\"disabled\": false,\n\t\t\"level\": \"debug\",\n\t\t\"output\": \"/tmp/sing-box.log\",\n\t\t\"timestamp\": true\n\t},\n\t\"dns\": {\n\t\t\"servers\": [\n\t\t\t{\n\t\t\t\t\"tag\": \"google\",\n\t\t\t\t\"address\": \"https://8.8.8.8/dns-query\"\n\t\t\t},\n\t\t\t{\n\t\t\t\"tag\": \"block\",\n\t\t\t\"address\": \"rcode://success\"\n\t\t\t}\n\t\t],\n\t\t\"final\": \"google\",\n\t\t\"strategy\": \"ipv4_only\"\n\t},\n\t\"inbounds\": [\n\t\t{\n\t\t\t\"type\": \"tun\",\n\t\t\t\"interface_name\": \"tun0\",\n\t\t\t\"domain_strategy\": \"ipv4_only\",\n\t\t\t\"inet4_address\": \"172.16.250.1/30\",\n\t\t\t\"mtu\": 1500,\n\t\t\t\"auto_route\": true,\n\t\t\t\"strict_route\": false,\n\t\t\t\"sniff\": true,\n\t\t\t\"sniff_override_destination\": true\n\t\t},\n\t\t{\n\t\t\t\"type\": \"redirect\",\n\t\t\t\"tag\": \"redirect-in\",\n\t\t\t\"listen\": \"0.0.0.0\",\n\t\t\t\"listen_port\": 100,\n\t\t\t\"domain_strategy\": \"ipv4_only\",\n\t\t\t\"sniff\": true,\n\t\t\t\"sniff_override_destination\": true\n\t\t}\n\t],\n\t\"outbounds\": [\n\t\t{\n\t\t\t# vless-out\n\t\t},\n\t\t{\n\t\t\t\"type\": \"direct\",\n\t\t\t\"tag\": \"direct\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"block\",\n\t\t\t\"tag\": \"block\"\n\t\t},\n\t\t\t{\n\t\t\t\"type\": \"dns\",\n\t\t\t\"tag\": \"dns-out\"\n\t\t}\n\t],\n\t\"route\": {\n\t\t\"rules\": [\n\t\t\t{\n\t\t\t\t\"protocol\": \"dns\",\n\t\t\t\t\"outbound\": \"dns-out\"\n\t\t\t},\n\t\t\t{\n                \"ip_is_private\": true,\n                \"outbound\": \"direct\"\n            },\n\t\t\t{\n                \"rule_set\": [\n\t\t\t\t\t\"geoip-ru\",\n\t\t\t\t\t\"geosite-ru\"\n\t\t\t\t],\n                \"outbound\": \"direct\"\n            }\n        ],\n\t\"rule_set\": [\n\t\t{\n\t\t\t\"type\": \"remote\",\n\t\t\t\"tag\": \"geoip-ru\",\n\t\t\t\"format\": \"binary\",\n\t\t\t\"url\": \"https://raw.githubusercontent.com/Chocolate4U/Iran-sing-box-rules/rule-set/geoip-ru.srs\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"remote\",\n\t\t\t\"tag\": \"geosite-ru\",\n\t\t\t\"format\": \"binary\",\n\t\t\t\"url\": \"https://raw.githubusercontent.com/Chocolate4U/Iran-sing-box-rules/rule-set/geosite-category-ru.srs\"\n\t\t}\n\t],\n\t\"final\": \"vless-out\",\n\t\"auto_detect_interface\": true\n\t}\n}\n</code></pre>\n<p>Я не знаю, почему, но в отличие от всего остального оно работает.</p>\n<p>Веселье, брызги шампанского, тему можно закрывать? Не совсем <img src=\"https://ntc.party/images/emoji/twitter/upside_down_face.png?v=12\" title=\":upside_down_face:\" class=\"emoji\" alt=\":upside_down_face:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>Осталась крайне загадочная проблема, корни которой я понять не могу. Скорость на ТВ действительно становится выше - ну, типа, с 8 - 9 Mbps по speedtest она вырастает до 13 - 14 Mbps (upload всегда на 1 - 2 мегабита выше, чем download, хотя в тестах без sing-box обычно наоборот). В приложении youtube изменения примерно такие же. В то же время на ПК с Windows 10 скорость становится <strong>намного</strong> выше, упираясь только в обычную ширину канала по wi-fi, а youtube без проблем открывает 4K 60 fps. Все тесты на speedtest делаются до одного и того же сервера, во всех случаях верно определяется удаленный IP-адрес.</p>\n<p>Аналогичную проблему вижу на смартфоне с Android, для которого я тоже прописал редирект в iptables: там скорость опять-таки бьется в потолок 13 - 14 Mbps, и youtube тоже не воспроизводит 4K.</p>\n<p>Что общего между смартфоном на Android и ТВ Samsung, чего нет у Windows - я понять не могу. Пробовал отключать в Firefox DoH и чистить кэш запросов, отключать http3 и даже http2, тестировать через Chrome, прописывать одни и те же dns-серверы на всех устройствах (8.8.8.8, или роутер, или малина) - и неизменно получаю высокую скорость на ПК, а на телевизоре и смартфоне неизменно упираюсь в 13 - 14 Mbps (с той же небольшой разницей в пользу upload). Единственная особенность ПК - то, что он подключен к Wi-Fi через Keenetic Start в режиме адаптера, но не уверен, что это как-то может влиять на ситуацию.</p>",
        "post_number": 46,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-12T12:28:19.815Z",
        "reply_count": 3,
        "reply_to_post_number": 44,
        "quote_count": 0,
        "incoming_link_count": 19,
        "reads": 74,
        "readers_count": 73,
        "score": 119.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "0ka",
            "name": "0ka",
            "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/46",
        "can_translate": false
    },
    {
        "id": 32525,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-08-12T12:29:28.018Z",
        "cooked": "<p>nload на rpi показывает ту же скорость что и пк при спидтесте?</p>",
        "post_number": 47,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-12T12:29:28.018Z",
        "reply_count": 1,
        "reply_to_post_number": 46,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 71,
        "readers_count": 70,
        "score": 19.0,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/47",
        "can_translate": false
    },
    {
        "id": 32530,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-12T12:45:43.624Z",
        "cooked": "<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"raspberry-pi-xray-между-роутером-и-телевизором/f14a48a685d451026774838a05e2654622875f5a.jpeg\" data-download-href=\"https://ntc.party/uploads/default/f14a48a685d451026774838a05e2654622875f5a\" title=\"2024-08-12 15_44_28-Window\"><img src=\"raspberry-pi-xray-между-роутером-и-телевизором/f14a48a685d451026774838a05e2654622875f5a_2_690x234.jpeg\" alt=\"2024-08-12 15_44_28-Window\" data-base62-sha1=\"yqydNVC3mpPbj3Pw9HsPQpr9uFI\" width=\"690\" height=\"234\" srcset=\"raspberry-pi-xray-между-роутером-и-телевизором/f14a48a685d451026774838a05e2654622875f5a_2_690x234.jpeg, raspberry-pi-xray-между-роутером-и-телевизором/f14a48a685d451026774838a05e2654622875f5a_2_1035x351.jpeg 1.5x, raspberry-pi-xray-между-роутером-и-телевизором/f14a48a685d451026774838a05e2654622875f5a.jpeg 2x\" data-dominant-color=\"7F838B\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">2024-08-12 15_44_28-Window</span><span class=\"informations\">1379×469 108 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"raspberry-pi-xray-между-роутером-и-телевизором/49726efbdc7397bf181d71eb33419d69c370fede.jpeg\" data-download-href=\"https://ntc.party/uploads/default/49726efbdc7397bf181d71eb33419d69c370fede\" title=\"2024-08-12 16_06_23-The Hype Is Real - B7 Audi RS4 - YouTube — Mozilla Firefox\"><img src=\"raspberry-pi-xray-между-роутером-и-телевизором/49726efbdc7397bf181d71eb33419d69c370fede_2_689x389.jpeg\" alt=\"2024-08-12 16_06_23-The Hype Is Real - B7 Audi RS4 - YouTube — Mozilla Firefox\" data-base62-sha1=\"atK1JPqinSC2ibYByjRixHCnFMi\" width=\"689\" height=\"389\" srcset=\"raspberry-pi-xray-между-роутером-и-телевизором/49726efbdc7397bf181d71eb33419d69c370fede_2_689x389.jpeg, raspberry-pi-xray-между-роутером-и-телевизором/49726efbdc7397bf181d71eb33419d69c370fede_2_1033x583.jpeg 1.5x, raspberry-pi-xray-между-роутером-и-телевизором/49726efbdc7397bf181d71eb33419d69c370fede.jpeg 2x\" data-dominant-color=\"858A91\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">2024-08-12 16_06_23-The Hype Is Real - B7 Audi RS4 - YouTube — Mozilla Firefox</span><span class=\"informations\">1292×729 223 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p><img src=\"https://ntc.party/images/emoji/twitter/upside_down_face.png?v=12\" title=\":upside_down_face:\" class=\"emoji only-emoji\" alt=\":upside_down_face:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
        "post_number": 48,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-12T13:11:26.658Z",
        "reply_count": 1,
        "reply_to_post_number": 47,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 72,
        "readers_count": 71,
        "score": 24.2,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "0ka",
            "name": "0ka",
            "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/48",
        "can_translate": false
    },
    {
        "id": 32546,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-08-12T13:17:41.712Z",
        "cooked": "<p>а если включить bbr на rpi и сервере?</p>",
        "post_number": 49,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-12T13:17:51.935Z",
        "reply_count": 1,
        "reply_to_post_number": 48,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 69,
        "readers_count": 68,
        "score": 18.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/49",
        "can_translate": false
    },
    {
        "id": 32554,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-12T13:24:01.205Z",
        "cooked": "<p>На сервере включен, на rpi включил сейчас, но увы - ничего не меняется.</p>\n<p>Ладно, спасибо большое, думаю пора оставить это дело) Подумаю еще на досуге, может что-то придет в голову, должна же быть какая-то объяснимая разница между устройствами. Может еще с чего-нибудь потестирую.</p>",
        "post_number": 50,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-12T13:24:01.205Z",
        "reply_count": 0,
        "reply_to_post_number": 49,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 68,
        "readers_count": 67,
        "score": 13.6,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "0ka",
            "name": "0ka",
            "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/50",
        "can_translate": false
    },
    {
        "id": 32728,
        "name": "Dmitriy",
        "username": "shimanov",
        "avatar_template": "/user_avatar/ntc.party/shimanov/{size}/6695_2.png",
        "created_at": "2024-08-13T11:09:03.238Z",
        "cooked": "<p>Всем привет, столкнулся с такой же проблемой, что и автор, взял последний конфиг, но в секции outbounds заменил vless на socks</p>\n<pre><code class=\"lang-auto\">{\n\t\"type\": \"socks\",\n\t\"tag\": \"socks-out\",\n\t\"server\": \"192.168.1.182\",\n\t\"server_port\": 1080,\n\t\"version\": \"5\",\n\t\"network\": \"tcp\",\n  \t\"udp_over_tcp\": false\n}\n</code></pre>\n<p>Такая конфигурация отлично работает на винде, но вот на телеке Samsung не работает, после запуска ютуба серый экран или лого ютуба висит.<br>\nСудя по логу sing box запрос до сервера доходит нормально</p>\n<pre><code class=\"lang-auto\">-0400 2024-08-13 06:50:55 DEBUG dns: exchange www.youtube.com. IN AAAA\n-0400 2024-08-13 06:50:55 DEBUG dns: exchange www.youtube.com. IN A\n-0400 2024-08-13 06:50:55 DEBUG dns: strategy rejected\n-0400 2024-08-13 06:50:55 DEBUG dns: exchanged www.youtube.com NOERROR 300\n-0400 2024-08-13 06:50:55 INFO dns: exchanged www.youtube.com CNAME www.youtube.com. 300 IN CNAME youtube-ui.l.google.com.\n-0400 2024-08-13 06:50:55 INFO dns: exchanged www.youtube.com CNAME youtube-ui.l.google.com. 300 IN CNAME wide-youtube.l.google.com.\n-0400 2024-08-13 06:50:55 INFO dns: exchanged www.youtube.com A wide-youtube.l.google.com. 300 IN A 142.251.1.198\n-0400 2024-08-13 06:50:55 INFO [1466161358 0ms] inbound/tun[0]: inbound connection from 192.168.1.10:59817\n-0400 2024-08-13 06:50:55 INFO [1466161358 0ms] inbound/tun[0]: inbound connection to 142.251.1.198:443\n-0400 2024-08-13 06:50:55 DEBUG [1466161358 29ms] router: sniffed protocol: tls, domain: www.youtube.com\n-0400 2024-08-13 06:50:55 DEBUG [1466161358 30ms] dns: resolved [142.251.1.198]\n-0400 2024-08-13 06:50:55 INFO [1466161358 30ms] outbound/socks[socks-out]: outbound connection to 142.251.1.198:443\n-0400 2024-08-13 06:50:56 INFO [4115249208 0ms] inbound/tun[0]: inbound packet connection from 192.168.1.10:53517\n-0400 2024-08-13 06:50:56 INFO [4115249208 0ms] inbound/tun[0]: inbound packet connection to 8.8.8.8:53\n-0400 2024-08-13 06:50:56 DEBUG [4115249208 0ms] router: sniffed packet protocol: dns\n-0400 2024-08-13 06:50:56 DEBUG [4115249208 0ms] router: match[0] protocol=dns =&gt; dns-out\n</code></pre>\n<p>Подскажите куда капнуть, в какую сторону посмотреть</p>",
        "post_number": 51,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-13T11:09:03.238Z",
        "reply_count": 1,
        "reply_to_post_number": 46,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 67,
        "readers_count": 66,
        "score": 18.4,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "Dmitriy",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4739,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/51",
        "can_translate": false
    },
    {
        "id": 32734,
        "name": "George Dorohov",
        "username": "dorohovGeorge",
        "avatar_template": "/user_avatar/ntc.party/dorohovgeorge/{size}/6697_2.png",
        "created_at": "2024-08-13T11:58:43.585Z",
        "cooked": "<p><a class=\"mention\" href=\"/u/xofamim548\">@xofamim548</a> добрый день, следил за вашим решением почти в прямом эфире. Возможно не до конца понимаю всех тонкостей. Я попробовал использовать ваше решение, но у меня какие то проблемы с geo-ip. Если можете подсказать буду крайне признателен. Проблема на скрине<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"raspberry-pi-xray-между-роутером-и-телевизором/1ae0c0d310879aeb0d2608862821a2f1edaf925f.jpeg\" data-download-href=\"https://ntc.party/uploads/default/1ae0c0d310879aeb0d2608862821a2f1edaf925f\" title=\"2024-08-13 14.58.31\"><img src=\"raspberry-pi-xray-между-роутером-и-телевизором/1ae0c0d310879aeb0d2608862821a2f1edaf925f_2_679x499.jpeg\" alt=\"2024-08-13 14.58.31\" data-base62-sha1=\"3PLWDBhyKnkO9hPK5AjTWifITlt\" width=\"679\" height=\"499\" srcset=\"raspberry-pi-xray-между-роутером-и-телевизором/1ae0c0d310879aeb0d2608862821a2f1edaf925f_2_679x499.jpeg, raspberry-pi-xray-между-роутером-и-телевизором/1ae0c0d310879aeb0d2608862821a2f1edaf925f.jpeg 1.5x, raspberry-pi-xray-между-роутером-и-телевизором/1ae0c0d310879aeb0d2608862821a2f1edaf925f.jpeg 2x\" data-dominant-color=\"1B1C1D\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">2024-08-13 14.58.31</span><span class=\"informations\">946×696 47.4 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
        "post_number": 52,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-13T11:58:43.585Z",
        "reply_count": 1,
        "reply_to_post_number": 46,
        "quote_count": 0,
        "incoming_link_count": 4,
        "reads": 65,
        "readers_count": 64,
        "score": 38.0,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "George Dorohov",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4741,
        "hidden": false,
        "trust_level": 0,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/52",
        "can_translate": false
    },
    {
        "id": 32795,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-13T14:50:10.439Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"shimanov\" data-post=\"51\" data-topic=\"8804\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/user_avatar/ntc.party/shimanov/48/6695_2.png\" class=\"avatar\"> shimanov:</div>\n<blockquote>\n<p>Всем привет, столкнулся с такой же проблемой, что и автор, взял последний конфиг, но в секции outbounds заменил vless на socks</p>\n</blockquote>\n</aside>\n<p>Верно ли я понимаю, что UDP-запросы идут вникуда? Мой опыт показал, что на самсунге без UDP работать не будет, блокировать можно только на 443 порту. Если UDP идут куда-то мимо удалённого сервера, то скорее всего тоже не будет.</p>\n<p>Всё хотел посмотреть, что там на UDP завязано, но малость устал всё это настраивать, так руки и не дошли.</p>",
        "post_number": 53,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-13T14:51:25.040Z",
        "reply_count": 1,
        "reply_to_post_number": 51,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 65,
        "readers_count": 64,
        "score": 18.0,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/53",
        "can_translate": false
    },
    {
        "id": 32801,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-13T15:00:07.809Z",
        "cooked": "<p>Честно сказать, я тоже до сих пор не понимаю всех тонкостей <img src=\"https://ntc.party/images/emoji/twitter/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"> Сбросьте сюда полный конфиг sing-box без чувствительных данных, возможно тег google где-то повторно используется не в тему. И заодно результат выполнения</p>\n<pre><code class=\"lang-auto\">cat /etc/resolv.conf\n</code></pre>",
        "post_number": 54,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-13T15:00:07.809Z",
        "reply_count": 0,
        "reply_to_post_number": 52,
        "quote_count": 0,
        "incoming_link_count": 19,
        "reads": 65,
        "readers_count": 64,
        "score": 108.0,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "dorohovGeorge",
            "name": "George Dorohov",
            "avatar_template": "/user_avatar/ntc.party/dorohovgeorge/{size}/6697_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/54",
        "can_translate": false
    },
    {
        "id": 32811,
        "name": "Dmitriy",
        "username": "shimanov",
        "avatar_template": "/user_avatar/ntc.party/shimanov/{size}/6695_2.png",
        "created_at": "2024-08-13T15:23:57.288Z",
        "cooked": "<p>Т.е. UDP тоже надо пустить на удаленный сервер?<br>\nВ iptables добавлял обе настройки как в вашем примере</p>",
        "post_number": 55,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-13T15:23:57.288Z",
        "reply_count": 1,
        "reply_to_post_number": 53,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 66,
        "readers_count": 65,
        "score": 28.2,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "Dmitriy",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4739,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/55",
        "can_translate": false
    },
    {
        "id": 32814,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-13T15:32:23.914Z",
        "cooked": "<p>Да, верно, UDP надо пропускать на удалённый. В соседней теме <a href=\"https://ntc.party/t/%D0%BE%D0%B1%D1%81%D1%83%D0%B6%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B7%D0%B0%D0%BC%D0%B5%D0%B4%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-youtube-%D0%B2-%D1%80%D0%BE%D1%81%D1%81%D0%B8%D0%B8/8074/608\">обсуждали</a> проблему с Samsung и (Good)byeDPI, там тоже у людей странности, телевизор куда-то ещё обращается помимо доменов youtube. Подозреваю, что по UDP, хотя повторюсь, не проверял.</p>\n<p>В iptables у меня два правила, это верно (дропы для udp :443 и редирект tcp на 100-й порт).</p>\n<p>Сейчас вот попробовал зарезать весь UDP через iptables, та же ситуация, сразу перестает работать и серый экран. Выше по теме можно найти, когда я пускал в редирект только tcp и не делал tun интерфейс для udp (то есть udp шел напрямую), опять же было лого youtube или серый экран.</p>",
        "post_number": 56,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-13T15:37:30.128Z",
        "reply_count": 1,
        "reply_to_post_number": 55,
        "quote_count": 0,
        "incoming_link_count": 80,
        "reads": 65,
        "readers_count": 64,
        "score": 418.0,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://ntc.party/t/%D0%BE%D0%B1%D1%81%D1%83%D0%B6%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B7%D0%B0%D0%BC%D0%B5%D0%B4%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-youtube-%D0%B2-%D1%80%D0%BE%D1%81%D1%81%D0%B8%D0%B8/8074/608",
                "internal": true,
                "reflection": false,
                "title": "Обсуждение: Замедление YouTube в России",
                "clicks": 4
            }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "shimanov",
            "name": "Dmitriy",
            "avatar_template": "/user_avatar/ntc.party/shimanov/{size}/6695_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/56",
        "can_translate": false
    },
    {
        "id": 32841,
        "name": "Dmitriy",
        "username": "shimanov",
        "avatar_template": "/user_avatar/ntc.party/shimanov/{size}/6695_2.png",
        "created_at": "2024-08-13T17:32:59.428Z",
        "cooked": "<p>Спасибо огромное, в итоге ваш конфиг с небольшим изменением с vless на socks работает отлично!!!<br>\nМоя ошибка была в том, что я не сохранил изменения в iptables, поэтому ничего не работало.</p>",
        "post_number": 57,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-13T17:32:59.428Z",
        "reply_count": 1,
        "reply_to_post_number": 56,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 66,
        "readers_count": 65,
        "score": 23.2,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "Dmitriy",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4739,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/57",
        "can_translate": false
    },
    {
        "id": 32849,
        "name": "Dmitriy",
        "username": "shimanov",
        "avatar_template": "/user_avatar/ntc.party/shimanov/{size}/6695_2.png",
        "created_at": "2024-08-13T17:57:35.900Z",
        "cooked": "<p>Рано радовался, выключил телек, включил и снова приложение ютуба не работает</p>",
        "post_number": 58,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-13T17:57:35.900Z",
        "reply_count": 1,
        "reply_to_post_number": 57,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 63,
        "readers_count": 62,
        "score": 17.6,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "Dmitriy",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "shimanov",
            "name": "Dmitriy",
            "avatar_template": "/user_avatar/ntc.party/shimanov/{size}/6695_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4739,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/58",
        "can_translate": false
    },
    {
        "id": 32851,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-13T18:02:46.797Z",
        "cooked": "<p>Если UDP настроили, попробуйте на телевизоре вписать DNS 8.8.8.8.</p>\n<p>Вообще опять-таки слабо понимаю, как ходят DNS-запросы в моей последней конфигурации, <a class=\"mention\" href=\"/u/0ka\">@0ka</a> не подскажете? Вот этот DoH гугла вообще используется или нет? Потому что я сейчас попробовал позахватывать UDP трафик, и у меня такое чувство, что нет.</p>\n<p><a class=\"attachment\" href=\"raspberry-pi-xray-между-роутером-и-телевизором/egs626Bu6gTNzsJjZ28VWrn4fjI.pcap\">capture-udp.pcap</a> (57,2 КБ)</p>",
        "post_number": 59,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-13T18:02:46.797Z",
        "reply_count": 1,
        "reply_to_post_number": 58,
        "quote_count": 0,
        "incoming_link_count": 4,
        "reads": 69,
        "readers_count": 68,
        "score": 38.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "/uploads/short-url/egs626Bu6gTNzsJjZ28VWrn4fjI.pcap",
                "internal": true,
                "reflection": false,
                "clicks": 0
            }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "shimanov",
            "name": "Dmitriy",
            "avatar_template": "/user_avatar/ntc.party/shimanov/{size}/6695_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/59",
        "can_translate": false
    },
    {
        "id": 32857,
        "name": "Dmitriy",
        "username": "shimanov",
        "avatar_template": "/user_avatar/ntc.party/shimanov/{size}/6695_2.png",
        "created_at": "2024-08-13T18:15:19.920Z",
        "cooked": "<p>Поменял DNS на 8.8.8.8, результат тот же.<br>\nДля полной картины вот мой конфиг:</p>\n<pre><code class=\"lang-auto\">{\n\t\"log\": {\n\t\t\"disabled\": false,\n\t\t\"level\": \"trace\",\n\t\t\"output\": \"/etc/sing-box/sing-box.log\",\n\t\t\"timestamp\": true\n\t},\n\t\"dns\": {\n\t\t\"servers\": [\n\t\t\t{\n\t\t\t\t\"tag\": \"google\",\n\t\t\t\t\"address\": \"https://8.8.8.8/dns-query\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"tag\": \"local\",\n\t\t\t\t\"address\": \"192.168.1.1\",\n\t\t\t\t\"detour\": \"direct\"\n\t\t\t},\n\t\t\t{\n\t\t\t\"tag\": \"block\",\n\t\t\t\"address\": \"rcode://success\"\n\t\t\t}\n\t\t],\n\t\t\"strategy\": \"ipv4_only\"\n\t},\n\t\"inbounds\": [\n\t\t{\n\t\t\t\"type\": \"tun\",\n\t\t\t\"interface_name\": \"tun0\",\n\t\t\t\"domain_strategy\": \"ipv4_only\",\n\t\t\t\"inet4_address\": \"172.16.250.1/30\",\n\t\t\t\"mtu\": 9000,\n\t\t\t\"auto_route\": true,\n\t\t\t\"strict_route\": false,\n\t\t\t\"sniff\": true,\n\t\t\t\"sniff_override_destination\": true\n\t\t},\n\t\t{\n\t\t\t\"type\": \"redirect\",\n\t\t\t\"tag\": \"redirect-in\",\n\t\t\t\"listen\": \"0.0.0.0\",\n\t\t\t\"listen_port\": 100,\n\t\t\t\"domain_strategy\": \"ipv4_only\",\n\t\t\t\"sniff\": true,\n\t\t\t\"sniff_override_destination\": true\n\t\t}\n\t],\n\t\"outbounds\": [\n\t\t{\n\t\t\t\"type\": \"socks\",\n\t\t\t\"tag\": \"socks-out\",\n\t\t\t\"server\": \"192.168.1.182\",\n\t\t\t\"server_port\": 1080,\n\t\t\t\"version\": \"5\",\n\t\t\t\"network\": \"tcp\",\n  \t\t\t\"udp_over_tcp\": true\n\t\t},\n\t\t{\n\t\t\t\"type\": \"direct\",\n\t\t\t\"tag\": \"direct\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"block\",\n\t\t\t\"tag\": \"block\"\n\t\t},\n\t\t\t{\n\t\t\t\"type\": \"dns\",\n\t\t\t\"tag\": \"dns-out\"\n\t\t}\n\t],\n\t\"route\": {\n\t\t\"rules\": [\n\t\t\t{\n\t\t\t\t\"protocol\": \"dns\",\n\t\t\t\t\"outbound\": \"dns-out\"\n\t\t\t},\n\t\t\t{\n                \"ip_is_private\": true,\n                \"outbound\": \"direct\"\n            },\n\t\t\t{\n                \"rule_set\": [\n\t\t\t\t\t\"geoip-ru\",\n\t\t\t\t\t\"geosite-ru\"\n\t\t\t\t],\n                \"outbound\": \"direct\"\n            }\n        ],\n\t\"rule_set\": [\n\t\t{\n\t\t\t\"type\": \"remote\",\n\t\t\t\"tag\": \"geoip-ru\",\n\t\t\t\"format\": \"binary\",\n\t\t\t\"url\": \"https://raw.githubusercontent.com/Chocolate4U/Iran-sing-box-rules/rule-set/geoip-ru.srs\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"remote\",\n\t\t\t\"tag\": \"geosite-ru\",\n\t\t\t\"format\": \"binary\",\n\t\t\t\"url\": \"https://raw.githubusercontent.com/Chocolate4U/Iran-sing-box-rules/rule-set/geosite-category-ru.srs\"\n\t\t}\n\t],\n\t\"final\": \"socks-out\",\n\t\"auto_detect_interface\": true\n\t}\n}\n</code></pre>",
        "post_number": 60,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-13T18:15:19.920Z",
        "reply_count": 1,
        "reply_to_post_number": 59,
        "quote_count": 0,
        "incoming_link_count": 6,
        "reads": 84,
        "readers_count": 83,
        "score": 51.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "Dmitriy",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4739,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/60",
        "can_translate": false
    },
    {
        "id": 32858,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-13T18:18:06.738Z",
        "cooked": "<p>Без этой секции пробовали?</p>\n<aside class=\"quote no-group\" data-username=\"shimanov\" data-post=\"60\" data-topic=\"8804\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/user_avatar/ntc.party/shimanov/48/6695_2.png\" class=\"avatar\"> shimanov:</div>\n<blockquote>\n<pre><code class=\"lang-auto\">{\n\t\t\t\t\"tag\": \"local\",\n\t\t\t\t\"address\": \"192.168.1.1\",\n\t\t\t\t\"detour\": \"direct\"\n\t\t\t},\n</code></pre>\n</blockquote>\n</aside>\n<p>Мне она всё сильно портила почему-то. Пока не прописал тег google в качестве final, ничего не работало.</p>\n<p>P. S. Надо все-таки сесть и разобраться с dns запросами в sing-box, не понимаю, как там разные секции друг с другом связаны.</p>",
        "post_number": 61,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-13T18:24:03.463Z",
        "reply_count": 0,
        "reply_to_post_number": 60,
        "quote_count": 1,
        "incoming_link_count": 14,
        "reads": 81,
        "readers_count": 80,
        "score": 71.2,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/61",
        "can_translate": false
    },
    {
        "id": 32868,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-13T19:16:16.244Z",
        "cooked": "<p>Вообще я понял, что если я хочу всегда использовать DoH гугла (а я хочу), то конфиг можно упростить до такого состояния:</p>\n<pre><code class=\"lang-auto\">{\n\t\"log\": {\n\t\t\"disabled\": true,\n\t\t\"level\": \"info\",\n\t\t\"output\": \"/tmp/sing-box.log\",\n\t\t\"timestamp\": true\n\t},\n\t\"dns\": {\n\t\t\"servers\": [\n\t\t\t{\n\t\t\t\t\"tag\": \"google\",\n\t\t\t\t\"address\": \"https://8.8.8.8/dns-query\"\n\t\t\t},\n\t\t\t{\n\t\t\t\"tag\": \"block\",\n\t\t\t\"address\": \"rcode://success\"\n\t\t\t}\n\t\t],\n\t\t\"final\": \"google\",\n\t\t\"strategy\": \"ipv4_only\"\n\t},\n\t\"inbounds\": [\n\t\t{\n\t\t\t\"type\": \"tun\",\n\t\t\t\"interface_name\": \"tun0\",\n\t\t\t\"domain_strategy\": \"ipv4_only\",\n\t\t\t\"inet4_address\": \"172.16.250.1/30\",\n\t\t\t\"mtu\": 1500,\n\t\t\t\"auto_route\": true,\n\t\t\t\"strict_route\": false,\n\t\t\t\"sniff\": true,\n\t\t\t\"sniff_override_destination\": true\n\t\t},\n\t\t{\n\t\t\t\"type\": \"redirect\",\n\t\t\t\"tag\": \"redirect-in\",\n\t\t\t\"listen\": \"0.0.0.0\",\n\t\t\t\"listen_port\": 100,\n\t\t\t\"domain_strategy\": \"ipv4_only\",\n\t\t\t\"sniff\": true,\n\t\t\t\"sniff_override_destination\": true\n\t\t}\n\t],\n\t\"outbounds\": [\n\t\t{\n\t\t\t# vless-out\n\t\t},\n\t\t{\n\t\t\t\"type\": \"direct\",\n\t\t\t\"tag\": \"direct\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"block\",\n\t\t\t\"tag\": \"block\"\n\t\t}\n\t],\n\t\"route\": {\n\t\t\"rules\": [\n\t\t\t{\n                \"ip_is_private\": true,\n                \"outbound\": \"direct\"\n            },\n\t\t\t{\n                \"rule_set\": [\n\t\t\t\t\t\"geoip-ru\",\n\t\t\t\t\t\"geosite-ru\"\n\t\t\t\t],\n                \"outbound\": \"direct\"\n            }\n        ],\n\t\"rule_set\": [\n\t\t{\n\t\t\t\"type\": \"remote\",\n\t\t\t\"tag\": \"geoip-ru\",\n\t\t\t\"format\": \"binary\",\n\t\t\t\"url\": \"https://raw.githubusercontent.com/Chocolate4U/Iran-sing-box-rules/rule-set/geoip-ru.srs\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"remote\",\n\t\t\t\"tag\": \"geosite-ru\",\n\t\t\t\"format\": \"binary\",\n\t\t\t\"url\": \"https://raw.githubusercontent.com/Chocolate4U/Iran-sing-box-rules/rule-set/geosite-category-ru.srs\"\n\t\t}\n\t],\n\t\"final\": \"vless-out\",\n\t\"auto_detect_interface\": true\n\t}\n}\n</code></pre>\n<p>Примерное понимание работы DNS и правил дает вот этот пример: <a href=\"https://vpnrouter.homes/singbox-dns/\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Sing-Box DNS - VPN Router for Home Networks</a></p>\n<p>Я, правда, так до конца и не уверен, какие ответы от 8.8.8.8 на 53 порту в итоге отображает tcpdump. Если я корректно понимаю, телевизор пытается обращаться к 8.8.8.8 (установлен в настройках тв), sing-box перенаправляет запрос согласно правилам, а потом как бы возвращает ответ от 8.8.8.8. Но это если я правильно понял.</p>",
        "post_number": 62,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-13T19:18:42.087Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 33,
        "reads": 86,
        "readers_count": 85,
        "score": 182.2,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://vpnrouter.homes/singbox-dns/",
                "internal": false,
                "reflection": false,
                "title": "Sing-Box DNS - VPN Router for Home Networks",
                "clicks": 19
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/62",
        "can_translate": false
    },
    {
        "id": 32972,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-14T08:30:10.943Z",
        "cooked": "<p>Выкроил еще немного времени и протестировал кучу разных конфигов, в том числе те, которые у меня не работали. Тестировал с полной перезагрузкой телевизора с выключением из розетки на 30+ секунд. (Всем советую делать так же.)</p>\n<p>Во-первых, как я и предположил выше, UDP на 443 порту можно не блокировать (хотя возможно зависит от модельного года, но у меня QUIC не используется).</p>\n<p>Во-вторых, за эти дни что-то поменялось. Все конфиги с redirect+tun, которые у меня не работали <em>по причинам</em>, теперь работают. С локальными DNS, с удаленными DNS, с роутингом по geoip и geosite, с роутингом по файлику youtube.json - работают, и видео открываются, и поиск, и рекомендации, все как рукой сняло. Иногда проявляется странный нюанс: в тех конфигах, что раньше не работали, приложение youtube временами открывается со второго раза. В первый раз начинает загружаться, вылетает, и телевизор выдает сообщение “Произошла ошибка сети”. Снова открываешь youtube - работает. Но ошибка воспроизводится как-то нестабильно.</p>\n<p>В итоге оставил так:</p>\n<pre><code class=\"lang-auto\">{\n\t\"log\": {\n\t\t\"disabled\": true,\n\t\t\"level\": \"info\",\n\t\t\"output\": \"/tmp/sing-box.log\",\n\t\t\"timestamp\": true\n\t},\n\t\"dns\": {\n\t\t\"servers\": [\n\t\t\t{\n\t\t\t\t\"tag\": \"google\",\n\t\t\t\t\"address\": \"https://8.8.8.8/dns-query\"\n\t\t\t},\n\t\t\t{\n\t\t\t\"tag\": \"block\",\n\t\t\t\"address\": \"rcode://success\"\n\t\t\t}\n\t\t],\n\t\t\"final\": \"google\",\n\t\t\"strategy\": \"ipv4_only\"\n\t},\n\t\"inbounds\": [\n\t\t{\n\t\t\t\"type\": \"tun\",\n\t\t\t\"interface_name\": \"tun0\",\n\t\t\t\"domain_strategy\": \"ipv4_only\",\n\t\t\t\"inet4_address\": \"172.16.250.1/30\",\n\t\t\t\"mtu\": 1500,\n\t\t\t\"auto_route\": true,\n\t\t\t\"strict_route\": false,\n\t\t\t\"sniff\": true,\n\t\t\t\"sniff_override_destination\": true\n\t\t},\n\t\t{\n\t\t\t\"type\": \"redirect\",\n\t\t\t\"tag\": \"redirect-in\",\n\t\t\t\"listen\": \"0.0.0.0\",\n\t\t\t\"listen_port\": 100,\n\t\t\t\"domain_strategy\": \"ipv4_only\",\n\t\t\t\"sniff\": true,\n\t\t\t\"sniff_override_destination\": true\n\t\t}\n\t],\n\t\"outbounds\": [\n\t\t{\n\t\t\t\"type\": \"vless\",\n\t\t\t\"tag\": \"vless-out\",\n\t\t\t\"server\": \"IP_ADDR_HERE\",\n\t\t\t\"server_port\": 443,\n\t\t\t\"uuid\": \"UUID_HERE\",\n\t\t\t\"flow\": \"xtls-rprx-vision\",\n\t\t\t\"network\": \"tcp\",\n\t\t\t\"tls\": {\n\t\t\t\t\"enabled\": true,\n\t\t\t\t\"server_name\": \"DOMAIN_HERE\",\n\t\t\t\t\"alpn\": [\"h2\"],\n\t\t\t\t\"utls\": {\n\t\t\t\t\t\"enabled\": true,\n\t\t\t\t\t\"fingerprint\": \"chrome\"\n\t\t\t\t},\n\t\t\t\t\"reality\": {\n\t\t\t\t\t\"enabled\": true,\n\t\t\t\t\t\"public_key\": \"PUBLIC_KEY_HERE\",\n\t\t\t\t\t\"short_id\": \"SHORT_ID_HERE\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"packet_encoding\": \"xudp\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"direct\",\n\t\t\t\"tag\": \"direct\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"block\",\n\t\t\t\"tag\": \"block\"\n\t\t}\n\t],\n\t\"route\": {\n\t\t\"rules\": [\n\t\t\t{\n                \"ip_is_private\": true,\n                \"outbound\": \"direct\"\n            },\n\t\t\t{\n                \"rule_set\": [\n\t\t\t\t\t\"geoip-ru\",\n\t\t\t\t\t\"geosite-ru\"\n\t\t\t\t],\n                \"outbound\": \"direct\"\n            }\n        ],\n\t\"rule_set\": [\n\t\t{\n\t\t\t\"type\": \"remote\",\n\t\t\t\"tag\": \"geoip-ru\",\n\t\t\t\"format\": \"binary\",\n\t\t\t\"url\": \"https://raw.githubusercontent.com/Chocolate4U/Iran-sing-box-rules/rule-set/geoip-ru.srs\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"remote\",\n\t\t\t\"tag\": \"geosite-ru\",\n\t\t\t\"format\": \"binary\",\n\t\t\t\"url\": \"https://raw.githubusercontent.com/Chocolate4U/Iran-sing-box-rules/rule-set/geosite-category-ru.srs\"\n\t\t}\n\t],\n\t\"final\": \"vless-out\",\n\t\"auto_detect_interface\": true\n\t}\n}\n</code></pre>\n<p>Также если кому-то интересно, при роутинге по youtube.json сам файлик выглядел так:</p>\n<pre><code class=\"lang-auto\">{\n    \"version\": 1,\n    \"rules\": [\n        {\n            \"domain_suffix\": [\n\t\t\t\t\".googlevideo.com\",\n\t\t\t\t\".youtube.com\",\n\t\t\t\t\".ggpht.com\",\n\t\t\t\t\".ytimg.com\",\n\t\t\t\t\".googleapis.com\",\n\t\t\t\t\".youtu.be\",\n\t\t\t\t\".google.com\",\n\t\t\t\t\".yt.be\",\n\t\t\t\t\".youtubekids.com\",\n\t\t\t\t\".nhacmp3youtube.com\",\n\t\t\t\t\".googleusercontent.com\",\n\t\t\t\t\".gstatic.com\"\n            ]\n        }\n    ]\n}\n</code></pre>",
        "post_number": 63,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-14T08:35:38.774Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 27,
        "reads": 79,
        "readers_count": 78,
        "score": 150.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/63",
        "can_translate": false
    },
    {
        "id": 33011,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-08-14T11:35:01.270Z",
        "cooked": "<p>Еще пара мыслей для тех, у кого все работало, а потом перестало.</p>\n<ol>\n<li>Отключить ipv6, если не используете. Поначалу отключал так:</li>\n</ol>\n<pre><code class=\"lang-auto\">sudo nano /etc/sysctl.conf\nДобавить в конец:\nnet.ipv6.conf.all.disable_ipv6 = 1\nnet.ipv6.conf.default.disable_ipv6 = 1\nnet.ipv4.ip_forward=1\nи выполнить:\nsudo sysctl -p\n</code></pre>\n<p>Оно даже срабатывает, но после перезагрузки ipconfig почему-то снова показывает ipv6 адрес, что может создавать неприятности. Есть <a href=\"https://www.howtoraspberry.com/2020/04/disable-ipv6-on-raspberry-pi/\" rel=\"noopener nofollow ugc\">статья</a> по RPI, в которой написано, как надо:</p>\n<pre><code class=\"lang-auto\">sudo nano /boot/firmware/cmdline.txt\nДобавить в конец строки: ipv6.disable=1\n</code></pre>\n<p>После этого сделать sudo reboot и выполнить ifconfig, чтобы убедиться, что ipv6 для eth0 больше не отображается.</p>\n<ol start=\"2\">\n<li>Не забывать сохранять правила iptables, чтобы не слетали после перезагрузки.</li>\n</ol>\n<pre><code class=\"lang-auto\">sudo iptables -t nat -A PREROUTING -s IP_ТЕЛЕВИЗОРА/32 -p tcp -j REDIRECT --to-port 100\nsudo apt-get install iptables-persistent\nsudo netfilter-persistent save\nsudo systemctl enable netfilter-persistent\nsudo systemctl start netfilter-persistent\n</code></pre>\n<ol start=\"3\">\n<li>sing-box после перезагрузки может стартовать слишком рано. Если после ребута все перестало работать, проверить статус сервиса sing-box. Если он failed, хотя раньше запускался, то надо поправить конфиг sing-box.service примерно так (главным образом строку After):</li>\n</ol>\n<pre><code class=\"lang-auto\">[Unit]\nDescription=Sing-Box Service\nAfter=network.target nss-lookup.target network-online.target\n\n[Service]\nExecStart=/usr/local/bin/sing-box run -c /etc/sing-box/config.json\nRestart=on-failure\nRestartSec=10\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n<p>Хотя по идее в репах должен быть правильный конфиг, но мало ли.</p>",
        "post_number": 64,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-14T11:35:01.270Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 14,
        "reads": 89,
        "readers_count": 88,
        "score": 92.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://www.howtoraspberry.com/2020/04/disable-ipv6-on-raspberry-pi/",
                "internal": false,
                "reflection": false,
                "title": "How to Really Disable IPv6 on Raspberry PI – How to Raspberry",
                "clicks": 0
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/64",
        "can_translate": false
    },
    {
        "id": 34083,
        "name": "omgiafs",
        "username": "omgiafs",
        "avatar_template": "/letter_avatar_proxy/v4/letter/o/c89c15/{size}.png",
        "created_at": "2024-08-19T16:05:32.437Z",
        "cooked": "<p>Поделюсь своим опытом настройки.</p>\n<h1><a name=\"p-34083-h-1\" class=\"anchor\" href=\"#p-34083-h-1\"></a>Дано</h1>\n<ul>\n<li>SmartTV Samsung c TizenOS (т.е. не умеет в прокси и VPN),</li>\n<li>роутер с OpenWRT 23.05.0 с современным железом (поддержка WiFi 5 и выше),</li>\n<li>VPS на территории потанцевального противника</li>\n</ul>\n<h1><a name=\"p-34083-h-2\" class=\"anchor\" href=\"#p-34083-h-2\"></a>Задача</h1>\n<p>Реализация желания смотреть Ютуб, злоумышленно эксплуатируя уязвимость в виде статьи 29 Конституции РФ.</p>\n<h1><a name=\"p-34083-h-3\" class=\"anchor\" href=\"#p-34083-h-3\"></a>Решение</h1>\n<p>sing-box на роутере + пара правил nftables на нём же.</p>\n<h1><a name=\"p-34083-h-4\" class=\"anchor\" href=\"#p-34083-h-4\"></a>Подробности:</h1>\n<h2><a name=\"p-34083-sing-box-5\" class=\"anchor\" href=\"#p-34083-sing-box-5\"></a>Ставим sing-box</h2>\n<p><code>opkg update &amp;&amp; opkg install sing-box</code></p>\n<h2><a name=\"p-34083-sing-box-6\" class=\"anchor\" href=\"#p-34083-sing-box-6\"></a>Конфиг sing-box</h2>\n<p><code>cat /etc/config/sing-box</code></p>\n<pre data-code-wrap=\"config\"><code class=\"lang-config\">config sing-box 'main'\n        option enabled '1'\n        option user 'sing-box'\n        option conffile '/etc/sing-box/config.json'\n        option workdir '/usr/share/sing-box'\n</code></pre>\n<p><code>cat /etc/sing-box/config.json</code></p>\n<pre data-code-wrap=\"YAML\"><code class=\"lang-YAML\">{\n  \"log\": {\n    \"level\": \"warn\",\n    \"disabled\": false\n  },\n  \"dns\": {\n    \"servers\": [\n      {\n        \"tag\": \"dns-google\",\n        \"address\": \"tls://8.8.8.8\",\n        \"detour\": \"vless-xtls-vision-out\"\n      },\n      { //  в моём случае \"address\" не \"local\", т.к. на роутере крутится DNS-сервер для WAN и LAN сетей\n        //  и настроены разные view для локальных и внешних клиентов.\n        //  На интерфейсе 192.168.1.1 я гарантированно попадаю на view LAN и мой домен резолвится в его локальный IP, а не в белый.\n        \"tag\": \"dns-local\",\n        \"address\": \"192.168.1.1\", \n        \"detour\": \"direct-out\"\n      }\n    ], //servers\n    \"rules\": [\n      {\n        \"outbound\": [\n          \"direct-out\"\n        ],\n        \"server\": \"dns-local\"\n      },\n      {\n        \"domain_suffix\": [\n          \"local\",\n          \"home\",\n          \"isp.local.site\"\n        ],\n        \"server\": \"dns-local\"\n      },\n      {\n        \"outbound\": [\n          \"vless-xtls-vision-out\"\n        ],\n        \"server\": \"dns-google\"\n      }\n    ]\n  }, // dns\n  \"inbounds\": [\n    {\n     \"type\": \"redirect\",\n     \"tag\": \"redirect-in\",\n     \"listen\": \"192.168.1.1\",\n     \"listen_port\": 3129,\n     \"sniff\": true,\n     \"tcp_fast_open\": true\n    },\n    {\n      \"listen\": \"192.168.1.1\",\n      \"listen_port\": 3130,\n      \"tag\": \"vless-xtls-vision-mixed-in\",\n      \"type\": \"mixed\"\n    }\n  ],\n  \"outbounds\": [\n    {\n      \"flow\": \"xtls-rprx-vision\",\n      \"packet_encoding\": \"xudp\",\n      \"server\": \"REDACTED\",\n      \"server_port\": 443,\n      \"tag\": \"vless-xtls-vision-out\",\n      \"tls\": {\n        \"enabled\": true,\n        \"server_name\": \"REDACTED\",\n        \"utls\": {\n          \"enabled\": true,\n          \"fingerprint\": \"chrome\"\n        }\n      },\n      \"type\": \"vless\",\n      \"uuid\": \"REDACTED\"\n    },\n    {\n      \"type\": \"direct\",\n      \"tag\": \"direct-out\"\n    },\n    {\n      \"type\": \"dns\",\n      \"tag\": \"dns-out\"\n    }\n  ],\n  \"route\": {\n    \"rules\": [\n      { // rule for connecting without proxy\n        \"domain_suffix\": [\n          \"local\",\n          \"home\",\n          \"isp.local.site\"\n          ],\n         \"outbound\": \"direct-out\"\n      },\n        { // Youtube for Samsung Smart TV\n          \"inbound\": \"redirect-in\",\n          \"domain_suffix\": [\n            \"youtube.com\",\n            \"youtu.be\",\n            \"googlevideo.com\",\n            \"ytimg.com\"\n          ],\n          \"outbound\": \"vless-xtls-vision-out\"\n        },\n       {\n         \"rule_set\": \"antizapret\",\n         \"outbound\": \"vless-xtls-vision-out\"\n       },\n       {\n         \"protocol\": \"dns\",\n         \"outbound\": \"dns-out\"\n        },\n        {\n          \"inbound\": \"redirect-in\",\n          \"outbound\": \"direct-out\"\n        },\n        {\n          \"inbound\": \"vless-xtls-mixed-in\",\n          \"outbound\": \"vless-xtls-vision-out\"\n        }\n    ], //rules\n    \"rule_set\": [\n      { // Remote rule-set will be cached if experimental.cache_file.enabled.\n        \"tag\": \"antizapret\",\n        \"type\": \"remote\",\n        \"format\": \"binary\",\n        \"url\": \"https://github.com/savely-krasovsky/antizapret-sing-box/releases/latest/download/antizapret.srs\",\n        \"download_detour\": \"vless-xtls-vision-out\",\n        \"update_interval\": \"1d\"\n      }\n    ]\n  }\n}\n</code></pre>\n<h2><a name=\"p-34083-nftables-7\" class=\"anchor\" href=\"#p-34083-nftables-7\"></a>Правила nftables</h2>\n<h3><a name=\"p-34083-uci-8\" class=\"anchor\" href=\"#p-34083-uci-8\"></a>В формате UCI:</h3>\n<p><code>/etc/config/firewall</code></p>\n<pre><code class=\"lang-auto\">config rule\n        option enabled          1\n        option name             SamsungTV-block-quick\n        option target           REJECT\n        option src              lan\n        option dest             wan\n        option proto            udp\n        option src_ip           'SMART.TV.IP.ADDRESS'\n        option dest_port        443\n        option family           ipv4\n\nconfig redirect\n        option enabled          1\n        option name             SamsungTV-redirect-HTTPS-to-sing-box\n        option target           DNAT\n        option src              lan\n        option dest             wan\n        option proto            tcp\n        option src_ip           'SMART.TV.IP.ADDRESS'\n        option src_dport        443\n        option dest_ip          '192.168.1.1'\n        option dest_port        3129 # port of 'redirect-in' sing-box inbound\n        option family           ipv4\n</code></pre>\n<h3><a name=\"p-34083-nftables-9\" class=\"anchor\" href=\"#p-34083-nftables-9\"></a>В виде правил nftables:</h3>\n<p><code>fw4 print</code>:</p>\n<pre data-code-wrap=\"shell\"><code class=\"lang-shell\">        chain forward_lan {\n                ip saddr SMART.TV.IP.ADDRESS udp dport 443 counter jump reject_to_wan comment \"!fw4: DNAT-SamsungTV-block-quick\"\n        }\n        chain dstnat_lan {\n                ip saddr SMART.TV.IP.ADDRESS tcp dport 443 counter dnat 192.168.1.1:3129 comment \"!fw4: DNAT-SamsungTV-redirect-HTTPS-to-sing-box\"\n        }\n\n</code></pre>\n<p>В данном случае блочим QUICK (UDP/443) и редиректим только HTTPS (TCP/443). Можно редиректить и весь трафик Smart TV, но у меня и так прекрасно работает.</p>\n<h2><a name=\"p-34083-crontab-10\" class=\"anchor\" href=\"#p-34083-crontab-10\"></a>Crontab</h2>\n<p><code>crontab -e</code></p>\n<pre data-code-wrap=\"cron\"><code class=\"lang-cron\"># restart sing-box every 2 hours to avoid high memory consumption and OOM-killer spawning\n0  */2 * * * /etc/init.d/sing-box restart\n\n</code></pre>\n<h1><a name=\"p-34083-h-11\" class=\"anchor\" href=\"#p-34083-h-11\"></a>Итого</h1>\n<p>Редиректим HTTPS со смартТВ на “redirect”-вход sing-box и ходим на домены, имеющие отношение к YouTube, через прокси.<br>\nТакже имеем HTTP/SOCKS прокси.<br>\nМаршрутизация несложная: сначала на локальные домены и на сайт провайдера лезем напрямую, затем правило для SmartTV, которое редиректит трафик Ютуба в прокси.<br>\nДалее бонусом идёт маршрутизация на основе правил Antizapret в новом формате (SRS).<br>\nЕщё далее - это скорее fallbacks, до них дело вряд ли дойдёт.</p>\n<p>Каждые два часа рестартим sing-box во избежание прихода OOM-killer.<br>\nТут нужно заметить, что sing-box (как и xray) просто не запускается, если ограничить виртуальную память процесса до менее чем 800 МБ. На роутере, как вы понимаете, пока таких объёмов RAM нет. По умолчанию sing-box заявляет себе 1.2 ГБ виртуальной памяти а мы надеемся что ему не понадобится больше, чем у нас есть (у меня на роутере 256 МБ RAM). Поэтому на всякий случай рестартим sing-box каждые 2 часа. На современном роутере (WiFi 5+) это происходит моментально. Почему эти программы требуют (не потребляют!) так много виртуальной памяти - я не погромист, поэтому не знаю, в коде гошечки не колупался.</p>\n<p>Бегло протестировал - Ютуб на ТВ заработал как встарь. Пользуйтесь, друзья!<br>\n<a class=\"mention\" href=\"/u/valdikss\">@ValdikSS</a> , привет тебе из Гудлайновской сети!</p>",
        "post_number": 65,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-08-19T16:22:00.586Z",
        "reply_count": 2,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 202,
        "reads": 85,
        "readers_count": 84,
        "score": 1037.0,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "omgiafs",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 3,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://ntc.party/t/%D0%BE%D0%B1%D1%85%D0%BE%D0%B4-%D0%B7%D0%B0%D0%BC%D0%B5%D0%B4%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F-%D0%BD%D0%B0-samsung-tv-%D0%BD%D0%B0-tizen-os/9752/18",
                "internal": true,
                "reflection": true,
                "title": "Обход замедления на Samsung TV (на Tizen OS)",
                "clicks": 3
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4903,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/65",
        "can_translate": false
    },
    {
        "id": 36633,
        "name": "omgiafs",
        "username": "omgiafs",
        "avatar_template": "/letter_avatar_proxy/v4/letter/o/c89c15/{size}.png",
        "created_at": "2024-09-08T05:39:24.811Z",
        "cooked": "<p>Спустя некоторое время эксплуатации <code>sing-box</code> на <code>Openwrt</code> пришлось немного доработать напильником, чтобы это всё работало стабильно. Нестабильно это всё работало потому, что телевизор - не единственный клиент для <code>sing-box</code> на роутере, и коннектов довольно приличное количество круглосуточно.</p>\n<p>Доработки:</p>\n<ol>\n<li>\n<p>Блокировка IPv6-коннектов в sing-box. Если IPv6 нет, то делать это обязательно, т.к. неотключение <strong>обязательно</strong> влёчёт за собой наличие большого количества соединений в таймауте, и они забивают таблицу nf_conntrack. Просто потому, что по умолчанию <code>net.netfilter.nf_conntrack_tcp_timeout_close_wait = 60</code>.</p>\n</li>\n<li>\n<p>Увеличение количества открытых файлов для процесса sing-box</p>\n</li>\n<li>\n<p>В <code>/etc/sing-box/config.json</code> в секцию  <code>\"dns\"</code> добавить опцию <code>\"strategy\": \"ipv4_only\"</code>:</p>\n</li>\n</ol>\n<pre data-code-wrap=\"bash\"><code class=\"lang-bash\">  \"dns\": {\n    \"strategy\": \"ipv4_only\",\n    \"servers\": [\n      {\n        \"tag\": \"dns-google\",\n        ...\n</code></pre>\n<ol start=\"2\">\n<li>в <code>/etc/init.d/sing-box</code> после строк</li>\n</ol>\n<pre data-code-wrap=\"bash\"><code class=\"lang-bash\">        procd_open_instance \"$NAME.main\"\n        procd_set_param command \"$PROG\" run -c \"$conffile\" -D \"$workdir\"\n</code></pre>\n<p>добавить</p>\n<pre data-code-wrap=\"bash\"><code class=\"lang-bash\">        procd_set_param limits nofile=\"65536 65536\"\n</code></pre>\n<p><strong>ВАЖНО: Любое обновление пакета <code>sing-box</code> перезапишет файл <code>/etc/init.d/sing-box</code> на тот, который идёт с пакетом. Поэтому после каждого обновления <code>sing-box</code> нужно заново прописывать лимит.</strong></p>\n<ol start=\"3\">\n<li>в <code>/etc/sysupgrade.conf</code> добавить строку<br>\n<code>/etc/init.d/sing-box</code>, если сохраняете конфиги.</li>\n</ol>\n<p>Без этих мер <code>sing-box</code> работал нестабильно и падал. Или не падал, но упирался в лимиты, спамил ошибками в лог и для меня как пользователя сервиса фактически сервис не предоставлялся. Сейчас <code>sing-box</code> не падает, в лимиты не упирается, спама ошибок нет, сервис работает вторые сутки стабильно.</p>\n<p><em>Возможно поможет только пункт №1, т.к. все упоры в лимиты происходили из-за него. Но я не тестировал. Просто привожу мой подход к решению проблемы.</em></p>",
        "post_number": 66,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-09-08T05:45:45.948Z",
        "reply_count": 0,
        "reply_to_post_number": 65,
        "quote_count": 0,
        "incoming_link_count": 9,
        "reads": 71,
        "readers_count": 70,
        "score": 59.2,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "omgiafs",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "omgiafs",
            "name": "omgiafs",
            "avatar_template": "/letter_avatar_proxy/v4/letter/o/c89c15/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4903,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/66",
        "can_translate": false
    },
    {
        "id": 40590,
        "name": "13GwKd33",
        "username": "13GwKd33",
        "avatar_template": "/letter_avatar_proxy/v4/letter/1/858c86/{size}.png",
        "created_at": "2024-09-15T21:59:19.862Z",
        "cooked": "<p>Хочу настроить sing-box, чтобы только определенные подсети и домены шли к VPS-серверу, а все остальное шло через bypass. После тестирования своего конфига было вроде все ок, но имеется проблема с udp трафиком.<br>\n<img src=\"raspberry-pi-xray-между-роутером-и-телевизором/a535383a5569a7b0cfec73697f18d202ca7fd15f.png\" alt=\"Untitled Diagram.drawio\" data-base62-sha1=\"nzuNV6g0uhoz7Ax4tgwUV7gNbyv\" width=\"427\" height=\"370\"></p>\n<p>На прокси сервере в локалке два правила для fw:</p>\n<pre><code class=\"lang-auto\">iptables -t nat -A PREROUTING -s 192.168.13.0/25 -p udp -j REDIRECT --to-port 100\niptables -t nat -A PREROUTING -s 192.168.13.0/25 -p tcp -j REDIRECT --to-port 100\n</code></pre>\n<p>Сам конфиг sing-box выглядит следующим образом:</p>\n<pre><code class=\"lang-auto\">{\n  \"dns\": {\n    \"independent_cache\": true,\n    \"rules\": [\n      {\n        \"domain\": [\n          \"2ip.ru\",\n          \"youtube.com\",\n          \"googlevideo.com\",\n          \"ytimg.com\",\n          \"youtu.be\",\n          \"ggpht.com\",\n          \"youtubei.googleapis.com\",\n          \"yt4.ggpht.com\",\n          \"ytimg.l.google.com\",\n          \"nhacmp3youtube.com\",\n          \"googleusercontent.com\",\n          \"googleapis.com\",\n          \"gstatic.com\"\n        ],\n        \"domain_keyword\": [],\n        \"domain_regex\": [],\n        \"domain_suffix\": [],\n        \"geosite\": [],\n        \"server\": \"dns-remote\"\n      },\n      {\n        \"query_type\": [\n          32,\n          33\n        ],\n        \"server\": \"dns-block\"\n      },\n      {\n        \"domain_suffix\": \".lan\",\n        \"server\": \"dns-block\"\n      }\n    ],\n    \"servers\": [\n      {\n        \"address\": \"https://1.1.1.1/dns-query\",\n        \"address_resolver\": \"dns-local\",\n        \"detour\": \"proxy\",\n        \"strategy\": \"prefer_ipv4\",\n        \"tag\": \"dns-remote\"\n      },\n      {\n        \"address\": \"local\",\n        \"address_resolver\": \"dns-local\",\n        \"detour\": \"direct\",\n        \"strategy\": \"prefer_ipv4\",\n        \"tag\": \"dns-direct\"\n      },\n      {\n        \"address\": \"rcode://success\",\n        \"tag\": \"dns-block\"\n      },\n      {\n        \"address\": \"local\",\n        \"detour\": \"direct\",\n        \"tag\": \"dns-local\"\n      }\n    ]\n  },\n   \"inbounds\": [{\n      \"type\": \"redirect\",\n      \"tag\": \"redirect-in\",\n      \"sniff\": true,\n      \"listen\": \"0.0.0.0\",\n      \"listen_port\": 100\n  }],\n  \"log\": {\n    \"level\": \"info\"\n  },\n  \"outbounds\": [\n    {\n      \"domain_strategy\": \"\",\n      \"flow\": \"xtls-rprx-vision\",\n      \"packet_encoding\": \"\",\n      \"server\": \"111.111.111.111\",\n      \"server_port\": 44444,\n      \"tag\": \"proxy\",\n      \"tls\": {\n        \"enabled\": true,\n        \"reality\": {\n          \"enabled\": true,\n          \"public_key\": \"wwwwwwwwwwwwwwwwwwwwwwwwwww\",\n          \"short_id\": \"ccccccccc\"\n        },\n        \"server_name\": \"google.com\",\n        \"utls\": {\n          \"enabled\": true,\n          \"fingerprint\": \"safari\"\n        }\n      },\n      \"type\": \"vless\",\n      \"uuid\": \"66666666666666666666\"\n    },\n    {\n      \"tag\": \"direct\",\n      \"type\": \"direct\"\n    },\n    {\n      \"tag\": \"bypass\",\n      \"type\": \"direct\"\n    },\n    {\n      \"tag\": \"block\",\n      \"type\": \"block\"\n    },\n    {\n      \"tag\": \"dns-out\",\n      \"type\": \"dns\"\n    }\n  ],\n  \"route\": {\n    \"final\": \"bypass\",\n    \"rules\": [\n      {\n        \"outbound\": \"dns-out\",\n        \"protocol\": \"dns\"\n      },\n      {\n        \"domain\": [],\n        \"domain_keyword\": [],\n        \"domain_regex\": [],\n        \"domain_suffix\": [],\n        \"geosite\": [\n          \"category-ads-all\"\n        ],\n        \"outbound\": \"block\"\n      },\n      {\n        \"domain\": [\n          \"2ip.ru\",\n          \"youtube.com\",\n          \"googlevideo.com\",\n          \"ytimg.com\",\n          \"youtu.be\",\n          \"ggpht.com\",\n          \"youtubei.googleapis.com\",\n          \"yt4.ggpht.com\",\n          \"ytimg.l.google.com\",\n          \"nhacmp3youtube.com\",\n          \"googleusercontent.com\",\n          \"googleapis.com\",\n          \"gstatic.com\"\n        ],\n        \"domain_keyword\": [],\n        \"domain_regex\": [],\n        \"domain_suffix\": [],\n        \"geosite\": [],\n        \"outbound\": \"proxy\"\n      },\n      {\n        \"geoip\": [],\n        \"ip_cidr\": [\n          \"147.75.208.0/20\",\n          \"185.89.216.0/22\",\n          \"31.13.24.0/21\",\n          \"31.13.64.0/19\",\n          \"31.13.96.0/19\",\n          \"45.64.40.0/22\",\n          \"66.220.144.0/20\",\n          \"69.63.176.0/20\",\n          \"69.171.224.0/19\",\n          \"74.119.76.0/22\",\n          \"102.132.96.0/20\",\n          \"103.4.96.0/22\",\n          \"129.134.0.0/16\",\n          \"157.240.0.0/16\",\n          \"173.252.64.0/18\",\n          \"179.60.192.0/22\",\n          \"185.60.216.0/22\",\n          \"204.15.20.0/22\",\n          \"102.221.188.0/22\",\n          \"163.114.128.0/20\",\n          \"164.163.191.64/26\",\n          \"199.201.64.0/22\",\n          \"64.233.160.0/19\",\n          \"66.102.0.0/20\",\n          \"66.249.64.0/18\",\n          \"72.14.192.0/18\",\n          \"74.125.0.0/16\",\n          \"209.85.128.0/17\",\n          \"216.239.32.0/19\",\n          \"64.18.0.0/20\",\n          \"108.177.8.0/21\",\n          \"172.217.0.0/19\",\n          \"173.194.0.0/16\",\n          \"207.126.144.0/20\",\n          \"216.58.192.0/19\",\n          \"3.2.40.0/25\",\n          \"3.4.3.0/24\",\n          \"3.4.4.0/24\",\n          \"3.4.6.0/24\",\n          \"3.5.76.0/22\",\n          \"3.5.80.0/21\",\n          \"13.34.14.128/26\",\n          \"13.34.23.96/27\",\n          \"13.34.23.128/25\",\n          \"13.34.24.96/27\",\n          \"13.34.24.128/26\",\n          \"13.34.24.192/27\",\n          \"13.34.25.64/26\",\n          \"13.34.25.128/26\",\n          \"13.34.26.0/25\",\n          \"13.34.28.0/24\",\n          \"13.34.42.128/26\",\n          \"13.34.54.96/27\",\n          \"13.34.54.128/25\",\n          \"13.34.55.0/27\",\n          \"13.34.57.0/26\",\n          \"13.34.61.192/26\",\n          \"13.34.67.64/26\",\n          \"13.34.67.128/25\",\n          \"13.34.68.0/26\",\n          \"13.34.70.64/26\",\n          \"13.34.79.64/26\",\n          \"13.34.82.64/26\",\n          \"13.34.82.128/25\",\n          \"13.34.85.64/26\",\n          \"13.34.86.192/26\",\n          \"13.34.88.192/26\",\n          \"13.34.93.128/26\",\n          \"13.248.112.0/24\",\n          \"15.177.80.0/24\",\n          \"15.181.0.0/19\",\n          \"15.181.64.0/20\",\n          \"15.181.116.0/22\",\n          \"15.181.128.0/20\",\n          \"15.181.245.0/24\",\n          \"15.181.248.0/24\",\n          \"15.181.250.0/23\",\n          \"15.181.252.0/23\",\n          \"15.193.7.0/24\",\n          \"15.220.0.0/19\",\n          \"15.220.32.0/21\",\n          \"15.220.40.0/22\",\n          \"15.220.200.0/21\",\n          \"15.220.208.128/26\",\n          \"15.220.224.0/23\",\n          \"15.220.226.0/24\",\n          \"15.220.252.0/22\",\n          \"15.221.1.0/24\",\n          \"15.221.7.0/24\",\n          \"15.221.148.0/23\",\n          \"15.230.67.192/26\",\n          \"15.230.68.0/25\",\n          \"15.230.92.0/24\",\n          \"15.230.240.0/24\",\n          \"15.230.247.0/24\",\n          \"15.248.40.0/22\",\n          \"15.248.80.0/20\",\n          \"15.253.0.0/16\",\n          \"15.254.0.0/16\",\n          \"18.34.48.0/20\",\n          \"18.34.244.0/22\",\n          \"18.88.128.0/18\",\n          \"18.236.0.0/15\",\n          \"18.246.0.0/16\",\n          \"34.208.0.0/12\",\n          \"35.71.64.0/22\",\n          \"35.80.0.0/12\",\n          \"35.155.0.0/16\",\n          \"35.160.0.0/13\",\n          \"44.224.0.0/11\",\n          \"50.112.0.0/16\",\n          \"52.10.0.0/15\",\n          \"52.12.0.0/15\",\n          \"52.24.0.0/14\",\n          \"52.32.0.0/13\",\n          \"52.40.0.0/14\",\n          \"52.46.180.0/22\",\n          \"52.46.216.0/22\",\n          \"52.46.249.0/24\",\n          \"52.75.0.0/16\",\n          \"52.88.0.0/15\",\n          \"52.92.128.0/17\",\n          \"52.93.12.12/31\",\n          \"52.93.14.18/31\",\n          \"52.93.20.0/24\",\n          \"52.93.120.179/32\",\n          \"52.93.122.218/32\",\n          \"52.93.240.146/31\",\n          \"52.93.240.148/31\",\n          \"52.93.240.152/29\",\n          \"52.93.240.160/27\",\n          \"52.93.240.192/29\",\n          \"52.93.240.200/30\",\n          \"52.93.240.204/31\",\n          \"52.94.10.0/24\",\n          \"52.94.28.0/23\",\n          \"52.94.76.0/22\",\n          \"52.94.116.0/22\",\n          \"52.94.120.0/22\",\n          \"52.94.128.0/22\",\n          \"52.94.176.0/20\",\n          \"52.94.197.0/24\",\n          \"52.94.208.0/21\",\n          \"52.94.248.96/28\",\n          \"52.94.249.64/28\",\n          \"52.95.40.0/24\",\n          \"52.95.230.0/24\",\n          \"52.95.247.0/24\",\n          \"52.95.255.112/28\",\n          \"52.119.160.0/20\",\n          \"52.119.252.0/22\",\n          \"52.144.194.64/26\",\n          \"52.144.194.128/26\",\n          \"52.144.197.128/25\",\n          \"52.218.128.0/17\",\n          \"54.68.0.0/14\",\n          \"54.148.0.0/15\",\n          \"54.184.0.0/13\",\n          \"54.200.0.0/14\",\n          \"54.212.0.0/15\",\n          \"54.214.0.0/16\",\n          \"54.218.0.0/16\",\n          \"54.239.0.32/28\",\n          \"54.239.2.0/23\",\n          \"54.239.48.0/22\",\n          \"54.240.230.0/23\",\n          \"54.240.248.0/21\",\n          \"54.244.0.0/15\",\n          \"64.252.65.0/24\",\n          \"64.252.70.0/23\",\n          \"64.252.72.0/23\",\n          \"70.224.192.0/18\",\n          \"99.77.130.0/24\",\n          \"99.77.152.0/24\",\n          \"99.77.186.0/24\",\n          \"99.77.232.0/24\",\n          \"99.77.253.0/24\",\n          \"99.78.196.0/22\",\n          \"99.150.56.0/21\",\n          \"99.151.186.0/23\",\n          \"100.20.0.0/14\",\n          \"108.166.224.0/21\",\n          \"108.166.240.0/21\",\n          \"142.4.160.16/29\",\n          \"142.4.160.32/29\",\n          \"142.4.160.56/29\",\n          \"142.4.160.64/29\",\n          \"142.4.160.96/28\",\n          \"142.4.160.224/29\",\n          \"150.222.15.132/31\",\n          \"150.222.74.0/23\",\n          \"150.222.102.0/24\",\n          \"150.222.176.0/22\",\n          \"150.222.180.0/24\",\n          \"150.222.196.0/24\",\n          \"150.222.214.0/24\",\n          \"151.148.33.0/24\",\n          \"162.222.148.0/22\",\n          \"176.32.125.0/25\",\n          \"176.32.125.128/26\",\n          \"184.32.0.0/12\",\n          \"205.251.232.0/22\"\n        ],\n        \"outbound\": \"proxy\"\n      },\n      {\n        \"network\": \"udp\",\n        \"outbound\": \"block\",\n        \"port\": [\n          135,\n          137,\n          138,\n          139,\n          5353\n        ]\n      },\n      {\n        \"ip_cidr\": [\n          \"224.0.0.0/3\",\n          \"ff00::/8\"\n        ],\n        \"outbound\": \"block\"\n      },\n      {\n        \"outbound\": \"block\",\n        \"source_ip_cidr\": [\n          \"224.0.0.0/3\",\n          \"ff00::/8\"\n        ]\n      }\n    ]\n  }\n}\n</code></pre>\n<p>Что нужно добавить или убавить чтобы с udp все было ок?</p>",
        "post_number": 67,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-09-15T22:10:36.447Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 13,
        "reads": 68,
        "readers_count": 67,
        "score": 83.6,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "13GwKd33",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 3,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 2209,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/67",
        "can_translate": false
    },
    {
        "id": 40815,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-09-16T14:01:48.091Z",
        "cooked": "<p>для udp надо использовать tproxy или tun. ну и правила у вас полная жесть</p>",
        "post_number": 68,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-09-16T14:01:48.091Z",
        "reply_count": 1,
        "reply_to_post_number": 67,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 63,
        "readers_count": 62,
        "score": 27.6,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "13GwKd33",
            "name": "13GwKd33",
            "avatar_template": "/letter_avatar_proxy/v4/letter/1/858c86/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/68",
        "can_translate": false
    },
    {
        "id": 45411,
        "name": null,
        "username": "Mayday",
        "avatar_template": "/letter_avatar_proxy/v4/letter/m/ad7895/{size}.png",
        "created_at": "2024-09-25T13:30:53.716Z",
        "cooked": "<p>Парни! Не понимаю почему вы sing-box мучаете?  Имея Малинку можно домашний трафик не заворачивать в WG чтобы толкнуть его VLESS-ом (или shadowsocks) на свой VPS. Устанавливайте 3X-ui <strong>на VPS и Малину</strong>!  В панели 3X-ui Малины создайте HTTP-прокси (для домашних - без пароля), и делайте бридж на внешний VPS. В маршрутизации задаете правило и всё прекрасно работает. Настраивать довольно легко.<br>\nДам пример, где человек тоже делает через WG. Можно пойти по его инструкциям, но… ещё раз - (наверное) достаточно HTTP-прокси для дома. В браузерах или в системе, указываете, что ходить в Интет нужно через прокси и… радуетесь! Если кто-то домашним биторентом пользуется, то можно добавить правило обхода в маршрутизации - direct - IP и порт, и поднять это правило над  созданным Inboud.<br>\nНе реклама: “<a href=\"https://deniom.ru/komandy-i-nastrojki/nastrojka-dvojnogo-vpn-cherez-3-x-ui/\" rel=\"noopener nofollow ugc\">Настройка двойного VPN через 3X-UI</a>”</p>",
        "post_number": 69,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-09-25T13:30:53.716Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 21,
        "reads": 60,
        "readers_count": 59,
        "score": 122.0,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://deniom.ru/komandy-i-nastrojki/nastrojka-dvojnogo-vpn-cherez-3-x-ui/",
                "internal": false,
                "reflection": false,
                "title": "Настройка двойного VPN через 3X-UI",
                "clicks": 38
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 6048,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/69",
        "can_translate": false
    },
    {
        "id": 45416,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-09-25T13:57:53.418Z",
        "cooked": "<p>Если честно, по приведенной ссылке на скринах вообще ничего не видно. Поэтому я не совсем понял, в чем плюс конкретно 3x-ui, у которого под капотом все тот же xray (который делает то же что и sing-box).</p>\n<blockquote>\n<p>В браузерах или в системе, указываете, что ходить в Интет нужно через прокси</p>\n</blockquote>\n<p>Так а если в браузерах или системе нельзя указать, что нужно через прокси ходить?</p>",
        "post_number": 70,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-09-25T13:59:36.782Z",
        "reply_count": 1,
        "reply_to_post_number": 69,
        "quote_count": 0,
        "incoming_link_count": 4,
        "reads": 59,
        "readers_count": 58,
        "score": 36.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "Mayday",
            "name": null,
            "avatar_template": "/letter_avatar_proxy/v4/letter/m/ad7895/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/70",
        "can_translate": false
    },
    {
        "id": 45438,
        "name": null,
        "username": "Mayday",
        "avatar_template": "/letter_avatar_proxy/v4/letter/m/ad7895/{size}.png",
        "created_at": "2024-09-25T15:25:55.964Z",
        "cooked": "<p>Когда начнете панель настраивать, то всё будет видно: смотрите на свой экран и на картинку - мелкие детали ничего не дают. Да и другого примера я не видел нигде, а так бы поделился.<br>\nА на счет прокси… ну, может, на ТВ может и не быть, конечно. А так… про всё браузеры не знаю, а системы трудно представить без настроек прокси. Может пример приведете?<br>\nОбратите внимание на Slimjet - очень удобен для работы с прокси - позволяет использовать несколько профилей и быстро их переключать.</p>",
        "post_number": 71,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-09-25T15:25:55.964Z",
        "reply_count": 1,
        "reply_to_post_number": 70,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 57,
        "readers_count": 56,
        "score": 21.4,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "xofamim548",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 6048,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/71",
        "can_translate": false
    },
    {
        "id": 45458,
        "name": "",
        "username": "xofamim548",
        "avatar_template": "/letter_avatar_proxy/v4/letter/x/a698b9/{size}.png",
        "created_at": "2024-09-25T16:05:22.394Z",
        "cooked": "<p>Так я не спорю, по возможности всё надо делать наиболее простым способом. В теме как раз обсуждается проблема, при которой явное проксирование не вариант, потому что таких настроек на клиенте попросту нет.</p>",
        "post_number": 72,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-09-25T16:05:22.394Z",
        "reply_count": 0,
        "reply_to_post_number": 71,
        "quote_count": 0,
        "incoming_link_count": 4,
        "reads": 56,
        "readers_count": 55,
        "score": 31.2,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "Mayday",
            "name": null,
            "avatar_template": "/letter_avatar_proxy/v4/letter/m/ad7895/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 3793,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/72",
        "can_translate": false
    },
    {
        "id": 45830,
        "name": "Yojimboz",
        "username": "Yojimboz",
        "avatar_template": "/user_avatar/ntc.party/yojimboz/{size}/5957_2.png",
        "created_at": "2024-09-26T14:46:30.405Z",
        "cooked": "<p>Друзья, помогите разобраться, что не так с настройкой sing-box.</p>\n<p><strong>Дано:</strong></p>\n<ol>\n<li>\n<p>виртуалка с Ubuntu (192.168.1.148), на ней настроен sing-box, все работает. Используется как маршрутизатор.<br>\nДомашний роутер перенаправляет на нее трафик, адресованный определенным ip-адресам и подсетям. Оттуда через sing-box в VPS.</p>\n</li>\n<li>\n<p>вторая такая же виртуала с Ubuntu (192.168.1.75).<br>\nНастроена с нуля, точно так же, такой же конфиг sing-box, заменен только ip-адрес в конфиге.</p>\n</li>\n</ol>\n<p>На второй никак не работает. Сам sing-box работает, в логах чисто, но через curl ничего не отдает, виснет:</p>\n<pre><code class=\"lang-auto\">curl --interface tun0 https://2ip.io\ncurl: (28) Failed to connect to 2ip.io port 443 after 136133 ms: Couldn't connect to server\n</code></pre>\n<p>Мне кажется, что с маршрутизацией на уровне ОС.<br>\nСравнил две машины, нашел только одно различие в выводе “ip route”</p>\n<p>На машине 192.168.1.148, где все работает:</p>\n<pre><code class=\"lang-auto\"># ip route show\ndefault via 192.168.1.1 dev enp1s0 proto dhcp src 192.168.1.148 metric 100\n169.254.0.0/16 dev enp1s0 scope link metric 1000\n172.17.0.0/16 dev docker0 proto kernel scope link src 172.17.0.1 linkdown\n192.168.1.0/24 dev enp1s0 proto kernel scope link src 192.168.1.148 metric 100\n192.168.1.148/30 dev tun0 proto kernel scope link src 192.168.1.148\n</code></pre>\n<p>На машине 192.168.1.75, где не работает:</p>\n<pre><code class=\"lang-auto\"># ip route\ndefault via 192.168.1.1 dev enp1s0 proto dhcp src 192.168.1.75 metric 100\n192.168.1.0/24 dev enp1s0 proto kernel scope link src 192.168.1.75 metric 100\n192.168.1.1 dev enp1s0 proto dhcp scope link src 192.168.1.75 metric 100\n192.168.1.72/30 dev tun0 proto kernel scope link src 192.168.1.75\n</code></pre>\n<p>В последней строке маршрут, который добавляет сам sing-box. В первом случае он делает маршрут для адреса 192.168.1.148/30, где 192.168.1.148 - это и есть адрес виртуалки.</p>\n<p>Во втором случае он делает маршрут для адреса 192.168.1.72/30, при этом адрес виртуалки другой - 192.168.1.75</p>\n<p>Возможно, причина в этом? Но этот маршрут вручную поправить не могу. Удалить дает, а создать маршрут для “192.168.1.75/30” не дает, т.к. это некорректный адрес подсети.</p>\n<p>На всякий случай прикладываю конфиг:</p>\n<pre><code class=\"lang-auto\">{\n  \"log\": {\n    \"disabled\": false,\n    \"level\": \"debug\",\n    \"output\": \"/tmp/sing-box.log\",\n    \"timestamp\": true\n  },\n  \"dns\": {\n    \"servers\": [\n      {\n        \"address\": \"tls://8.8.8.8\"\n      }\n    ]\n  },\n  \"inbounds\": [\n    {\n      \"type\": \"tun\",\n      \"interface_name\": \"tun0\",\n      \"domain_strategy\": \"ipv4_only\",\n      \"inet4_address\": \"192.168.1.75/30\",\n      \"auto_route\": true,\n      \"strict_route\": false,\n      \"sniff\": true\n   }\n  ],\n\t\"outbounds\": [\n\t\t{\n\t\t\t\"type\": \"vless\",\n\t\t\t\"server\": \"xxx\",\n\t\t\t\"server_port\": 443,\n\t\t\t\"uuid\": \"xxx\",\n\t\t\t\"flow\": \"xtls-rprx-vision\",\n\t\t\t\"tls\": {\n\t\t\t\t\"enabled\": true,\n\t\t\t\t\"insecure\": false,\n\t\t\t\t\"server_name\": \"microsoft.com\",\n\t\t\t\t\"utls\": {\n\t\t\t\t\t\"enabled\": true,\n\t\t\t\t\t\"fingerprint\": \"chrome\"\n\t\t\t\t},\n\t\t\t\t\"reality\": {\n\t\t\t\t\t\"enabled\": true,\n\t\t\t\t\t\"public_key\": \"xxx\",\n\t\t\t\t\t\"short_id\": \"xxx\"\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"direct\",\n\t\t\t\"tag\": \"direct\"\n\t\t},\n\t\t\t{\n\t\t\t\"type\": \"dns\",\n\t\t\t\"tag\": \"dns-out\"\n\t\t\t}\n\t],\n  \"route\": {\n  \t\"rules\": [\n\t\t\t{\n\t\t\t\t\"protocol\": \"dns\",\n\t\t\t\t\"outbound\": \"dns-out\"\n\t\t\t}\n\t\t\t],\n\n    \"auto_detect_interface\": true\n  }\n}\n</code></pre>",
        "post_number": 73,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-09-26T14:47:08.774Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 19,
        "reads": 64,
        "readers_count": 63,
        "score": 107.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "Yojimboz",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4186,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/73",
        "can_translate": false
    },
    {
        "id": 45983,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-09-26T20:02:50.833Z",
        "cooked": "<p>с постером выше решили в лс: inet4_address tun никак не связан с локальным ip устройства, там должно быть 172.19.0.1/30</p>",
        "post_number": 74,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-09-26T20:02:50.833Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 58,
        "readers_count": 57,
        "score": 16.6,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/74",
        "can_translate": false
    },
    {
        "id": 46063,
        "name": "Yojimboz",
        "username": "Yojimboz",
        "avatar_template": "/user_avatar/ntc.party/yojimboz/{size}/5957_2.png",
        "created_at": "2024-09-27T06:45:23.149Z",
        "cooked": "<p>Да, все заработало. Огромное спасибо за помощь!</p>",
        "post_number": 75,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-09-27T06:45:23.149Z",
        "reply_count": 0,
        "reply_to_post_number": 74,
        "quote_count": 0,
        "incoming_link_count": 11,
        "reads": 59,
        "readers_count": 58,
        "score": 66.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "Yojimboz",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "0ka",
            "name": "0ka",
            "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4186,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/75",
        "can_translate": false
    },
    {
        "id": 56762,
        "name": "13GwKd33",
        "username": "13GwKd33",
        "avatar_template": "/letter_avatar_proxy/v4/letter/1/858c86/{size}.png",
        "created_at": "2024-10-18T22:03:58.250Z",
        "cooked": "<p>если использовать tun, то что еще необходимо настроить помимо net.ipv4.conf.all.forwarding=1 ?</p>\n<p>конфигурация inbound следующая:</p>\n<pre><code class=\"lang-auto\">  {\n         \"auto_route\":true,\n         \"domain_strategy\":\"prefer_ipv4\",\n         \"endpoint_independent_nat\":true,\n         \"inet4_address\":\"172.19.0.1/28\",\n         \"interface_name\":\"nekoray-tun\",\n         \"mtu\":1500,\n         \"sniff\":true,\n         \"sniff_override_destination\":false,\n         \"stack\":\"gvisor\",\n         \"strict_route\":false,\n         \"tag\":\"tun-in\",\n         \"type\":\"tun\"\n      }\n</code></pre>",
        "post_number": 76,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-10-18T22:03:58.250Z",
        "reply_count": 0,
        "reply_to_post_number": 68,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 48,
        "readers_count": 47,
        "score": 14.6,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "13GwKd33",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "0ka",
            "name": "0ka",
            "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 2209,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/76",
        "can_translate": false
    },
    {
        "id": 57668,
        "name": "",
        "username": "KuzBass",
        "avatar_template": "/letter_avatar_proxy/v4/letter/k/dbc845/{size}.png",
        "created_at": "2024-10-21T03:34:13.457Z",
        "cooked": "<p>Всем привет! Слежу за этой темой самого его появления и собсна по ней же и настраивал малинку для всех устройств дома. Схема такая:  Клиент - микротик - малина - микротик - мир. На днях обнаружил, что перестали скачиваться приложения с Google Play. Перепробовал уже кучу доменов исключать/добавлять. Не помогает. Есть у кого-нибудь соображения по этому поводу?</p>\n<p>Сейчас использую следующие домены:</p>\n<pre><code class=\"lang-auto\">root@raspberrypi:/etc/sing-box# cat ./rule-set/youtube.json\n{\n    \"version\": 1,\n    \"rules\": [\n        {\n            \"domain_suffix\": [\n                                \".googlevideo.com\",\n                                \".youtube.com\",\n                                \".ggpht.com\",\n                                \".ytimg.com\",\n                                \".googleapis.com\",\n                                \".youtu.be\",\n                                \".google.com\",\n                                \".yt.be\",\n                                \".youtubekids.com\",\n                                \".nhacmp3youtube.com\",\n                                \".googleusercontent.com\",\n                                \".gstatic.com\"\n            ]\n        }\n    ]\n}\nroot@raspberrypi:/etc/sing-box# cat ./rule-set/discord.json\n{\n    \"version\": 1,\n    \"rules\": [\n        {\n            \"domain_suffix\": [\n                                                        \"dis.gd\",\n                                                        \"discord-activities.com\",\n                                                        \"discord.co\",\n                                                        \"discord.com\",\n                                                        \"discord.design\",\n                                                        \"discord.dev\",\n                                                        \"discord.gg\",\n                                                        \"discord.gift\",\n                                                        \"discord.gifts\",\n                                                        \"discord.media\",\n                                                        \"discord.new\",\n                                                        \"discord.store\",\n                                                        \"discord.tools\",\n                                                        \"discordactivities.com\",\n                                                        \"discordapp.com\",\n                                                        \"discordapp.net\",\n                                                        \"discordcdn.com\",\n                                                        \"discordmerch.com\",\n                                                        \"discordpartygames.com\",\n                                                        \"discordsays.com\",\n                                                        \"discordsez.com\",\n                                                        \"discordstatus.com\"\n            ]\n        }\n    ]\n}\n\n</code></pre>",
        "post_number": 77,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-10-21T03:39:16.569Z",
        "reply_count": 2,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 9,
        "reads": 50,
        "readers_count": 49,
        "score": 65.0,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 7485,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/77",
        "can_translate": false
    },
    {
        "id": 57820,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-10-21T11:12:36.444Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"KuzBass\" data-post=\"77\" data-topic=\"8804\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/k/dbc845/48.png\" class=\"avatar\"> KuzBass:</div>\n<blockquote>\n<p>Есть у кого-нибудь соображения по этому поводу?</p>\n</blockquote>\n</aside>\n<p>пользуйтесь wireshark/tcpdump и смотрите на какие домены идут запросы</p>",
        "post_number": 78,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-10-21T11:13:04.652Z",
        "reply_count": 1,
        "reply_to_post_number": 77,
        "quote_count": 1,
        "incoming_link_count": 2,
        "reads": 52,
        "readers_count": 51,
        "score": 25.4,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/78",
        "can_translate": false
    },
    {
        "id": 59890,
        "name": "",
        "username": "KuzBass",
        "avatar_template": "/letter_avatar_proxy/v4/letter/k/dbc845/{size}.png",
        "created_at": "2024-10-28T06:15:42.447Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"KuzBass\" data-post=\"77\" data-topic=\"8804\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/k/dbc845/48.png\" class=\"avatar\"> KuzBass:</div>\n<blockquote>\n<p><code>.googleapis.com</code></p>\n</blockquote>\n</aside>\n<p>Проблема была конкретно в этом домене “.googleapis.com” . Пока без него ютюб работает нормально</p>",
        "post_number": 79,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-10-28T06:15:42.447Z",
        "reply_count": 0,
        "reply_to_post_number": 78,
        "quote_count": 1,
        "incoming_link_count": 1,
        "reads": 54,
        "readers_count": 53,
        "score": 15.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "0ka",
            "name": "0ka",
            "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 7485,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/79",
        "can_translate": false
    },
    {
        "id": 61673,
        "name": "",
        "username": "KuzBass",
        "avatar_template": "/letter_avatar_proxy/v4/letter/k/dbc845/{size}.png",
        "created_at": "2024-11-02T04:04:04.805Z",
        "cooked": "<p>Мое итоговое решение. Возможно кому пригодится. Ну и будет для меня шпаргалкой на всякий случай <img src=\"https://ntc.party/images/emoji/twitter/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"><br>\n<strong>Железо:</strong><br>\nRaspberri Pi 4b + Mikrotik rb2011uias-2hnd + keenetic voyager pro (в самой схеме она не участвует, просто жертва обстоятельств)<br>\n<strong>Задача:</strong><br>\nВ квартире есть тв, планшет, 2 телефона и 2 ПК (ну и горстка “умных устройств”, но их мы лешим просмотра ютюба и посиделок в дискорде с друзьями). Необходимо сделать так, чтоб на всем этом работал Ютюб, дискорд и прочие выкидыши капиталистического загнивающего запада. <img src=\"https://ntc.party/images/emoji/twitter/upside_down_face.png?v=12\" title=\":upside_down_face:\" class=\"emoji\" alt=\":upside_down_face:\" loading=\"lazy\" width=\"20\" height=\"20\"><br>\nНу и желательно чтоб ничего на клиентах настраивать не пришлось. Мне лень.<br>\n<strong>Решение:</strong><br>\nАрендуем VPS. На ней поднимаем панель 3x-ui. Это делается в 2 команды. на этом заострять внимания не будем.<br>\nНа малинке:</p>\n<ol>\n<li>Разрешаем форвардинг пакетов и отключаем ipv6</li>\n</ol>\n<pre><code class=\"lang-auto\">sudo nano /etc/sysctl.conf\nДобавить в конец:\nnet.ipv6.conf.all.disable_ipv6 = 1\nnet.ipv6.conf.default.disable_ipv6 = 1\nnet.ipv4.ip_forward=1\nи выполнить:\nsudo sysctl -p\n</code></pre>\n<ol start=\"2\">\n<li>Маскарадим буквально все, что через нас пролетает.</li>\n</ol>\n<pre><code class=\"lang-auto\">iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\n\nСохраняем правила:\nsudo apt-get install iptables-persistent\nsudo netfilter-persistent save\nsudo systemctl enable netfilter-persistent\nsudo systemctl start netfilter-persistent\n</code></pre>\n<ol start=\"3\">\n<li>Качаем и настраиваем Sing-box</li>\n</ol>\n<pre><code class=\"lang-auto\">bash &lt;(curl -fsSL https://sing-box.app/deb-install.sh)\n</code></pre>\n<p>Конфиг /etc/sing-box/config.json</p>\n<pre><code class=\"lang-auto\">{\n\"log\": {\n    \"disabled\": false,\n    \"level\": \"warn\",\n    \"output\": \"/tmp/sing-box.log\",\n    \"timestamp\": true\n    },\n\"dns\": {\n\t\"strategy\": \"ipv4_only\",\n\t\"servers\": [\n\t{\n\t\"tag\": \"google\",\n\t\"address\": \"https://8.8.8.8/dns-query\"\n\t},\n\t{\n\t\"tag\": \"local\",\n\t\"address\": \"local\",\n\t\"detour\": \"direct\"\n\t},\n\t{\n\t\t\"tag\": \"block\",\n\t\"address\": \"rcode://success\"\n\t}\n\t],\n\t\"strategy\": \"ipv4_only\"\n\t},\n    \"inbounds\": [\n      {\n        \"type\": \"tun\",\n        \"interface_name\": \"tun0\",\n        \"domain_strategy\": \"ipv4_only\",\n        \"inet4_address\": \"172.16.250.1/30\",\n        \"auto_route\": true,\n        \"strict_route\": false,\n        \"sniff\": true,\n\t\"sniff_override_destination\": true,\n\t\"gso\": true\n     }\n    ],\n  \"outbounds\": [\n    {\n      \"domain_strategy\": \"\",\n      \"flow\": \"xtls-rprx-vision\",\n      \"packet_encoding\": \"\",\n      \"server\": \"XXXXXXXX\",\n      \"server_port\": 443,\n      \"tag\": \"vless-out\",\n      \"tls\": {\n        \"enabled\": true,\n        \"reality\": {\n          \"enabled\": true,\n          \"public_key\": \"XXXXXXXX\",\n          \"short_id\": \"XXXXXXXX\"\n        },\n        \"server_name\": \"google.com\",\n        \"utls\": {\n          \"enabled\": true,\n          \"fingerprint\": \"random\"\n        }\n      },\n      \"type\": \"vless\",\n      \"uuid\": \"XXXXXXXX\"\n    },\n\t{\n\t\"type\": \"dns\",\n\t\"tag\": \"dns-out\"\n\t  },\n\t{\n\t\"type\": \"direct\",\n\t\"tag\": \"direct\"\n\t},\n\t{\n\t\"type\": \"block\",\n\t\"tag\": \"block\"\n\t}\n\n  ],\n   \"route\": {\n    \"rules\": [\n\t{\n\t\"protocol\": \"dns\",\n\t\"outbound\": \"dns-out\"\n\t},\n        {\n         \"ip_is_private\": true,\n        \"outbound\": \"direct\"\n        },\n\t\t// Изгои не достойные смотреть синий трактор на ютюбе\n        {\n        \"source_ip_cidr\": [\n\t\t\"10.10.0.13\",\n\t\t\"10.10.0.29\",\n\t\t\"10.10.0.220\",\n\t\t\"10.10.0.251\"\n\t\t\t],\n        \"outbound\": \"direct\"\n        },\n\t\t// Исключаем Российские домены. Можно еще добавить GOV\n        {\n        \"domain_suffix\": [\n\t\t\".ru\",\n\t\t\".su\"\n\t\t\t],\n        \"outbound\": \"direct\"\n        },\n\t{\n\t\"domain_suffix\": \"ntc.party\",\n\t\"outbound\": \"vless-out\"\n\t},\n        {\n        \"domain_suffix\": \"weather.com\",\n        \"outbound\": \"vless-out\"\n        },\n       {\n         \"rule_set\": \"antizapret\",\n         \"outbound\": \"vless-out\"\n       },\n       {\n          \"rule_set\": \"youtube\",\n          \"outbound\": \"vless-out\"\n        },\n       {\n          \"rule_set\": \"discord\",\n          \"outbound\": \"vless-out\"\n        },\n       {\n          \"rule_set\": \"discordipset\",\n          \"outbound\": \"vless-out\"\n        },\n       {\n          \"rule_set\": \"insta\",\n          \"outbound\": \"vless-out\"\n        },\n       {\n          \"rule_set\": \"meta\",\n          \"outbound\": \"vless-out\"\n        }\n\t],\n\t// Этот список работы еле как. Но чет местами открывает ну и пускай будет.\n\"rule_set\": [\n      { // Remote rule-set will be cached if experimental.cache_file.enabled.\n        \"tag\": \"antizapret\",\n        \"type\": \"remote\",\n        \"format\": \"binary\",\n        \"url\": \"https://github.com/savely-krasovsky/antizapret-sing-box/releases/latest/download/antizapret.srs\",\n        \"download_detour\": \"vless-out\",\n        \"update_interval\": \"1d\"\n      },\n      {\n         \"tag\": \"youtube\",\n         \"type\": \"local\",\n         \"format\": \"source\",\n         \"path\": \"/etc/sing-box/rule-set/youtube.json\"\n      },\n      {\n         \"tag\": \"discord\",\n         \"type\": \"local\",\n         \"format\": \"source\",\n         \"path\": \"/etc/sing-box/rule-set/discord.json\"\n      },\n      {\n         \"tag\": \"discordipset\",\n         \"type\": \"local\",\n         \"format\": \"source\",\n         \"path\": \"/etc/sing-box/rule-set/discordipset.json\"\n      },\n      {\n         \"tag\": \"insta\",\n         \"type\": \"local\",\n         \"format\": \"source\",\n         \"path\": \"/etc/sing-box/rule-set/instafasebook.json\"\n      },\n      {\n         \"tag\": \"meta\",\n         \"type\": \"local\",\n         \"format\": \"source\",\n         \"path\": \"/etc/sing-box/rule-set/meta.json\"\n      }\n    ],\n\n\t\"final\": \"direct\",\n\t\"auto_detect_interface\": true\n    }\n  }\n\n</code></pre>\n<p>Пример правил /etc/sing-box/rule-set/youtube.json</p>\n<pre><code class=\"lang-auto\">{\n    \"version\": 1,\n    \"rules\": [\n        {\n            \"domain_suffix\":[\n\"1e100.net\",\n\"ggpht.com\",\n\"googleusercontent.com\",\n\"googlevideo.com\",\n\"gstatic.com\",\n\"gvt1.com\",\n\"l.google.com\",\n\"m.youtube.com\",\n\"nhacmp3youtube.com\",\n\"play.google.com\",\n\"wide-youtube.l.google.com\",\n\"www.youtube.com\",\n\"youtu.be\",\n\"youtube-nocookie.com\",\n\"youtube-studio.com\",\n\"youtube-ui.l.google.com\",\n\"youtube.be\",\n\"youtube.ca\",\n\"youtube.co\",\n\"youtube.co.in\",\n\"youtube.co.uk\",\n\"youtube.com\",\n\"youtube.com.au\",\n\"youtube.com.br\",\n\"youtube.com.mx\",\n\"youtube.com.tr\",\n\"youtube.com.ua\",\n\"youtube.de\",\n\"youtube.es\",\n\"youtube.fr\",\n\"youtube.googleapis.com\",\n\"youtube.jp\",\n\"youtube.nl\",\n\"youtube.pl\",\n\"youtube.pt\",\n\"youtube.ru\",\n\"youtubeapi.com\",\n\"youtubechildren.com\",\n\"youtubecommunity.com\",\n\"youtubecreators.com\",\n\"youtubeeducation.com\",\n\"youtubeembeddedplayer.googleapis.com\",\n\"youtubei.googleapis.com\",\n\"youtubekids.com\",\n\"yt-video-upload.l.google.com\",\n\"yt.be\",\n\"yt3.ggpht.com\",\n\"ytimg.com\",\n\"10tv.app\",\n\"7tv.app\",\n\"7tv.gg\",\n\"7tv.io\",\n\"api.7tv.app\",\n\"cdn.7tv.app\",\n\"cdn.7tv.gg\",\n\"emotes.7tv.app\",\n\"events.7tv.app\",\n\"static.7tv.app\"\n]\n        }\n    ]\n}\n\n\n</code></pre>\n<p>Добавляем  автозагрузку sing-box</p>\n<pre><code class=\"lang-auto\">systemctl enable sing-box.service\n</code></pre>\n<p>Ну и делаем автоматическую перезагрузку сервиса.</p>\n<aside class=\"quote no-group\" data-username=\"omgiafs\" data-post=\"65\" data-topic=\"8804\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/o/c89c15/48.png\" class=\"avatar\"> omgiafs:</div>\n<blockquote>\n<h2>Crontab</h2>\n<p><code>crontab -e</code></p>\n<pre><code class=\"lang-auto\"># restart sing-box every 2 hours to avoid high memory consumption and OOM-killer spawning\n0  */2 * * * /etc/init.d/sing-box restart\n</code></pre>\n</blockquote>\n</aside>\n<ol start=\"4\">\n<li><strong>А ОТКУДА РОЖАТЬ ТАКИЕ RULES-SET??</strong><br>\nВ тырнетах вы можете наткнуться на списки для zapret’a, но они лишь список.</li>\n</ol>\n<pre><code class=\"lang-auto\">instagramm.com\ninstagramn.com\ninstagrampartners.com\ninstagramphoto.com\ninstagramq.com\ninstagramsepeti.com\ninstagramtakipcisatinal.net\n</code></pre>\n<p>Есть два пути. 1. Прогнать этот список через онлайн редакторы/преобразователи и тому подобное и собрать конструкцию уже на месте.<br>\n2.  Воспользоваться Python скриптом который изволил родить мне ChatGPT. Он ищет txt файлики в папке откуда его запустили и переделывает их в json c уже готовой конструкцией и даже определяет ip или домены вы добавляете.</p>\n<pre><code class=\"lang-auto\">import json\nimport ipaddress\nimport os\n\n# Функция для чтения имен из текстового файла\ndef read_names_from_txt(file_path):\n    with open(file_path, 'r', encoding='utf-8') as file:\n        names = [line.strip() for line in file if line.strip()]\n    return names\n\n# Функция для проверки, является ли строка IP-адресом или подсетью\ndef is_valid_ip_or_subnet(ip):\n    try:\n        ipaddress.ip_network(ip, strict=False)\n        return True\n    except ValueError:\n        return False\n\n# Функция для записи имен в JSON файл с нужной структурой\ndef write_names_to_json(names, json_file_path):\n    data = {\n        \"version\": 1,\n        \"rules\": [\n            {\n                \"ip_cidr\": [],\n                \"domain_suffix\": []\n            }\n        ]\n    }\n\n    for name in names:\n        if is_valid_ip_or_subnet(name):\n            data[\"rules\"][0][\"ip_cidr\"].append(name)\n        else:\n            data[\"rules\"][0][\"domain_suffix\"].append(name)\n\n    with open(json_file_path, 'w', encoding='utf-8') as json_file:\n        json.dump(data, json_file, ensure_ascii=False, indent=4)\n\n# Основная программа\ndef main():\n    current_directory = os.getcwd()  # Получаем текущую директорию\n\n    # Ищем все текстовые файлы в текущей директории\n    for filename in os.listdir(current_directory):\n        if filename.endswith('.txt'):\n            txt_file_path = os.path.join(current_directory, filename)\n            json_file_path = os.path.splitext(txt_file_path)[0] + '.json'  # Сохраняем с тем же именем, но в формате JSON\n\n            names = read_names_from_txt(txt_file_path)\n            write_names_to_json(names, json_file_path)\n\n            # Удаляем исходный текстовый файл\n            os.remove(txt_file_path)\n            print(f\"Файл {txt_file_path} успешно преобразован в {json_file_path} и удалён.\")\n\nif __name__ == \"__main__\":\n    main()\n\n</code></pre>\n<p>Где-то видел инфу, что сам sing-box что-то умеет, но я не разбирался. Мне лень <img src=\"https://ntc.party/images/emoji/twitter/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>На этом моя настройка малинки закончена. Всем кто участвовал в обсуждении СПАСИБО, вы оказали огромную помощь в настройке и теперь я могу дальше деградировать. <img src=\"https://ntc.party/images/emoji/twitter/grinning.png?v=12\" title=\":grinning:\" class=\"emoji\" alt=\":grinning:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p><strong>Настройка Mikrotik</strong><br>\nЕсть 3 пути.</p>\n<ol>\n<li>Mangle.<br>\nИзначально я выбрал именно этот путь. Но как показала практика это режет скорость тырнетов и если на скачивание это ±20%, то на выгрузку это 50%. Поэтому этот вариант отпадает. (Возможно, у вас стоит дикая тварь, которая может пережевать весь трафик без потерь. Но у меня точно нет)</li>\n<li>В DHCP сервере указать основным шлюзом малинку.<br>\nЭто самый надежный способ в плане потери пропускной способности. Но если что-то произойдет с малиной то тырнетов вам дома не видать, пока вы не поменяете шлюз на DHCP сервере и аренда не обновится. Главное не забудьте задать статический ip на малине.</li>\n<li>В DHCP сервере указать основным шлюзом малинку. НО делаем автоматическую проверку жизни малины и скрипт для смены основного шлюза<br>\n1.Делаем привило Mangle на Output, метим все исходящие маршруты до адреса 4.2.2.2<br>\n2.Добавляем маршрут в ip-routes, что все маршруты с этой меткой идут через малину.<br>\n3. system-scripts добавляем скрипт, который при падении малины сам поменяет шлюз и перезагрузит все порты, а при восстановлении вернет все в зад.</li>\n</ol>\n<pre><code class=\"lang-auto\">:local GATEWAY \"4.2.2.2\"\n:local COUNT \"2\"\n:local REPLY \"1\"\n:local STATUS  ([/ping $GATEWAY count=$COUNT]-$REPLY);\n:if ($STATUS&lt;0) do={\n/log error message=\"vless not check\"\n/ip dhcp-server network set [find comment=main_server]  gateway=10.10.0.1\n/interface ethernet set ether2 disabled=yes\n/interface ethernet set ether3 disabled=yes\n/interface ethernet set ether5 disabled=yes\n/interface ethernet set ether6 disabled=yes\n/interface ethernet set ether7 disabled=yes\n/interface ethernet set ether8 disabled=yes\n/interface ethernet set ether9 disabled=yes\n:delay 3\n/interface ethernet set ether2 disabled=no\n/interface ethernet set ether3 disabled=no\n/interface ethernet set ether5 disabled=no\n/interface ethernet set ether6 disabled=no\n/interface ethernet set ether7 disabled=no\n/interface ethernet set ether8 disabled=no\n/interface ethernet set ether9 disabled=no\n} else {\n/ip dhcp-server network set [find comment=main_server]  gateway=10.10.0.10\n}\n</code></pre>\n<p>Малина имеет адрес 10.10.0.10, а сам микрот 10.10.0.1<br>\nДалее делаем задачу на запуск скрипта по времени ip-scheduler. Я запускаю скрипт каждые 30 сек.<br>\nПри потери связи с малиной все пойдет через провайдера в течении 1 минуты максимум. А вот при восстановлении фильтрация появится в зависимости от срока аренды вашего DHCP сервера. Я поставил 5 мин.<br>\nЕсть один минус - каждый раз будет в логи срать сообщениями о смене шлюза, но это мы переживем.<br>\nНу и естественно не забываем про статику на малине и в лизесах залочить ip адрес малины</p>\n<p><strong>Итог:</strong><br>\nВ итоге мы имеем довольно надежную схему, которая не режет трафик от провайдера и не ест трафик на VPS т.к. него летят лишь отфильтрованные домены. Схема без особого труда масштабируется и поднимается за час времени с поднятием vps и обновлением малины.<br>\nЖду ваши комментарии и предложения. А также рассказы где я накосячил <img src=\"https://ntc.party/images/emoji/twitter/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"><br>\nЗ.Ы. Потратил на написание этого текста больше времени, чем на поднятие схемы</p>",
        "post_number": 80,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-11-02T04:25:11.240Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 1,
        "incoming_link_count": 69,
        "reads": 63,
        "readers_count": 62,
        "score": 362.6,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 4,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 7485,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/80",
        "can_translate": false
    },
    {
        "id": 63889,
        "name": "Yojimboz",
        "username": "Yojimboz",
        "avatar_template": "/user_avatar/ntc.party/yojimboz/{size}/5957_2.png",
        "created_at": "2024-11-08T10:00:25.719Z",
        "cooked": "<p>Спасибо, что собрали все в одном месте!</p>\n<p>У самого успешно работает схема с маршрутизацией нужных подсетей на виртуалку с sing-box (маршрутизирует сам Keenetic).<br>\nНо с доавблением новых сервисов схема становится все более громоздкой. Сначала мучался с поиском и добавлением подсетей youtube, потом discord…</p>\n<p>Возможно, проще сделать так же как у вас и пустить весь трафик на sing-box с правилами на основе доменных имен.</p>\n<p>Тоже переживаю по поводу надежности и отказоутойчивости схемы, поэтому отлично, что вы сделали у себя watchdog.</p>\n<p>Скажите, если делаю малину (или в моем случае виртуалку) шлюзом по-умолчанию, через нее же пойдет весь LAN-трафик тоже? опасаюсь просто, чтобы не стало узким местом всей домашей сети</p>",
        "post_number": 81,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-11-08T10:00:25.719Z",
        "reply_count": 1,
        "reply_to_post_number": 80,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 53,
        "readers_count": 52,
        "score": 25.6,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "Yojimboz",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "KuzBass",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/k/dbc845/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4186,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/81",
        "can_translate": false
    },
    {
        "id": 65815,
        "name": "",
        "username": "KuzBass",
        "avatar_template": "/letter_avatar_proxy/v4/letter/k/dbc845/{size}.png",
        "created_at": "2024-11-13T01:12:10.654Z",
        "cooked": "<p>LAN траффик идет как правило не доходя до маршрутизатора вообще. В одной локальной сети устройства работают напрямую, а это значит используют arp таблицу свитча/роутера, так что нет. на производительность локальной сети схема не повлияет. Если конечно вы не юзаете VLANы. Тогда это уже другой разговор. Там учувствует маршрутизация и там могут быть затыки, но это будет не большое снижение скорости траффика, при условии, что sing-box настроен верно.</p>",
        "post_number": 82,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-11-13T01:12:10.654Z",
        "reply_count": 1,
        "reply_to_post_number": 81,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 49,
        "readers_count": 48,
        "score": 14.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "Yojimboz",
            "name": "Yojimboz",
            "avatar_template": "/user_avatar/ntc.party/yojimboz/{size}/5957_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 7485,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/82",
        "can_translate": false
    },
    {
        "id": 66876,
        "name": "Yojimboz",
        "username": "Yojimboz",
        "avatar_template": "/user_avatar/ntc.party/yojimboz/{size}/5957_2.png",
        "created_at": "2024-11-15T10:07:47.885Z",
        "cooked": "<p>Спасибо, все сделал, как у вас. Отлично работает!</p>\n<p>Есть теперь только сложность с использованием VLESS-клиента на ПК.<br>\nСейчас шлюзом по умолчанию стоит 192.168.1.65 - это виртуалка с поднятым sing-box, держит туннель VLESS (3X-UI) до VPS в Европе.</p>\n<p>Когда на ПК запускаю клиент Foxray и соединяюсь с тем же VPS, трафик перестает ходить.<br>\nЕсли указываю на ПК (192.168.1.165) обычный шлюз - 192.168.1.1 (домашний роутер), все работает.</p>\n<p>Насколько понимаю, проблема в том, что VLESS-трафик от клиента на ПК заворачивается повторно в тот же VLESS-туннель между шлюзом и VPS.</p>\n<p>Видимо, нужно какое-то правило в конфиге sing-box, чтобы и входящий, и исходящий трафик в сторону<br>\n89.40.xx.xx шел напрямую.</p>\n<pre><code class=\"lang-auto\">+0300 2024-11-15 12:47:06 INFO [1162613644 0ms] inbound/tun[0]: inbound connection from 192.168.1.165:49977\n+0300 2024-11-15 12:47:06 INFO [1162613644 0ms] inbound/tun[0]: inbound connection to 89.40.xx.xx:443\n+0300 2024-11-15 12:47:06 DEBUG [1162613644 1ms] router: sniffed protocol: tls, domain: microsoft.com\n+0300 2024-11-15 12:47:06 DEBUG [1162613644 2ms] dns: resolved [20.76.201.171 20.112.250.133 20.70.246.20 20.236.44.162 20.231.239.246]\n+0300 2024-11-15 12:47:06 INFO [1162613644 2ms] outbound/direct[direct]: outbound connection to microsoft.com:443\n+0300 2024-11-15 12:47:06 INFO [2452199677 0ms] inbound/tun[0]: inbound connection from 192.168.1.165:49978\n+0300 2024-11-15 12:47:06 INFO [2452199677 0ms] inbound/tun[0]: inbound connection to 89.40.xx.xx:443\n+0300 2024-11-15 12:47:06 DEBUG [2452199677 2ms] router: sniffed protocol: tls, domain: microsoft.com\n</code></pre>\n<p>Добавил в конфиг такое, но, похоже, это только для исходящего трафика. А VPN-сервер присылает и в обратную сторону.</p>\n<pre><code class=\"lang-auto\">         {\n        \"ip_cidr\": \"89.40.xx.xx\",\n        \"outbound\": \"direct\"\n        },\n</code></pre>\n<p>Не подскажете, что можно сделать?</p>",
        "post_number": 83,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-11-15T10:08:32.625Z",
        "reply_count": 1,
        "reply_to_post_number": 82,
        "quote_count": 0,
        "incoming_link_count": 6,
        "reads": 54,
        "readers_count": 53,
        "score": 45.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "Yojimboz",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "KuzBass",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/k/dbc845/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4186,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/83",
        "can_translate": false
    },
    {
        "id": 67732,
        "name": "",
        "username": "KuzBass",
        "avatar_template": "/letter_avatar_proxy/v4/letter/k/dbc845/{size}.png",
        "created_at": "2024-11-18T03:08:15.569Z",
        "cooked": "<p>Честно говоря, у меня с этим тоже затык был. Решил просто добавлением маршрута в винде “route add…” указал в качестве шлюза ip маршрутизатора и все.</p>",
        "post_number": 84,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-11-18T03:08:15.569Z",
        "reply_count": 1,
        "reply_to_post_number": 83,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 52,
        "readers_count": 51,
        "score": 15.4,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "Yojimboz",
            "name": "Yojimboz",
            "avatar_template": "/user_avatar/ntc.party/yojimboz/{size}/5957_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 7485,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/84",
        "can_translate": false
    },
    {
        "id": 68567,
        "name": "Yojimboz",
        "username": "Yojimboz",
        "avatar_template": "/user_avatar/ntc.party/yojimboz/{size}/5957_2.png",
        "created_at": "2024-11-22T13:08:08.113Z",
        "cooked": "<p>Сам задал вопрос, сам отвечу)</p>\n<p>Нужно на машине, где sing-box добавить статический маршрут, чтобы она запросы в адрес европейского VPS перекидывала на шлюз роутера:</p>\n<p><code>ip route add 89.40.xx.xx via 192.168.1.1</code></p>",
        "post_number": 85,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2024-11-22T13:08:08.113Z",
        "reply_count": 0,
        "reply_to_post_number": 84,
        "quote_count": 0,
        "incoming_link_count": 14,
        "reads": 54,
        "readers_count": 53,
        "score": 80.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "Yojimboz",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "KuzBass",
            "name": "",
            "avatar_template": "/letter_avatar_proxy/v4/letter/k/dbc845/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4186,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/85",
        "can_translate": false
    },
    {
        "id": 82206,
        "name": "",
        "username": "KuzBass",
        "avatar_template": "/letter_avatar_proxy/v4/letter/k/dbc845/{size}.png",
        "created_at": "2025-03-12T02:24:28.937Z",
        "cooked": "<p>Мой актуальный конфиг для версии 1.11.4.</p>\n<pre><code class=\"lang-auto\">{\n  \"log\": {\n    \"disabled\": false,\n    \"level\": \"debug\",\n    \"output\": \"/tmp/sing-box.log\",\n    \"timestamp\": true\n  },\n  \"dns\": {\n    \"strategy\": \"ipv4_only\",\n    \"servers\": [\n      {\n        \"tag\": \"google\",\n        \"address\": \"https://8.8.8.8/dns-query\",\n        \"detour\": \"direct\"\n      },\n      {\n        \"tag\": \"cloudflare\",\n        \"address\": \"https://1.1.1.1/dns-query\",\n        \"detour\": \"direct\"\n      }\n    ]\n  },\n  \"inbounds\": [\n    {\n      \"type\": \"tun\",\n      \"interface_name\": \"tun0\",\n      \"domain_strategy\": \"ipv4_only\",\n      \"address\": \"172.16.250.1/30\",\n      \"auto_route\": true,\n      \"sniff\": true,\n      \"strict_route\": false,\n      \"sniff_override_destination\": true\n    }\n  ],\n  \"outbounds\": [\n    {\n      \"domain_strategy\": \"prefer_ipv4\",\n      \"flow\": \"xtls-rprx-vision\",\n      \"packet_encoding\": \"xudp\",\n      \"server\": \"XXXXXXXXXXXXX\",\n      \"server_port\": 443,\n      \"tag\": \"vless-out\",\n      \"tls\": {\n        \"enabled\": true,\n        \"reality\": {\n          \"enabled\": true,\n          \"public_key\": \"XXXXXXXXXXXXXX\",\n          \"short_id\": \"XXXXXXXXX\"\n        },\n        \"server_name\": \"google.com\",\n        \"utls\": {\n          \"enabled\": true,\n          \"fingerprint\": \"random\"\n        }\n      },\n      \"type\": \"vless\",\n      \"uuid\": \"XXXXXXXXXXXX\"\n    },\n    {\n      \"type\": \"direct\",\n      \"tag\": \"direct\"\n    }\n  ],\n  \"route\": {\n    \"rules\": [\n      {\n        \"protocol\": \"dns\",\n        \"action\": \"hijack-dns\"\n      },\n      {\n        \"ip_is_private\": true,\n        \"outbound\": \"direct\"\n      },\n    {\n        \"rule_set\": [\n          \"antizapret\",\n\t  \"discord\"\n        ],\n        \"outbound\": \"vless-out\"\n      }\n    ],\n    \"rule_set\": [\n      {\n    \"tag\": \"antizapret\",\n    \"type\": \"remote\",\n    \"format\": \"binary\",\n    \"url\": \"https://cdn.jsdelivr.net/gh/runetfreedom/russia-v2ray-rules-dat@release/sing-box/rule-set-geosite/geosite-ru-blocked.srs\",\n    \"download_detour\": \"vless-out\",\n    \"update_interval\": \"1d\"\n  },\n      {\n         \"tag\": \"discord\",\n         \"type\": \"local\",\n         \"format\": \"source\",\n         \"path\": \"/etc/sing-box/rule-set/discord.json\"\n      }\n    ],\n    \"final\": \"direct\",\n    \"auto_detect_interface\": true\n  }\n}\n\n</code></pre>",
        "post_number": 86,
        "post_type": 1,
        "posts_count": 86,
        "updated_at": "2025-03-12T02:24:28.937Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 11,
        "reads": 35,
        "readers_count": 34,
        "score": 61.8,
        "yours": false,
        "topic_id": 8804,
        "topic_slug": "raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 7485,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/raspberry-pi-xray-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%D0%BE%D0%BC-%D0%B8-%D1%82%D0%B5%D0%BB%D0%B5%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%BC/8804/86",
        "can_translate": false
    }
]

    <html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <style>
    th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      word-wrap: break-word;
      padding: 5px;
    }
    table {
      width: 100%;
      max-width: 100%;
      border: 1px solid black;
      border-collapse: collapse;
      table-layout: fixed;
      word-wrap: break-word
    }
    code {
      word-wrap: break-word;
    }
    pre {
        white-space: pre-wrap;
    }
    </style>
        <title>установка-и-настройка-xray-на-openwrt-самый-лучший-вариант</title>
      </head>
      <body>
        <table border="1" width="100%" cellpadding="5">
          <tr>
            <th style="width: 10%;">Ник</th>
            <th>Пост</th>
            <th style="width: 10%;">Дата</th>
          </tr>
    <tr><td>tom(tom)</td><td><p>Всем привет .</p>
<p>Хотел бы попросить опытных пользователей здесь на форуму , написать 1 максимум 2 схемы  по Китайским протоколам . Прочитав  разные отзывы пользователей с разных форумов я убедился что у пользователей возникает путаница в связи с большим количеством протоколов .</p>
<p>Этот протокол такой-то но нет этого , но он может работать , а этот такой-то   хороший но лучше его использовать так-то итд</p>
<p>Вы скажите , эй , каждый протокол для определннных задач и будете правы. Именно поэтому хотел бы попросить указать ДВЕ наилучшие схемы  на сегодня самых перспективных протоколов.</p>
<p>Еще важный ньюанс , не хотелось бы отдельно собирать образ , а установить на роутер с предустановленной операционной системой OpenWRT или LibreCMC ( форк OpenWRT)</p>
<p>Предположим у нас есть роутер NanoPi R2S Plus ( RAM 	 1GB DDR4, Storage  32GB eMMC ) <a href="https://www.friendlyelec.com/index.php?route=product/product&amp;path=69&amp;product_id=296" class="inline-onebox" rel="noopener nofollow ugc">R2S Plus</a><br>
На мой взгляд это  один  из лучших вариантов на сегодняшний день.</p>
<p><strong>Не нужно вставлять флешки USB для расширения памяти !</strong></p>
<p>Для сравнения возьмем популярный роутер GL-AR300M16 (Memory DDR2 128MB / Storage  16MB)<br>
Цена почти одинаковая но разница в железе огромная, поэтому  рекомендуется к покупке    NanoPi R2S Plus.</p>
<p>В этой статье рассказывается об установке X-ray на OpenWRT , <strong>этого достаточно чтобы обходить блокировки ?</strong></p><aside class="onebox allowlistedgeneric" data-onebox-src="https://miracleptr.wordpress.com/2023/08/31/%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0-%D0%B8-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-xray-%D0%BD%D0%B0-openwrt-%D0%B4%D0%BB%D1%8F-shadowsocks-xtls-reality-%D0%B8/">
  <header class="source">
      <img src="установка-и-настройка-xray-на-openwrt-самый-лучший-вариант/7ad08aa585a29ef987d7472bbc27f661bcb308bd.jpeg" class="site-icon" data-dominant-color="E7E5DB" width="32" height="32">

      <a href="https://miracleptr.wordpress.com/2023/08/31/%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0-%D0%B8-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-xray-%D0%BD%D0%B0-openwrt-%D0%B4%D0%BB%D1%8F-shadowsocks-xtls-reality-%D0%B8/" target="_blank" rel="noopener nofollow ugc" title="09:58AM - 31 August 2023">MiraclePtr – 31 Aug 23</a>
  </header>

  <article class="onebox-body">
    

<h3><a href="https://miracleptr.wordpress.com/2023/08/31/%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0-%D0%B8-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-xray-%D0%BD%D0%B0-openwrt-%D0%B4%D0%BB%D1%8F-shadowsocks-xtls-reality-%D0%B8/" target="_blank" rel="noopener nofollow ugc">Установка и настройка XRay на OpenWRT (для Shadowsocks, XTLS-Reality и...</a></h3>

  <p>По многочисленным просьбам, настало время статьи про настройку XRay на OpenWRT. Про настройку этого дела под OpenWRT уже недавно рассказывал&nbsp;@Andrevich&nbsp;в своей отличной статье&nbsp;Обход блокировок на O…</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>
</td><td>2024-01-20T09:38:11.797Z</td></tr><tr><td>bolvan</td><td><p>Думаю не стоит ориентироваться на веб интерфейс. Этим вы себя только ограничиваете. Ищите решение куда ткнуть что вписать, и тем самым закрываете себя от множества отличных статей, описывающих настройку xray в оригинале без “интерфейсов”.<br>
Нужно всего лишь правильно написать /etc/xray/config.json<br>
И, конечно, настроить сервер. Но там вряд ли вы будете гонять openwrt.<br>
Если и будет какой-то UI, то другой. 3x-ui , например.</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://habr.com/ru/articles/727868/">
  <header class="source">
      <img src="установка-и-настройка-xray-на-openwrt-самый-лучший-вариант/e8fc7b34a1237fbc93fd62548efc1a4df1f7fa72.png" class="site-icon" data-dominant-color="97BFD2" width="16" height="16">

      <a href="https://habr.com/ru/articles/727868/" target="_blank" rel="noopener">Хабр</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/361;"><img src="установка-и-настройка-xray-на-openwrt-самый-лучший-вариант/1fbacc132353e12aa0e07ca76d58b12ecea0a171.png" class="thumbnail" data-dominant-color="4C6778" width="690" height="362"></div>

<h3><a href="https://habr.com/ru/articles/727868/" target="_blank" rel="noopener">Современные технологии обхода блокировок: V2Ray, XRay, XTLS, Hysteria, Cloak...</a></h3>

  <p>Статья опубликована под лицензией Creative Commons BY-NC-SA . Три месяца назад здесь на Хабре я опубликовал статью “ Интернет-цензура и обход блокировок: не время расслабляться ”, в которой простыми...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://habr.com/ru/articles/728836/">
  <header class="source">
      <img src="установка-и-настройка-xray-на-openwrt-самый-лучший-вариант/e8fc7b34a1237fbc93fd62548efc1a4df1f7fa72.png" class="site-icon" data-dominant-color="97BFD2" width="16" height="16">

      <a href="https://habr.com/ru/articles/728836/" target="_blank" rel="noopener">Хабр</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/361;"><img src="установка-и-настройка-xray-на-openwrt-самый-лучший-вариант/67015f6827fefdfe1bce6c81b6bce77d49c44c2b.png" class="thumbnail" data-dominant-color="516F81" width="690" height="362"></div>

<h3><a href="https://habr.com/ru/articles/728836/" target="_blank" rel="noopener">Обход блокировок: настройка сервера XRay для Shadowsocks-2022 и VLESS с...</a></h3>

  <p>Статья опубликована под лицензией Creative Commons BY-NC-SA . Предыдущие статьи серии: « Современные технологии обхода блокировок: V2Ray, XRay, XTLS, Hysteria и все‑все‑все » « Программы‑клиенты...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://habr.com/ru/articles/731608/">
  <header class="source">
      <img src="установка-и-настройка-xray-на-openwrt-самый-лучший-вариант/e8fc7b34a1237fbc93fd62548efc1a4df1f7fa72.png" class="site-icon" data-dominant-color="97BFD2" width="16" height="16">

      <a href="https://habr.com/ru/articles/731608/" target="_blank" rel="noopener">Хабр</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/361;"><img src="установка-и-настройка-xray-на-openwrt-самый-лучший-вариант/ad5b48b0f0ef53272c8a8feced50eb236a5c3e43.png" class="thumbnail" data-dominant-color="516F80" width="690" height="362"></div>

<h3><a href="https://habr.com/ru/articles/731608/" target="_blank" rel="noopener">Bleeding-edge обход блокировок с полной маскировкой: настраиваем сервер и...</a></h3>

  <p>Статья опубликована под лицензией Creative Commons BY-NC-SA . В серии предыдущих статей я описывал, почему повсеместно используемые VPN- и прокси-протоколы такие как Wireguard и L2TP очень уязвимы к...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://habr.com/ru/articles/735536/">
  <header class="source">
      <img src="установка-и-настройка-xray-на-openwrt-самый-лучший-вариант/e8fc7b34a1237fbc93fd62548efc1a4df1f7fa72.png" class="site-icon" data-dominant-color="97BFD2" width="16" height="16">

      <a href="https://habr.com/ru/articles/735536/" target="_blank" rel="noopener">Хабр</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/361;"><img src="установка-и-настройка-xray-на-openwrt-самый-лучший-вариант/402af0a397458beb8d452c685f57a4cb5666d085.png" class="thumbnail" data-dominant-color="4B6677" width="690" height="362"></div>

<h3><a href="https://habr.com/ru/articles/735536/" target="_blank" rel="noopener">3X-UI: Shadowsocks-2022 &amp; XRay (XTLS) сервер с простой настройкой и...</a></h3>

  <p>Статья опубликована под лицензией Creative Commons BY-NC-SA . В серии предыдущих статей я описывал, почему повсеместно используемые VPN- и прокси-протоколы такие как OpenVPN и L2TP&nbsp; очень уязвимы...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>
</td><td>2024-01-20T09:44:26.863Z</td></tr><tr><td>tom(tom)</td><td><p>Cпасибо за ваш ответ . Задача именно установить на роутер . Предположим вы куда-то едете , взяли с собой роутер на OpenWRT и у вас телефон на базе Android. <strong>У вас нет с собой PC</strong><br>
Подключаясь в любом месте к интернету  города “X” через  роутер ,на ваш телефон поступает трафик обработанный X-ray ,что позволяет вам свободно пользоваться интернетом .</p>
<p>Что касается вэб интерфейса , то в OpenWRT можно его не использовать.  Хотелось бы понять , <strong>достаточно установки X-ray на роутер ,чтобы обходить  блокировки ?</strong></p>
<p>P.S  Статьи , ссылки которых вы дали это от одного автора )) Данный автор создал аварийный варинт на wordpress.</p></td><td>2024-01-20T10:00:27.097Z</td></tr><tr><td>bolvan</td><td><aside class="quote no-group" data-username="tom" data-post="3" data-topic="6932">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/t/3d9bf3/48.png" class="avatar"> tom:</div>
<blockquote>
<p>Что касается вэб интерфейса , то в OpenWRT можно его не использовать. Хотелось бы понять , <strong>достаточно установки X-ray на роутер ,чтобы обходить блокировки ?</strong></p>
</blockquote>
</aside>
<p>Если хотите прозрачно, то нет.<br>
Требуется особая конфигурация и много ip/nf tables.</p>
<p>Тут китаеза, но конфиги приведены для понимания как это настраивать</p><aside class="onebox allowlistedgeneric" data-onebox-src="https://xtls.github.io/en/document/level-2/tproxy.html#%E5%BC%80%E5%A7%8B%E4%B9%8B%E5%89%8D">
  <header class="source">
      <img src="установка-и-настройка-xray-на-openwrt-самый-лучший-вариант/d9bcf147606ea7c8d4f3a06afd01c42c4a3672c1_2_690x215.png" class="site-icon" data-dominant-color="754544" width="690" height="215">

      <a href="https://xtls.github.io/en/document/level-2/tproxy.html#%E5%BC%80%E5%A7%8B%E4%B9%8B%E5%89%8D" target="_blank" rel="noopener">xtls.github.io</a>
  </header>

  <article class="onebox-body">
    

<h3><a href="https://xtls.github.io/en/document/level-2/tproxy.html#%E5%BC%80%E5%A7%8B%E4%B9%8B%E5%89%8D" target="_blank" rel="noopener">TProxy 透明代理 | Project X</a></h3>

  <p>Official document of Xray</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>
<p>
Возможно, часть этих nftables можно перевести на язык firewall4 (/etc/config/firewall). Надо смотреть есть ли такой функционал по всем таргетам.<br>
А если нет, то можно самому табличку отдельную от fw4 создать, и там это все написать.<br>
xray настроить как tproxy, заворачивать на него средствами nft</p></td><td>2024-01-20T11:21:53.851Z</td></tr><tr><td>borouhin(Alexander Borouhin)</td><td><aside class="quote no-group" data-username="tom" data-post="1" data-topic="6932">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/t/3d9bf3/48.png" class="avatar"> tom:</div>
<blockquote>
<p>Предположим у нас есть роутер NanoPi R2S Plus ( RAM 1GB DDR4, Storage 32GB eMMC ) <a href="https://www.friendlyelec.com/index.php?route=product/product&amp;path=69&amp;product_id=296" rel="noopener nofollow ugc">R2S Plus </a></p>
</blockquote>
</aside>
<p>Если у нас такой роутер есть - зачем нам костыли в виде OpenWRT? На него прекрасно Armbian ставится и настраивается всё по гайдам для обычного Linux-сервера без затруднений в виде попыток понять “а куда это запрятали в OpenWRT”</p></td><td>2024-01-20T11:26:20.206Z</td></tr><tr><td>0ka(0ka)</td><td><p>вы совсем ничего в теме не понимаете, правильно? (т.е. с линуксом не обращались раньше)<br>
вопрос в конце поста странный, всю статью вам рассказывают как обходить блокировки на устройствах, в конце вы спрашивате “этого достаточно чтобы обходить блокировки ?”.<br>
Для вас это скорее всего будет лучшим способом. Не думаю что осилите то, что предлагают другие комментаторы.</p></td><td>2024-01-20T11:46:00.402Z</td></tr><tr><td>tom(tom)</td><td><p>Спасибо за ответ .  Правильно я понял вас ,что на данный момент на данном форуме нет инструкции как установить X-ray с набором скриптов для настройки OpenWRT ?</p></td><td>2024-01-20T18:46:30.430Z</td></tr><tr><td>tom(tom)</td><td><p>Старик , ты написал самое глупое из  возможных сценариев.  Никогда не нужно считать себя умнее других, если я не осилю , попрошу ( оплачу работу ) того кто осилит, не вижу здесь проблемы.<br>
Ты думаешь один в протокал разбираешься ? И у нас нет грамотных сетевиков ?</p>
<p>Запомни когда речь идет о блокировках нужно не выЕ, а помогать друг другу , например "Черный треугольник " создает видео с примерами , он не говорит c своих видео  как ты,что вы ребята не осилите и тому подобное.   Или вот это парень который написал эту статью <a href="https://miracleptr.wordpress.com/2023/08/31/%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0-%D0%B8-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-xray-%D0%BD%D0%B0-openwrt-%D0%B4%D0%BB%D1%8F-shadowsocks-xtls-reality-%D0%B8/" class="inline-onebox" rel="noopener nofollow ugc">Установка и настройка XRay на OpenWRT (для Shadowsocks, XTLS-Reality и всего-всего-всего) — MiraclePtr</a>.</p></td><td>2024-01-20T18:54:56.460Z</td></tr><tr><td>tom(tom)</td><td><p>Спасибо за ответ.<br>
Вы логично рассуждаете , да , можно установить и Arch Linux <a href="https://gist.github.com/larsch/a8f13faa2163984bb945d02efb897e6d" class="inline-onebox" rel="noopener nofollow ugc">Installing Arch Linux AArch64 on the NanoPi R2S · GitHub</a>  но в данной теме хотелось бы понять про OpenWRT.</p>
<p>Или в  этом нет сымсла так как это сложнеес точки зрения настройки и не эффективно.</p></td><td>2024-01-20T19:11:19.663Z</td></tr><tr><td>bolvan</td><td><aside class="quote no-group" data-username="tom" data-post="9" data-topic="6932">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/t/3d9bf3/48.png" class="avatar"> tom:</div>
<blockquote>
<p>Или в этом нет сымсла так как это сложнеес точки зрения настройки и не эффективно</p>
</blockquote>
</aside>
<p>Наоборот, я бы сказал, что проще. Почему : потому что на openwrt не надо париться с настройкой роутера через таблес. Там все готовое. А linux он и есть linux. На него все можно нацепить, если не ограничиваться люськой.</p>
<p>Я попробовал. Сходу не вышло. Перенаправить удалось через tproxy, но xray не может определить адрес назначения. Не знаю что ему нужно, в таких случаях я бы тупо сделал socks настройку xray и для опрозрачивания использовал redsocks. Правда, это будет работать только для tcp.</p>
<p>tproxy таргет отсутствует в firewall 3/4  , возможность сделать ip rule add local вроде тоже (хотя в общем случае rules поддерживаются в /etc/config/network). Так что все касаемое tproxy - ручками.</p></td><td>2024-01-20T19:28:11.961Z</td></tr><tr><td>borouhin(Alexander Borouhin)</td><td><aside class="quote no-group" data-username="tom" data-post="9" data-topic="6932">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/t/3d9bf3/48.png" class="avatar"> tom:</div>
<blockquote>
<p>Или в этом нет сымсла так как это сложнеес точки зрения настройки и не эффективно.</p>
</blockquote>
</aside>
<p>После того, как началась эта чехарда с блокировками по протоколам, я во всех железных роутерах с их роутерными ОС/прошивками разочаровался в принципе.<br>
Вот есть у меня аж 4 микротика - и что от них сейчас толку, если из всех неблокируемых (ну по крайней мере пока) протоколов там только катастрофически тормозной SSTP, а всё, что можно поднять в контейнере, тоже безумно тормозит. В итоге к микротикам прикручено по одноплатнику Orange Pi, на которых поставлен обычный Linux и через которые я гоняю стойкие к блокировкам туннели (Amnezia-WG и WG через Cloak).<br>
В OpenWRT (или в Vyatta/VyOS, скажем) получше, но тоже каждый новый протокол - это надо или самому портировать на OpenWRT, или ждать, кто кто-то это сделает, молиться, что там не будет никакой фатальной несовместимости - и всё равно много работать руками, только ещё и превозмогая ОС, заточенную под GUI.<br>
А весьма вероятно, что в ближайшее время протоколы менять нам придётся <strong>часто</strong>… Так что моими следующими роутерами, если буду покупать новые, будут стандартные одноюнитовые сервера с 4-хпортовыми сетевыми картами и обычным линуксом. Наигрался в эту внешнюю “простоту”, хватит. То, что в OpenWRT или Mikrotik “есть готовое” - оно в любом линуксе настаривается за час с перекурами, а ещё лучше один раз создать роль “router” в Ansible под свои потребности и потом автоматом накатывать любые изменения и улучшения.</p></td><td>2024-01-20T21:10:03.115Z</td></tr><tr><td>neo1</td><td><aside class="quote no-group" data-username="tom" data-post="3" data-topic="6932">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/t/3d9bf3/48.png" class="avatar"> tom:</div>
<blockquote>
<p>Подключаясь в любом месте к интернету города “X” через роутер ,на ваш телефон поступает трафик обработанный X-ray ,что позволяет вам свободно пользоваться интернетом .</p>
</blockquote>
</aside>
<p>Понимаю, что мой вопрос немного не по теме, но не могу не спросить: а зачем в вашем примере телефону нужна прокладка в виде роутера-с-Xray? Есть же множество приложений на телефон, которые позволяют использовать протоколы Xray прямо с телефона. А там уже не важно, откуда телефон получает интернет: из роутера, из публичной WIFI сети, или через sim-карту.</p>
<p>Или есть какой-то сценарий, который мешает использовать приложения на телефоне?</p></td><td>2024-01-21T03:45:35.156Z</td></tr><tr><td>RapWolf</td><td><aside class="quote no-group" data-username="borouhin" data-post="11" data-topic="6932">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/borouhin/48/3734_2.png" class="avatar"> borouhin:</div>
<blockquote>
<p>После того, как началась эта чехарда с блокировками по протоколам, я во всех железных роутерах с их роутерными ОС/прошивками разочаровался в принципе.</p>
</blockquote>
</aside>
<p>Только это заставило разочароваться?<br>
Я в принципе не понимаю что вы называете роутерами. Это какое-то чудовищное детище больного разума, 4-в-1, на арм процессоре десятилетней давности, который ещё и больше для телефонов, чем для эмбедов предназначался.<br>
Лучше взять нормальный роутер на x86_64 проце, поставить на него pfSense, при надобности отдельно купить точку доступа и свич. И место есть, и оперативки не 1 гб, и не портированные на арм тулзы работают, и pihole/adguard/vpn можно сразу на него поставить, а не подключать сбц отдельно</p></td><td>2024-01-21T07:23:10.424Z</td></tr><tr><td>bolvan</td><td><aside class="quote no-group" data-username="borouhin" data-post="11" data-topic="6932">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/borouhin/48/3734_2.png" class="avatar"> borouhin:</div>
<blockquote>
<p>превозмогая ОС, заточенную под GUI.</p>
</blockquote>
</aside>
<p>openwrt не заточена под GUI.  наоборот, luci - это побочное явление.<br>
прекрасно управляется и без люськи. я , например, ее ставлю только на всякий случай.<br>
изредка бывает полезно, если не знаешь каких-то опций в конфигах.<br>
но легко бы обошелся и без. базовые образы собираю сам и даже не думаю туда включать luci</p>
<p>в openwrt есть своя система поднятия и управления сетью - netifd. можно провести параллели с network manager в каком-то смысле.<br>
есть своя система управления фаерволом/роутером. firewall3 или firewall4</p>
<p>есть стандартизированная система управления конфигами - UCI. и скрипты запуска /etc/init.d затачиваются на трансляцию UCI конфигов в конфиги конкретных демонов.<br>
некоторые демоны напрямую используют UCI или имеют патчи на использование UCI</p>
<p>есть микроаналог dbus - ubus. с его помощью выстроено “пинание” некоторых демонов без перезапуска. передача им команд и получение результата.</p>
<p>но во всем остальном это обычный linux. можно синхронизироваться с поднятием интерфейсов через /etc/hotplug.d/iface. есть /etc/rc.local<br>
есть хуки к фаерволу<br>
тут главное хукнуться куда надо, и там можно написать свою отсебятину. да, она не будет проведена через морду, но кому нужна эта морда ?</p>
<p>в классическом linux все равно надо будет писать эту отсебятину и пихать в какой-нибудь rc.local или системд юнит. только еще кучу другой отсебятины по поводу роутера и фаервола, поднимать dnsmasq и тд, либо нацеплять какие-то упрощенки для чайников</p>
<p>микротики, насколько мне известно, перешиваются на openwrt.</p></td><td>2024-01-21T07:54:09.290Z</td></tr><tr><td>bolvan</td><td><aside class="quote no-group" data-username="RapWolf" data-post="13" data-topic="6932">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/rapwolf/48/496_2.png" class="avatar"> RapWolf:</div>
<blockquote>
<p>поставить на него pfSense</p>
</blockquote>
</aside>
<p>в новых условиях надо сразу быть готовыми к отказу от интеграшек.<br>
интеграшкой я называю удобно-простую систему с веб мордой, в которой настраивается куча разных функций.<br>
или хотя бы быть готовым к выходу за пределы интеграшки<br>
в случае pfsense можно выйти на уровень freebsd.<br>
но PF фаервол не очень хорош тем, что придется вписывать свои якоря в код скриптов самого pfsense. отдельную табличку nftables или свои iptables не трогая код основной системы не выйдет залепить туда.<br>
если знаешь freebsd достаточно хорошо , то вариант.  но я считаю linux имеет больше возможностей как на уровне управления сетью, так и на уровне совместимого софта</p></td><td>2024-01-21T08:02:57.419Z</td></tr><tr><td>borouhin(Alexander Borouhin)</td><td><aside class="quote no-group quote-modified" data-username="bolvan" data-post="14" data-topic="6932">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/b/8e8cbc/48.png" class="avatar"> bolvan:</div>
<blockquote>
<p>в openwrt есть своя система поднятия и управления сетью<br>
…<br>
есть своя система управления фаерволом/роутером<br>
…<br>
есть стандартизированная система управления конфигами</p>
</blockquote>
</aside>
<p>Вот в том-то и дело, что оно всё “своё”, и даже если оно в каких-то моментах и удобнее - надо потратить время, чтобы в этом разобраться, и потом все изменения делать дважды - для линукса, который у нас на серверах, и для OpenWRT (или любой другой роутерной ОС/прошивки), которая у нас на роутерах. Линукс все так или иначе знают (ну кроме весьма обширной секты свидетелей Windows на серверах <img src="https://ntc.party/images/emoji/twitter/slight_smile.png?v=12" title=":slight_smile:" class="emoji" alt=":slight_smile:" loading="lazy" width="20" height="20"> и полутора ещё оставшихся в живых фанатов фряхи <img src="https://ntc.party/images/emoji/twitter/slight_smile.png?v=12" title=":slight_smile:" class="emoji" alt=":slight_smile:" loading="lazy" width="20" height="20"> ) - и если даже с другой стороны туннеля на той самой зарубежной VPS у нас он, то логично именно иметь и на роутере.<br>
А когда роутеров/серверов становится больше трёх - централизованная система управления конфигурацией становится must have, и тут своеобычность роутера тоже добавляет дополнительной работы. Да, у Ansible есть коллекция для OpenWRT - но это свой отдельный велосипед, каждый таск придётся дублировать.</p>
<aside class="quote no-group" data-username="bolvan" data-post="14" data-topic="6932">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/b/8e8cbc/48.png" class="avatar"> bolvan:</div>
<blockquote>
<p>микротики, насколько мне известно, перешиваются на openwrt.</p>
</blockquote>
</aside>
<p>Только некоторые модели, причём низшего ценового диапазона (на которых особо ничего не поставишь уже из-за слабого железа, а не только из-за ОС).</p></td><td>2024-01-21T12:41:43.896Z</td></tr><tr><td>Xunlei</td><td><p>Для информации похожие темы:<br>
<a href="https://ntc.party/t/%D0%BA%D0%B0%D0%BA%D0%BE%D0%B9-%D1%81%D1%83%D1%89%D0%B5%D1%81%D1%82%D0%B2%D1%83%D0%B5%D1%82-%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D0%B9-%D0%B8-%D1%83%D0%BD%D0%B8%D0%B2%D0%B5%D1%80%D1%81%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9-%D0%B4%D0%BB%D1%8F-%D1%80%D0%B0%D0%B7%D0%BD%D1%8B%D1%85-%D1%83%D1%81%D1%82%D1%80%D0%BE%D0%B9%D1%81%D1%82%D0%B2-%D1%81%D0%BF%D0%BE%D1%81%D0%BE%D0%B1-%D0%BF%D0%BE%D0%B4%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D1%8F-%D0%BA-vpn-%D0%B2-%D1%83%D1%81%D0%BB%D0%BE%D0%B2%D0%B8%D1%8F%D1%85-%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B8/5603">Какой существует простой и универсальный (для разных устройств) способ подключения к VPN в условиях блокировки</a><br>
<a href="https://ntc.party/t/openwrt-%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80/5643/">OpenWRT роутер</a><br>
<a href="https://ntc.party/t/openvpn-xor-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D0%B0-%D1%81-%D0%BA%D0%BB%D0%B8%D0%B5%D0%BD%D1%82%D0%BE%D0%BC/5756">OpenVPN + XOR настройка / проблема с клиентом</a><br>
<a href="https://ntc.party/t/%D0%BA%D0%B0%D0%BA-%D0%B2%D1%8B-%D0%BE%D0%B1%D1%85%D0%BE%D0%B4%D0%B8%D1%82%D0%B5-%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B8-%D0%B7%D0%B0%D0%BF%D1%80%D0%B5%D1%89%D0%B5%D0%BD%D0%BD%D1%8B%D1%85-%D1%81%D0%B0%D0%B9%D1%82%D0%BE%D0%B2/5615">Как вы обходите блокировки запрещенных сайтов?</a></p></td><td>2024-01-21T13:46:56.304Z</td></tr><tr><td>tom(tom)</td><td><p>Спасибо за ответ. Вы написали что пробовали но у вас не получилось , уточните пожалуйста каким источником вы пользовались ? Было бы здорово если здесь был бы рабочий вариант  или статья или кто-то написл на gihub инструкцию, к которой можно обратится чтобы поэксперементировать и здесь общими усилиями доработать.</p></td><td>2024-01-21T18:38:01.066Z</td></tr><tr><td>tom(tom)</td><td><p>Приветствую. Хороший вопрос . То есть вы полагаете что можно  до поездки в Китай настроить например Nekoray на телефоне и сервера с X-ray где-то на удаленном VPS а  приехав в Китай с телефона подключиться к этому серверу ?</p>
<p>Мне кажется идея <a class="mention" href="/u/borouhin">@borouhin</a> верна , можно купить например вот такой вариант  роутера-одноплатного компьютера <a href="https://www.friendlyelec.com/index.php?route=product/product&amp;path=69&amp;product_id=290" class="inline-onebox" rel="noopener nofollow ugc">NanoPi R5C</a> установить на него Debian и дальше настроить  полноценно. Мне казалось с точки зрения настройки достаточно установить X-ray на OpenWRT  плюс-минус небольшие танцы с бубнами и все  заработает, если игра не стоит свечь,то конечно одноплатные компьютеры в этом смысле очень выйгрышный вариант.</p></td><td>2024-01-21T19:01:16.724Z</td></tr><tr><td>bolvan</td><td><aside class="quote no-group" data-username="tom" data-post="18" data-topic="6932">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/t/3d9bf3/48.png" class="avatar"> tom:</div>
<blockquote>
<p>Спасибо за ответ. Вы написали что пробовали но у вас не получилось , уточните пожалуйста каким источником вы пользовались ?</p>
</blockquote>
</aside>
<p>Я сделал стандартный заворот через tproxy. Например так, как у китайцев написано.<br>
Заворот произошел, но прога не может распознать destination IP, на что жалуется и сразу бросает конект. Разбираться глубоко не стал. Однако, есть отработанная методика через redsocks</p></td><td>2024-01-22T07:30:48.957Z</td></tr><tr><td>bolvan</td><td><aside class="quote no-group" data-username="tom" data-post="19" data-topic="6932">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/t/3d9bf3/48.png" class="avatar"> tom:</div>
<blockquote>
<p>Приветствую. Хороший вопрос . То есть вы полагаете что можно до поездки в Китай настроить например Nekoray на телефоне и сервера с X-ray где-то на удаленном VPS а приехав в Китай с телефона подключиться к этому серверу ?</p>
</blockquote>
</aside>
<p>Это наиболее логичный вариант. Зачем девайсы на linux и сложности с настройкой, когда на телефоне VPNизация делается одной кнопкой ? Главное, чтобы IP хостера не оказался заблокирован. А для этого желательно кого-то попросить оттуда попингать.<br>
Есть вариант еще не хостера брать, а настроить на своем квартирном подключении с внешним IP все то же самое. В этом случае вероятность попадания в блокировку по IP минимальна. А с российскими блокировками можно решить вопрос через вторичное тунеллирование или zapret</p></td><td>2024-01-22T07:33:07.298Z</td></tr><tr><td>tom(tom)</td><td><p>Спасибо за ваш ответ .  Понял , поищу в интернете ,может кто-то успешно установил xray на openwrt ,установил у себя дома и обходит блокировки )</p></td><td>2024-01-22T10:14:32.456Z</td></tr><tr><td>tom(tom)</td><td><aside class="quote no-group" data-username="bolvan" data-post="21" data-topic="6932">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/b/8e8cbc/48.png" class="avatar"> bolvan:</div>
<blockquote>
<p>Зачем девайсы на linux и сложности с настройкой</p>
</blockquote>
</aside>
<p>Идея такая чтобы локально пропускать трафик , у вас на руках есть устройство  которое делает все локально и вы можете его контролировать ( переустановить backup итд)<br>
Что касается вашего сценария, вдруг что-то пойдет не так , вам нужно будет искать возможность зайти на свой сервер ( VPS итд) чтобы что-то исправить, а для этого нужен PС ну и далее по скписку.<br>
Возможно оба наши варианты -рабочие , можно и так  и так . Если не сработал один, включил другой.</p></td><td>2024-01-22T10:25:42.949Z</td></tr><tr><td>doomer2007</td><td><p>Здравствуй, твой запрет вещь отличная, спасибо. Но хочу задать нескромный вопрос. Где-то можно найти удалённые хабровские статьи? Как я понял они удалены вне зависимости на то, с какой страны я пытаюсь их открыть.</p></td><td>2024-10-05T16:57:21.149Z</td></tr><tr><td>bolvan</td><td><p>если речь о статьях по обходу - они доступны с других стран</p></td><td>2024-10-05T17:25:48.296Z</td></tr><tr><td>doomer2007</td><td><p>Вы правы. Зашел один раз из другой страны, и он переправил меня на текст о недоступности, а сейчас всё нормально. Я что-то не так делал.<br>
Так же если у кого другого возникнут вопросы об удаленных или скрытых статьях, то на этом же форуме уде создана такая <a href="https://ntc.party/t/%D0%B0%D1%80%D1%85%D0%B8%D0%B2-%D0%B8%D0%BD%D1%81%D1%82%D1%80%D1%83%D0%BA%D1%86%D0%B8%D0%B9-%D0%BF%D0%BE-%D0%BE%D0%B1%D1%85%D0%BE%D0%B4%D1%83-%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BE%D0%BA/7209">тема</a></p></td><td>2024-10-05T17:35:44.889Z</td></tr><tr><td>SuperUser</td><td><p>Где можно почитать описание настройки xray+reality клиента на OpenWrt без мишуры в виде luci, таких как luci-app-xray?<br>
Цель - на роутере с OpenWrt иметь socks5 прокси, и правилами iptables заворачивать запросы на нужные домены.<br>
Вопрос возникает только - как поднять клиента на OpenWrt на определенном порту, с остальным вопросов не возникает.</p></td><td>2024-10-19T00:48:18.422Z</td></tr><tr><td>R0iZ(R0iZ)</td><td><p><a href="https://telegra.ph/Nastrojka-sing-box-openwrt-09-28" rel="noopener nofollow ugc">Подробный мануал</a></p></td><td>2024-10-19T06:33:48.104Z</td></tr><tr><td>SuperUser</td><td><p>Спасибо за ссылку, это, конечно, более прозрачно, но примерно тоже самое, что и в модуле для luci - luci-app-xray</p>
<p>Обращаю внимание на строчку кода (настройки) из статьи:<br>
uci set firewall.<span class="mention">@zone</span>[-1].input=“ACCEPT”</p>
<p>Вместо нее ставьте:<br>
uci set firewall.<span class="mention">@zone</span>[-1].input=“REJECT”</p>
<p>Ps<br>
luci-app-xray я бы вообще никому не рекомендовал</p></td><td>2024-10-19T14:24:54.267Z</td></tr><tr><td>SuperUser</td><td><aside class="quote no-group" data-username="SuperUser" data-post="29" data-topic="6932">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/s/bbe5ce/48.png" class="avatar"> SuperUser:</div>
<blockquote>
<p>uci set firewall.<span class="mention">@zone</span>[-1].input=“ACCEPT”</p>
</blockquote>
</aside>
<p>А ведь я ошибся, именно так это и работает.<br>
Удалось всё настроить xray+tun+(ipset со своим списком доменов).<br>
Списки доменов не настраивал в json файле конфигурации sing-box, а по старинке -  ipset+iptables правила для перенаправления в tun.<br>
Работает, и не потребляет много памяти, так как не используются безумные списки из интернетов и geoip.<br>
Но, конечно, нужно иметь для sing-box +10Mb памяти flash, видимо, если OpenWrt с luci - то flash достаточно будет от 32Mb.</p>
<p>Пока что, для меня, это лучший способ. Проще чем с xray-core.</p></td><td>2024-10-21T21:47:52.674Z</td></tr>
    </table>
      </body>
    </html>
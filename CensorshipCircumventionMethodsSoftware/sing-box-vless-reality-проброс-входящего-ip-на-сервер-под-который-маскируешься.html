
    <html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <style>
    th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      word-wrap: break-word;
      padding: 5px;
    }
    table {
      width: 100%;
      max-width: 100%;
      border: 1px solid black;
      border-collapse: collapse;
      table-layout: fixed;
      word-wrap: break-word
    }
    code {
      word-wrap: break-word;
    }
    pre {
        white-space: pre-wrap;
    }
    </style>
        <title>sing-box-vless-reality-проброс-входящего-ip-на-сервер-под-который-маскируешься</title>
      </head>
      <body>
        <table border="1" width="100%" cellpadding="5">
          <tr>
            <th style="width: 10%;">Ник</th>
            <th>Пост</th>
            <th style="width: 10%;">Дата</th>
          </tr>
    <tr><td>bib128</td><td><p>Моя цепочка на сервере VLESS-REALITY (подключено по типу steal oneself):<br>
внешнее подключение → <strong>sing-box</strong> с указанным в  inbounds.tls.handshake внутренним адресом и портом 1111 → <strong>caddy</strong>, перенаправляющий 1111 на 2222 →  <strong>vaultwarden</strong>  запущенный на этом внутреннем порту 2222 → <strong>fail2ban</strong>, мониторящий логи vaultwarden.<br>
Моя проблема в том, что до <strong>vaultwarden</strong> все логи о входах доходят в виде <strong>внутренних подключений</strong> 127.0.0.1, а следовательно для <strong>fail2ban</strong> нет информации какой внешний ip заблокировать. <strong>Caddy</strong> настроен на передачу предыдущего ip, и если исключить из цепочки sing-box, он его передаёт. Т.е. дело именно в sing-box.</p>
<p>Возможен ли такой сценарий у sing-box, когда он c VLESS (с REALITY или без) мог дальше пробрасывать внешний ip ?</p></td><td>2024-10-15T11:42:04.075Z</td></tr>
    </table>
      </body>
    </html>
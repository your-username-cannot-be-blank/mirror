[
    {
        "id": 76833,
        "name": "Unknown",
        "username": "1unknown",
        "avatar_template": "/user_avatar/ntc.party/1unknown/{size}/14635_2.png",
        "created_at": "2024-12-30T14:58:06.151Z",
        "cooked": "<p>Всех приветствую! Я дам два описания (так будет проще меня понять):</p>\n<ul>\n<li>что сделал;</li>\n<li>что хочу сделать.</li>\n</ul>\n<p>Что сделал:<br>\nЕсть арендованный VPS сервер с Ubuntu 24.02, на нём стоит AdGuard Home на 53 порту.<br>\nДля ряда выбранных мною сайтов он перезаписывает DNS запросы на IP моего же VPS, отправляя тем самым их в Sing-box, который слушает 80 и 443 порт. То есть это аналог Smart DNS от comss, который позволяет обходить региональные ограничения (геоблокировку по IP).<br>\nВ 3X-UI я создал VLESS + Realitty с маскировкой под чужой сайт на 8443 порту. Так никаких конфликтов не возникает.</p>\n<p>Теперь опишу что хочу сделать:<br>\nЯ взял в аренду на год свой домен. Установил Ngnix в Ubuntu, который слушает 127.0.0.1:8080 порт, заменил HTML на свой сайт-заглушку.<br>\nПосле чего в 3X-UI создал VLESS + TLS с Fallbacks на мой сайт-заглушку на 443 порту чтобы провайдер, РКН или любой другой видел что я обмениваюсь данными с этим сайтом-заглушкой, например какой-нибудь <a href=\"http://example.com\" rel=\"noopener nofollow ugc\">example.com</a> - решит зайти на него по HTTPS и видит работающий сайт-заглушку.<br>\nНо тут возникает проблема - я не знаю как можно заменить Sing-box, который принимал запросы на 80 и 443 порту.<br>\nКуда теперь отправлять AdGuard Home перезаписанный DNS запрос?<br>\nКонцептуально я пока в тупике, но может свежий взгляд даст подсказку куда копнуть.<br>\nГрубо говоря, я хочу за сайтом-заглушкой спрятать VLESS + TLS и свой DNS сервер.</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 6,
        "updated_at": "2025-01-05T22:45:16.633Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 670,
        "reads": 91,
        "readers_count": 90,
        "score": 3278.0,
        "yours": false,
        "topic_id": 14244,
        "topic_slug": "%D0%BF%D0%BE%D0%BC%D0%BE%D0%B3%D0%B8%D1%82%D0%B5-%D1%81%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C-3x-ui-vless-tls-fallback-ngnix-smartdns-proxy-%D0%BD%D0%B0-%D0%BE%D0%B4%D0%BD%D0%BE%D0%BC-ipport-80-443",
        "display_username": "Unknown",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 5,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "http://example.com",
                "internal": false,
                "reflection": false,
                "title": "Example Domain",
                "clicks": 4
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4852,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%BF%D0%BE%D0%BC%D0%BE%D0%B3%D0%B8%D1%82%D0%B5-%D1%81%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C-3x-ui-vless-tls-fallback-ngnix-smartdns-proxy-%D0%BD%D0%B0-%D0%BE%D0%B4%D0%BD%D0%BE%D0%BC-ipport-80-443/14244/1",
        "can_translate": false
    },
    {
        "id": 76836,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-12-30T15:13:41.652Z",
        "cooked": "<aside class=\"quote no-group quote-modified\" data-username=\"1unknown\" data-post=\"1\" data-topic=\"14244\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/user_avatar/ntc.party/1unknown/48/14635_2.png\" class=\"avatar\"> 1unknown:</div>\n<blockquote>\n<p>я хочу на 443 порте сервера спрятать VLESS+TLS+fallback и smart dns сервер.</p>\n</blockquote>\n</aside>\n<p>исправил</p>\n<p>p.s. мне кажется что сделать это без компромиссов невозможно, т.е. лучше купить второй ip</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 6,
        "updated_at": "2024-12-30T15:23:13.194Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 1,
        "incoming_link_count": 21,
        "reads": 88,
        "readers_count": 87,
        "score": 122.4,
        "yours": false,
        "topic_id": 14244,
        "topic_slug": "%D0%BF%D0%BE%D0%BC%D0%BE%D0%B3%D0%B8%D1%82%D0%B5-%D1%81%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C-3x-ui-vless-tls-fallback-ngnix-smartdns-proxy-%D0%BD%D0%B0-%D0%BE%D0%B4%D0%BD%D0%BE%D0%BC-ipport-80-443",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%BF%D0%BE%D0%BC%D0%BE%D0%B3%D0%B8%D1%82%D0%B5-%D1%81%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C-3x-ui-vless-tls-fallback-ngnix-smartdns-proxy-%D0%BD%D0%B0-%D0%BE%D0%B4%D0%BD%D0%BE%D0%BC-ipport-80-443/14244/2",
        "can_translate": false
    },
    {
        "id": 76860,
        "name": "",
        "username": "MasterYoba",
        "avatar_template": "/user_avatar/ntc.party/masteryoba/{size}/6182_2.png",
        "created_at": "2024-12-30T17:13:35.273Z",
        "cooked": "<p>Вам нужно расположить всё это хозяйство за nginx, чтобы именно nginx слушал 443 порт, а внутри него разруливать можно как угодно.<br>\nНапример: nginx слушает 443 порт, html заглушка на юникс сокете типа listen unix:/dev/shm/nginx.sock , vless-reality на 4443 порте, в настройках реалити “target”: “/dev/shm/nginx.sock”,  а serverNames - ваш домен (а лучше субдомен). Sing-box слушает на 4444 порте. В конфиге nginx вы разруливаете, чтобы запросы на ваш (суб)домен <a href=\"http://example.com\" rel=\"noopener nofollow ugc\">example.com</a> proxy_pass на 4443 в реалити, а всё остальное proxy_pass на 4444 в sing-box. Такой конфиг решает поставленную задачу. По сути это вариация схемы reality “steal oneself” <a href=\"https://github.com/chika0801/Xray-examples/tree/main/VLESS-Vision-REALITY/steal_oneself\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Xray-examples/VLESS-Vision-REALITY/steal_oneself at main · chika0801/Xray-examples · GitHub</a></p>\n<p>И еще, adguard в этой схеме вообще лишний, sing-box умеет из коробки перезаписывать dns запросы “на себя”. Изучайте fakeip функционал в нём <a href=\"https://sing-box.sagernet.org/configuration/dns/fakeip/\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">FakeIP - sing-box</a></p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 6,
        "updated_at": "2024-12-30T17:13:35.273Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 17,
        "reads": 75,
        "readers_count": 74,
        "score": 99.8,
        "yours": false,
        "topic_id": 14244,
        "topic_slug": "%D0%BF%D0%BE%D0%BC%D0%BE%D0%B3%D0%B8%D1%82%D0%B5-%D1%81%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C-3x-ui-vless-tls-fallback-ngnix-smartdns-proxy-%D0%BD%D0%B0-%D0%BE%D0%B4%D0%BD%D0%BE%D0%BC-ipport-80-443",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://github.com/chika0801/Xray-examples/tree/main/VLESS-Vision-REALITY/steal_oneself",
                "internal": false,
                "reflection": false,
                "title": "Xray-examples/VLESS-Vision-REALITY/steal_oneself at main · chika0801/Xray-examples · GitHub",
                "clicks": 18
            },
            {
                "url": "https://sing-box.sagernet.org/configuration/dns/fakeip/",
                "internal": false,
                "reflection": false,
                "title": "FakeIP - sing-box",
                "clicks": 4
            },
            {
                "url": "http://example.com",
                "internal": false,
                "reflection": false,
                "title": "Example Domain",
                "clicks": 1
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4361,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%BF%D0%BE%D0%BC%D0%BE%D0%B3%D0%B8%D1%82%D0%B5-%D1%81%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C-3x-ui-vless-tls-fallback-ngnix-smartdns-proxy-%D0%BD%D0%B0-%D0%BE%D0%B4%D0%BD%D0%BE%D0%BC-ipport-80-443/14244/3",
        "can_translate": false
    },
    {
        "id": 76874,
        "name": "Unknown",
        "username": "1unknown",
        "avatar_template": "/user_avatar/ntc.party/1unknown/{size}/14635_2.png",
        "created_at": "2024-12-30T18:25:29.743Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"MasterYoba\" data-post=\"3\" data-topic=\"14244\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/user_avatar/ntc.party/masteryoba/48/6182_2.png\" class=\"avatar\"> MasterYoba:</div>\n<blockquote>\n<p>а лучше субдомен</p>\n</blockquote>\n</aside>\n<p>Почему лучше использовать субдомен в такой схеме? То есть основной домен будет для HTML заглушки, а субдомен пустить под VLESS?</p>\n<aside class=\"quote no-group\" data-username=\"MasterYoba\" data-post=\"3\" data-topic=\"14244\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/user_avatar/ntc.party/masteryoba/48/6182_2.png\" class=\"avatar\"> MasterYoba:</div>\n<blockquote>\n<p>adguard в этой схеме вообще лишний, sing-box умеет из коробки перезаписывать dns запросы “на себя”</p>\n</blockquote>\n</aside>\n<p>Благодарю за наводку, изучу.<br>\nПредварительно перед началом ознакомления хочу спросить один вопрос.<br>\nЕсли я буду таки использовать AGH, то можно ли обойтись только VLESS на порту 4443, если Ngnix будет слушать 80 и 443 порт, и будет запрос сайта по HTTP? Для чего нужен будет Sing-box, если можно будет всегда отправлять на обработку DNS запрос во VLESS?</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 6,
        "updated_at": "2024-12-30T18:32:38.258Z",
        "reply_count": 1,
        "reply_to_post_number": 3,
        "quote_count": 1,
        "incoming_link_count": 3,
        "reads": 66,
        "readers_count": 65,
        "score": 33.0,
        "yours": false,
        "topic_id": 14244,
        "topic_slug": "%D0%BF%D0%BE%D0%BC%D0%BE%D0%B3%D0%B8%D1%82%D0%B5-%D1%81%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C-3x-ui-vless-tls-fallback-ngnix-smartdns-proxy-%D0%BD%D0%B0-%D0%BE%D0%B4%D0%BD%D0%BE%D0%BC-ipport-80-443",
        "display_username": "Unknown",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4852,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%BF%D0%BE%D0%BC%D0%BE%D0%B3%D0%B8%D1%82%D0%B5-%D1%81%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C-3x-ui-vless-tls-fallback-ngnix-smartdns-proxy-%D0%BD%D0%B0-%D0%BE%D0%B4%D0%BD%D0%BE%D0%BC-ipport-80-443/14244/4",
        "can_translate": false
    },
    {
        "id": 76882,
        "name": "",
        "username": "MasterYoba",
        "avatar_template": "/user_avatar/ntc.party/masteryoba/{size}/6182_2.png",
        "created_at": "2024-12-30T19:05:06.251Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"1unknown\" data-post=\"4\" data-topic=\"14244\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/user_avatar/ntc.party/1unknown/48/14635_2.png\" class=\"avatar\"> 1unknown:</div>\n<blockquote>\n<p>Почему лучше использовать субдомен в такой схеме</p>\n</blockquote>\n</aside>\n<p>Ну не лучше, просто “гибче”. Вы примените под эту прокси-схему субдомен вида <a href=\"http://test.example.com\" rel=\"noopener nofollow ugc\">test.example.com</a>, а сам <a href=\"http://example.com\" rel=\"noopener nofollow ugc\">example.com</a> останется свободным для других задач. Вдруг вы решите потом на нём настоящий сайт захостить, добавить ещё инбаунды, или ещё что. Если не хотите, можно и сам верхний домен использовать, разницы никакой.</p>\n<aside class=\"quote no-group\" data-username=\"1unknown\" data-post=\"4\" data-topic=\"14244\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/user_avatar/ntc.party/1unknown/48/14635_2.png\" class=\"avatar\"> 1unknown:</div>\n<blockquote>\n<p>То есть основной домен будет для HTML заглушки, а субдомен пустить под VLESS?</p>\n</blockquote>\n</aside>\n<p>Не, надо выбрать что-то одно, и оно будет использоваться для маскировки реалити, и заглушка будет открываться в браузере при заходе на него.</p>\n<aside class=\"quote no-group\" data-username=\"1unknown\" data-post=\"4\" data-topic=\"14244\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/user_avatar/ntc.party/1unknown/48/14635_2.png\" class=\"avatar\"> 1unknown:</div>\n<blockquote>\n<p>можно ли обойтись только VLESS</p>\n</blockquote>\n</aside>\n<p>Да, конечно можно. Я просто решил именно под исходные условия подогнать решение, тем более вдруг есть какая-то специфичная причина использовать именно sing-box. (Как вариант - fakeip)<br>\nИ еще, я не пользовался 3x-ui, только голым xray-core, если там есть какие-то свои ограничения, они мне неизвестны. Но в теории это просто генератор конфиги для xray-core, так что должно быть всё норм.</p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 6,
        "updated_at": "2024-12-30T19:05:06.251Z",
        "reply_count": 1,
        "reply_to_post_number": 4,
        "quote_count": 1,
        "incoming_link_count": 2,
        "reads": 60,
        "readers_count": 59,
        "score": 26.8,
        "yours": false,
        "topic_id": 14244,
        "topic_slug": "%D0%BF%D0%BE%D0%BC%D0%BE%D0%B3%D0%B8%D1%82%D0%B5-%D1%81%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C-3x-ui-vless-tls-fallback-ngnix-smartdns-proxy-%D0%BD%D0%B0-%D0%BE%D0%B4%D0%BD%D0%BE%D0%BC-ipport-80-443",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "http://test.example.com",
                "internal": false,
                "reflection": false,
                "clicks": 0
            },
            {
                "url": "http://example.com",
                "internal": false,
                "reflection": false,
                "clicks": 0
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4361,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%BF%D0%BE%D0%BC%D0%BE%D0%B3%D0%B8%D1%82%D0%B5-%D1%81%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C-3x-ui-vless-tls-fallback-ngnix-smartdns-proxy-%D0%BD%D0%B0-%D0%BE%D0%B4%D0%BD%D0%BE%D0%BC-ipport-80-443/14244/5",
        "can_translate": false
    },
    {
        "id": 77170,
        "name": "Unknown",
        "username": "1unknown",
        "avatar_template": "/user_avatar/ntc.party/1unknown/{size}/14635_2.png",
        "created_at": "2025-01-01T16:14:03.219Z",
        "cooked": "<p>Благодарю <img src=\"https://ntc.party/images/emoji/twitter/handshake.png?v=12\" title=\":handshake:\" class=\"emoji\" alt=\":handshake:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 6,
        "updated_at": "2025-01-01T16:15:01.882Z",
        "reply_count": 0,
        "reply_to_post_number": 5,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 35,
        "readers_count": 34,
        "score": 21.8,
        "yours": false,
        "topic_id": 14244,
        "topic_slug": "%D0%BF%D0%BE%D0%BC%D0%BE%D0%B3%D0%B8%D1%82%D0%B5-%D1%81%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C-3x-ui-vless-tls-fallback-ngnix-smartdns-proxy-%D0%BD%D0%B0-%D0%BE%D0%B4%D0%BD%D0%BE%D0%BC-ipport-80-443",
        "display_username": "Unknown",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "MasterYoba",
            "name": "",
            "avatar_template": "/user_avatar/ntc.party/masteryoba/{size}/6182_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 4852,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%BF%D0%BE%D0%BC%D0%BE%D0%B3%D0%B8%D1%82%D0%B5-%D1%81%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C-3x-ui-vless-tls-fallback-ngnix-smartdns-proxy-%D0%BD%D0%B0-%D0%BE%D0%B4%D0%BD%D0%BE%D0%BC-ipport-80-443/14244/6",
        "can_translate": false
    }
]
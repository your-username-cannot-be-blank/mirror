[
    {
        "id": 738,
        "name": "",
        "username": "tango",
        "avatar_template": "/letter_avatar_proxy/v4/letter/t/e36b37/{size}.png",
        "created_at": "2019-12-19T20:20:23.345Z",
        "cooked": "<aside class=\"onebox githubrepo\" data-onebox-src=\"https://github.com/twisteroidambassador/ptadapter\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/twisteroidambassador/ptadapter\" target=\"_blank\" rel=\"noopener\">github.com</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"github-row\" data-github-private-repo=\"false\">\n  <img width=\"690\" height=\"344\" src=\"ptadapter/fb76cd05dc450b4ecd918afdada9d6097b2b1b8b_2_690x344.png\" class=\"thumbnail\" data-dominant-color=\"EFF2F5\">\n\n  <h3><a href=\"https://github.com/twisteroidambassador/ptadapter\" target=\"_blank\" rel=\"noopener\">GitHub - twisteroidambassador/ptadapter: Pluggable Transports Python interface &amp; standalone...</a></h3>\n\n    <p><span class=\"github-repo-description\">Pluggable Transports Python interface &amp; standalone tunnels</span></p>\n</div>\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>Pluggable transports like <a href=\"https://trac.torproject.org/projects/tor/wiki/doc/meek\">meek</a> and <a href=\"https://gitlab.com/yawning/obfs4\">obfs4</a> can be difficult to use outside of Tor. That’s because they communicate with a parent process using a <a href=\"https://spec.torproject.org/pt-spec\">specification</a> that is not widely implemented. ptadapter wraps pluggable transports to provide a simple local TCP interface so that pluggable transports can easily be used by other programs.</p>\n<p>Author’s announcement: <a href=\"https://groups.google.com/d/msg/traffic-obf/cPc8JgwK2_k/S6TJjCweEAAJ\">https://groups.google.com/d/msg/traffic-obf/cPc8JgwK2_k/S6TJjCweEAAJ</a></p>\n<hr>\n<p>Here is a tutorial on using ptadapter and obfs4 to obfuscate a simple HTTP proxy.</p>\n<h2><a name=\"p-738-server-1\" class=\"anchor\" href=\"#p-738-server-1\"></a>Server</h2>\n<p>Install the dependencies.</p>\n<pre><code class=\"lang-auto\">$ sudo apt install python3-pip obfs4proxy ncat\n$ sudo pip3 install ptadapter\n</code></pre>\n<p>Run your HTTP proxy, listening on a localhost port. (You can replace this step with any kind of server you want.)</p>\n<pre><code class=\"lang-auto\">$ ncat -l -k --proxy-type http 127.0.0.1 3128\n</code></pre>\n<p>Create a file called <code>ptadapter.ini</code>. The format is documented <a href=\"https://twisteroidambassador.github.io/ptadapter-docs/console_script.html#config-file\">here</a></p>\n<pre><code class=\"lang-auto\">[server]\nexec = /usr/bin/obfs4proxy\nstate = pt_state\nforward = 127.0.0.1:3128\ntunnels = server_obfs4\n[server_obfs4]\ntransport = obfs4\nlisten = 0.0.0.0:9999 # replace this with a port of your choice\n</code></pre>\n<p>Run ptadapter on the configuration file. Now you have an external obfs4 listener on 0.0.0.0:9999 that will deobfuscate traffic and forward it to 127.0.0.1:3128.</p>\n<pre><code class=\"lang-auto\">$ ptadapter -S ptadapter.ini\n</code></pre>\n<p>Get the bridge’s certificate for <code>pt_state/obfs4_bridgeline.txt</code>. The important part is <strong><code>cert=...</code></strong>, the obfs4 server’s public key information. You will need it when setting up the client.</p>\n<pre><code class=\"lang-auto\">$ cat pt_state/obfs4_bridgeline.txt\nBridge obfs4 &lt;IP ADDRESS&gt;:&lt;PORT&gt; &lt;FINGERPRINT&gt; cert=1/x+AlgQH0T9ZD23FUzs7SeYzDFhxIXjlbTwU7ExkAXVAmi601C4S4Auk+oRqniAIbqmXg iat-mode=0\n</code></pre>\n<h2><a name=\"p-738-client-2\" class=\"anchor\" href=\"#p-738-client-2\"></a>Client</h2>\n<p>Install the dependencies.</p>\n<pre><code class=\"lang-auto\">$ sudo apt install python3-pip obfs4proxy\n$ sudo pip3 install ptadapter\n</code></pre>\n<p>Create a file called <code>ptadapter.ini</code>. Copy the values for <code>options-cert</code> and <code>options-iat-mode</code> from <code>pt_state/obfs4_bridgeline.txt</code> on the server.</p>\n<pre><code class=\"lang-auto\">[client]\nexec = /usr/bin/obfs4proxy\nstate = pt_state\ntunnels = client_obfs4\n[client_obfs4]\ntransport = obfs4\nlisten = 127.0.0.1:3128\nupstream = &lt;IP address of server&gt;:9999\noptions-cert = 1/x+AlgQH0T9ZD23FUzs7SeYzDFhxIXjlbTwU7ExkAXVAmi601C4S4Auk+oRqniAIbqmXg\noptions-iat-mode = 0\n</code></pre>\n<p>Run ptadapter on the configuration file. Now you have a local listener at 127.0.0.1:3128 that will obfuscate and forward to <em>server</em>:9999, which will then deobfuscate and forward to its own 127.0.0.1:3128. Basically, the client’s port 3128 is connected to the server’s port 3128 through a magic obfuscated tunnel.</p>\n<pre><code class=\"lang-auto\">$ ptadapter -C ptadapter.ini\n</code></pre>\n<p>Now you can test the tunnel, treating the client’s local 127.0.0.1:3128 as if it were an HTTP proxy.</p>\n<pre><code class=\"lang-auto\">$ curl -x http://127.0.0.1:3128/ https://wtfismyip.com/text\n&lt;IP address of server&gt;\n</code></pre>\n<p>You can also configure 127.0.0.1:3128 in your web browser, etc.</p>\n<h2><a name=\"p-738-troubleshooting-3\" class=\"anchor\" href=\"#p-738-troubleshooting-3\"></a>Troubleshooting</h2>\n<p>Use the <code>-v</code> option to make ptadapter more verbose.</p>\n<pre><code class=\"lang-auto\">$ ptadapter -vv -S ptadapter.ini\n$ ptadapter -vv -C ptadapter.ini\n</code></pre>\n<p>Enable obfs4proxy logging in <code>ptadapter.ini</code>. The logs will appear in <code>pt_state/obfs4proxy.log</code>.</p>\n<pre><code class=\"lang-auto\">[server]                 \nexec = /usr/bin/obfs4proxy --enableLogging --unsafeLogging --logLevel=DEBUG\n</code></pre>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 2,
        "updated_at": "2019-12-19T20:20:23.345Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 163,
        "reads": 18,
        "readers_count": 17,
        "score": 823.6,
        "yours": false,
        "topic_id": 275,
        "topic_slug": "ptadapter",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://github.com/twisteroidambassador/ptadapter",
                "internal": false,
                "reflection": false,
                "title": "GitHub - twisteroidambassador/ptadapter: Pluggable Transports Python interface & standalone tunnels",
                "clicks": 16
            },
            {
                "url": "https://groups.google.com/d/msg/traffic-obf/cPc8JgwK2_k/S6TJjCweEAAJ",
                "internal": false,
                "reflection": false,
                "clicks": 4
            },
            {
                "url": "https://twisteroidambassador.github.io/ptadapter-docs/console_script.html#config-file",
                "internal": false,
                "reflection": false,
                "title": "Console Script Guide — ptadapter 3.0.0rc2 documentation",
                "clicks": 3
            },
            {
                "url": "https://gitlab.com/yawning/obfs4",
                "internal": false,
                "reflection": false,
                "title": "Yawning Angel / obfs4 · GitLab",
                "clicks": 2
            },
            {
                "url": "https://trac.torproject.org/projects/tor/wiki/doc/meek",
                "internal": false,
                "reflection": false,
                "title": "doc/meek – Tor Bug Tracker & Wiki",
                "clicks": 2
            },
            {
                "url": "https://spec.torproject.org/pt-spec",
                "internal": false,
                "reflection": false,
                "clicks": 0
            }
        ],
        "read": true,
        "user_title": "dnstt developer",
        "title_is_group": false,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 26,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/ptadapter/275/1",
        "can_translate": false
    },
    {
        "id": 4929,
        "name": "",
        "username": "tango",
        "avatar_template": "/letter_avatar_proxy/v4/letter/t/e36b37/{size}.png",
        "created_at": "2021-12-31T05:48:45.343Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"tango\" data-post=\"1\" data-topic=\"275\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/t/e36b37/48.png\" class=\"avatar\"> tango:</div>\n<blockquote>\n<p>Create a file called <code>ptadapter.ini</code>. The format is documented <a href=\"https://twisteroidambassador.github.io/ptadapter-docs/console_script.html#config-file\">here</a></p>\n</blockquote>\n</aside>\n<p>The above documentation link doesn’t work for me anymore. Here is a working link:</p>\n<p><a href=\"https://ptadapter.readthedocs.io/en/latest/console_script.html#config-file\" class=\"onebox\" target=\"_blank\" rel=\"noopener\">https://ptadapter.readthedocs.io/en/latest/console_script.html#config-file</a></p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 2,
        "updated_at": "2021-12-31T05:48:45.343Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 1,
        "incoming_link_count": 1,
        "reads": 11,
        "readers_count": 10,
        "score": 7.2,
        "yours": false,
        "topic_id": 275,
        "topic_slug": "ptadapter",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://ptadapter.readthedocs.io/en/latest/console_script.html#config-file",
                "internal": false,
                "reflection": false,
                "title": "Console Script Guide — ptadapter 3.0.0 documentation",
                "clicks": 9
            }
        ],
        "read": true,
        "user_title": "dnstt developer",
        "title_is_group": false,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 26,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/ptadapter/275/2",
        "can_translate": false
    }
]
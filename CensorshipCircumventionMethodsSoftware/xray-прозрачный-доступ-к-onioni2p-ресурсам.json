[
    {
        "id": 20055,
        "name": "Dmitry",
        "username": "dimzon",
        "avatar_template": "/user_avatar/ntc.party/dimzon/{size}/3877_2.png",
        "created_at": "2023-11-18T06:22:20.325Z",
        "cooked": "<p>Необходимости сохранять анонимность при доступе в даркнет нету. Просто хочется настроить прозрачный доступ чтобы было.</p>\n<p>На сервере крутится <strong>xray</strong> + <strong>tor</strong>, имеется такое правило маршрутизации</p>\n<pre><code class=\"lang-auto\">{\n                \"type\": \"field\",\n                \"outboundTag\": \"TOR\",\n                \"domain\": [\n                    \"domain:onion\"\n                ]\n            },\n</code></pre>\n<p>имеем такой outbound</p>\n<pre><code class=\"lang-auto\">        {\n            \"tag\": \"TOR\",\n            \"protocol\": \"socks\",\n            \"settings\": {\n                \"servers\": [\n                    {\n                        \"address\": \"127.0.0.1\",\n                        \"port\": 9050\n                    }\n                ]\n            }\n        },\n</code></pre>\n<p>В режиме socks5-прокси например с компа сайт <strong><a href=\"http://flibustaongezhld6dibs2dps6vm4nvqg2kp7vgowbu76tzopgnhazqd.onion/\" rel=\"noopener nofollow ugc\">http://flibustaongezhld6dibs2dps6vm4nvqg2kp7vgowbu76tzopgnhazqd.onion/</a></strong> открывается но не с первого раза, при этом в логах на сервере в /var/log/xray/error.log имеем строки вида</p>\n<pre><code class=\"lang-auto\">2023/11/18 06:58:46 [Warning] [2410852795] app/proxyman/outbound: failed to process outbound traffic &gt; proxy/socks: failed to establish connection to server &gt; read tcp 127.0.0.1:12456-&gt;127.0.0.1:9050: i/o timeout\n</code></pre>\n<p>в документации к xray не нашел способа увеличить таймут для этого outbound.</p>\n<p>Ну а на мобильном не всем браузерам подсунешь socks5 прокси. А в режиме tun - это вооще не работает…</p>\n<p>Я так понимаю что должен быть какой-то “локальный” dns-сервер на xray-сервере который будет выдавать уникальные фейковые ip-адреса  (наверное AAAA записи из какого-нибудь волшебного CIDR) для onion, весь dns клиента завернуть на xray чтобы он прозрачно получал ipv6 до onion и потом уже работал с ним…</p>\n<p>Может кто-то уже делал что-то подобное?</p>\n<p>С i2p аналогично, сейчас пока разбираюсь с onion…</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2024-09-17T12:09:28.937Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1137,
        "reads": 104,
        "readers_count": 103,
        "score": 5705.8,
        "yours": false,
        "topic_id": 6278,
        "topic_slug": "xray-%D0%BF%D1%80%D0%BE%D0%B7%D1%80%D0%B0%D1%87%D0%BD%D1%8B%D0%B9-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF-%D0%BA-onioni2p-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0%D0%BC",
        "display_username": "Dmitry",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "http://flibustaongezhld6dibs2dps6vm4nvqg2kp7vgowbu76tzopgnhazqd.onion/",
                "internal": false,
                "reflection": false,
                "clicks": 14
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 2799,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/xray-%D0%BF%D1%80%D0%BE%D0%B7%D1%80%D0%B0%D1%87%D0%BD%D1%8B%D0%B9-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF-%D0%BA-onioni2p-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0%D0%BC/6278/1",
        "can_translate": false
    },
    {
        "id": 20075,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2023-11-18T12:41:23.509Z",
        "cooked": "<pre><code class=\"lang-auto\">    \"policy\": {\n        \"levels\": {\n            \"0\": {\n                \"handshake\": 10\n            }\n        }\n    },\n</code></pre>\n<p>не помогает?</p>\n<p>вот еще нашел конфиг для sing-box <a href=\"https://github.com/XTLS/Xray-core/discussions/2298#discussioncomment-6427330\" class=\"inline-onebox\">Regarding nonIPQuery · XTLS/Xray-core · Discussion #2298 · GitHub</a></p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2023-11-18T12:41:23.509Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 88,
        "readers_count": 87,
        "score": 37.6,
        "yours": false,
        "topic_id": 6278,
        "topic_slug": "xray-%D0%BF%D1%80%D0%BE%D0%B7%D1%80%D0%B0%D1%87%D0%BD%D1%8B%D0%B9-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF-%D0%BA-onioni2p-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0%D0%BC",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "https://github.com/XTLS/Xray-core/discussions/2298#discussioncomment-6427330",
                "internal": false,
                "reflection": false,
                "title": "Regarding nonIPQuery · XTLS/Xray-core · Discussion #2298 · GitHub",
                "clicks": 23
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/xray-%D0%BF%D1%80%D0%BE%D0%B7%D1%80%D0%B0%D1%87%D0%BD%D1%8B%D0%B9-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF-%D0%BA-onioni2p-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0%D0%BC/6278/2",
        "can_translate": false
    },
    {
        "id": 20093,
        "name": "Dmitry",
        "username": "dimzon",
        "avatar_template": "/user_avatar/ntc.party/dimzon/{size}/3877_2.png",
        "created_at": "2023-11-18T21:24:15.639Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"0ka\" data-post=\"2\" data-topic=\"6278\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/0/d78d45/48.png\" class=\"avatar\"> 0ka:</div>\n<blockquote>\n<p><code>\"handshake\": 10</code></p>\n</blockquote>\n</aside>\n<p>Помогло!</p>\n<p>Касательно DNS пошел путем linux-way. В torrc добавил строки:</p>\n<pre><code class=\"lang-auto\">DNSPort 127.0.0.2:53\nAutomapHostsOnResolve 1\nAutomapHostsSuffixes .onion\n</code></pre>\n<p>Потом склеил все с помощью dnsmasq добился такого поведения на стороне VDS</p>\n<pre><code class=\"lang-auto\">root@v2136098:/opt/real# nslookup flibustaongezhld6dibs2dps6vm4nvqg2kp7vgowbu76tzopgnhazqd.onion\nServer:         127.0.0.1\nAddress:        127.0.0.1#53\n\nNon-authoritative answer:\nName:   flibustaongezhld6dibs2dps6vm4nvqg2kp7vgowbu76tzopgnhazqd.onion\nAddress: 127.230.9.54\nName:   flibustaongezhld6dibs2dps6vm4nvqg2kp7vgowbu76tzopgnhazqd.onion\nAddress: fe80:2f39:b9c6:12ab:10cf:1857:51ca:c510\n\nroot@v2136098:/opt/real# nslookup flibusta.lib\nServer:         127.0.0.1\nAddress:        127.0.0.1#53\n\nNon-authoritative answer:\nName:   flibusta.lib\nAddress: 179.43.150.83\n</code></pre>\n<p>В server-config.json поставил единственный сервер в dns</p>\n<pre><code class=\"lang-auto\">\"dns\": {\n        \"servers\": [\n            \"tcp+local:\\/\\/127.0.0.1\"\n        ]\n    }\n</code></pre>\n<p>В режиме socks заработала lib (потому как в настройках dnsmasq указал серверы OpenNIC) но в режиме tun на клиенте не работает: не ресолвится</p>\n<p>Клиент - свежий v2rayNG…</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2023-11-18T21:24:15.639Z",
        "reply_count": 1,
        "reply_to_post_number": 2,
        "quote_count": 1,
        "incoming_link_count": 9,
        "reads": 83,
        "readers_count": 82,
        "score": 66.6,
        "yours": false,
        "topic_id": 6278,
        "topic_slug": "xray-%D0%BF%D1%80%D0%BE%D0%B7%D1%80%D0%B0%D1%87%D0%BD%D1%8B%D0%B9-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF-%D0%BA-onioni2p-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0%D0%BC",
        "display_username": "Dmitry",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 2799,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/xray-%D0%BF%D1%80%D0%BE%D0%B7%D1%80%D0%B0%D1%87%D0%BD%D1%8B%D0%B9-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF-%D0%BA-onioni2p-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0%D0%BC/6278/3",
        "can_translate": false
    },
    {
        "id": 20094,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2023-11-18T21:53:42.876Z",
        "cooked": "<p>в v2rayng прописан remote dns 127.0.0.1?</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2023-11-18T21:53:42.876Z",
        "reply_count": 1,
        "reply_to_post_number": 3,
        "quote_count": 0,
        "incoming_link_count": 7,
        "reads": 71,
        "readers_count": 70,
        "score": 54.2,
        "yours": false,
        "topic_id": 6278,
        "topic_slug": "xray-%D0%BF%D1%80%D0%BE%D0%B7%D1%80%D0%B0%D1%87%D0%BD%D1%8B%D0%B9-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF-%D0%BA-onioni2p-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0%D0%BC",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "dimzon",
            "name": "Dmitry",
            "avatar_template": "/user_avatar/ntc.party/dimzon/{size}/3877_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/xray-%D0%BF%D1%80%D0%BE%D0%B7%D1%80%D0%B0%D1%87%D0%BD%D1%8B%D0%B9-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF-%D0%BA-onioni2p-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0%D0%BC/6278/4",
        "can_translate": false
    },
    {
        "id": 20102,
        "name": "Dmitry",
        "username": "dimzon",
        "avatar_template": "/user_avatar/ntc.party/dimzon/{size}/3877_2.png",
        "created_at": "2023-11-19T02:45:47.582Z",
        "cooked": "<p>пробовал - вообще никакие страницы не  находит, есть мысли но пока воюю на стороне VDS, прикрутил i2pd, все оказалось проще</p>\n<p>В dnsmasq прибил гвоздями 1 адрес и для onion и i2p:</p>\n<pre><code class=\"lang-auto\">address=/i2p/127.254.0.1\naddress=/onion/127.254.0.1\n</code></pre>\n<p>повесил на http-порту привокси:</p>\n<pre><code class=\"lang-auto\">listen-address 127.254.0.1:80\nforward-socks5t   .onion     127.0.0.1:9050 .\nforward           .i2p   127.0.0.1:4444\n</code></pre>\n<p>итого wget на vds выдает и onion и i2p</p>\n<p>Теперь вот думаю понравится ли ip адрес 127.254.0.1 клиенту, не попробует ли он сделать bypass lan</p>\n<p>Не в курсе можно ли создать фиктивный адрес типа 195.1.1.1 который будет действовать в рамках VDS на который можно будет повесить привокси?</p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2023-11-19T02:45:48.621Z",
        "reply_count": 0,
        "reply_to_post_number": 4,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 70,
        "readers_count": 69,
        "score": 24.0,
        "yours": false,
        "topic_id": 6278,
        "topic_slug": "xray-%D0%BF%D1%80%D0%BE%D0%B7%D1%80%D0%B0%D1%87%D0%BD%D1%8B%D0%B9-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF-%D0%BA-onioni2p-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0%D0%BC",
        "display_username": "Dmitry",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "0ka",
            "name": "0ka",
            "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 2799,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": "Automatically removed quote of whole previous post.",
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/xray-%D0%BF%D1%80%D0%BE%D0%B7%D1%80%D0%B0%D1%87%D0%BD%D1%8B%D0%B9-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF-%D0%BA-onioni2p-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0%D0%BC/6278/5",
        "can_translate": false
    },
    {
        "id": 20107,
        "name": null,
        "username": "ValdikSS",
        "avatar_template": "/user_avatar/ntc.party/valdikss/{size}/2_2.png",
        "created_at": "2023-11-19T03:12:07.548Z",
        "cooked": "<p>Установите какой-то локальный адрес на интерфейс lo, его и пропишите в конфигурационных файлах. При этом слушать (bind’ится) только на этом интерфейсе не нужно.</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2023-11-19T03:12:07.548Z",
        "reply_count": 2,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 63,
        "readers_count": 62,
        "score": 22.6,
        "yours": false,
        "topic_id": 6278,
        "topic_slug": "xray-%D0%BF%D1%80%D0%BE%D0%B7%D1%80%D0%B0%D1%87%D0%BD%D1%8B%D0%B9-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF-%D0%BA-onioni2p-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0%D0%BC",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "AntiZapret staff",
        "title_is_group": false,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": true,
        "staff": true,
        "user_id": 1,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/xray-%D0%BF%D1%80%D0%BE%D0%B7%D1%80%D0%B0%D1%87%D0%BD%D1%8B%D0%B9-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF-%D0%BA-onioni2p-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0%D0%BC/6278/6",
        "can_translate": false
    },
    {
        "id": 20119,
        "name": "Dmitry",
        "username": "dimzon",
        "avatar_template": "/user_avatar/ntc.party/dimzon/{size}/3877_2.png",
        "created_at": "2023-11-19T07:07:43.806Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"ValdikSS\" data-post=\"6\" data-topic=\"6278\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/user_avatar/ntc.party/valdikss/48/2_2.png\" class=\"avatar\"> ValdikSS:</div>\n<blockquote>\n<p>Установите какой-то локальный адрес на интерфейс lo</p>\n</blockquote>\n</aside>\n<pre><code class=\"lang-auto\">root@v2136098:~# ip address show dev lo\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet 195.195.195.195/32 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n\nroot@v2136098:~# nslookup stats.i2p 195.195.195.195\nServer:         195.195.195.195\nAddress:        195.195.195.195#53\n\nName:   stats.i2p\nAddress: 195.195.195.195\n\nroot@v2136098:~# nslookup ya.ru 195.195.195.195\nServer:         195.195.195.195\nAddress:        195.195.195.195#53\n\nNon-authoritative answer:\nName:   ya.ru\nAddress: 5.255.255.242\nName:   ya.ru\nAddress: 77.88.55.242\nName:   ya.ru\nAddress: 2a02:6b8::2:242\n\nroot@v2136098:~# nslookup rutor.lib 195.195.195.195\nServer:         195.195.195.195\nAddress:        195.195.195.195#53\n\nNon-authoritative answer:\nName:   rutor.lib\nAddress: 193.46.255.25\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"xray-прозрачный-доступ-к-onioni2p-ресурсам/3694367ad01840484b1950f905edc56928afd7a8.jpeg\" data-download-href=\"https://ntc.party/uploads/default/3694367ad01840484b1950f905edc56928afd7a8\" title=\"image\"><img src=\"xray-прозрачный-доступ-к-onioni2p-ресурсам/3694367ad01840484b1950f905edc56928afd7a8_2_225x500.jpeg\" alt=\"image\" data-base62-sha1=\"7MPkkoYdSWap1ZcZbGfEDBH6oYw\" width=\"225\" height=\"500\" srcset=\"xray-прозрачный-доступ-к-onioni2p-ресурсам/3694367ad01840484b1950f905edc56928afd7a8_2_225x500.jpeg, xray-прозрачный-доступ-к-onioni2p-ресурсам/3694367ad01840484b1950f905edc56928afd7a8_2_337x750.jpeg 1.5x, xray-прозрачный-доступ-к-onioni2p-ресурсам/3694367ad01840484b1950f905edc56928afd7a8_2_450x1000.jpeg 2x\" data-dominant-color=\"0B0B0B\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">720×1600 85 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div><br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"xray-прозрачный-доступ-к-onioni2p-ресурсам/3f3973d2eaab5dc5f47979e88a8ed8a145a2c8f3.png\" data-download-href=\"https://ntc.party/uploads/default/3f3973d2eaab5dc5f47979e88a8ed8a145a2c8f3\" title=\"image\"><img src=\"xray-прозрачный-доступ-к-onioni2p-ресурсам/3f3973d2eaab5dc5f47979e88a8ed8a145a2c8f3_2_225x500.png\" alt=\"image\" data-base62-sha1=\"91jaEQE5QQzNcb87zjOKeU5FM2L\" width=\"225\" height=\"500\" srcset=\"xray-прозрачный-доступ-к-onioni2p-ресурсам/3f3973d2eaab5dc5f47979e88a8ed8a145a2c8f3_2_225x500.png, xray-прозрачный-доступ-к-onioni2p-ресурсам/3f3973d2eaab5dc5f47979e88a8ed8a145a2c8f3_2_337x750.png 1.5x, xray-прозрачный-доступ-к-onioni2p-ресурсам/3f3973d2eaab5dc5f47979e88a8ed8a145a2c8f3_2_450x1000.png 2x\" data-dominant-color=\"FAFAFA\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">720×1600 72 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div><br>\n<strong><a href=\"http://ya.ru\" rel=\"noopener nofollow ugc\">ya.ru</a></strong> - работает!<br>\n<strong>rutor.lib</strong> - не ресолвит!</p>\n<p>Вот такая фигня. Может scope поменять попробовать у 195.195.195.195 ?</p>\n<p>ЗЫ. Прописал в v2rayng левые dns - при соединении проверка средствами v2rayng говорит что сбой а браузер работает как ни в чем не бывало, ip vps на <a href=\"http://2ip.ru\" rel=\"noopener nofollow ugc\">2ip.ru</a> показывает</p>\n<p>ЗЫ2. Включил галочку fakedns в клиенте, заработало. Но это я так понимаю костыль на стороне клиента,  и мой внутренний перфекционист грызет меня со страшной силой.</p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2023-11-19T08:41:31.127Z",
        "reply_count": 0,
        "reply_to_post_number": 6,
        "quote_count": 1,
        "incoming_link_count": 3,
        "reads": 66,
        "readers_count": 65,
        "score": 28.2,
        "yours": false,
        "topic_id": 6278,
        "topic_slug": "xray-%D0%BF%D1%80%D0%BE%D0%B7%D1%80%D0%B0%D1%87%D0%BD%D1%8B%D0%B9-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF-%D0%BA-onioni2p-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0%D0%BC",
        "display_username": "Dmitry",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 3,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "http://ya.ru",
                "internal": false,
                "reflection": false,
                "title": "Яндекс",
                "clicks": 2
            },
            {
                "url": "http://2ip.ru",
                "internal": false,
                "reflection": false,
                "title": "Узнать IP адрес",
                "clicks": 0
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 2799,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/xray-%D0%BF%D1%80%D0%BE%D0%B7%D1%80%D0%B0%D1%87%D0%BD%D1%8B%D0%B9-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF-%D0%BA-onioni2p-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0%D0%BC/6278/7",
        "can_translate": false
    },
    {
        "id": 20122,
        "name": "Dmitry",
        "username": "dimzon",
        "avatar_template": "/user_avatar/ntc.party/dimzon/{size}/3877_2.png",
        "created_at": "2023-11-19T10:58:02.590Z",
        "cooked": "<p>Заработало.<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"xray-прозрачный-доступ-к-onioni2p-ресурсам/57921d8fb3c438b9cb72b817954bab3c18d6375a.jpeg\" data-download-href=\"https://ntc.party/uploads/default/57921d8fb3c438b9cb72b817954bab3c18d6375a\" title=\"image\"><img src=\"xray-прозрачный-доступ-к-onioni2p-ресурсам/57921d8fb3c438b9cb72b817954bab3c18d6375a_2_225x500.jpeg\" alt=\"image\" data-base62-sha1=\"cuGADndIbXjUCCQfWUKfGJNPVUe\" width=\"225\" height=\"500\" srcset=\"xray-прозрачный-доступ-к-onioni2p-ресурсам/57921d8fb3c438b9cb72b817954bab3c18d6375a_2_225x500.jpeg, xray-прозрачный-доступ-к-onioni2p-ресурсам/57921d8fb3c438b9cb72b817954bab3c18d6375a_2_337x750.jpeg 1.5x, xray-прозрачный-доступ-к-onioni2p-ресурсам/57921d8fb3c438b9cb72b817954bab3c18d6375a_2_450x1000.jpeg 2x\" data-dominant-color=\"0E0D0D\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">720×1600 117 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>При включенной галочке на виртуальном адресе 26.26.26.2:53 поднимается UDP-only  который редиректит dns-запросы на удаленный ресолвер xray</p>\n<p>Смысл опций “удаленная / внутреняя dns” пока не ясен</p>",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2023-11-19T10:58:02.590Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 61,
        "readers_count": 60,
        "score": 22.2,
        "yours": false,
        "topic_id": 6278,
        "topic_slug": "xray-%D0%BF%D1%80%D0%BE%D0%B7%D1%80%D0%B0%D1%87%D0%BD%D1%8B%D0%B9-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF-%D0%BA-onioni2p-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0%D0%BC",
        "display_username": "Dmitry",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 2799,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/xray-%D0%BF%D1%80%D0%BE%D0%B7%D1%80%D0%B0%D1%87%D0%BD%D1%8B%D0%B9-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF-%D0%BA-onioni2p-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0%D0%BC/6278/8",
        "can_translate": false
    },
    {
        "id": 20171,
        "name": "Dmitry",
        "username": "dimzon",
        "avatar_template": "/user_avatar/ntc.party/dimzon/{size}/3877_2.png",
        "created_at": "2023-11-21T01:58:20.118Z",
        "cooked": "<p><a class=\"mention\" href=\"/u/valdikss\">@ValdikSS</a> получилось, вот инструкция может кому пригодится</p>\n<ol>\n<li>\n<p>Обычный DNS рулим на VDS стандартными средствами, ресолвер вешаем на 127.0.0.1:53, помним про /etc/resolve.conf</p>\n</li>\n<li>\n<p>Сломался outbound protocol=“wireguard” , пришлось запускать 2-й экземпляр XRay и лазить в него из основного через socks:</p>\n</li>\n</ol>\n<pre><code class=\"lang-auto\">{\n    \"log\": {\n        \"loglevel\": \"warning\",\n        \"access\": \"\\/var\\/log\\/xray\\/wg-access.log\",\n        \"error\": \"\\/var\\/log\\/xray\\/wg-error.log\",\n        \"dnsLog\": false\n    },\n    \"dns\": {\n        \"servers\": [\n            \"tcp+local:1.1.1.1\",\n            \"tcp+local:1.0.0.1\"\n        ]\n    },\n    \"inbounds\": [\n        {\n            \"port\": \"1081\",\n            \"listen\": \"127.0.0.1\",\n            \"tag\": \"wireproxy\",\n            \"protocol\": \"socks\",\n            \"settings\": {\n                \"auth\": \"noauth\",\n                \"udp\": true\n            }\n        }\n    ],\n    \"outbounds\": [\n        {\n            \"tag\": \"WARP\",\n            \"protocol\": \"wireguard\",\n            \"settings\": {\n                \"secretKey\": \"...\",\n                \"address\": [\n                    \"172.16.0.2\\/32\",\n                    \"2606:4700:110:8de1:4b29:ef08:2482:535d\\/128\"\n                ],\n                \"peers\": [\n                    {\n                        \"endpoint\": \"engage.cloudflareclient.com:2408\",\n                        \"publicKey\": \"bmXOC+F1FxEMF9dyiK2H5\\/1SUtzH0JuVo51h2wPfgyo=\"\n                    }\n                ],\n                \"mtu\": 1280\n            }\n        }\n    ],\n    \"routing\": {\n        \"domainStrategy\": \"IPOnDemand\",\n        \"rules\": []\n    }\n}\n</code></pre>\n<ol start=\"3\">\n<li>Ставим привокси:</li>\n</ol>\n<pre><code class=\"lang-auto\">listen-address 127.0.0.1:8118\naccept-intercepted-requests 1\n\nuser-manual /usr/share/doc/privoxy/user-manual\nconfdir /etc/privoxy\nlogdir /var/log/privoxy\n\nforward-socks5t   .onion     127.0.0.1:9050 .\nforward           .i2p   127.0.0.1:4444\n\nlogfile logfile\ntoggle  0\nenable-remote-toggle  0\nenable-remote-http-toggle  0\nenable-edit-actions 0\nenforce-blocks 0\nbuffer-limit 4096\nenable-proxy-authentication-forwarding 0\nforwarded-connect-retries  0\nallow-cgi-request-crunching 0\nsplit-large-forms 0\nkeep-alive-timeout 5\ntolerate-pipelining 1\nsocket-timeout 300\n\n</code></pre>\n<ol start=\"4\">\n<li>xray</li>\n</ol>\n<pre><code class=\"lang-auto\">{\n\n\"dns\": {\n        \"tag\": \"dns_inbound\",\n        \"servers\": [\n            \"localhost\"\n        ],\n        \"hosts\": {\n            \"domain:onion\": \"155.155.155.155\",\n            \"domain:i2p\": \"155.155.155.155\"\n        }\n    },\n    \"inbounds\": [\n        {\n            \"listen\": \"127.0.0.4\",\n            \"port\": 53,\n            \"protocol\": \"dokodemo-door\",\n            \"network\": \"tcp,udp\",\n            \"settings\": {\n                \"address\": \"127.0.0.1\",\n                \"port\": 53,\n                \"network\": \"tcp,udp\"\n            },\n            \"tag\": \"dns-in\"\n        },\n.....\n],\n    \"outbounds\": [\n        {\n            \"protocol\": \"freedom\",\n            \"domainStrategy\": \"AsIs\",\n            \"tag\": \"freedom\",\n            \"settings\": {}\n        },\n        {\n            \"protocol\": \"freedom\",\n            \"domainStrategy\": \"AsIs\",\n            \"tag\": \"privoxy\",\n            \"redirect\": \"127.0.0.1:8118\",\n            \"userLevel\": 5,\n            \"settings\": {}\n        },\n        {\n            \"protocol\": \"dns\",\n            \"address\": \"9.9.9.9\",\n            \"port\": 53,\n            \"settings\": {\n                \"nonIPQuery\": \"drop\"\n            },\n            \"tag\": \"dns-out\"\n        },\n        {\n            \"tag\": \"WARP\",\n            \"protocol\": \"socks\",\n            \"settings\": {\n                \"servers\": [\n                    {\n                        \"address\": \"127.0.0.1\",\n                        \"port\": 1081\n                    }\n                ],\n            }\n        },\n        {\n            \"tag\": \"TOR\",\n            \"protocol\": \"socks\",\n            \"settings\": {\n                \"servers\": [\n                    {\n                        \"address\": \"127.0.0.1\",\n                        \"port\": 9050,\n                        \"users\": [\n                            {\n                                \"user\": \"tor-user\",\n                                \"pass\": \"tor-pass\",\n                                \"level\": 5\n                            }\n                        ]\n                    }\n                ]\n            }\n        },\n        {\n            \"tag\": \"i2p\",\n            \"protocol\": \"socks\",\n            \"settings\": {\n                \"servers\": [\n                    {\n                        \"address\": \"127.0.0.1\",\n                        \"port\": 4447,\n                        \"users\": [\n                            {\n                                \"user\": \"i2p-user\",\n                                \"pass\": \"i2p-pass\",\n                                \"level\": 5\n                            }\n                        ]\n                    }\n                ]\n            }\n        },\n        {\n            \"protocol\": \"blackhole\",\n            \"tag\": \"block\"\n        }\n    ],\n    \"routing\": {\n        \"domainStrategy\": \"IPIfNonMatch\",\n        \"rules\": [\n            {\n                \"type\": \"field\",\n                \"inboundTag\": [\n                    \"dns_inbound\"\n                ],\n                \"outboundTag\": \"freedom\",\n                \"network\": \"tcp,udp\"\n            },\n            {\n                \"type\": \"field\",\n                \"port\": \"53\",\n                \"outboundTag\": \"dns-out\",\n                \"network\": \"tcp,udp\"\n            },\n            {\n                \"type\": \"field\",\n                \"outboundTag\": \"TOR\",\n                \"domain\": [\n                    \"domain:onion\"\n                ]\n            },\n            {\n                \"type\": \"field\",\n                \"outboundTag\": \"i2p\",\n                \"domain\": [\n                    \"domain:i2p\"\n                ]\n            },\n            {\n                \"type\": \"field\",\n                \"ip\": [\n                    \"155.155.155.15\"\n                ],\n                \"outboundTag\": \"privoxy\",\n                \"network\": \"tcp\"\n            },\n            {\n                \"type\": \"field\",\n                \"ip\": [\n                    \"geoip:private\"\n                ],\n                \"outboundTag\": \"block\"\n            },\n            {\n                \"type\": \"field\",\n                \"port\": \"25, 587, 465, 2525\",\n                \"network\": \"tcp\",\n                \"outboundTag\": \"block\"\n            },\n            {\n                \"type\": \"field\",\n                \"outboundTag\": \"block\",\n                \"domain\": [\n                    \"geosite:category-ads-all\"\n                ]\n            },\n            {\n                \"type\": \"field\",\n                \"user\": [\n                    \"rl_0_Dmitry\"\n                ],\n                \"outboundTag\": \"WARP\"\n            },\n            {\n                \"type\": \"field\",\n                \"protocol\": [\n                    \"bittorrent\"\n                ],\n                \"outboundTag\": \"block\"\n            }\n        ]\n    },\n    \"policy\": {\n        \"levels\": {\n            \"0\": {\n                \"handshake\": 5,\n                \"connIdle\": 120\n            },\n            \"5\": {\n                \"handshake\": 120,\n                \"connIdle\": 300\n            }\n        }\n    }\n}\n</code></pre>\n<ol start=\"5\">\n<li>Настрока v2rayng<br>\nвключаем эту галочку<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"xray-прозрачный-доступ-к-onioni2p-ресурсам/0774ac5a97de9003a6f25a817b3a7a9ab4ea14a6.jpeg\" data-download-href=\"https://ntc.party/uploads/default/0774ac5a97de9003a6f25a817b3a7a9ab4ea14a6\" title=\"image\"><img src=\"xray-прозрачный-доступ-к-onioni2p-ресурсам/0774ac5a97de9003a6f25a817b3a7a9ab4ea14a6_2_536x500.jpeg\" alt=\"image\" data-base62-sha1=\"13XjrsgsRALESMzCGfgtEpIqfS6\" width=\"536\" height=\"500\" srcset=\"xray-прозрачный-доступ-к-onioni2p-ресурсам/0774ac5a97de9003a6f25a817b3a7a9ab4ea14a6_2_536x500.jpeg, xray-прозрачный-доступ-к-onioni2p-ресурсам/0774ac5a97de9003a6f25a817b3a7a9ab4ea14a6_2_804x750.jpeg 1.5x, xray-прозрачный-доступ-к-onioni2p-ресурсам/0774ac5a97de9003a6f25a817b3a7a9ab4ea14a6_2_1072x1000.jpeg 2x\" data-dominant-color=\"141212\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1080×1007 102 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></li>\n</ol>\n<p>а тут <strong>забавнее</strong>. Явно тыкаем на удаленная DNS и очищаем значение. При этом в UI все равно будет отображаться 1.1.1.1 Поэтому  тыкаем и убеждаемся что в окошке редактирования поле пустое</p>\n<p>Касательно “Внутренная DNS” наоборот - открывам и явно прописываем 223.5.5.5  (тыкаем и убеждаемся что в окошке редактирования поле  НЕ пустое)<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"xray-прозрачный-доступ-к-onioni2p-ресурсам/19beeb8bdcea80332dab0bbfdb235c54f25d35c7.jpeg\" data-download-href=\"https://ntc.party/uploads/default/19beeb8bdcea80332dab0bbfdb235c54f25d35c7\" title=\"image\"><img src=\"xray-прозрачный-доступ-к-onioni2p-ресурсам/19beeb8bdcea80332dab0bbfdb235c54f25d35c7_2_627x500.jpeg\" alt=\"image\" data-base62-sha1=\"3FKYPIhzt20L0b60048vVJN9rTx\" width=\"627\" height=\"500\" srcset=\"xray-прозрачный-доступ-к-onioni2p-ресурсам/19beeb8bdcea80332dab0bbfdb235c54f25d35c7_2_627x500.jpeg, xray-прозрачный-доступ-к-onioni2p-ресурсам/19beeb8bdcea80332dab0bbfdb235c54f25d35c7_2_940x750.jpeg 1.5x, xray-прозрачный-доступ-к-onioni2p-ресурсам/19beeb8bdcea80332dab0bbfdb235c54f25d35c7.jpeg 2x\" data-dominant-color=\"0B0707\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1080×861 57.5 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
        "post_number": 9,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2023-11-21T02:00:20.733Z",
        "reply_count": 0,
        "reply_to_post_number": 6,
        "quote_count": 0,
        "incoming_link_count": 34,
        "reads": 64,
        "readers_count": 63,
        "score": 182.8,
        "yours": false,
        "topic_id": 6278,
        "topic_slug": "xray-%D0%BF%D1%80%D0%BE%D0%B7%D1%80%D0%B0%D1%87%D0%BD%D1%8B%D0%B9-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF-%D0%BA-onioni2p-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0%D0%BC",
        "display_username": "Dmitry",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
            "username": "ValdikSS",
            "name": null,
            "avatar_template": "/user_avatar/ntc.party/valdikss/{size}/2_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 2799,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/xray-%D0%BF%D1%80%D0%BE%D0%B7%D1%80%D0%B0%D1%87%D0%BD%D1%8B%D0%B9-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF-%D0%BA-onioni2p-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0%D0%BC/6278/9",
        "can_translate": false
    }
]
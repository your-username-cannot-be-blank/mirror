
    <html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <style>
    th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      word-wrap: break-word;
      padding: 5px;
    }
    table {
      width: 100%;
      max-width: 100%;
      border: 1px solid black;
      border-collapse: collapse;
      table-layout: fixed;
      word-wrap: break-word
    }
    code {
      word-wrap: break-word;
    }
    pre {
        white-space: pre-wrap;
    }
    </style>
        <title>проверка-ip-и-cidr-по-спискам-блокировок</title>
      </head>
      <body>
        <table border="1" width="100%" cellpadding="5">
          <tr>
            <th style="width: 10%;">Ник</th>
            <th>Пост</th>
            <th style="width: 10%;">Дата</th>
          </tr>
    <tr><td>haste</td><td><p>Искал готовую консольную утилиту для проверки IP-адресов по спискам блокировок.</p>
<p>Если бы в списках были только IP-адреса, можно было бы обойтись <code>grep -x -F &lt;ip&gt; &lt;file.lst&gt;</code>. Это, кстати, быстрее, чем следующие варианты.</p>
<p>Списки блокировок бывают не только с конкретными IP-адресами, но и с подсетями в формате IP/маска, это называется CIDR. С ними grep не справится. Есть готовые библиотеки для работы с CIDR для разных языков, но мне было лень.</p>
<p>Нашлась утилита <a href="https://github.com/jrlevine/grepcidr3" class="inline-onebox" rel="noopener nofollow ugc">GitHub - jrlevine/grepcidr3: High performance search for IP addresses and CIDR ranges</a> . С ключами -a -D вполне работает. Не путать с оригинальной grepcidr ( <a href="https://pc-tools.net/unix/grepcidr" class="inline-onebox" rel="noopener nofollow ugc">grepcidr for UNIX</a> ), там поддержки CIDR в файлах нет, только в паттерне.</p>
<p>Есть недоработка grepcidr3 (для моего применения) - можно подсунуть сразу несколько файлов списков, но не пишет, в каком файле нашлось совпадение, и при первом же совпадении заканчивает искать. Кто бы допил…</p></td><td>2024-05-20T12:30:35.890Z</td></tr>
    </table>
      </body>
    </html>
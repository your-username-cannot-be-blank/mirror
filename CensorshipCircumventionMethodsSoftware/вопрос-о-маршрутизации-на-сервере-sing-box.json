[
    {
        "id": 70134,
        "name": null,
        "username": "npart",
        "avatar_template": "/letter_avatar_proxy/v4/letter/n/c5a1d2/{size}.png",
        "created_at": "2024-12-01T11:36:49.409Z",
        "cooked": "<p>Пробы ради решил поставить на сервере sing-box, который умеет поттягивать базы geoip и geosite от разработчика и использовать их для настроек маршрутизации. Настроил блок в виде:</p>\n<pre><code class=\"lang-auto\">{\n  \"route\": {\n\t\"rules\": {\n\t  {\n\t    \"rule_set\": [\n\t\t  \"geoip_ru\",\n\t\t  \"geosite_ru\"\n\t\t  ]\n\t\t  \"outbound\": \"block\"\n\t  }\n   }\n}\n</code></pre>\n<p>Настроив всё и подключившись через Nekobox с проксированием всего и без настроек роутинга, решил проверить, будет ли оно работать, зайдя на <a href=\"http://2ip.ru\" rel=\"noopener nofollow ugc\">2ip.ru</a> и <a href=\"http://2ip.io\" rel=\"noopener nofollow ugc\">2ip.io</a>. Адреса действительно были разные.</p>\n<p>Хотелось бы просто для ликбеза понять, что происходит с запросами к ру-зоне в этом варианте. Если при настроенном роутинге на клиенте, клиент сам определяет какие запросы ему проксировать, а какие нет, то в данном случае все запросы от клиента отправляются на сервер и фильтрация происходит уже там, так ведь? Если да, то разве “outbound”: “block” не должен просто блокировать все запросы? Или клиент после обработки ответа от сервера просто отправляет запрос напрямую?</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 4,
        "updated_at": "2024-12-01T11:36:49.409Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 166,
        "reads": 70,
        "readers_count": 69,
        "score": 838.8,
        "yours": false,
        "topic_id": 13477,
        "topic_slug": "%D0%B2%D0%BE%D0%BF%D1%80%D0%BE%D1%81-%D0%BE-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8-%D0%BD%D0%B0-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B5-sing-box",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
            {
                "url": "http://2ip.io",
                "internal": false,
                "reflection": false,
                "clicks": 2
            },
            {
                "url": "http://2ip.ru",
                "internal": false,
                "reflection": false,
                "title": "Узнать IP адрес",
                "clicks": 2
            }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 7918,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%B2%D0%BE%D0%BF%D1%80%D0%BE%D1%81-%D0%BE-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8-%D0%BD%D0%B0-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B5-sing-box/13477/1",
        "can_translate": false
    },
    {
        "id": 70149,
        "name": "0ka",
        "username": "0ka",
        "avatar_template": "/letter_avatar_proxy/v4/letter/0/d78d45/{size}.png",
        "created_at": "2024-12-01T13:35:06.563Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"npart\" data-post=\"1\" data-topic=\"13477\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/n/c5a1d2/48.png\" class=\"avatar\"> npart:</div>\n<blockquote>\n<p>разве “outbound”: “block” не должен просто блокировать все запросы?</p>\n</blockquote>\n</aside>\n<p>так и происходит</p>\n<aside class=\"quote no-group\" data-username=\"npart\" data-post=\"1\" data-topic=\"13477\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/n/c5a1d2/48.png\" class=\"avatar\"> npart:</div>\n<blockquote>\n<p>Или клиент после обработки ответа от сервера просто отправляет запрос напрямую?</p>\n</blockquote>\n</aside>\n<p>нет, на клиенте запрос так же не проходит</p>\n<aside class=\"quote no-group\" data-username=\"npart\" data-post=\"1\" data-topic=\"13477\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/n/c5a1d2/48.png\" class=\"avatar\"> npart:</div>\n<blockquote>\n<pre><code class=\"lang-auto\">\"geoip_ru\",\n\"geosite_ru\"\n</code></pre>\n</blockquote>\n</aside>\n<p>в официальном репозитории таких ruleset нету</p>\n<p>смотрите логи</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 4,
        "updated_at": "2024-12-01T13:36:18.154Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 1,
        "incoming_link_count": 4,
        "reads": 60,
        "readers_count": 59,
        "score": 37.0,
        "yours": false,
        "topic_id": 13477,
        "topic_slug": "%D0%B2%D0%BE%D0%BF%D1%80%D0%BE%D1%81-%D0%BE-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8-%D0%BD%D0%B0-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B5-sing-box",
        "display_username": "0ka",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 488,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%B2%D0%BE%D0%BF%D1%80%D0%BE%D1%81-%D0%BE-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8-%D0%BD%D0%B0-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B5-sing-box/13477/2",
        "can_translate": false
    },
    {
        "id": 70151,
        "name": null,
        "username": "npart",
        "avatar_template": "/letter_avatar_proxy/v4/letter/n/c5a1d2/{size}.png",
        "created_at": "2024-12-01T13:52:53.567Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"0ka\" data-post=\"2\" data-topic=\"13477\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/0/d78d45/48.png\" class=\"avatar\"> 0ka:</div>\n<blockquote>\n<p>в официальном репозитории таких ruleset нету</p>\n</blockquote>\n</aside>\n<p>База идет отсюда. Решил не писать для экономии места</p>\n<pre><code class=\"lang-auto\">\"rule_set\": [\n      {\n        \"type\": \"remote\",\n        \"tag\": \"geoip_ru\",\n        \"format\": \"binary\",\n        \"url\": \"https://raw.githubusercontent.com/SagerNet/sing-geoip/rule-set/geoip-ru.srs\"\n      },\n</code></pre>\n<aside class=\"quote no-group\" data-username=\"0ka\" data-post=\"2\" data-topic=\"13477\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://ntc.party/letter_avatar_proxy/v4/letter/0/d78d45/48.png\" class=\"avatar\"> 0ka:</div>\n<blockquote>\n<p>нет, на клиенте запрос так же не проходит</p>\n</blockquote>\n</aside>\n<p>В таком случае в браузере при запросе что должно происходить? Таймаут?</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 4,
        "updated_at": "2024-12-01T13:58:20.394Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 57,
        "readers_count": 56,
        "score": 11.2,
        "yours": false,
        "topic_id": 13477,
        "topic_slug": "%D0%B2%D0%BE%D0%BF%D1%80%D0%BE%D1%81-%D0%BE-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8-%D0%BD%D0%B0-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B5-sing-box",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 7918,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%B2%D0%BE%D0%BF%D1%80%D0%BE%D1%81-%D0%BE-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8-%D0%BD%D0%B0-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B5-sing-box/13477/3",
        "can_translate": false
    },
    {
        "id": 70295,
        "name": null,
        "username": "npart",
        "avatar_template": "/letter_avatar_proxy/v4/letter/n/c5a1d2/{size}.png",
        "created_at": "2024-12-02T06:34:15.493Z",
        "cooked": "<p>В итоге всё встало на свои места. Как оказалось, несмотря на удаление всех правил маршрутизации в GUI Nekobox, в файле конфигурации по какой-то причине осталось правило на заворачивание .ru доменов в direct, из-за чего и возник вопрос. После пересоздания файла всё стало работать как надо. Спасибо что проконсультировали</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 4,
        "updated_at": "2024-12-02T06:34:15.493Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 37,
        "readers_count": 36,
        "score": 7.2,
        "yours": false,
        "topic_id": 13477,
        "topic_slug": "%D0%B2%D0%BE%D0%BF%D1%80%D0%BE%D1%81-%D0%BE-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8-%D0%BD%D0%B0-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B5-sing-box",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 7918,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": false,
        "wiki": false,
        "post_url": "/t/%D0%B2%D0%BE%D0%BF%D1%80%D0%BE%D1%81-%D0%BE-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8-%D0%BD%D0%B0-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B5-sing-box/13477/4",
        "can_translate": false
    }
]
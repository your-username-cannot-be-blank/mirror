
    <html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <style>
    th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      word-wrap: break-word;
      padding: 5px;
    }
    table {
      width: 100%;
      max-width: 100%;
      border: 1px solid black;
      border-collapse: collapse;
      table-layout: fixed;
      word-wrap: break-word
    }
    code {
      word-wrap: break-word;
    }
    pre {
        white-space: pre-wrap;
    }
    </style>
        <title>magisk-модуль-с-zapret-для-android-13098</title>
      </head>
      <body>
        <table border="1" width="100%" cellpadding="5">
          <tr>
            <th style="width: 10%;">Ник</th>
            <th>Пост</th>
            <th style="width: 10%;">Дата</th>
          </tr>
    <tr><td>ImMALWARE(MALWARE)</td><td><h1><a name="p-66156-magisk-zapret-1" class="anchor" href="#p-66156-magisk-zapret-1"></a>Привет! Решил впервые опубликовать тему на этом форуме. Я сделал небольшой Magisk модуль с zapret’ом.</h1>
<p>Скачать тут: <a href="https://github.com/ImMALWARE/zapret-magisk/releases/download/2/zapret_module.zip" rel="noopener nofollow ugc">https://github.com/ImMALWARE/zapret-magisk/releases/download/2/zapret_module.zip</a></p>
<h2><a name="p-66156-zapret-youtube-discord-2" class="anchor" href="#p-66156-zapret-youtube-discord-2"></a>Установите модуль, перезагрузитесь, как обычно. <strong>zapret</strong> будет запущен автоматически. YouTube и Discord (с голосовыми чатами) должны работать корректно.</h2>
<p>Другие заблокированные сайты впервые откроются не сразу, только с ~пятого раза. Потому что zapret работает в режиме автоматического списка. После того, как они хотя бы один раз открылись, в следующий раз они будут открываться сразу.</p>
<p>Если нужно остановить zapret, придётся установить приложение Termux и выполнить команду:</p>
<pre data-code-wrap="sh"><code class="lang-sh">su -c zapret stop
</code></pre>
<p>Если не нужен автозапуск, то выполните команду:</p>
<pre data-code-wrap="sh"><code class="lang-sh">su -c rm /data/adb/modules/zapret/autostart
</code></pre>
<p>Запускать zapret тогда нужно будет по команде:</p>
<pre data-code-wrap="sh"><code class="lang-sh">su -c zapret start
</code></pre>
<h2><a name="p-66156-zapret-3" class="anchor" href="#p-66156-zapret-3"></a>Если это кому-нибудь будет нужно, то в дальнейшем я сделаю отдельное приложение для управления этим zapret.</h2></td><td>2024-11-13T23:24:02.232Z</td></tr><tr><td>p0zitiv</td><td><p>не получится code - download zip. Внутри зипа файлы будут в дополнительной папке</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="magisk-модуль-с-zapret-для-android-13098/191843febe036a901108ec11ae7c99c73ae4927e.png" data-download-href="https://ntc.party/uploads/default/191843febe036a901108ec11ae7c99c73ae4927e" title="0-02-08-018901c9782ea55f131db3003693ab73eb9d30efa6ff26312ff30d3f683430b7_4c0b29a524f565ee"><img src="magisk-модуль-с-zapret-для-android-13098/191843febe036a901108ec11ae7c99c73ae4927e.png" alt="0-02-08-018901c9782ea55f131db3003693ab73eb9d30efa6ff26312ff30d3f683430b7_4c0b29a524f565ee" data-base62-sha1="3zZVnW59zKHwgHSdsdX2F4INLIy" width="690" height="176" data-dominant-color="1E1E1E"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">0-02-08-018901c9782ea55f131db3003693ab73eb9d30efa6ff26312ff30d3f683430b7_4c0b29a524f565ee</span><span class="informations">1080×276 8.22 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p></td><td>2024-11-14T00:13:39.110Z</td></tr><tr><td>ImMALWARE(MALWARE)</td><td><p>Очень извиняюсь, не подумал об этом. Исправил, отредактировал пост.</p></td><td>2024-11-14T00:31:28.125Z</td></tr><tr><td>KDS</td><td><p>А зачем там везде --wssize 1:6 понатыкано? Там, где это не нужно, это приведет лишь к полной неработоспособности стратегии.<br>
Хотя, в принципе, она все равно не работает (ибо не открывает гуглвидео), хоть так хоть этак. Ростелеком<br>
Остальное тестить не стал. Еще и на nfqws защитник взвыл, видимо из-за UPX-а</p></td><td>2024-11-14T03:17:20.347Z</td></tr><tr><td>Vinodarin(Алексей)</td><td><p>Жду приложение! <img src="https://ntc.party/images/emoji/twitter/+1/2.png?v=12" title=":+1:t2:" class="emoji" alt=":+1:t2:" loading="lazy" width="20" height="20"></p></td><td>2024-11-14T20:56:40.096Z</td></tr><tr><td>NotMatveyKa</td><td><p>Работает только на WI-FI, на мобильном интернете не работает</p></td><td>2024-11-15T04:48:21.457Z</td></tr><tr><td>spv82</td><td><p><a class="mention" href="/u/immalware">@ImMALWARE</a><br>
Сами бинарники наверное лучше для Андроида собирать.<br>
Вот собрал с помощью последнего Android NDK (minSdk 21) - <a href="https://github.com/spvkgn/nfqws-android/releases" class="inline-onebox" rel="noopener nofollow ugc">Releases · spvkgn/nfqws-android · GitHub</a></p></td><td>2024-11-15T14:03:42.685Z</td></tr><tr><td>Shararamosh(Богдан Падалко)</td><td><p>Он типа автоподбор для каждого сайта делает, а потом просто для каждого сайта запоминает параметры? Просто иначе непонятно, как это так с пятого раза подключение.</p></td><td>2024-11-16T00:33:28.280Z</td></tr><tr><td>spot320</td><td><p>На мобильном не заработало, на wifi не проверял.<br>
p.s. автору спасибо, обновлёние работает отлично</p></td><td>2024-11-16T08:36:25.490Z</td></tr><tr><td>ImMALWARE(MALWARE)</td><td><p>Прочитай как работает autohostslist в zapret</p></td><td>2024-11-16T10:53:17.702Z</td></tr><tr><td>ImMALWARE(MALWARE)</td><td><p>Обновил модуль, отредактировал пост.<br>
Исправил недочёты: убрал -wssize, оптимизировал скрипт, переименовал xbin в bin</p></td><td>2024-11-16T10:56:37.279Z</td></tr><tr><td>mIzzzzon</td><td><aside class="quote no-group" data-username="ImMALWARE" data-post="1" data-topic="13098">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/immalware/48/7110_2.png" class="avatar"> ImMALWARE:</div>
<blockquote>
<p>Если это кому-нибудь будет нужно, то в дальнейшем я сделаю отдельное приложение для управления этим zapret.</p>
</blockquote>
</aside>
<p>Думаю не только я, но и многие другие пользователи будут рады иметь весь функционал zapret`а на телефоне</p></td><td>2024-11-16T20:15:22.138Z</td></tr><tr><td>chronotorius(Victor Shilin)</td><td><p>На мобильном у меня не работало без dnscrypt-proxy, пришлось учиться устанавливать его под Android 10+, заработало в связке с приложением OverrideDNS.<br>
Переделал конфиг под себя, (стратегии из YTDisBystro по большей части и кое-где отсебятина, домены discord перенес в общий список russia-blacklist.txt):</p>
<pre><code class="lang-auto">	MODPATH=/data/adb/modules/zapret

    config="--filter-tcp=443 --hostlist=$MODPATH/YTDisBystro/russia-youtubeGV.txt --dpi-desync=split --dpi-desync-split-pos=1 --dpi-desync-fooling=badseq --dpi-desync-repeats=10 --dpi-desync-autottl --new";
    config="$config --filter-tcp=443 --hostlist=$MODPATH/YTDisBystro/russia-youtube.txt --dpi-desync=fake,split2 --dpi-desync-split-seqovl=2 --dpi-desync-split-pos=3 --dpi-desync-fake-tls=$MODPATH/YTDisBystro/tls_clienthello_www_google_com_new.bin --dpi-desync-autottl --new"
	config="$config --filter-tcp=80 --hostlist=$MODPATH/YTDisBystro/russia-blacklist.txt --dpi-desync=fake,split2 --dpi-desync-fooling=md5sig --dpi-desync-autottl --new";
    config="$config --filter-tcp=443 --hostlist=$MODPATH/YTDisBystro/russia-blacklist.txt --dpi-desync=fake,split2 --dpi-desync-split-seqovl=288 --dpi-desync-split-tls=sniext --dpi-desync-fake-tls=$MODPATH/YTDisBystro/tls_clienthello_www_google_com_new.bin --dpi-desync-autottl --hostlist=$MODPATH/YTDisBystro/zapret-hosts-user.txt --hostlist-exclude=$MODPATH/YTDisBystro/zapret-hosts-user-exclude.txt --hostlist-auto=$MODPATH/YTDisBystro/zapret-hosts-auto.txt --hostlist-auto-fail-threshold=3 --hostlist-auto-fail-time=60 --hostlist-auto-retrans-threshold=3";
</code></pre></td><td>2024-11-18T15:38:52.353Z</td></tr><tr><td>chronotorius(Victor Shilin)</td><td><p>Я правильно понимаю, что при раздаче интернета через wifi с устройства на Android, на принимающем устройстве обход блокировки так просто не заработает? Проверил, не заработало, хотя правила iptables POSTROUTING есть.</p></td><td>2024-11-18T17:30:49.435Z</td></tr><tr><td>IndeecFOX(IndeecFox)</td><td><p>Правильно. Аппаратное ускорение попробуйте отключить. Есть утилита VPN hotspot. С ней работает. Но надо аппаратное ускорение выключать. Включить VPN, в настройках приложения выбрать tun0 или аналогичный, включить точку и в приложении переклюк дёрнуть. Примерно так.</p></td><td>2024-11-19T10:47:15.318Z</td></tr><tr><td>chronotorius(Victor Shilin)</td><td><p>Спасибо, hardware offloading именно на роутере нужно отключать (ибо инфы как это сделать на телефоне, не находил)? Увы, на моем девайсе прога не заработала (какие-то проблемы с интерфейсом p2p0 на прошивке устройства).</p></td><td>2024-11-19T13:14:36.512Z</td></tr><tr><td>kroko</td><td><p>Привет, на TOX1 TV приставке с Magisk не получилось, хотя в этой же сети с пк с такой же конфигой нормально youtube работает, м.б. кто-нибудь может что посоветовать?</p>
<p>Ещё у меня на приставке почему-то при выполнении команды в Termux<br>
su -c zapret stop<br>
появляется ошибка can’t execute permission denied<br>
хотя в Magisk для Termux выставлена выдача root прав</p></td><td>2024-11-19T15:39:08.072Z</td></tr><tr><td>chronotorius(Victor Shilin)</td><td><p>Проверить, запустился ли демон nfqws и применились ли правила iptables.<br>
У меня на телефоне не было нужных конфигов в ядре, пришлось пересобирать.<br>
По поводу permission denied, может банально chmod 755 нужен, или проблемы с SELinux.</p></td><td>2024-11-19T16:02:18.228Z</td></tr><tr><td>ImMALWARE(MALWARE)</td><td><p>попробуй реально chmod 755 сделать и перезагрузиться</p></td><td>2024-11-19T19:40:29.268Z</td></tr><tr><td>IndeecFOX(IndeecFox)</td><td><aside class="quote no-group" data-username="kroko" data-post="17" data-topic="13098">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/k/50afbb/48.png" class="avatar"> kroko:</div>
<blockquote>
<p>Привет, на TOX1 TV приставке с Magisk не получилось, хотя в этой же сети с пк с такой же конфигой нормально youtube работает, м.б. кто-нибудь может что посоветовать?</p>
</blockquote>
</aside>
<p>Я оффтопну, но ещё bybyedpi 1.3.8 от romanvht есть а автоподбором конфига. Как вариант, если не именно zapret нужен.</p></td><td>2024-11-20T00:35:18.183Z</td></tr><tr><td>Sorangan(Sasha)</td><td><p>Ютуб все равно плохо работает. Можно где-то что-то подкрутить или нет?</p></td><td>2024-11-21T12:45:48.263Z</td></tr><tr><td>KXLLXRMXN</td><td><p>Кстати да, через мобильную сеть грузит только Аватарки. Через вафлю нормально. Мобильный билайн</p></td><td>2024-11-21T12:52:43.614Z</td></tr><tr><td>cpman228</td><td><p>Можно как-то свой список подсунуть?<br>
Как проверить, что он работает, а то этот сайт загрузился, а потом перестал грузиться(<br>
Некоторые другие сайты тоже долго не грузятся.<br>
Странно, а твиттер сразу заработал xd</p></td><td>2024-12-08T22:39:35.112Z</td></tr><tr><td>ImMALWARE(MALWARE)</td><td><p>свой список по пути /data/adb/zapret/DPI_list.txt</p>
<p>он должен автоматически добавлять забаненные сайты в список</p></td><td>2024-12-08T22:56:49.055Z</td></tr><tr><td>cpman228</td><td><p>Как в эту папку попасть? В термукс пишу sudo cd adb, он отвечает</p>
<blockquote>
<p>env: exec cd: No such file or directory</p>
</blockquote></td><td>2024-12-08T23:50:23.811Z</td></tr><tr><td>xX_RUP3R7_P4UL50N_Xx</td><td><pre><code class="lang-auto">su
cd /data/adb
</code></pre></td><td>2024-12-09T08:09:53.225Z</td></tr><tr><td>cpman228</td><td><p>Спасибо! А как в режиме su изменить файл? При попытке использовать vim или nano он пишет</p>
<blockquote>
<p>/system/bin/sh: nano: inaccessible or not found 127|</p>
</blockquote></td><td>2024-12-09T08:17:09.567Z</td></tr><tr><td>xX_RUP3R7_P4UL50N_Xx</td><td><pre><code class="lang-auto">exit
pkg install nano
sudo nano /path/to/file
</code></pre>
<p>P.s. а зачем? Не проще ли воспользоваться Total Commander и встроенным в него файловым редактором?</p></td><td>2024-12-09T08:23:04.202Z</td></tr><tr><td>cpman228</td><td><p>Точно, удобнее, я просто не там искал <img src="https://ntc.party/images/emoji/twitter/sweat_smile.png?v=12" title=":sweat_smile:" class="emoji" alt=":sweat_smile:" loading="lazy" width="20" height="20"></p></td><td>2024-12-09T10:36:44.703Z</td></tr><tr><td>Mahou</td><td><p>Хмм, на мобильном Tele2 отлично работает, и ютуб, и заблокированные сайты, а вот на домашнем интернете МТС только ютуб, остальные сайты ERR_CONNECTION_RESET.<br>
Спасибо за модуль, очень удобно лишний раз не включать/отключать vpn.</p></td><td>2024-12-19T17:29:07.449Z</td></tr><tr><td>ImMALWARE(MALWARE)</td><td><p>К сожалению не могу отредачить пост, поэтому напишу тут.<br>
<strong>Обновление модуля!</strong></p>
<h2><a name="p-74486-httpsgithubcomimmalwarezapret-magiskreleasesdownload3zapret_modulezip-1" class="anchor" href="#p-74486-httpsgithubcomimmalwarezapret-magiskreleasesdownload3zapret_modulezip-1"></a>Скачать тут: <a href="https://github.com/ImMALWARE/zapret-magisk/releases/download/3/zapret_module.zip" rel="noopener nofollow ugc">https://github.com/ImMALWARE/zapret-magisk/releases/download/3/zapret_module.zip</a></h2>
<ul>
<li>Для остановки/перезапуска zapret’a теперь можно использовать кнопку <strong>Action</strong> в приложении Magisk</li>
<li>Поддержка обновлений в приложении Magisk</li>
<li>Новые конфиги</li>
<li>Поддержка большего количества процессоров</li>
</ul></td><td>2024-12-23T11:06:07.325Z</td></tr><tr><td>GusikTheCaptain</td><td><p>Опа, решил поинтересоваться обходами, так как на выходных рутану телефончик, а тут ещё и сорок минут назад выложили новую версию! Охуеннейше! Прям для меня! Блохадарю!</p></td><td>2024-12-23T11:49:59.363Z</td></tr><tr><td>KXLLXRMXN</td><td><p>Спасибо, что продолжаешь улучшать. Красавчик!</p></td><td>2024-12-23T14:05:25.356Z</td></tr><tr><td>lazylizard(Антон)</td><td><p>Подтверждаю, работает, правда когда я, любопытства ради, сделал <strong>su -c zapret stop</strong> а потом <strong>su -c zapret start</strong>, видео в ReVanced перестало воспроизводиться. Помогла перезагрузка. Большое спасибо автору!</p></td><td>2024-12-23T14:24:44.905Z</td></tr><tr><td>KXLLXRMXN</td><td><p>Так же было. Вручную запуск не помогал, помогала только перезагрузка</p></td><td>2024-12-23T14:39:30.257Z</td></tr><tr><td>ImMALWARE(MALWARE)</td><td><p>В новой версии можно тыкать кнопку Action в приложении Magisk в списке модулей вместо команд</p></td><td>2024-12-23T14:56:52.471Z</td></tr><tr><td>lazylizard(Антон)</td><td><p>Проверил, есть такая кнопка. А в версии Magisk 27.0 она была? А то я что-то не видел, пока не обновил Magisk до 28.1. Сейчас нажал кнопку — написало, что zapret остановился. Ещё раз нажал — запустился. Видео на этот раз продолжило воспроизводиться, как ни в чём не бывало, и другое видео открылось нормально. Ещё раз спасибо!</p></td><td>2024-12-23T16:00:37.387Z</td></tr><tr><td>ImMALWARE(MALWARE)</td><td><p>с 28 версии поддерживается Action</p></td><td>2024-12-23T16:45:09.261Z</td></tr><tr><td>Svog111(Svog111)</td><td><p>На мобильном работает. На Wi-fi тормозит сильно youtube. При чем на компе zapret от YTDisBystro хорошо работает. Тут нужно алгоритм наверное подкрутить. Также у меня стоит на телефоне ByeByeDPI. Так там наоборот на Wi-Fi все летает, а на мобильном вообще не работает. Ну хотя бы смогу переключаться если вдруг понадобится с одной программы на другую. Но если бы работало одновременно и на мобильном интернете и на Wi-Fi, то совсем было бы хорошо</p></td><td>2024-12-24T00:49:58.772Z</td></tr><tr><td>ImMALWARE(MALWARE)</td><td><p>Конфиг можно отредактировать в <code>/data/adb/modules/zapret/system/bin/zapret</code> (это текстовый файл)</p></td><td>2024-12-25T12:23:03.019Z</td></tr><tr><td>lmfzl</td><td><p>Спасибо тебе большое, очень долго ждал порта запрета, всех благ</p></td><td>2024-12-30T10:50:38.009Z</td></tr><tr><td>W1T</td><td><p>Установил magick, но кнопка модули серая и не активная. Что надо сделать чтобы модули можно было ставить?</p></td><td>2025-01-01T11:21:04.655Z</td></tr><tr><td>ImMALWARE(MALWARE)</td><td><p>почитай что такое рут права и как устанавливать magisk</p></td><td>2025-01-01T12:11:35.606Z</td></tr><tr><td>Karaulx(Karaulx)</td><td><p>Установил на tanix w2 при нажатии на старт ошибка unknown arrch: arml8</p></td><td>2025-01-07T03:22:34.381Z</td></tr><tr><td>ImMALWARE(MALWARE)</td><td><p>Обнови через Magisk, исправил</p></td><td>2025-01-08T20:00:48.954Z</td></tr><tr><td>Roper89(RopeR)</td><td><p>Ютуб завёлся, но загрузка приложений из <strong>Google Play</strong> не работает. Какие ему домены надо прописать? Весь блеклист из YTDisBystro скормил, но не помогло. <img src="https://ntc.party/images/emoji/twitter/thinking.png?v=12" title=":thinking:" class="emoji" alt=":thinking:" loading="lazy" width="20" height="20"></p></td><td>2025-01-21T12:01:42.266Z</td></tr><tr><td>ImMALWARE(MALWARE)</td><td><p>Странно… У тебя последняя версия 1.2.1?</p></td><td>2025-01-21T14:08:24.057Z</td></tr><tr><td>dissonator(konstantin shæv)</td><td><p>Что-то с 4й версией модуля явно не так. Бывает youtube работает от включения бокса до выключения без нареканий. Бывает застрянет на перемотке и всё - хоть перематывай, хоть перезагружай приложения. Хоть выключай/включай модуль в магиске - бестолку, не грузит. Иногда помогает полная перезагрузка бокса (AX95DB 4/32 AndroidTV9) всё начинает без проблем работать, а иногда и перезагрузка не помогает…<br>
На 3-й и 2-й версии всё работает без нареканий. Пользуюсь 3й.<br>
Любую необходимую инфу для отладки предоставлю.</p></td><td>2025-01-23T09:21:01.749Z</td></tr><tr><td>Roper89(RopeR)</td><td><p>Да, 1.2.1 (уточню, он не поломал мне загрузку, просто не разблокировал) проблема скорей в самом запрете и <a href="https://ntc.party/t/%D0%BD%D0%B5-%D1%81%D0%BA%D0%B0%D1%87%D0%B8%D0%B2%D0%B0%D1%8E%D1%82%D1%81%D1%8F-%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F-%D0%B8%D0%B7-googleplay/13264/1">распространена</a></p></td><td>2025-01-23T10:43:24.722Z</td></tr><tr><td>ImMALWARE(MALWARE)</td><td><p>лучше вам сделать blockcheck и поменять конфиг в модуле (который находится в текстовом файле <code>/data/adb/modules/zapret/system/bin/zapret</code>)</p>
<p><a class="mention" href="/u/roper89">@Roper89</a> вам тоже</p></td><td>2025-01-24T06:01:20.216Z</td></tr><tr><td>dissonator(konstantin shæv)</td><td><p>скопировал конфиг из 3й версии в 4ю. пока проблем нет. благодарю</p></td><td>2025-01-24T23:28:44.765Z</td></tr><tr><td>Roper89(RopeR)</td><td><p>Можете поделиться конфигом? (в сообщение можно прикрепить файл)</p></td><td>2025-01-25T16:47:52.976Z</td></tr><tr><td>dissonator(konstantin shæv)</td><td><p>Увы, вся история повторяется…<br>
Дело не в конфигах, они в 3й и 4й версии модуля практически идентичные за исключением пары доменов дискорда и одной добавленной архитектуры arm.<br>
Использую версию 1.2 из поста выше (v3 на гитхабе). У меня она почему-то работает без нареканий “из коробки”. Использую исключительно для ютуба.</p>
<p><a class="mention" href="/u/immalware">@ImMALWARE</a><br>
Завтра попробую то что предложит blockcheck, однако врядли что-то изменится. Как мне кажется что-то не так в новой версии модуля, надо посмотреть какие изменения вносились. В любом случае огромное спасибо за модуль - очень удобно!</p></td><td>2025-01-25T20:48:11.514Z</td></tr>
    </table>
      </body>
    </html>

    <html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <style>
    th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      word-wrap: break-word;
      padding: 5px;
    }
    table {
      width: 100%;
      max-width: 100%;
      border: 1px solid black;
      border-collapse: collapse;
      table-layout: fixed;
      word-wrap: break-word
    }
    code {
      word-wrap: break-word;
    }
    pre {
        white-space: pre-wrap;
    }
    </style>
        <title>yt-dlp-опять-не-качает-видео-с-ютуба-11597</title>
      </head>
      <body>
        <table border="1" width="100%" cellpadding="5">
          <tr>
            <th style="width: 10%;">Ник</th>
            <th>Пост</th>
            <th style="width: 10%;">Дата</th>
          </tr>
    <tr><td>doggych(Doggych)</td><td><p>Последние несколько дней видео в браузере начали воспроизводится с 5-ти секундной задержкой и проматываются хуже. Когда такое происходит в браузере, это говорит о том что yt-dlp качать вообще не будет, так и есть, не качает. Точно так же было в прошлый раз, но <a class="mention" href="/u/ori">@Ori</a> тогда скинул рабочую стратегию и сразу все заработало. В браузере все видео стали воспроизводится без задержки и yt-dlp стал скачивать.</p>
<p>Вот та самая рабочая стратегия которая помогла в прошлый раз:<br>
-e2 -f2 --reverse-frag --fake-gen 12 --wrong-seq --fake-from-hex 160301FFFF01FFFFFF0303594F5552204144564552544953454D454E542048455245202D202431302F6D6F000000000009000000050003000000</p>
<p>Перепробовал кучу новых вариантов что тут пишут, все работают с задержкой в браузере в 5 секунд, а yt-dlp не стал качать ни на одном.</p>
<p>goodbyedpi.exe заменял,  для меня ничего не поменялось, что с новым, что со старым работает одинаково с задержкой и yt-dlp не качает.</p>
<p>GoodByeDPI PX2W V1.2 не помогло, все тоже самое</p>
<p>Сборка с запретом zapret_only_DS_X, начинает скачивание через yt-dlp, но оно супермедленное и докачать даже маленькое видео не представляется возможным. Но у некоторых видео в браузере пропала задержка, хотя у большинства она осталась.</p>
<p>У кого-то получилось убрать полностью задержку в браузере и тем самым сделать рабочим yt-dlp? Помогите пожалуйста!</p></td><td>2024-10-11T12:32:29.749Z</td></tr><tr><td>Andron</td><td><p>Через запрет и preset_russia2.cmd загружает на макс. скорости, но с обрывами сети. В ютДЛП, ставьте максимум обрывов не 10 а 100 например и качаете, там если обрывает и затем снова подхватывает то продолжает закачку с места обрыва. Пока только так у меня работает. (МТС)</p></td><td>2024-10-11T15:26:10.403Z</td></tr><tr><td>ImMALWARE(MALWARE)</td><td><p>yt-dlp поддерживает прокси. Если у тебя есть прокси, то yt-dlp --proxy “socks5://login:password@adress:port” <em>ссылка</em></p></td><td>2024-10-13T11:04:09.369Z</td></tr><tr><td>TikTak(TikTak)</td><td><aside class="quote no-group">
<blockquote>
<p>У кого-то получилось убрать полностью задержку в браузере и тем самым сделать рабочим yt-dlp?</p>
</blockquote>
</aside>
<p>У меня например с крайней запретовской быстросборкой1.3 задержка в браузере пропала. но  ют-длп всё равно не качает с тех же серверов что в браузере доступны. Хз почему<br>
[download] Got error: HTTPSConnectionPool(host=‘<a href="http://rr18---sn-n8v7kn7d.googlevideo.com/" rel="noopener nofollow ugc">rr18—sn-n8v7kn7d.googlevideo.com</a>’, port=443): Read timed out. (read timeout=20.0). Retrying</p>
<p>вчера конфиги для гбдпиай с --reverse-frag работали для браузера и ют-длп, потом ркн опять поменял что-то и рабочими остались конфиги с  --native-frag где скорость мизерная ~50кБс. только 144р качать.</p></td><td>2024-10-17T11:43:49.383Z</td></tr><tr><td>Ori</td><td><aside class="quote no-group" data-username="doggych" data-post="1" data-topic="11597">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/doggych/48/8936_2.png" class="avatar"> doggych:</div>
<blockquote>
<p>Перепробовал кучу новых вариантов что тут пишут, все работают с задержкой в браузере в 5 секунд, а yt-dlp не стал качать ни на одном.</p>
</blockquote>
</aside>
<p>Потому что браузер обычно присасывается к 3 разным серверам: провайдерскому, магистральному и какому-нибудь ещё. А yt-dlp только к ближайшему (т.е. провайдерскому). Либо ваша стратегия на него не срабатывает, либо проблема в самом сервере. Я по этому поводу картинку ещё месяца полтора назад делал, т.к. у меня именно такая проблема:</p>
<details>
<summary>
Спойлер</summary>
<p><div class="lightbox-wrapper"><a class="lightbox" href="yt-dlp-опять-не-качает-видео-с-ютуба-11597/32844e2f6dbd40c73553d1766e750e02d7ef0d0b.png" data-download-href="https://ntc.party/uploads/default/32844e2f6dbd40c73553d1766e750e02d7ef0d0b" title="ggc"><img src="yt-dlp-опять-не-качает-видео-с-ютуба-11597/32844e2f6dbd40c73553d1766e750e02d7ef0d0b.png" alt="ggc" data-base62-sha1="7cTkRJlxQKIJQvxO7ACAGqzsMvV" width="669" height="500" data-dominant-color="F3F3F3"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">ggc</span><span class="informations">1002×748 17.7 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
</details>
<p>Теперь что касается yt-dlp. Он запрашивает ссылку на гуглвидео у ютуба, маскируясь под андроид-приложение, а затем качает видео по этой ссылке. Поэтому, самое эффективное в плане скорости решение: получить ссылку через прокси, а качать напрямую, используя обход гудбая/запрета.</p>
<p>Сделать можно несколькими способами:</p>
<ul>
<li>Самый простой способ, через курл:<br>
<code>yt-dlp https://www.youtube.com/watch?v=blablabla -f bv+ba/b --proxy socks5h://127.0.0.1:9150 --downloader curl --downloader-args curl:"--noproxy *"</code><br>
Здесь мы получаем ссылку через socks-прокси (можно воспользоваться банальным тор браузером или полноценным тором или чем-то ещё), а затем передаем её курлу с флагом <code>--no-proxy *</code>, который говорит курлу игнорировать прокси. В итоге видео тянется напрямую. Минус - всего 1 поток, а у ютуба есть ограничение на скорость потоков.</li>
<li>Самый эффективный вариант, через aria2c:<br>
<code>yt-dlp https://www.youtube.com/watch?v=blablabla -f bv+ba/b --proxy http://127.0.0.1:9180 --downloader aria2c --downloader-args aria2c:"-c -j10 -s10 -x10 -k1M -m100 --retry-wait=10 --all-proxy="</code><br>
Здесь нам понадобится консольная качалка aria2c, можно найти на гитхабе. Работает многопоточно, поэтому даже быстрее, чем нативное скачивание через сам yt-dlp. Ссылку получаем через прокси, потом передаем её в aria2, перезаписывая прокси в ноль ключом <code>--all-proxy=</code>. Вам понадобится http-прокси, иначе aria крашнется с ошибкой в процессе передачи команды от yt-dlp, т.к. не поддерживает socks. Можно, опять-таки, воспользоваться тором: просто добавляем в torrc строку <code>HTTPTunnelPort 9180</code></li>
</ul>
<p>Вам может понадобится много попыток для того чтобы начать скачивание, т.к. при использовании прокси ютуб будет ругаться “залогиньтесь, чтобы доказать что вы не бот”. Если используете тор браузер - просто перезапускаете его, чтобы новая цепочка построилась.</p></td><td>2024-10-17T21:22:42.581Z</td></tr><tr><td>TesterTi(TesterIt)</td><td><aside class="quote no-group" data-username="Ori" data-post="6" data-topic="11597">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/ori/48/7551_2.png" class="avatar"> Ori:</div>
<blockquote>
<p>при использовании прокси ютуб будет ругаться “залогиньтесь, чтобы доказать что вы не бот”</p>
</blockquote>
</aside>
<p>На этот случай можно сделать в расширении <a href="https://addons.mozilla.org/ru/firefox/addon/cookies-txt" class="inline-onebox">cookies.txt – Загрузите это расширение для 🦊 Firefox (ru)</a> (для хрома <a href="https://chromewebstore.google.com/detail/get-cookiestxt-locally/cclelndahbckbenkjhflpdbgdldlbecc">https://chromewebstore.google.com/detail/get-cookiestxt-locally/cclelndahbckbenkjhflpdbgdldlbecc</a>) свои куки из браузера в режиме инкогнито, сохранить их как youtube_cookies.txt в папку с yt-dlp. Затем добавить  <code>--cookies youtube_cookies.txt</code> перед <code>--downloader</code></p></td><td>2024-10-17T22:28:50.195Z</td></tr><tr><td>Ori</td><td><p>Спс, я попробую.</p></td><td>2024-10-17T22:29:46.569Z</td></tr><tr><td>TikTak(TikTak)</td><td><p>upd. 3апрет всё-таки тоже пробивает. Если параметр --dpi-desync-autottl в конфиге для блэклиста где <a href="http://googlevideo.com" rel="noopener nofollow ugc">googlevideo.com</a>  сменить на --dpi-desync-ttl=4<br>
Но раза с с 30го) зато с норм скоростью. поэтому можно увеличить кол-во ретраев.</p>
<aside class="quote no-group">
<blockquote>
<p>А yt-dlp только к ближайшему (т.е. провайдерскому)</p>
</blockquote>
</aside>
<p>вроде бы не только к провайдерскому судя по логу<br>
<div class="lightbox-wrapper"><a class="lightbox" href="yt-dlp-опять-не-качает-видео-с-ютуба-11597/11f5f0bd5c44cd4f77250e7f571443d35b25ef18.png" data-download-href="https://ntc.party/uploads/default/11f5f0bd5c44cd4f77250e7f571443d35b25ef18" title="cmd-yt-dlp"><img src="yt-dlp-опять-не-качает-видео-с-ютуба-11597/11f5f0bd5c44cd4f77250e7f571443d35b25ef18.png" alt="cmd-yt-dlp" data-base62-sha1="2yT2ASsbBTvYDLE55NNvaj3jxuo" width="690" height="348" data-dominant-color="0B2D07"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">cmd-yt-dlp</span><span class="informations">979×494 28.7 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>и кстати после начала использования запрета хром начал подсасываться к кэшам типа <a href="http://rr1---sn-hpaxjvh-v8ce.googlevideo.com/" rel="noopener nofollow ugc">rr1---sn-hpaxjvh-v8ce.googlevideo.com/</a><br>
<a href="http://rr2---sn-hpaxjvh-v8cl.googlevideo.com" rel="noopener nofollow ugc">rr2---sn-hpaxjvh-v8cl.googlevideo.com</a> которые судя по хуис вообще не моего провайдера, а дом.ру всякие итд<br>
можно конечно взять их с rr1 по rr19 или сколько их там, и завернуть на петлю в .hosts. но в браузере 3апрет их нормально пробивает. хз</p></td><td>2024-10-17T23:58:10.155Z</td></tr><tr><td>Ori</td><td><p>Интересно. У меня yt-dlp тупо выбирает 1 сервер и тычется в него до посинения, хоть 100 ретраев ставь.</p></td><td>2024-10-18T00:01:44.483Z</td></tr>
    </table>
      </body>
    </html>
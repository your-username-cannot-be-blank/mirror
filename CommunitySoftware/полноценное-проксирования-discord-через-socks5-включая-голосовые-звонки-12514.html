
    <html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <style>
    th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      word-wrap: break-word;
      padding: 5px;
    }
    table {
      width: 100%;
      max-width: 100%;
      border: 1px solid black;
      border-collapse: collapse;
      table-layout: fixed;
      word-wrap: break-word
    }
    code {
      word-wrap: break-word;
    }
    pre {
        white-space: pre-wrap;
    }
    </style>
        <title>полноценное-проксирования-discord-через-socks5-включая-голосовые-звонки-12514</title>
      </head>
      <body>
        <table border="1" width="100%" cellpadding="5">
          <tr>
            <th style="width: 10%;">Ник</th>
            <th>Пост</th>
            <th style="width: 10%;">Дата</th>
          </tr>
    <tr><td>runetfreedom</td><td><p>Всем привет, мое решение чем-то похоже на то, что уже тут, оказывается, <a href="https://ntc.party/t/%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-%D0%BF%D1%80%D0%BE%D0%BA%D1%81%D0%B8-%D1%82%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE-%D0%B4%D0%BB%D1%8F-discord-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-dll-%D0%BF%D0%BB%D1%8E%D1%81-%D0%B3%D0%BE%D0%BB%D0%BE%D1%81%D0%BE%D0%B2%D1%8B%D0%B5-%D0%B7%D0%B2%D0%BE%D0%BD%D0%BA%D0%B8-%D0%B1%D0%B5%D0%B7-%D0%BF%D1%80%D0%BE%D0%BA%D1%81%D0%B8/12044">публиковалось</a></p>
<p>Но, в отличии от решения выше, мое решение более полноценное - оно не слегка модифицирует, а действительно проксирует весь входящий и исходящий UDP трафик дискорда через socks5 прокси.</p>
<p>Решение корректно обрабатывает обновления дискорда, так что работает по принципу “поставил и забыл”</p>
<p>Опционально в комплекте есть автоматический установщик для вашего удобства.</p>
<p>Скачать вы можете тут <a href="https://github.com/runetfreedom/discord-voice-proxy" rel="noopener nofollow ugc">https://github.com/runetfreedom/discord-voice-proxy</a></p>
<p>Кучу технических подробностей можете прочитать в статье на хабре: <a href="https://habr.com/ru/articles/855164/" rel="noopener nofollow ugc">https://habr.com/ru/articles/855164/</a></p></td><td>2024-11-01T08:33:17.431Z</td></tr><tr><td>easyone11</td><td><p>Интересная статья, спасибо.</p></td><td>2024-11-01T08:47:36.551Z</td></tr><tr><td>Xunlei</td><td><p>Интересно, поддерживается ли фрагментация пакетов UDP клиента релея и работет ли PMTUD дискорда или же там все голосовые пакеты до 1 КиБ?</p></td><td>2024-11-01T09:23:56.040Z</td></tr><tr><td>runetfreedom</td><td><p>Фрагментация со стороны клиента не поддерживается (флаг фрагментации всего установлен в 0, т.е автономная датаграмма). Но если верить документации socks5, то это не обязательно:</p>
<blockquote>
<p>Implementation of fragmentation is optional; an implementation that does not support fragmentation MUST drop any datagram whose FRAG field is other than X’00’.</p>
</blockquote>
<p>Что касается размеров пакетов, то даже со включенным скринкастом я не видел пакетов больше 72 байт</p></td><td>2024-11-01T09:33:27.001Z</td></tr><tr><td>Xunlei</td><td><p>Да, реализация со стороны сервера не обязательна.<br>
72 байт что-то маловато, это в пустой комнате? В мамбле 200-300 байт, а в тимспике тоже до 100 байт.</p></td><td>2024-11-01T09:39:45.325Z</td></tr><tr><td>Xunlei</td><td><pre><code class="lang-auto">		CopyMemory(path + GetSystemDirectoryA(path, MAX_PATH - 12), "\\DWrite.dll", 13);
      
		OriginalDLL = LoadLibraryA(path);
</code></pre>
<p>Начиная с Windows NT 4.0 майкрософт рекомендует при работе с файлами поддерживать UNC пути длиной 32 КиБ в кодировке UCS-2 (сейчас UTF-16). Так же было бы здорово добавить поддержку IPv6 прокси (у меня прокси работают на IPv6, но приходится иногда поднимать инстансы IPv4 для программ, написанных ленивыми разработчиками).</p></td><td>2024-11-01T10:05:05.722Z</td></tr><tr><td>mutt-tamer-dinghy</td><td><p>Но мне нравится решение от hdrover тем, что голос работает там без прокси. Что снижает нагрузку на впс и канал. Что позволяет взять более дешевый впс.</p>
<p>Странно у меня ваше решение не коннектит к войсу. Подключение к rtc маршрут не найден. Подключаюсь Через локалхост на nekobox</p></td><td>2024-11-01T10:40:43.160Z</td></tr><tr><td>runetfreedom</td><td><p>Я тестировал на v2rayN, чуть позже проверю на nekobox</p></td><td>2024-11-01T10:51:56.739Z</td></tr><tr><td>runetfreedom</td><td><p>Так дискорд то к rtc подключается по ipv4.</p>
<p>Что касается длины путей - с одной стороны вы правы, с другой это совершенно бесполезно, ибо путь к system32 никогда не превысит MAX_PATH по очевидным причинам</p></td><td>2024-11-01T10:53:33.849Z</td></tr><tr><td>runetfreedom</td><td><p>Вы были правы, был баг с sing-box. Я проигнорировал пункт документации, в котором говорится, что я обязан держать tcp соединение с прокси сервером открытым пока действует udp ассоциация.</p>
<p>Если вам не сложно, то скачайте и проверьте, пожалуйста, <a href="https://github.com/runetfreedom/discord-voice-proxy/releases/tag/v0.1.1" rel="noopener nofollow ugc">новый релиз</a>. (можно заменить только force-proxy.dll)</p></td><td>2024-11-01T12:34:09.955Z</td></tr><tr><td>mutt-tamer-dinghy</td><td><p>Да теперь работает.</p></td><td>2024-11-01T12:59:56.535Z</td></tr><tr><td>Xunlei</td><td><aside class="quote no-group" data-username="runetfreedom" data-post="9" data-topic="12514">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/r/4af34b/48.png" class="avatar"> runetfreedom:</div>
<blockquote>
<p>Так дискорд то к rtc подключается по ipv4</p>
</blockquote>
</aside>
<p>Я написал про IPv6 прокси клиент/сервер, который должен мочь подключатся по адресам IPv4, IPv6 и по домену.</p></td><td>2024-11-01T17:39:44.675Z</td></tr><tr><td>runetfreedom</td><td><p>Реализована поддержка авторизации для socks5 прокси.</p></td><td>2024-11-02T17:07:33.226Z</td></tr><tr><td>bv0</td><td><p>А в инсталлятор можно добавить ввод логина и пароля для прокси?</p></td><td>2024-11-02T17:42:47.131Z</td></tr><tr><td>Rattlerutrap(Rattlerutrap)</td><td><p>добрый день, искреннее спасибо, дискорд заработал, но как всегда есть нюанс. ситуация такая, не получается подключится к rtc, пишет не установлен маршрут. подключаюсь к прокси через proxifier</p></td><td>2024-11-02T18:11:05.896Z</td></tr><tr><td>Rattlerutrap(Rattlerutrap)</td><td><p>у меня через proxifier ввод логина и пароля в самом приложении, автоматический установщик всё сам сделал, так что я доволен. еще в readme написано:<br>
Optionally, you can pass SOCKS5 credentials using:</p>
<pre><code class="lang-auto">SOCKS5_PROXY_LOGIN=login
SOCKS5_PROXY_PASSWORD=password
</code></pre>
<p>Don’t forget to restart Discord. Done!<br>
както так</p></td><td>2024-11-02T18:14:13.407Z</td></tr><tr><td>runetfreedom</td><td><p>Добавил в версии 0.2.1 в интсаллятор запрос логина и пароля (можно оставить пустыми)</p></td><td>2024-11-02T18:24:41.747Z</td></tr><tr><td>runetfreedom</td><td><p>Вы используете последнюю версию? Уверены, что правильно задали порт и логин с паролем?</p></td><td>2024-11-02T18:25:30.807Z</td></tr><tr><td>Rattlerutrap(Rattlerutrap)</td><td><p>не именно дискорд то у меня заработал, я другому человеку отвечал, у меня проблема при подключении к rtc, если бы я не правильно задал логин с паролем, то у меня бы и само приложение не работало, а проблема только с войсом</p></td><td>2024-11-02T18:29:19.222Z</td></tr><tr><td>Durandal(Asperkun95)</td><td><p>После последнего обновления отваливается проксирование, нужно снова закидывать файлы. Как я заметил после апдейта создается еще одна папка с версией дискорда (помимо старой app-1.0.9173 теперь есть и app-1.0.9174)</p></td><td>2024-12-12T07:45:37.438Z</td></tr>
    </table>
      </body>
    </html>
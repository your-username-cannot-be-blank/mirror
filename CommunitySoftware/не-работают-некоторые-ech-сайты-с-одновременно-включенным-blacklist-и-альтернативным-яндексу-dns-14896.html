
    <html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <style>
    th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      word-wrap: break-word;
      padding: 5px;
    }
    table {
      width: 100%;
      max-width: 100%;
      border: 1px solid black;
      border-collapse: collapse;
      table-layout: fixed;
      word-wrap: break-word
    }
    code {
      word-wrap: break-word;
    }
    pre {
        white-space: pre-wrap;
    }
    </style>
        <title>не-работают-некоторые-ech-сайты-с-одновременно-включенным-blacklist-и-альтернативным-яндексу-dns-14896</title>
      </head>
      <body>
        <table border="1" width="100%" cellpadding="5">
          <tr>
            <th style="width: 10%;">Ник</th>
            <th>Пост</th>
            <th style="width: 10%;">Дата</th>
          </tr>
    <tr><td>pavelmx</td><td><p><code>Rutracker.org</code>, <code>kinozal.tv</code>, <code>nnmclub.to</code> и, возможно, многие другие перестают работать в MS Edge и других браузерах, которые не используют по умолчанию собственный встроенный dns редирект на внешние DNS резольверы.<br>
Воспроизводится такое поведение при установке dns отличающийся от <code>--dns-addr 77.88.8.8 --dns-port 1253</code> и присутствии <code>--blacklist ..\russia-blacklist.txt</code>. Но всё-таки многие, изначально заблокированные интернет провайдером сайты, успешно работают.<br>
Если <code>--dns-addr 9.9.9.9 --dns-port 53</code> или даже <code>--dns-addr 9.9.9.9 --dns-port 9953</code>, как и многие другие на стандартном и не стандартном dns порте, и включен <code>--blacklist</code>, то сайты из списка выше не открываются.<br>
Если <code>--blacklist ..\russia-blacklist.txt</code> содержит хотя бы одну строчку <code>google.com</code> или все 16000 строк от РКН, то по-прежнему не открывается. Другими словами, присутствие или отсутствие <code>Rutracker.org</code> в blacklist ни на что не влияет.<br>
Если убрать <code>--blacklist</code> из строки запуска вовсе и оставить <code>--dns-addr 9.9.9.9 --dns-port 53</code>, то все работает.<br>
Тестировал на нескольких интернет провайдерах и на нескольких windows 10 машинах.<br>
Перед воспроизведением ошибки и и каждом перезапуске goodbyedpi необходимо закрыть MS Edge и выполнить <code>ipconfig /flushdns</code>, естественно. Иначе найдёт dns запись в кэше и ошибки не будет.<br>
Получается дилемма, либо использовать dns от Яндекса, который резольвит некоторые санкционные ресурсы в localhost или ещё куда-то не туда, либо убирать blacklist, без которого ломаются многие сайты.<br>
То, что <code>rutracker.org</code>, <code>kinozal.tv</code>, <code>nnmclub.to</code> работают на cloudflare c ECH, в курсе. <code>cloudflare-ech.com</code> в blacklist добавлял/убирал. В браузерах со своим включенным DNS редиректом такой проблемы нет, соответственно.</p>
<p>PS<br>
Другими словами:<br>
<code>-9 --blacklist ..\russia-blacklist.txt --dns-addr 77.88.8.8 --dns-port 1253</code> <strong>- работает</strong>.<br>
<code>-9 --dns-addr 9.9.9.9 --dns-port 53</code> <strong>- работает</strong>.<br>
<code>-9 --blacklist ..\russia-blacklist.txt</code> <strong>- работает</strong>.<br>
<code>-9 --blacklist ..\russia-blacklist.txt</code> --dns-addr 9.9.9.9 --dns-port 53 <strong>- не работает</strong>.</p></td><td>2025-01-25T14:40:10.692Z</td></tr>
    </table>
      </body>
    </html>
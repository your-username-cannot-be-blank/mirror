
    <html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <style>
    th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      word-wrap: break-word;
      padding: 5px;
    }
    table {
      width: 100%;
      max-width: 100%;
      border: 1px solid black;
      border-collapse: collapse;
      table-layout: fixed;
      word-wrap: break-word
    }
    code {
      word-wrap: break-word;
    }
    pre {
        white-space: pre-wrap;
    }
    </style>
        <title>не-обновляется-0russiaupdate-windows-7-10454</title>
      </head>
      <body>
        <table border="1" width="100%" cellpadding="5">
          <tr>
            <th style="width: 10%;">Ник</th>
            <th>Пост</th>
            <th style="width: 10%;">Дата</th>
          </tr>
    <tr><td>Arioch(The Arioch)</td><td><p>Похоже, но не совсем, на закрытую тему <a href="https://ntc.party/t/%D0%BD%D0%B5-%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D1%8F%D0%B5%D1%82%D1%81%D1%8F-0russiaupdateblacklistfile-023rc2/10186" class="inline-onebox">Не обновляется 0_russia_update_blacklist_file 0.2.3rc2</a></p>
<p>Подозреваю, что это не блокировки, а именно несовместим именно старый BITS/MSIE</p>
<p>В связи с чем вопрос, нельзя ли сделать для 0-скрипта поддержку wget/curl ?</p>
<ol>
<li>У меня Win 7 со всеми бесплатными обновлениями. Кумулятивку платных не искал, но возможно какие-то из них то же стоят.</li>
<li>Проводной ростелеком, Москва</li>
<li>Тянется это давно, со времён 2.2 уж точно. Но меня это не парило, потому что я без блэклистов гонял, и так нормально было. Да и может быть это правильно, без блэклистов, обфусцировать весь траффик, с точки зрения товарищей вахтёров, смотрящих на костры в ночи?..</li>
<li>При этом если взять адрес и вбить его в Вивальди (хромоног), то скаивается без проблем</li>
<li>Диагностика другая</li>
<li>тут бы полагалось порыться в журнале винды на предмет schannel, но лень</li>
</ol>
<pre><code class="lang-auto">DISPLAY: 'blacklist' TYPE: DOWNLOAD STATE: ERROR
PRIORITY: NORMAL FILES: 0 / 1 BYTES: 0 / UNKNOWN
Unable to complete transfer.
ERROR FILE:    https://p.thenewone.lol/domains-export.txt -&gt; D:\Downloads\Valdi
ERROR CODE:    0x80072f7d - Ошибка поддержки безопасных каналов
ERROR CONTEXT: 0x00000005 - Ошибка при обработке удаленного файла.
</code></pre></td><td>2024-09-20T19:40:01.172Z</td></tr><tr><td>TesterTi(TesterIt)</td><td><p>Подтверждаю, перестало работать. С запущенным gdpi</p>
<pre><code class="lang-auto">DISPLAY: 'blacklist' TYPE: DOWNLOAD STATE: TRANSIENT_ERROR
PRIORITY: NORMAL FILES: 0 / 1 BYTES: 0 / UNKNOWN
ERROR FILE:    https://p.thenewone.lol/domains-export.txt -&gt; d:\My Documents\Пр
ERROR CODE:    0x80072efd - Не удается установить соединение с сервером
ERROR CONTEXT: 0x00000005 - Ошибка при обработке удаленного файла.
</code></pre>
<p><code>curl -v https://p.thenewone.lol</code><br>
выдает ошибку 403</p>
<details>
<summary>
Спойлер</summary>
<pre><code class="lang-auto">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0* Host p.thenewone.lol:443 was resolved.
* IPv6: (none)
* IPv4: 195.123.208.131
*   Trying 195.123.208.131:443...
* Failed to set TCP_KEEPINTVL on fd 348: errno 10042
* Failed to set TCP_KEEPCNT on fd 348: errno 10042
* Connected to p.thenewone.lol (195.123.208.131) port 443
* ALPN: curl offers h2,http/1.1
} [5 bytes data]
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [512 bytes data]
*  CAfile: d:\CMD\curl-ca-bundle.crt
*  CApath: none
{ [5 bytes data]
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [122 bytes data]
* TLSv1.3 (IN), TLS handshake, Encrypted Extensions (8):
{ [19 bytes data]
* TLSv1.3 (IN), TLS handshake, Certificate (11):
{ [2065 bytes data]
* TLSv1.3 (IN), TLS handshake, CERT verify (15):
{ [78 bytes data]
* TLSv1.3 (IN), TLS handshake, Finished (20):
{ [52 bytes data]
* TLSv1.3 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.3 (OUT), TLS handshake, Finished (20):
} [52 bytes data]
* SSL connection using TLSv1.3 / TLS_AES_256_GCM_SHA384 / x25519 / id-ecPublicKey
* ALPN: server accepted h2
* Server certificate:
*  subject: CN=p.thenewone.lol
*  start date: Sep 16 08:25:18 2024 GMT
*  expire date: Dec 15 08:25:17 2024 GMT
*  subjectAltName: host "p.thenewone.lol" matched cert's "p.thenewone.lol"
*  issuer: C=US; O=Let's Encrypt; CN=E5
*  SSL certificate verify ok.
*   Certificate level 0: Public key type EC/prime256v1 (256/128 Bits/secBits), signed using ecdsa-with-SHA384
*   Certificate level 1: Public key type EC/secp384r1 (384/192 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type RSA (4096/152 Bits/secBits), signed using sha256WithRSAEncryption
} [5 bytes data]
* using HTTP/2
* [HTTP/2] [1] OPENED stream for https://p.thenewone.lol/
* [HTTP/2] [1] [:method: GET]
* [HTTP/2] [1] [:scheme: https]
* [HTTP/2] [1] [:authority: p.thenewone.lol]
* [HTTP/2] [1] [:path: /]
* [HTTP/2] [1] [user-agent: curl/8.9.1]
* [HTTP/2] [1] [accept: */*]
} [5 bytes data]
&gt; GET / HTTP/2
&gt; Host: p.thenewone.lol
&gt; User-Agent: curl/8.9.1
&gt; Accept: */*
* Request completely sent off
{ [5 bytes data]
* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):
{ [265 bytes data]
* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):
{ [265 bytes data]
&lt; HTTP/2 403 
&lt; server: nginx/1.18.0
&lt; date: Fri, 20 Sep 2024 23:10:22 GMT
&lt; content-type: text/html; charset=UTF-8
&lt; content-length: 153
{ [5 bytes data]
100   153  100   153    0     0    317      0 --:--:-- --:--:-- --:--:--   322
* Connection #0 to host p.thenewone.lol left intact
</code></pre>
</details></td><td>2024-09-20T23:14:16.585Z</td></tr><tr><td>WhiteAls(ъыь)</td><td><p>только что проверил на вм с win7 с бесплатными патчами от мс и проблем не обнаружил. 403 при обращении к корню указанного сайта всегда было.<br>
минут 30 назад и этот сайт не работал, возможно ValdikSS переносил свои сайты куда-то.<br>
в любом случае, что мешает установить корневые сертификаты lets ecrypt самостоятельно?</p><aside class="onebox allowlistedgeneric" data-onebox-src="https://letsencrypt.org/ru/certificates/">
  <header class="source">

      <a href="https://letsencrypt.org/ru/certificates/" target="_blank" rel="noopener nofollow ugc">letsencrypt.org</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/362;"><img src="не-обновляется-0russiaupdate-windows-7-10454/c0f71b11acf471cb0064575038886ed2fcc9a16b_2_690x362.png" class="thumbnail" data-dominant-color="DEE4E8" width="690" height="362"></div>

<h3><a href="https://letsencrypt.org/ru/certificates/" target="_blank" rel="noopener nofollow ugc">Цепочка доверия -  Что такое Let's Encrypt</a></h3>

  <p>Корневые сертификаты Наши корневые сертификаты хранятся в надёжном месте и недоступны онлайн. Мы выпускаем сертификаты для пользователей на основе промежуточных сертификатов из следующего раздела. Для дополнительной совместимости с новым Root X2 с...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://support.microsoft.com/ru-ru/topic/%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D0%B0-%D1%81%D1%80%D0%BE%D1%87%D0%BD%D1%8B%D1%85-%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B9-%D0%B4%D0%BE%D0%B2%D0%B5%D1%80%D0%B5%D0%BD%D0%BD%D1%8B%D1%85-%D0%BA%D0%BE%D1%80%D0%BD%D0%B5%D0%B2%D1%8B%D1%85-%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D0%B2-%D0%B4%D0%BB%D1%8F-%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D1%8B-%D0%BA%D0%BE%D1%80%D0%BD%D0%B5%D0%B2%D1%8B%D1%85-%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D0%B2-windows-%D0%B2-windows-a4ac4d6c-7c62-3b6e-dfd2-377982bf3ea5">
  <header class="source">
      <img src="не-обновляется-0russiaupdate-windows-7-10454/e82d2e5bae8041267d27387528ae04c86a4bc482.png" class="site-icon" data-dominant-color="9C9A44" width="32" height="32">

      <a href="https://support.microsoft.com/ru-ru/topic/%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D0%B0-%D1%81%D1%80%D0%BE%D1%87%D0%BD%D1%8B%D1%85-%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B9-%D0%B4%D0%BE%D0%B2%D0%B5%D1%80%D0%B5%D0%BD%D0%BD%D1%8B%D1%85-%D0%BA%D0%BE%D1%80%D0%BD%D0%B5%D0%B2%D1%8B%D1%85-%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D0%B2-%D0%B4%D0%BB%D1%8F-%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D1%8B-%D0%BA%D0%BE%D1%80%D0%BD%D0%B5%D0%B2%D1%8B%D1%85-%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D0%B2-windows-%D0%B2-windows-a4ac4d6c-7c62-3b6e-dfd2-377982bf3ea5" target="_blank" rel="noopener nofollow ugc">support.microsoft.com</a>
  </header>

  <article class="onebox-body">
    

<h3><a href="https://support.microsoft.com/ru-ru/topic/%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D0%B0-%D1%81%D1%80%D0%BE%D1%87%D0%BD%D1%8B%D1%85-%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B9-%D0%B4%D0%BE%D0%B2%D0%B5%D1%80%D0%B5%D0%BD%D0%BD%D1%8B%D1%85-%D0%BA%D0%BE%D1%80%D0%BD%D0%B5%D0%B2%D1%8B%D1%85-%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D0%B2-%D0%B4%D0%BB%D1%8F-%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D1%8B-%D0%BA%D0%BE%D1%80%D0%BD%D0%B5%D0%B2%D1%8B%D1%85-%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D0%B2-windows-%D0%B2-windows-a4ac4d6c-7c62-3b6e-dfd2-377982bf3ea5" target="_blank" rel="noopener nofollow ugc">Поддержка срочных обновлений доверенных корневых сертификатов для программы...</a></h3>

  <p>Описание обновления для обновления программы корневых сертификатов Windows в Windows 8.1, Windows RT 8.1, Windows Server 2012 R2, Windows 8, Windows RT, Windows Server 2012, Windows 7 и Windows Server 2008 R2.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>
</td><td>2024-09-21T00:17:50.353Z</td></tr><tr><td>KDS</td><td><p>Проще, наверное, <a href="https://ntc.party/t/%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%B8-%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D1%82%D1%8C-wrong-seq/10003/297">так сделать</a></p></td><td>2024-09-21T01:26:50.394Z</td></tr><tr><td>Arioch(The Arioch)</td><td><p>да не зависит это от circumvention <img src="https://ntc.party/images/emoji/twitter/slight_smile.png?v=12" title=":slight_smile:" class="emoji" alt=":slight_smile:" loading="lazy" width="20" height="20"> я вчера ночью перед сном таки раскочегарил комп c win10, и там нулевой скрипт сработал вовсе без запущенных маскировок/VPN/прочего</p>
<p>то есть я и на “семёрке” скачивал браузером без активного GDPI, но не был вчера на 100% уверен и не написал.  А ночью на win10 специально проверил - да, сам список скачивается на чистом компе и никакой РКН его не банит.</p>
<p><em>Единственное, может быть стоило его архивировать в zip или cab, чисто траффик серверу экономить. Но это Валдику вопрос. Если его кошелёк тянет непакованный текстовик 2,5мб раздавать всем - то его дело.</em></p></td><td>2024-09-21T11:48:21.898Z</td></tr><tr><td>Arioch(The Arioch)</td><td><blockquote>
<p>Описание обновления для обновления программы</p>
</blockquote>
<p>Не работает, там 404.</p>
<p>Но во встроенном обновлении у меня давно ничего не вылезает, кроме антивируса (MSE). Поэтому я предполагаю, что все обновления “этой ветки” у меня есть.</p>
<p>Но всё же попробуем, по шагам.<br>
По твоей ссылке там сплошное 404, но с помощью веб-архива находится редирект 2020 года на <a href="http://www.microsoft.com/ru-ru/download/details.aspx?id=45633" rel="noopener nofollow ugc">http://www.microsoft.com/ru-ru/download/details.aspx?id=45633</a></p>
<pre><code class="lang-auto">Title: Обновление для Windows 7 для систем на базе 64-разрядных (x64) процессоров (KB3004394)
Version: 3004394
Date Published: 09.02.2015
File Name: Windows6.1-KB3004394-v2-x64.msu
File Size: 2.3 MB
</code></pre>
<p>Как и ожидалось,</p>
<pre><code class="lang-auto">---------------------------
Автономный установщик обновлений Windows
---------------------------
Обновление не применимо к этому комьютеру.
---------------------------
ОК   
---------------------------
</code></pre>
<p>Не очень информативно…</p>
<p>Тут пустота: <code>C:\Windows\system32&gt;WMIC QFE LIST FULL | grep 3004394</code></p>
<p>находим <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\ApplicabilityEvaluationCache\Package_for_KB3004394~31bf3856ad364e35~amd64~~6.1.2.0</code></p>
<pre><code class="lang-auto">ApplicabilityState = 0x50
CurrentState = 0
</code></pre>
<p>Похоже, что какой-то более новый патч его перекрыл?..</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://learn.microsoft.com/ru-ru/archive/blogs/tip_of_the_day/tip-of-the-day-cbs-servicing-states-chart-refresher">
  <header class="source">

      <a href="https://learn.microsoft.com/ru-ru/archive/blogs/tip_of_the_day/tip-of-the-day-cbs-servicing-states-chart-refresher" target="_blank" rel="noopener nofollow ugc">learn.microsoft.com</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/362;"><img src="не-обновляется-0russiaupdate-windows-7-10454/df50ff207e6a6ce3b4d58cdf0195308a0fb1e170_2_690x362.png" class="thumbnail" data-dominant-color="D1DDE2" width="690" height="362"></div>

<h3><a href="https://learn.microsoft.com/ru-ru/archive/blogs/tip_of_the_day/tip-of-the-day-cbs-servicing-states-chart-refresher" target="_blank" rel="noopener nofollow ugc">Tip of the Day: CBS Servicing States Chart - Refresher</a></h3>



  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<blockquote>
<p>Superseded == 0x50 == 80<br>
CbsInstallStateSuperseded == -17: only returned from EvaluateApplicability</p>
</blockquote>
<p>И в самом деле, в <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages</code> такого нет.</p>
<p>Таки ваш номер KB слегка устарел… Такие дела…</p></td><td>2024-09-21T12:15:17.476Z</td></tr><tr><td>Arioch(The Arioch)</td><td><p><em>Вторую часть отдельным постом, а то совсем большие получаются. А это не NNTP, a WWW, который любой набранный текст может убить в любую секунду по любой прихоти…</em></p>
<p>Первая ссылка тоже слегка протухла. Поэтому <a href="https://letsencrypt.org/certificates/" class="inline-onebox" rel="noopener nofollow ugc">Chains of Trust - Let's Encrypt</a></p>
<blockquote>
<p>Последнее обновление: 2 окт. 2021 г. Внимание! Английская версия сайта была обновлена, перевод неактуален (11 июн. 2024 г.)</p>
</blockquote>
<p>Запускаю <em>certmgr.msc</em>, ISRG X1 уже в корневых лежит (и только он)</p>
<p>Скачиваю в DER-формате X1 self-signed, сравниваю серийник, оно…</p>
<p>Скачиваю X2 cross-signed… Упс.</p>
<pre><code class="lang-auto">---------------------------
Предупреждение о безопасности
---------------------------
....ISRG Root X2

Не удается проверить, что сертификат принадлежит "ISRG Root X2"....

Отпечаток (sha1) : 151682F5 218C0A51 1C28F406 0A73B9CA 78CE9A53

Предупреждение: Если установить данный корневой сертификат, то Windows автоматически будет доверять любому сертификату, выданному ЦС. Установка сертификата без отпечатка может привести к риску безопасности. "Да" указывает, что риск принимается.
</code></pre>
<p>Ну ладно, поставлю как есть, но на будущее, старичкам с win7 лучше ставить Self-signed x2</p>
<p>Перезапускаю программу, в списке появился, но только до сентября 2025…</p>
<blockquote>
<p>Кстати <em>Certificate details (cross-signed by DST Root CA X3)</em> а он как раз сдох в 2021. Впрочем, беглый гуглёж намекает, что DST X3 не обновлялся и уже не будет…</p>
</blockquote>
<p>Скачиваю и устанавливаю intermediate E5-E8 (c/s X1), R11, R12, перезапускаю BITS - все равно не работает.</p>
<p>Сравниваю серийники… Попутно выясняю, что можно было ничего не качать, а сразу брать из браузера.</p>
<p><em>тут нет спойлер-тэга или коллапс-тэга?</em></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="не-обновляется-0russiaupdate-windows-7-10454/0086abd6c69c946dc01403d9d65edb5003349423.png" data-download-href="https://ntc.party/uploads/default/0086abd6c69c946dc01403d9d65edb5003349423" title="2024-09-21 15_45_34-403 Forbidden - Vivaldi"><img src="не-обновляется-0russiaupdate-windows-7-10454/0086abd6c69c946dc01403d9d65edb5003349423_2_412x500.png" alt="2024-09-21 15_45_34-403 Forbidden - Vivaldi" data-base62-sha1="4EwYi7jobYLtLIeEVbPsBiCogj" width="412" height="500" srcset="не-обновляется-0russiaupdate-windows-7-10454/0086abd6c69c946dc01403d9d65edb5003349423_2_412x500.png, не-обновляется-0russiaupdate-windows-7-10454/0086abd6c69c946dc01403d9d65edb5003349423.png 1.5x, не-обновляется-0russiaupdate-windows-7-10454/0086abd6c69c946dc01403d9d65edb5003349423.png 2x" data-dominant-color="E9E9E9"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">2024-09-21 15_45_34-403 Forbidden - Vivaldi</span><span class="informations">584×708 15.2 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div> <div class="lightbox-wrapper"><a class="lightbox" href="не-обновляется-0russiaupdate-windows-7-10454/a23968f06ce4d817718d24adc0b96f7e9a9752f4.png" data-download-href="https://ntc.party/uploads/default/a23968f06ce4d817718d24adc0b96f7e9a9752f4" title="2024-09-21 15_47_03-403 Forbidden - Vivaldi"><img src="не-обновляется-0russiaupdate-windows-7-10454/a23968f06ce4d817718d24adc0b96f7e9a9752f4_2_476x500.png" alt="2024-09-21 15_47_03-403 Forbidden - Vivaldi" data-base62-sha1="n96lIVc9CPd9DsSvd8pmIUshCpm" width="476" height="500" srcset="не-обновляется-0russiaupdate-windows-7-10454/a23968f06ce4d817718d24adc0b96f7e9a9752f4_2_476x500.png, не-обновляется-0russiaupdate-windows-7-10454/a23968f06ce4d817718d24adc0b96f7e9a9752f4_2_714x750.png 1.5x, не-обновляется-0russiaupdate-windows-7-10454/a23968f06ce4d817718d24adc0b96f7e9a9752f4_2_952x1000.png 2x" data-dominant-color="C5C5C6"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">2024-09-21 15_47_03-403 Forbidden - Vivaldi</span><span class="informations">1026×1076 61.3 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Устанавливаю вторую пачку E5-E8…  <code>net stop bits</code>, <code>net start bits</code>… Один хрен, не работает.</p>
<p>От безнадёги даже установил конечный сертификат P-lol - один фиг. Дальше сейчас некогда копать, да и не очень, если честно, понимаю куда.</p>
<p>Поставил self-signed x2 - поведение слегка изменилось. Раньше после запуска скрипта и до ошибки было секунды две. А теперь ошибка моментально возникает.</p>
<p>Выключу компостер, пойду гулять. Может быть после перезагрузки попустит…</p>
<p>Но сдается мне, проблема именно в разрешённых и запрещённых версиях SSL/TLS, и что они разные у win7 bits и у того сайта.</p>
<p>WIN+R, <code>EventVwr.msc</code></p>
<pre><code class="lang-auto">Имя журнала:   System
Источник:      Schannel
Дата:          21.09.2024 15:57:58
Код события:   36887
Категория задачи:Отсутствует
Уровень:       Ошибка
Ключевые слова:
Пользователь:  система
Компьютер:     pc-analyticdev
Описание:
Получено следующее предупреждение о неустранимой ошибке: 80.
Xml события:
&lt;Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event"&gt;
  &lt;System&gt;
    &lt;Provider Name="Schannel" Guid="{1F678132-5938-4686-9FDC-C8FF68F15C85}" /&gt;
    &lt;EventID&gt;36887&lt;/EventID&gt;
    &lt;Version&gt;0&lt;/Version&gt;
    &lt;Level&gt;2&lt;/Level&gt;
    &lt;Task&gt;0&lt;/Task&gt;
    &lt;Opcode&gt;0&lt;/Opcode&gt;
    &lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;
    &lt;TimeCreated SystemTime="2024-09-21T12:57:58.780034800Z" /&gt;
    &lt;EventRecordID&gt;853426&lt;/EventRecordID&gt;
    &lt;Correlation /&gt;
    &lt;Execution ProcessID="744" ThreadID="2092" /&gt;
    &lt;Channel&gt;System&lt;/Channel&gt;
    &lt;Computer&gt;...[ДАННЫE УДАЛЕНЫ]....&lt;/Computer&gt;
    &lt;Security UserID="S-1-5-18" /&gt;
  &lt;/System&gt;
  &lt;EventData&gt;
    &lt;Data Name="AlertDesc"&gt;80&lt;/Data&gt;
  &lt;/EventData&gt;
&lt;/Event&gt;
</code></pre></td><td>2024-09-21T12:53:19.130Z</td></tr><tr><td>TesterTi(TesterIt)</td><td><aside class="quote no-group" data-username="Arioch" data-post="5" data-topic="10454">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/arioch/48/8371_2.png" class="avatar"> Arioch:</div>
<blockquote>
<p>на “семёрке” скачивал браузером без активного GDPI</p>
</blockquote>
</aside>
<p>В том то и дело, что в браузере у меня тоже скачивается. И через курл качается сам файл. А через BITS ошибка. При этом еще недавно все работало без всяких обновлений (которые не ставятся - “неприменимо к вашему компьютеру”).</p></td><td>2024-09-21T12:59:25.961Z</td></tr><tr><td>Arioch(The Arioch)</td><td><p>поэтому я с самого начала и заговорил про wget/curl - явно же “в недрах” win7 тупо нет поддержки нуэных версий TLS, а те которые есть - запрещены Валдиком на его сайте…</p></td><td>2024-09-21T13:02:21.477Z</td></tr><tr><td>groundzero</td><td><p>В 7 винде по умолчанию не включена поддержка TLS выше версии 1.0, а сайт поддерживает только TLS 1.2+. Как включить: <a href="https://support.microsoft.com/en-us/topic/update-to-enable-tls-1-1-and-tls-1-2-as-default-secure-protocols-in-winhttp-in-windows-c4bd73d2-31d7-761e-0178-11268bb10392" class="inline-onebox" rel="noopener nofollow ugc">Update to enable TLS 1.1 and TLS 1.2 as default secure protocols in WinHTTP in Windows - Microsoft Support</a><br>
Ирония в том, что включение TLS 1.2+ ломает COM-овский WinHttp очень хитрожопым способом. Это можно игнорировать, если у тебя нет JS/VB-скриптов или других пользователей COM-сервера WinHttp.WinHttpRequest.5.1. А если есть, то я уже не помню как лечил. Скорее всего, куча вложенных try-catch с постепенным понижением флагов, т.е. типа (JS):</p>
<pre><code class="lang-auto">var xhr = new ActiveXObject("WinHttp.WinHttpRequest.5.1");
var WinHttpRequestOption_SecureProtocols = 9;
// 0x00000008   SSL 2.0
// 0x00000020   SSL 3.0
// 0x00000080   TLS 1.0
// 0x00000200   TLS 1.1
// 0x00000800   TLS 1.2
try { xhr.Option(WinHttpRequestOption_SecureProtocols) = 0x80 | 0x200 | 0x800; }
catch (x) {
  try { xhr.Option(WinHttpRequestOption_SecureProtocols) = 0x08 | 0x20 | 0x80; }
  catch (x) {
    xhr.Option(WinHttpRequestOption_SecureProtocols) = 0;
  }
}
</code></pre></td><td>2024-09-21T17:11:45.262Z</td></tr><tr><td>groundzero</td><td><p>Чтобы проверить поддерживаемые сайтом протоколы и шифры, можно юзать sslscan (<a href="https://github.com/rbsec/sslscan/" class="inline-onebox" rel="noopener nofollow ugc">GitHub - rbsec/sslscan: sslscan tests SSL/TLS enabled services to discover supported cipher suites</a>):</p>
<aside class="quote no-group">
<blockquote>
<p><code>sslscan --sni-name=p.thenewone.lol p.thenewone.lol:443</code></p>
</blockquote>
</aside></td><td>2024-09-21T17:18:44.323Z</td></tr><tr><td>exz</td><td><p>win7<br>
<div class="lightbox-wrapper"><a class="lightbox" href="не-обновляется-0russiaupdate-windows-7-10454/f86dbba2162e735c9f3e0fd485d08e61e024f9a7.png" data-download-href="https://ntc.party/uploads/default/f86dbba2162e735c9f3e0fd485d08e61e024f9a7" title="image"><img src="не-обновляется-0russiaupdate-windows-7-10454/f86dbba2162e735c9f3e0fd485d08e61e024f9a7.png" alt="image" data-base62-sha1="zrHvTpzwgJRv5nHvOCxOPq4KMaH" width="359" height="500" data-dominant-color="171717"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">652×906 27.9 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p></td><td>2024-09-21T17:57:44.660Z</td></tr><tr><td>Arioch(The Arioch)</td><td><p>само обновление у меня стояло<br>
установил easy fix<br>
прошелся по реестру, проверил<br>
добавил в schannel поддержку tls 1.2 (но не 1.1)</p>
<p>…ничего не изменилось, увы</p>
<p>Хотя и должно вроде: <a href="https://stackoverflow.com/a/48236070/976391" class="inline-onebox" rel="noopener nofollow ugc">ssl - Background Intelligent Transfer and TLS 1.2 - Stack Overflow</a></p>
<blockquote>
<p>ломает COM-овский WinHttp очень хитрожопым способом</p>
</blockquote>
<p>а подробнее про это было? у меня лично вроде нет, но на то и COM, чтобы его кто угодно мог использовать</p></td><td>2024-09-21T18:00:32.186Z</td></tr><tr><td>Arioch(The Arioch)</td><td><p>Поэтому чем трахаться с ненадёжными (и потенциально опасными, как я понял) модификациями win7, может быть надежнее подвязаться на программы, которые “свой TCP-стэк носят с собой”</p>
<p>Дописал вот</p>
<pre><code class="lang-auto">@ECHO OFF
PUSHD "%~dp0"
bitsadmin /transfer blacklist https://p.thenewone.lol/domains-export.txt "%CD%\russia-blacklist.txt"
echo %ERRORLEVEL% retcode %=ExitCode% 
cmd /c rem
echo %ERRORLEVEL% retcode %=ExitCode% 
POPD
</code></pre>
<p>Получил</p>
<pre><code class="lang-auto">ERROR CONTEXT: 0x00000005 - Ошибка при обработке удаленного файла.
-2147012739 retcode 80072F7D
0 retcode 00000000
</code></pre>
<p>Впрочем, в первый раз я получил “echo is off”, но возможно на тот момент у меня было на диск сохранено только ошибочное <code>echo %ERRORCODE%</code></p>
<p>В любом случае, ввиду отрицательного значения использовать обычное <code>IF ERRORLEVEL</code> не получится, но можно зачищать переменную %ERRORLEVEL% перед запуском BITS или использовать <code>=ExitCode</code> (RTFM: <a href="https://ss64.com/nt/syntax-variables.html" class="inline-onebox" rel="noopener nofollow ugc">Windows Environment Variables - Windows CMD - SS64.com</a>)</p>
<p>Есть еще один момент PowerShell 3+ из лучших побуждений ломает cURL и WGet, но на Win7 такие его версии вроде бы не актуальны.</p>
<ul>
<li><a href="https://habr.com/ru/articles/308140/" class="inline-onebox" rel="noopener nofollow ugc">Автор сurl просит Microsoft удалить алиасы curl и wget из PowerShell / Хабр</a></li>
<li><a href="https://techcommunity.microsoft.com/t5/windows-powershell/why-is-wget-no-longer-an-alias-for-invoke-webrequest/m-p/1282929" class="inline-onebox" rel="noopener nofollow ugc">Why is wget no longer an alias for Invoke-WebRequest? - Microsoft Community Hub</a></li>
<li><a href="https://support.moonpoint.com/os/windows/PowerShell/wget-curl.php" class="inline-onebox" rel="noopener nofollow ugc">Wget and curl functionality via PowerShell on a Windows system</a></li>
</ul></td><td>2024-09-21T18:24:06.915Z</td></tr><tr><td>Arioch(The Arioch)</td><td><p>кстати, offtopic</p>
<p>раз уж ты про jscript/wsh заговорил</p>
<p>ты не сталкивался с тем, что использование iDispatch внутри wsh/js почему-то сразу создает ТРИ ссылки на каждый объект, которые не освобождаются, пока не освобождается объект JS-модуля скрипта? то есть попытка сделать любой RAII прекрасно работает в VBScript, но полностью проваливается в JScript…</p></td><td>2024-09-21T18:28:00.523Z</td></tr><tr><td>TesterTi(TesterIt)</td><td><aside class="quote no-group" data-username="groundzero" data-post="11" data-topic="10454">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/g/ee59a6/48.png" class="avatar"> groundzero:</div>
<blockquote>
<p>Чтобы проверить поддерживаемые сайтом протоколы и шифры, можно юзать sslscan</p>
</blockquote>
</aside>
<p>А можно еще и онлайн здесь: <a href="https://page-speed.ru/tests/tls/" class="inline-onebox" rel="noopener nofollow ugc">Онлайн проверка версий протокола TLS</a>. Поддерживается только TLS 1.2 и TLS 1.3</p></td><td>2024-09-21T18:38:17.063Z</td></tr><tr><td>WhiteAls(ъыь)</td><td><p><a class="mention" href="/u/arioch">@Arioch</a> каюсь, что не перепроверил свои ссылки два раза. но судя по описанному у вас очевидная проблема с обновлениями, либо система система изначально как-то поломана.<br>
утсранять проблемы в win7 в 2024 - гиблое дело. ради спортивного интереса могу предложить вам попробовать исполнить в <code>cmd</code> вот такую команду<br>
<code>powershell -Command "(New-Object Net.WebClient).DownloadFile('https://p.thenewone.lol/domains-export.txt', 'russia-blacklist.txt')"</code><br>
если заработает, то можем попросить ValdikSS поменять скрипт обновления списков на использование этого варианта, т.к. он предназначен для работы в powershell 2.0, который идёт из коробки в win7 и работает вплоть до win11.<br>
также, можете попробовать установить <a href="https://nnmclub.to/forum/viewtopic.php?t=1530323" rel="noopener nofollow ugc">вот это</a>, если ваши политические, религиозные и прочие предпочтения не конфликтуют</p></td><td>2024-09-21T18:45:49.766Z</td></tr><tr><td>WhiteAls(ъыь)</td><td><p>не очень кратко о системе, на которой у меня работает и вариант с bits и вариант с posh.</p>
<details>
<summary>
Спойлер</summary>
<pre data-code-wrap="powershell"><code class="lang-powershell">PS C:\Users\user&gt; $PSVersionTable

Name                           Value
----                           -----
CLRVersion                     2.0.50727.8974
BuildVersion                   6.1.7601.23403
PSVersion                      2.0
WSManStackVersion              2.0
PSCompatibleVersions           {1.0, 2.0}
SerializationVersion           1.1.0.1
PSRemotingProtocolVersion      2.1


PS C:\Users\user&gt; Get-WmiObject -Class Win32_OperatingSystem | Select-Object Caption, OSArchitecture, Version

Caption                                 OSArchitecture                          Version
-------                                 --------------                          -------
Microsoft Windows 7 Профессиональная    64-bit                                  6.1.7601


PS C:\Users\user&gt; Get-WmiObject -Class Win32_QuickFixEngineering | Select-Object HotFixID, Description

HotFixID                                                    Description
--------                                                    -----------
KB2849697                                                   Update
KB2849697                                                   Update
KB2849696                                                   Update
KB2849696                                                   Update
KB2841134                                                   Update
KB2841134                                                   Update
KB2670838                                                   Update
KB2830477                                                   Update
KB2592687                                                   Update
KB917607                                                    Update
KB2533552                                                   Update
KB2534111                                                   Hotfix
KB2545698                                                   Update
KB2547666                                                   Update
KB2574819                                                   Update
KB2603229                                                   Update
KB2667402                                                   Security Update
KB2676562                                                   Security Update
KB2685811                                                   Update
KB2685813                                                   Update
KB2698365                                                   Security Update
KB2729094                                                   Update
KB2732059                                                   Update
KB2750841                                                   Update
KB2761217                                                   Update
KB2773072                                                   Update
KB2809215                                                   Update
KB2813347                                                   Security Update
KB2818604                                                   Update
KB2834140                                                   Update
KB2862330                                                   Security Update
KB2894844                                                   Security Update
KB2900986                                                   Security Update
KB2919469                                                   Update
KB2952664                                                   Update
KB2970228                                                   Update
KB2984972                                                   Security Update
KB3004375                                                   Security Update
KB3006137                                                   Hotfix
KB3021917                                                   Update
KB3046269                                                   Security Update
KB3059317                                                   Security Update
KB3064209                                                   Update
KB3068708                                                   Update
KB3080149                                                   Update
KB3102429                                                   Update
KB3118401                                                   Update
KB3123479                                                   Security Update
KB3125574                                                   Update
KB3138612                                                   Update
KB3150513                                                   Update
KB3156016                                                   Security Update
KB3159398                                                   Security Update
KB3161102                                                   Update
KB3161949                                                   Security Update
KB3172605                                                   Update
KB3179573                                                   Update
KB3184143                                                   Update
KB3185319                                                   Security Update
KB4019990                                                   Update
KB4474419                                                   Security Update
KB4490628                                                   Update
KB4524752                                                   Update
KB4532945                                                   Update
KB4575903                                                   Security Update
KB5001027                                                   Update
KB5032000                                                   Update
KB5032383                                                   Security Update
KB976902                                                    Update
KB5032252                                                   Security Update


PS C:\Users\user&gt; Get-Content -Path "russia-blacklist.txt" -TotalCount 10
Get-Content : Не удается найти путь "C:\Users\user\russia-blacklist.txt", так как он не существует.
строка:1 знак:12
+ Get-Content &lt;&lt;&lt;&lt;  -Path "russia-blacklist.txt" -TotalCount 10
    + CategoryInfo          : ObjectNotFound: (C:\Users\user\russia-blacklist.txt:String) [Get-Content], ItemNotFoundE
   xception
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetContentCommand

PS C:\Users\user&gt; (New-Object Net.WebClient).DownloadFile('https://p.thenewone.lol/domains-export.txt', 'russia-blacklis
t.txt')
PS C:\Users\user&gt; Get-Content -Path "russia-blacklist.txt" -TotalCount 10
000.pe
000webhostapp.com
00112.ru
002spb.ru
003.su
0057.ru
007007.bar
007007.best
007dom.ru
0095.ru
PS C:\Users\user&gt;
</code></pre>
</details></td><td>2024-09-21T19:00:04.644Z</td></tr><tr><td>Arioch(The Arioch)</td><td><p>Нет, конечно…</p>
<pre><code class="lang-auto">Exception calling "DownloadFile" with "2" argument(s): "Запрос был прерван: Не
удалось создать защищенный канал SSL/TLS."
At line:1 char:1
+ (New-Object Net.WebClient).DownloadFile('https://p.thenewone.lol/doma ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : WebException
</code></pre>
<blockquote>
<p>если ваши политические, религиозные и прочие предпочтения не конфликтуют</p>
</blockquote>
<p>Конфликтуют.</p>
<p>Учитывая радикализм Симпликса и уже случавшиеся прецеденты типа зачистки дисков на компьютерах в неправильной стране, а также мое общее недоверие к мегакодекпакам…<br>
<em>Тем более, повторюсь, что все официальные апдейты у меня и так стоят, а объявленные по ссылке “твики реестра” и вовсе лучше вслепую не делать</em></p>
<p>В общем-то, ЧТО мы пытаемся добиться?</p>
<p>Если спасти одного меня, то я могу скачать wget и поставить задачу в планировщик.</p>
<p>Если</p>
<blockquote>
<p>устранять проблемы в win7 в 2024</p>
</blockquote>
<p>то я полностью согласен в бесперспективности, поэтом изначально писал про wget/curl</p>
<p>Даже если тот мегапак вдруг решит <em>мою</em> проблему (и Тестера Ти тоже) - разве будет Валдик рекламировать этот мегапак для пользователей GDPI ? конечно нет.</p>
<p>Ну и спортивный интерес… ограниченный. Лезть куда-то понастоящему глубоко ни одному из нас не хочется <img src="https://ntc.party/images/emoji/twitter/slight_smile.png?v=12" title=":slight_smile:" class="emoji" alt=":slight_smile:" loading="lazy" width="20" height="20"></p>
<details>
<summary>
Спойлер</summary>
<pre><code class="lang-auto">Name                           Value
----                           -----
PSVersion                      5.1.14409.1018
PSEdition                      Desktop
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}
BuildVersion                   10.0.14409.1018
CLRVersion                     4.0.30319.42000
WSManStackVersion              3.0
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1
</code></pre>
<pre><code class="lang-auto">HotFixID  Description
--------  -----------
KB2849697 Update
KB2849697 Update
KB2849696 Update
KB2849696 Update
KB2841134 Update
KB2841134 Update
KB2670838 Update
KB2830477 Update
KB2592687 Update
KB958830  Update
KB971033  Update
KB917607  Update
KB3191566 Update
KB2393802 Security Update
KB2533552 Update
KB2545698 Update
KB2547666 Update
KB2556532 Security Update
KB2574819 Update
KB2603229 Update
KB2644615 Security Update
KB2661254 Update
KB2667402 Security Update
KB2676562 Security Update
KB2685811 Update
KB2685813 Update
KB2698365 Security Update
KB2724197 Security Update
KB2729094 Update
KB2732059 Update
KB2750841 Update
KB2761217 Update
KB2773072 Update
KB2809215 Update
KB2813170 Security Update
KB2813347 Security Update
KB2834140 Update
KB2862330 Security Update
KB2862973 Security Update
KB2884256 Security Update
KB2894844 Security Update
KB2898785 Security Update
KB2900986 Security Update
KB2909210 Security Update
KB2909921 Security Update
KB2919469 Update
KB2925418 Security Update
KB2929437 Security Update
KB2936068 Security Update
KB2952664 Update
KB2953522 Security Update
KB2957689 Security Update
KB2962872 Security Update
KB2963950 Security Update
KB2964358 Security Update
KB2970228 Update
KB2976627 Security Update
KB2977629 Security Update
KB2984972 Security Update
KB2987107 Security Update
KB2990214 Update
KB2999226 Update
KB3000483 Security Update
KB3003057 Security Update
KB3004375 Security Update
KB3006137 Hotfix
KB3008923 Security Update
KB3020370 Update
KB3021917 Update
KB3021952 Security Update
KB3025390 Security Update
KB3032359 Security Update
KB3034196 Security Update
KB3038314 Security Update
KB3046269 Security Update
KB3049563 Security Update
KB3058515 Security Update
KB3059317 Security Update
KB3065822 Security Update
KB3068708 Update
KB3074886 Security Update
KB3075516 Security Update
KB3078071 Security Update
KB3080149 Update
KB3087038 Security Update
KB3087985 Hotfix
KB3093983 Security Update
KB3100773 Security Update
KB3102429 Update
KB3104002 Security Update
KB3118401 Update
KB3123479 Security Update
KB3124275 Security Update
KB3125574 Update
KB3134814 Security Update
KB3138378 Update
KB3138612 Update
KB3139929 Security Update
KB3140245 Update
KB3141092 Update
KB3142024 Security Update
KB3142042 Security Update
KB3145739 Security Update
KB3146706 Security Update
KB3146963 Security Update
KB3148198 Security Update
KB3149090 Security Update
KB3150513 Update
KB3154070 Security Update
KB3156016 Security Update
KB3159398 Security Update
KB3160005 Security Update
KB3161102 Update
KB3161949 Security Update
KB3163245 Security Update
KB3170106 Security Update
KB3172605 Update
KB3175443 Security Update
KB3177467 Security Update
KB3179573 Update
KB3184143 Update
KB3185319 Security Update
KB3192391 Security Update
KB3197867 Security Update
KB3205394 Security Update
KB4012212 Security Update
KB4015546 Security Update
KB4018271 Security Update
KB4019263 Security Update
KB4019990 Update
KB4021558 Security Update
KB4022722 Security Update
KB4025337 Security Update
KB4034679 Security Update
KB4034733 Security Update
KB4036586 Security Update
KB4038779 Security Update
KB4040685 Security Update
KB4040966 Security Update
KB4040980 Update
KB4041678 Security Update
KB4048960 Security Update
KB4052978 Security Update
KB4054176 Security Update
KB4054521 Security Update
KB4054998 Update
KB4056568 Security Update
KB4056897 Security Update
KB4074587 Security Update
KB4074736 Security Update
KB4088878 Security Update
KB4089187 Security Update
KB4092946 Security Update
KB4093108 Security Update
KB4095874 Update
KB4096040 Security Update
KB4103712 Security Update
KB4103768 Security Update
KB4230450 Security Update
KB4284867 Security Update
KB4338423 Update
KB4338823 Security Update
KB4339093 Security Update
KB4343205 Security Update
KB4343899 Security Update
KB4344152 Update
KB4344177 Security Update
KB4457044 Update
KB4457145 Security Update
KB4457426 Security Update
KB4462915 Security Update
KB4462949 Security Update
KB4466536 Security Update
KB4467106 Security Update
KB4470199 Security Update
KB4470600 Security Update
KB4470641 Update
KB4474419 Security Update
KB4480063 Update
KB4480960 Security Update
KB4480965 Security Update
KB4483187 Security Update
KB4483458 Update
KB4489873 Security Update
KB4489885 Security Update
KB4490628 Update
KB4495606 Update
KB4495612 Security Update
KB4498206 Security Update
KB4499175 Security Update
KB4503259 Security Update
KB4503269 Security Update
KB4506976 Security Update
KB4507004 Update
KB4507434 Security Update
KB4507456 Security Update
KB4511872 Security Update
KB4512486 Security Update
KB4516033 Security Update
KB4516046 Security Update
KB4516655 Security Update
KB4519974 Security Update
KB4520003 Security Update
KB4523206 Security Update
KB4524135 Security Update
KB4524752 Update
KB4525106 Security Update
KB4525233 Security Update
KB4530677 Security Update
KB4530692 Security Update
KB4531786 Security Update
KB4532945 Update
KB4532960 Security Update
KB4534251 Security Update
KB4534314 Security Update
KB4536952 Security Update
KB4538483 Security Update
KB958488  Update
KB976002  Update
KB976902  Update
KB976932  Service Pack
KB4539601 Update
</code></pre>
</details></td><td>2024-09-21T19:14:45.886Z</td></tr><tr><td>groundzero</td><td><aside class="quote no-group" data-username="Arioch" data-post="13" data-topic="10454" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/arioch/48/8371_2.png" class="avatar"> Arioch:</div>
<blockquote>
<p>само обновление у меня стояло<br>
установил easy fix<br>
прошелся по реестру, проверил<br>
добавил в schannel поддержку tls 1.2 (но не 1.1)</p>
<p>…ничего не изменилось, увы</p>
</blockquote>
</aside>
<p>Надо перезагрузить комп.</p>
<p>Сторонние программы со своим стеком тоже не панацея, потому что могут быть забанены на куче cloudflare-вских серверов. TLS fingerprinting и все такое.</p>
<p>Про IDispatch не в курсе.</p></td><td>2024-09-21T19:16:34.384Z</td></tr><tr><td>Arioch(The Arioch)</td><td><aside class="quote no-group" data-username="groundzero" data-post="20" data-topic="10454">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/g/ee59a6/48.png" class="avatar"> groundzero:</div>
<blockquote>
<p>Надо перезагрузить комп.</p>
</blockquote>
</aside>
<p>Думал про это, но ни easyfix этого не попросил, ни статьи MS про это не писали.<br>
Попозже может быть, но надежды мало.</p>
<p>Тем более, ЕСЛИ этот твик в самом деле может испортить другие программы, использующие COM WinHTTP (а он ЕМНИП используется в том же MSIE AJAX), то Валдик в любом случае вряд ли будет такое предлагать. Ему едва ли нужны крики про “GDPI убивает полезные программы”.</p>
<blockquote>
<p>Сторонние программы … могут быть забанены на куче…</p>
</blockquote>
<p>wget и curl, на куче? вряд ли. Но если вдруг да, то Валдик сможет повторить проблему, используя ту же самодостаточную, статически собранную программу, а повторив - обойти её на своем сервере.</p>
<p>А с win7 он может только в безнадежные попытки угадать неудачное сочетание компонентов и настроек.из тысяч возможных.</p>
<p>Ну или разрешить TLS 1.0, почему бы кстати и нет, для статики и одного единственного файла?</p></td><td>2024-09-21T19:27:28.793Z</td></tr><tr><td>WhiteAls(ъыь)</td><td><aside class="quote no-group" data-username="Arioch" data-post="21" data-topic="10454">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/arioch/48/8371_2.png" class="avatar"> Arioch:</div>
<blockquote>
<p>Ну или разрешить TLS 1.0</p>
</blockquote>
</aside>
<p>а вы уверены, что дело в этом? wireshark запускали, чтобы посмотреть, что винда в client hello посылает?</p></td><td>2024-09-21T19:28:53.384Z</td></tr><tr><td>Arioch(The Arioch)</td><td><p>Нет, слишком сильное колдунство с непонятным выхлопом.</p>
<p>Допустим, мы узнаем, что в win7 плохая реализация TLS 1.2, и что нам это даст? Мы в общем и так догадываемся, раз она по умолчанию выключена.</p>
<p>В общем-то мы и так это знаем, ведь браузеры-то прекрасно качают.<br>
Мы даже не узнаем, все ли Win7 сломаны одинаково.<br>
Мы же не будлем делат ьсвою, исправленную сборку Win7</p></td><td>2024-09-21T19:43:19.633Z</td></tr><tr><td>WhiteAls(ъыь)</td><td><aside class="quote no-group" data-username="Arioch" data-post="23" data-topic="10454">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/arioch/48/8371_2.png" class="avatar"> Arioch:</div>
<blockquote>
<p>Мы в общем и так догадываемся, раз она по умолчанию выключена.</p>
</blockquote>
</aside>
<p>по идее не выключена.</p><aside class="onebox allowlistedgeneric" data-onebox-src="https://learn.microsoft.com/en-us/windows/win32/secauthn/tls-cipher-suites-in-windows-7">
  <header class="source">

      <a href="https://learn.microsoft.com/en-us/windows/win32/secauthn/tls-cipher-suites-in-windows-7" target="_blank" rel="noopener nofollow ugc">learn.microsoft.com</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/362;"><img src="не-обновляется-0russiaupdate-windows-7-10454/df50ff207e6a6ce3b4d58cdf0195308a0fb1e170_2_690x362.png" class="thumbnail" data-dominant-color="D1DDE2" width="690" height="362"></div>

<h3><a href="https://learn.microsoft.com/en-us/windows/win32/secauthn/tls-cipher-suites-in-windows-7" target="_blank" rel="noopener nofollow ugc">TLS Cipher Suites in Windows 7 - Win32 apps</a></h3>

  <p>Learn about TLS cipher suites in Windows 7. Cipher suites can only be negotiated for TLS versions which support them.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>
<p>
и скриншот отсюда показывает, что есть совпадающие шифронаборы <a href="https://ntc.party/t/%D0%BD%D0%B5-%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D1%8F%D0%B5%D1%82%D1%81%D1%8F-0russiaupdate-windows-7/10454/12" class="inline-onebox">Не обновляется 0_russia_update.... (Windows 7?) - #12 by exz</a></p></td><td>2024-09-21T19:45:23.373Z</td></tr><tr><td>Arioch(The Arioch)</td><td><p>Да, после перезагрузки кажется заработало.</p>
<p>Жаль, что без перезагрузки нельзя, чтобы 0-батник локально что-то включал, скачивал, и выключал обратно.</p>
<p><i>теперь следующий квест будет это все как-то с ByeDPI-A подружить, чтобы на телефоне <a href="http://fivepost.ru" rel="noopener nofollow ugc">fivepost.ru</a> не отваливался, вместо ютюба. Вообще бы, помечтать, чтобы авторы трёх программ договорились до общего формата конфигурации, хоть json хоть Ini</i></p></td><td>2024-09-21T20:08:11.654Z</td></tr><tr><td>Arioch(The Arioch)</td><td><p>это не та ссылка, вы про методы шифрования, а не про протоколы</p>
<p>а про протоколы вот тут: <a href="https://learn.microsoft.com/en-us/windows/win32/secauthn/protocols-in-tls-ssl--schannel-ssp-" class="inline-onebox" rel="noopener nofollow ugc">Protocols in TLS/SSL (Schannel SSP) - Win32 apps | Microsoft Learn</a></p>
<p>И толку, что шифр включён, если сам протокол выключен и этот шифр никто никогда не попросит <img src="https://ntc.party/images/emoji/twitter/smiley.png?v=12" title=":smiley:" class="emoji" alt=":smiley:" loading="lazy" width="20" height="20"></p></td><td>2024-09-21T20:15:31.716Z</td></tr><tr><td>WhiteAls(ъыь)</td><td><aside class="quote no-group" data-username="Arioch" data-post="26" data-topic="10454">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/user_avatar/ntc.party/arioch/48/8371_2.png" class="avatar"> Arioch:</div>
<blockquote>
<p>это не та ссылка, вы про методы шифрования, а не про протоколы</p>
</blockquote>
</aside>
<p>странно, что там пишут об отключенном tls 1.2. почему тогда у меня в свежеустановленной win7 он включен? и уж тем более странно, что у вас он отключен, учитывая большее кол-во установленных обновлений <img src="https://ntc.party/images/emoji/twitter/sweat_smile.png?v=12" title=":sweat_smile:" class="emoji" alt=":sweat_smile:" loading="lazy" width="20" height="20"></p></td><td>2024-09-21T20:29:36.610Z</td></tr><tr><td>Arioch(The Arioch)</td><td><p>свежеустановленная win7 и ТОЛЬКО она ? или сверху уже накатили какой-нибудь мега-пак с “registry tweaks” ?</p>
<blockquote>
<p>тем более странно, что у вас он отключен, учитывая … обновлений</p>
</blockquote>
<p>почему странно? выше по ссылке на документацию к тому самом обновлению сказано английским по белому, что “код” для поддержки TLS 1.2 в систему добавляется, но только код, а включать его надо в реестре самому.</p>
<aside class="quote quote-modified" data-post="10" data-topic="10454">
  <div class="title">
    <div class="quote-controls"></div>
    <img loading="lazy" alt="" width="24" height="24" src="https://ntc.party/letter_avatar_proxy/v4/letter/g/ee59a6/48.png" class="avatar">
    <a href="https://ntc.party/t/%D0%BD%D0%B5-%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D1%8F%D0%B5%D1%82%D1%81%D1%8F-0russiaupdate-windows-7/10454/10">Не обновляется 0_russia_update.... (Windows 7?)</a> <a class="badge-category__wrapper " href="/c/community-software/goodbyedpi/8"><span data-category-id="8" style="--category-badge-color: #BF1E2E; --category-badge-text-color: #FFFFFF; --parent-category-badge-color: #BF1E2E;" data-parent-category-id="27" data-drop-close="true" class="badge-category --has-parent" title="GoodbyeDPI Deep Packet Inspection (DPI) circumvention software discussion and official support forum"><span class="badge-category__name">GoodbyeDPI</span></span></a>
  </div>
  <blockquote>
    В 7 винде по умолчанию не включена поддержка TLS выше версии 1.0, а сайт поддерживает только TLS 1.2+. Как включить: <a href="https://support.microsoft.com/en-us/topic/update-to-enable-tls-1-1-and-tls-1-2-as-default-secure-protocols-in-winhttp-in-windows-c4bd73d2-31d7-761e-0178-11268bb10392" class="inline-onebox" rel="noopener nofollow ugc">Update to enable TLS 1.1 and TLS 1.2 as default secure protocols in WinHTTP in Windows - Microsoft Support</a> 
Ирония в том, что включение TLS 1.2+ ломает COM-овский WinHttp очень хитрожопым способом. Это можно игнорировать, если у тебя нет JS/VB-скриптов или других пользователей COM-сервера WinHttp.WinHttpRequest.5.1. А если есть, то я уже не помню как лечил. Скорее всего, куча влож…
  </blockquote>
</aside>

<p>Так что думаю, вы что-то установили не от Майкрософта, и это что-то вам настройки и поменяло.</p>
<p>Хотя, в общем, какая разница?..</p></td><td>2024-09-21T21:55:01.693Z</td></tr><tr><td>WhiteAls(ъыь)</td><td><p>к сожалению, у меня оригинального исошника не осталось, который я развернул в вм. есть только снимок сразу после установки. на вид выглядит как чистая win7 от мс, разве что несколько обновлений уже внедрены. завтра попробую скачать msdn образ и потестирую в нём.<br>
думаю, если бы это была винда после “мегапака”, то там бы стоял свежий дотнет и, соответсвенно, 5 версия posh, а не 2</p></td><td>2024-09-21T22:08:51.637Z</td></tr><tr><td>Arioch(The Arioch)</td><td><p>да забей, какой в этом в общем-то смысл? добро ночи <img src="https://ntc.party/images/emoji/twitter/slight_smile.png?v=12" title=":slight_smile:" class="emoji" alt=":slight_smile:" loading="lazy" width="20" height="20"></p></td><td>2024-09-21T22:10:03.380Z</td></tr>
    </table>
      </body>
    </html>